/*! For license information please see ol.js.LICENSE.txt */
!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.ol=n():t.ol=n()}(self,(function(){return function(){var t,n={226:function(t,n){n.read=function(t,n,i,r,e){var o,u,s=8*e-r-1,a=(1<<s)-1,f=a>>1,h=-7,c=i?e-1:0,l=i?-1:1,v=t[n+c];for(c+=l,o=v&(1<<-h)-1,v>>=-h,h+=s;h>0;o=256*o+t[n+c],c+=l,h-=8);for(u=o&(1<<-h)-1,o>>=-h,h+=r;h>0;u=256*u+t[n+c],c+=l,h-=8);if(0===o)o=1-f;else{if(o===a)return u?NaN:1/0*(v?-1:1);u+=Math.pow(2,r),o-=f}return(v?-1:1)*u*Math.pow(2,o-r)},n.write=function(t,n,i,r,e,o){var u,s,a,f=8*o-e-1,h=(1<<f)-1,c=h>>1,l=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,v=r?0:o-1,p=r?1:-1,d=n<0||0===n&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(s=isNaN(n)?1:0,u=h):(u=Math.floor(Math.log(n)/Math.LN2),n*(a=Math.pow(2,-u))<1&&(u--,a*=2),(n+=u+c>=1?l/a:l*Math.pow(2,1-c))*a>=2&&(u++,a/=2),u+c>=h?(s=0,u=h):u+c>=1?(s=(n*a-1)*Math.pow(2,e),u+=c):(s=n*Math.pow(2,c-1)*Math.pow(2,e),u=0));e>=8;t[i+v]=255&s,v+=p,s/=256,e-=8);for(u=u<<e|s,f+=e;f>0;t[i+v]=255&u,v+=p,u/=256,f-=8);t[i+v-p]|=128*d}},875:function(t,n,i){"use strict";function r(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function e(t,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}var u=i(692),s=Symbol("max"),a=Symbol("length"),f=Symbol("lengthCalculator"),h=Symbol("allowStale"),c=Symbol("maxAge"),l=Symbol("dispose"),v=Symbol("noDisposeOnSet"),p=Symbol("lruList"),d=Symbol("cache"),y=Symbol("updateAgeOnGet"),m=function(){return 1},w=function(){function t(n){if(r(this,t),"number"==typeof n&&(n={max:n}),n||(n={}),n.max&&("number"!=typeof n.max||n.max<0))throw new TypeError("max must be a non-negative number");this[s]=n.max||1/0;var i=n.length||m;if(this[f]="function"!=typeof i?m:i,this[h]=n.stale||!1,n.maxAge&&"number"!=typeof n.maxAge)throw new TypeError("maxAge must be a number");this[c]=n.maxAge||0,this[l]=n.dispose,this[v]=n.noDisposeOnSet||!1,this[y]=n.updateAgeOnGet||!1,this.reset()}return o(t,[{key:"max",get:function(){return this[s]},set:function(t){if("number"!=typeof t||t<0)throw new TypeError("max must be a non-negative number");this[s]=t||1/0,x(this)}},{key:"allowStale",get:function(){return this[h]},set:function(t){this[h]=!!t}},{key:"maxAge",get:function(){return this[c]},set:function(t){if("number"!=typeof t)throw new TypeError("maxAge must be a non-negative number");this[c]=t,x(this)}},{key:"lengthCalculator",get:function(){return this[f]},set:function(t){var n=this;"function"!=typeof t&&(t=m),t!==this[f]&&(this[f]=t,this[a]=0,this[p].forEach((function(t){t.length=n[f](t.value,t.key),n[a]+=t.length}))),x(this)}},{key:"length",get:function(){return this[a]}},{key:"itemCount",get:function(){return this[p].length}},{key:"rforEach",value:function(t,n){n=n||this;for(var i=this[p].tail;null!==i;){var r=i.prev;O(this,t,i,n),i=r}}},{key:"forEach",value:function(t,n){n=n||this;for(var i=this[p].head;null!==i;){var r=i.next;O(this,t,i,n),i=r}}},{key:"keys",value:function(){return this[p].toArray().map((function(t){return t.key}))}},{key:"values",value:function(){return this[p].toArray().map((function(t){return t.value}))}},{key:"reset",value:function(){var t=this;this[l]&&this[p]&&this[p].length&&this[p].forEach((function(n){return t[l](n.key,n.value)})),this[d]=new Map,this[p]=new u,this[a]=0}},{key:"dump",value:function(){var t=this;return this[p].map((function(n){return!g(t,n)&&{k:n.key,v:n.value,e:n.now+(n.maxAge||0)}})).toArray().filter((function(t){return t}))}},{key:"dumpLru",value:function(){return this[p]}},{key:"set",value:function(t,n,i){if((i=i||this[c])&&"number"!=typeof i)throw new TypeError("maxAge must be a number");var r=i?Date.now():0,e=this[f](n,t);if(this[d].has(t)){if(e>this[s])return _(this,this[d].get(t)),!1;var o=this[d].get(t).value;return this[l]&&(this[v]||this[l](t,o.value)),o.now=r,o.maxAge=i,o.value=n,this[a]+=e-o.length,o.length=e,this.get(t),x(this),!0}var u=new M(t,n,e,r,i);return u.length>this[s]?(this[l]&&this[l](t,n),!1):(this[a]+=u.length,this[p].unshift(u),this[d].set(t,this[p].head),x(this),!0)}},{key:"has",value:function(t){if(!this[d].has(t))return!1;var n=this[d].get(t).value;return!g(this,n)}},{key:"get",value:function(t){return b(this,t,!0)}},{key:"peek",value:function(t){return b(this,t,!1)}},{key:"pop",value:function(){var t=this[p].tail;return t?(_(this,t),t.value):null}},{key:"del",value:function(t){_(this,this[d].get(t))}},{key:"load",value:function(t){this.reset();for(var n=Date.now(),i=t.length-1;i>=0;i--){var r=t[i],e=r.e||0;if(0===e)this.set(r.k,r.v);else{var o=e-n;o>0&&this.set(r.k,r.v,o)}}}},{key:"prune",value:function(){var t=this;this[d].forEach((function(n,i){return b(t,i,!1)}))}}]),t}(),b=function(t,n,i){var r=t[d].get(n);if(r){var e=r.value;if(g(t,e)){if(_(t,r),!t[h])return}else i&&(t[y]&&(r.value.now=Date.now()),t[p].unshiftNode(r));return e.value}},g=function(t,n){if(!n||!n.maxAge&&!t[c])return!1;var i=Date.now()-n.now;return n.maxAge?i>n.maxAge:t[c]&&i>t[c]},x=function(t){if(t[a]>t[s])for(var n=t[p].tail;t[a]>t[s]&&null!==n;){var i=n.prev;_(t,n),n=i}},_=function(t,n){if(n){var i=n.value;t[l]&&t[l](i.key,i.value),t[a]-=i.length,t[d].delete(i.key),t[p].removeNode(n)}},M=o((function t(n,i,e,o,u){r(this,t),this.key=n,this.value=i,this.length=e,this.now=o,this.maxAge=u||0})),O=function(t,n,i,r){var e=i.value;g(t,e)&&(_(t,i),t[h]||(e=void 0)),e&&n.call(r,e.value,e.key,t)};t.exports=w},98:function(t,n,i){"use strict";t.exports=e;var r=i(226);function e(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}e.Varint=0,e.Fixed64=1,e.Bytes=2,e.Fixed32=5;var o=4294967296,u=1/o,s="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function a(t){return t.type===e.Bytes?t.readVarint()+t.pos:t.pos+1}function f(t,n,i){return i?4294967296*n+(t>>>0):4294967296*(n>>>0)+(t>>>0)}function h(t,n,i){var r=n<=16383?1:n<=2097151?2:n<=268435455?3:Math.floor(Math.log(n)/(7*Math.LN2));i.realloc(r);for(var e=i.pos-1;e>=t;e--)i.buf[e+r]=i.buf[e]}function c(t,n){for(var i=0;i<t.length;i++)n.writeVarint(t[i])}function l(t,n){for(var i=0;i<t.length;i++)n.writeSVarint(t[i])}function v(t,n){for(var i=0;i<t.length;i++)n.writeFloat(t[i])}function p(t,n){for(var i=0;i<t.length;i++)n.writeDouble(t[i])}function d(t,n){for(var i=0;i<t.length;i++)n.writeBoolean(t[i])}function y(t,n){for(var i=0;i<t.length;i++)n.writeFixed32(t[i])}function m(t,n){for(var i=0;i<t.length;i++)n.writeSFixed32(t[i])}function w(t,n){for(var i=0;i<t.length;i++)n.writeFixed64(t[i])}function b(t,n){for(var i=0;i<t.length;i++)n.writeSFixed64(t[i])}function g(t,n){return(t[n]|t[n+1]<<8|t[n+2]<<16)+16777216*t[n+3]}function x(t,n,i){t[i]=n,t[i+1]=n>>>8,t[i+2]=n>>>16,t[i+3]=n>>>24}function _(t,n){return(t[n]|t[n+1]<<8|t[n+2]<<16)+(t[n+3]<<24)}e.prototype={destroy:function(){this.buf=null},readFields:function(t,n,i){for(i=i||this.length;this.pos<i;){var r=this.readVarint(),e=r>>3,o=this.pos;this.type=7&r,t(e,n,this),this.pos===o&&this.skip(r)}return n},readMessage:function(t,n){return this.readFields(t,n,this.readVarint()+this.pos)},readFixed32:function(){var t=g(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=_(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=g(this.buf,this.pos)+g(this.buf,this.pos+4)*o;return this.pos+=8,t},readSFixed64:function(){var t=g(this.buf,this.pos)+_(this.buf,this.pos+4)*o;return this.pos+=8,t},readFloat:function(){var t=r.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=r.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var n,i,r=this.buf;return n=127&(i=r[this.pos++]),i<128?n:(n|=(127&(i=r[this.pos++]))<<7,i<128?n:(n|=(127&(i=r[this.pos++]))<<14,i<128?n:(n|=(127&(i=r[this.pos++]))<<21,i<128?n:function(t,n,i){var r,e,o=i.buf;if(e=o[i.pos++],r=(112&e)>>4,e<128)return f(t,r,n);if(e=o[i.pos++],r|=(127&e)<<3,e<128)return f(t,r,n);if(e=o[i.pos++],r|=(127&e)<<10,e<128)return f(t,r,n);if(e=o[i.pos++],r|=(127&e)<<17,e<128)return f(t,r,n);if(e=o[i.pos++],r|=(127&e)<<24,e<128)return f(t,r,n);if(e=o[i.pos++],r|=(1&e)<<31,e<128)return f(t,r,n);throw new Error("Expected varint not more than 10 bytes")}(n|=(15&(i=r[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,n=this.pos;return this.pos=t,t-n>=12&&s?function(t,n,i){return s.decode(t.subarray(n,i))}(this.buf,n,t):function(t,n,i){var r="",e=n;for(;e<i;){var o,u,s,a=t[e],f=null,h=a>239?4:a>223?3:a>191?2:1;if(e+h>i)break;1===h?a<128&&(f=a):2===h?128==(192&(o=t[e+1]))&&(f=(31&a)<<6|63&o)<=127&&(f=null):3===h?(o=t[e+1],u=t[e+2],128==(192&o)&&128==(192&u)&&((f=(15&a)<<12|(63&o)<<6|63&u)<=2047||f>=55296&&f<=57343)&&(f=null)):4===h&&(o=t[e+1],u=t[e+2],s=t[e+3],128==(192&o)&&128==(192&u)&&128==(192&s)&&((f=(15&a)<<18|(63&o)<<12|(63&u)<<6|63&s)<=65535||f>=1114112)&&(f=null)),null===f?(f=65533,h=1):f>65535&&(f-=65536,r+=String.fromCharCode(f>>>10&1023|55296),f=56320|1023&f),r+=String.fromCharCode(f),e+=h}return r}(this.buf,n,t)},readBytes:function(){var t=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,t);return this.pos=t,n},readPackedVarint:function(t,n){if(this.type!==e.Bytes)return t.push(this.readVarint(n));var i=a(this);for(t=t||[];this.pos<i;)t.push(this.readVarint(n));return t},readPackedSVarint:function(t){if(this.type!==e.Bytes)return t.push(this.readSVarint());var n=a(this);for(t=t||[];this.pos<n;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==e.Bytes)return t.push(this.readBoolean());var n=a(this);for(t=t||[];this.pos<n;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==e.Bytes)return t.push(this.readFloat());var n=a(this);for(t=t||[];this.pos<n;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==e.Bytes)return t.push(this.readDouble());var n=a(this);for(t=t||[];this.pos<n;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==e.Bytes)return t.push(this.readFixed32());var n=a(this);for(t=t||[];this.pos<n;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==e.Bytes)return t.push(this.readSFixed32());var n=a(this);for(t=t||[];this.pos<n;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==e.Bytes)return t.push(this.readFixed64());var n=a(this);for(t=t||[];this.pos<n;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==e.Bytes)return t.push(this.readSFixed64());var n=a(this);for(t=t||[];this.pos<n;)t.push(this.readSFixed64());return t},skip:function(t){var n=7&t;if(n===e.Varint)for(;this.buf[this.pos++]>127;);else if(n===e.Bytes)this.pos=this.readVarint()+this.pos;else if(n===e.Fixed32)this.pos+=4;else{if(n!==e.Fixed64)throw new Error("Unimplemented type: "+n);this.pos+=8}},writeTag:function(t,n){this.writeVarint(t<<3|n)},realloc:function(t){for(var n=this.length||16;n<this.pos+t;)n*=2;if(n!==this.length){var i=new Uint8Array(n);i.set(this.buf),this.buf=i,this.length=n}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),x(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),x(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),x(this.buf,-1&t,this.pos),x(this.buf,Math.floor(t*u),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),x(this.buf,-1&t,this.pos),x(this.buf,Math.floor(t*u),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,n){var i,r;t>=0?(i=t%4294967296|0,r=t/4294967296|0):(r=~(-t/4294967296),4294967295^(i=~(-t%4294967296))?i=i+1|0:(i=0,r=r+1|0));if(t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");n.realloc(10),function(t,n,i){i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos]=127&t}(i,0,n),function(t,n){var i=(7&t)<<4;if(n.buf[n.pos++]|=i|((t>>>=3)?128:0),!t)return;if(n.buf[n.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(n.buf[n.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(n.buf[n.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(n.buf[n.pos++]=127&t|((t>>>=7)?128:0),!t)return;n.buf[n.pos++]=127&t}(r,n)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var n=this.pos;this.pos=function(t,n,i){for(var r,e,o=0;o<n.length;o++){if((r=n.charCodeAt(o))>55295&&r<57344){if(!e){r>56319||o+1===n.length?(t[i++]=239,t[i++]=191,t[i++]=189):e=r;continue}if(r<56320){t[i++]=239,t[i++]=191,t[i++]=189,e=r;continue}r=e-55296<<10|r-56320|65536,e=null}else e&&(t[i++]=239,t[i++]=191,t[i++]=189,e=null);r<128?t[i++]=r:(r<2048?t[i++]=r>>6|192:(r<65536?t[i++]=r>>12|224:(t[i++]=r>>18|240,t[i++]=r>>12&63|128),t[i++]=r>>6&63|128),t[i++]=63&r|128)}return i}(this.buf,t,this.pos);var i=this.pos-n;i>=128&&h(n,i,this),this.pos=n-1,this.writeVarint(i),this.pos+=i},writeFloat:function(t){this.realloc(4),r.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),r.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var n=t.length;this.writeVarint(n),this.realloc(n);for(var i=0;i<n;i++)this.buf[this.pos++]=t[i]},writeRawMessage:function(t,n){this.pos++;var i=this.pos;t(n,this);var r=this.pos-i;r>=128&&h(i,r,this),this.pos=i-1,this.writeVarint(r),this.pos+=r},writeMessage:function(t,n,i){this.writeTag(t,e.Bytes),this.writeRawMessage(n,i)},writePackedVarint:function(t,n){n.length&&this.writeMessage(t,c,n)},writePackedSVarint:function(t,n){n.length&&this.writeMessage(t,l,n)},writePackedBoolean:function(t,n){n.length&&this.writeMessage(t,d,n)},writePackedFloat:function(t,n){n.length&&this.writeMessage(t,v,n)},writePackedDouble:function(t,n){n.length&&this.writeMessage(t,p,n)},writePackedFixed32:function(t,n){n.length&&this.writeMessage(t,y,n)},writePackedSFixed32:function(t,n){n.length&&this.writeMessage(t,m,n)},writePackedFixed64:function(t,n){n.length&&this.writeMessage(t,w,n)},writePackedSFixed64:function(t,n){n.length&&this.writeMessage(t,b,n)},writeBytesField:function(t,n){this.writeTag(t,e.Bytes),this.writeBytes(n)},writeFixed32Field:function(t,n){this.writeTag(t,e.Fixed32),this.writeFixed32(n)},writeSFixed32Field:function(t,n){this.writeTag(t,e.Fixed32),this.writeSFixed32(n)},writeFixed64Field:function(t,n){this.writeTag(t,e.Fixed64),this.writeFixed64(n)},writeSFixed64Field:function(t,n){this.writeTag(t,e.Fixed64),this.writeSFixed64(n)},writeVarintField:function(t,n){this.writeTag(t,e.Varint),this.writeVarint(n)},writeSVarintField:function(t,n){this.writeTag(t,e.Varint),this.writeSVarint(n)},writeStringField:function(t,n){this.writeTag(t,e.Bytes),this.writeString(n)},writeFloatField:function(t,n){this.writeTag(t,e.Fixed32),this.writeFloat(n)},writeDoubleField:function(t,n){this.writeTag(t,e.Fixed64),this.writeDouble(n)},writeBooleanField:function(t,n){this.writeVarintField(t,Boolean(n))}}},72:function(t,n,i){var r,e,o;function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}o=function(){"use strict";function t(t,r,e,o,u){!function t(i,r,e,o,u){for(;o>e;){if(o-e>600){var s=o-e+1,a=r-e+1,f=Math.log(s),h=.5*Math.exp(2*f/3),c=.5*Math.sqrt(f*h*(s-h)/s)*(a-s/2<0?-1:1);t(i,r,Math.max(e,Math.floor(r-a*h/s+c)),Math.min(o,Math.floor(r+(s-a)*h/s+c)),u)}var l=i[r],v=e,p=o;for(n(i,e,r),u(i[o],l)>0&&n(i,e,o);v<p;){for(n(i,v,p),v++,p--;u(i[v],l)<0;)v++;for(;u(i[p],l)>0;)p--}0===u(i[e],l)?n(i,e,p):n(i,++p,o),p<=r&&(e=p+1),r<=p&&(o=p-1)}}(t,r,e||0,o||t.length-1,u||i)}function n(t,n,i){var r=t[n];t[n]=t[i],t[i]=r}function i(t,n){return t<n?-1:t>n?1:0}var r=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function e(t,n,i){if(!i)return n.indexOf(t);for(var r=0;r<n.length;r++)if(i(t,n[r]))return r;return-1}function o(t,n){u(t,0,t.children.length,n,t)}function u(t,n,i,r,e){e||(e=p(null)),e.minX=1/0,e.minY=1/0,e.maxX=-1/0,e.maxY=-1/0;for(var o=n;o<i;o++){var u=t.children[o];s(e,t.leaf?r(u):u)}return e}function s(t,n){return t.minX=Math.min(t.minX,n.minX),t.minY=Math.min(t.minY,n.minY),t.maxX=Math.max(t.maxX,n.maxX),t.maxY=Math.max(t.maxY,n.maxY),t}function a(t,n){return t.minX-n.minX}function f(t,n){return t.minY-n.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function c(t){return t.maxX-t.minX+(t.maxY-t.minY)}function l(t,n){return t.minX<=n.minX&&t.minY<=n.minY&&n.maxX<=t.maxX&&n.maxY<=t.maxY}function v(t,n){return n.minX<=t.maxX&&n.minY<=t.maxY&&n.maxX>=t.minX&&n.maxY>=t.minY}function p(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function d(n,i,r,e,o){for(var u=[i,r];u.length;)if(!((r=u.pop())-(i=u.pop())<=e)){var s=i+Math.ceil((r-i)/e/2)*e;t(n,s,i,r,o),u.push(i,s,s,r)}}return r.prototype.all=function(){return this._all(this.data,[])},r.prototype.search=function(t){var n=this.data,i=[];if(!v(t,n))return i;for(var r=this.toBBox,e=[];n;){for(var o=0;o<n.children.length;o++){var u=n.children[o],s=n.leaf?r(u):u;v(t,s)&&(n.leaf?i.push(u):l(t,s)?this._all(u,i):e.push(u))}n=e.pop()}return i},r.prototype.collides=function(t){var n=this.data;if(!v(t,n))return!1;for(var i=[];n;){for(var r=0;r<n.children.length;r++){var e=n.children[r],o=n.leaf?this.toBBox(e):e;if(v(t,o)){if(n.leaf||l(t,o))return!0;i.push(e)}}n=i.pop()}return!1},r.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var n=0;n<t.length;n++)this.insert(t[n]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var r=this.data;this.data=i,i=r}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},r.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},r.prototype.clear=function(){return this.data=p([]),this},r.prototype.remove=function(t,n){if(!t)return this;for(var i,r,o,u=this.data,s=this.toBBox(t),a=[],f=[];u||a.length;){if(u||(u=a.pop(),r=a[a.length-1],i=f.pop(),o=!0),u.leaf){var h=e(t,u.children,n);if(-1!==h)return u.children.splice(h,1),a.push(u),this._condense(a),this}o||u.leaf||!l(u,s)?r?(i++,u=r.children[i],o=!1):u=null:(a.push(u),f.push(i),i=0,r=u,u=u.children[0])}return this},r.prototype.toBBox=function(t){return t},r.prototype.compareMinX=function(t,n){return t.minX-n.minX},r.prototype.compareMinY=function(t,n){return t.minY-n.minY},r.prototype.toJSON=function(){return this.data},r.prototype.fromJSON=function(t){return this.data=t,this},r.prototype._all=function(t,n){for(var i=[];t;)t.leaf?n.push.apply(n,t.children):i.push.apply(i,t.children),t=i.pop();return n},r.prototype._build=function(t,n,i,r){var e,u=i-n+1,s=this._maxEntries;if(u<=s)return o(e=p(t.slice(n,i+1)),this.toBBox),e;r||(r=Math.ceil(Math.log(u)/Math.log(s)),s=Math.ceil(u/Math.pow(s,r-1))),(e=p([])).leaf=!1,e.height=r;var a=Math.ceil(u/s),f=a*Math.ceil(Math.sqrt(s));d(t,n,i,f,this.compareMinX);for(var h=n;h<=i;h+=f){var c=Math.min(h+f-1,i);d(t,h,c,a,this.compareMinY);for(var l=h;l<=c;l+=a){var v=Math.min(l+a-1,c);e.children.push(this._build(t,l,v,r-1))}}return o(e,this.toBBox),e},r.prototype._chooseSubtree=function(t,n,i,r){for(;r.push(n),!n.leaf&&r.length-1!==i;){for(var e=1/0,o=1/0,u=void 0,s=0;s<n.children.length;s++){var a=n.children[s],f=h(a),c=(l=t,v=a,(Math.max(v.maxX,l.maxX)-Math.min(v.minX,l.minX))*(Math.max(v.maxY,l.maxY)-Math.min(v.minY,l.minY))-f);c<o?(o=c,e=f<e?f:e,u=a):c===o&&f<e&&(e=f,u=a)}n=u||n.children[0]}var l,v;return n},r.prototype._insert=function(t,n,i){var r=i?t:this.toBBox(t),e=[],o=this._chooseSubtree(r,this.data,n,e);for(o.children.push(t),s(o,r);n>=0&&e[n].children.length>this._maxEntries;)this._split(e,n),n--;this._adjustParentBBoxes(r,e,n)},r.prototype._split=function(t,n){var i=t[n],r=i.children.length,e=this._minEntries;this._chooseSplitAxis(i,e,r);var u=this._chooseSplitIndex(i,e,r),s=p(i.children.splice(u,i.children.length-u));s.height=i.height,s.leaf=i.leaf,o(i,this.toBBox),o(s,this.toBBox),n?t[n-1].children.push(s):this._splitRoot(i,s)},r.prototype._splitRoot=function(t,n){this.data=p([t,n]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},r.prototype._chooseSplitIndex=function(t,n,i){for(var r,e,o,s,a,f,c,l=1/0,v=1/0,p=n;p<=i-n;p++){var d=u(t,0,p,this.toBBox),y=u(t,p,i,this.toBBox),m=(e=d,o=y,s=Math.max(e.minX,o.minX),a=Math.max(e.minY,o.minY),f=Math.min(e.maxX,o.maxX),c=Math.min(e.maxY,o.maxY),Math.max(0,f-s)*Math.max(0,c-a)),w=h(d)+h(y);m<l?(l=m,r=p,v=w<v?w:v):m===l&&w<v&&(v=w,r=p)}return r||i-n},r.prototype._chooseSplitAxis=function(t,n,i){var r=t.leaf?this.compareMinX:a,e=t.leaf?this.compareMinY:f;this._allDistMargin(t,n,i,r)<this._allDistMargin(t,n,i,e)&&t.children.sort(r)},r.prototype._allDistMargin=function(t,n,i,r){t.children.sort(r);for(var e=this.toBBox,o=u(t,0,n,e),a=u(t,i-n,i,e),f=c(o)+c(a),h=n;h<i-n;h++){var l=t.children[h];s(o,t.leaf?e(l):l),f+=c(o)}for(var v=i-n-1;v>=n;v--){var p=t.children[v];s(a,t.leaf?e(p):p),f+=c(a)}return f},r.prototype._adjustParentBBoxes=function(t,n,i){for(var r=i;r>=0;r--)s(n[r],t)},r.prototype._condense=function(t){for(var n=t.length-1,i=void 0;n>=0;n--)0===t[n].children.length?n>0?(i=t[n-1].children).splice(i.indexOf(t[n]),1):this.clear():o(t[n],this.toBBox)},r},"object"==u(n)?t.exports=o():void 0===(e="function"==typeof(r=o)?r.call(n,i,n,t):r)||(t.exports=e)},760:function(t,n,i){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var e=function(t){"use strict";var n,i=Object.prototype,e=i.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},u=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",a=o.toStringTag||"@@toStringTag";function f(t,n,i){return Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[n]}try{f({},"")}catch(t){f=function(t,n,i){return t[n]=i}}function h(t,n,i,r){var e=n&&n.prototype instanceof m?n:m,o=Object.create(e.prototype),u=new T(r||[]);return o._invoke=function(t,n,i){var r=l;return function(e,o){if(r===p)throw new Error("Generator is already running");if(r===d){if("throw"===e)throw o;return C()}for(i.method=e,i.arg=o;;){var u=i.delegate;if(u){var s=j(u,i);if(s){if(s===y)continue;return s}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(r===l)throw r=d,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r=p;var a=c(t,n,i);if("normal"===a.type){if(r=i.done?d:v,a.arg===y)continue;return{value:a.arg,done:i.done}}"throw"===a.type&&(r=d,i.method="throw",i.arg=a.arg)}}}(t,i,u),o}function c(t,n,i){try{return{type:"normal",arg:t.call(n,i)}}catch(t){return{type:"throw",arg:t}}}t.wrap=h;var l="suspendedStart",v="suspendedYield",p="executing",d="completed",y={};function m(){}function w(){}function b(){}var g={};f(g,u,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(A([])));_&&_!==i&&e.call(_,u)&&(g=_);var M=b.prototype=m.prototype=Object.create(g);function O(t){["next","throw","return"].forEach((function(n){f(t,n,(function(t){return this._invoke(n,t)}))}))}function S(t,n){function i(o,u,s,a){var f=c(t[o],t,u);if("throw"!==f.type){var h=f.arg,l=h.value;return l&&"object"===r(l)&&e.call(l,"__await")?n.resolve(l.__await).then((function(t){i("next",t,s,a)}),(function(t){i("throw",t,s,a)})):n.resolve(l).then((function(t){h.value=t,s(h)}),(function(t){return i("throw",t,s,a)}))}a(f.arg)}var o;this._invoke=function(t,r){function e(){return new n((function(n,e){i(t,r,n,e)}))}return o=o?o.then(e,e):e()}}function j(t,i){var r=t.iterator[i.method];if(r===n){if(i.delegate=null,"throw"===i.method){if(t.iterator.return&&(i.method="return",i.arg=n,j(t,i),"throw"===i.method))return y;i.method="throw",i.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var e=c(r,t.iterator,i.arg);if("throw"===e.type)return i.method="throw",i.arg=e.arg,i.delegate=null,y;var o=e.arg;return o?o.done?(i[t.resultName]=o.value,i.next=t.nextLoc,"return"!==i.method&&(i.method="next",i.arg=n),i.delegate=null,y):o:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,y)}function E(t){var n={tryLoc:t[0]};1 in t&&(n.catchLoc=t[1]),2 in t&&(n.finallyLoc=t[2],n.afterLoc=t[3]),this.tryEntries.push(n)}function k(t){var n=t.completion||{};n.type="normal",delete n.arg,t.completion=n}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function A(t){if(t){var i=t[u];if(i)return i.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function i(){for(;++r<t.length;)if(e.call(t,r))return i.value=t[r],i.done=!1,i;return i.value=n,i.done=!0,i};return o.next=o}}return{next:C}}function C(){return{value:n,done:!0}}return w.prototype=b,f(M,"constructor",b),f(b,"constructor",w),w.displayName=f(b,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===w||"GeneratorFunction"===(n.displayName||n.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,f(t,a,"GeneratorFunction")),t.prototype=Object.create(M),t},t.awrap=function(t){return{__await:t}},O(S.prototype),f(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(n,i,r,e,o){void 0===o&&(o=Promise);var u=new S(h(n,i,r,e),o);return t.isGeneratorFunction(i)?u:u.next().then((function(t){return t.done?t.value:u.next()}))},O(M),f(M,a,"Generator"),f(M,u,(function(){return this})),f(M,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var n=[];for(var i in t)n.push(i);return n.reverse(),function i(){for(;n.length;){var r=n.pop();if(r in t)return i.value=r,i.done=!1,i}return i.done=!0,i}},t.values=A,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(k),!t)for(var i in this)"t"===i.charAt(0)&&e.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var i=this;function r(r,e){return s.type="throw",s.arg=t,i.next=r,e&&(i.method="next",i.arg=n),!!e}for(var o=this.tryEntries.length-1;o>=0;--o){var u=this.tryEntries[o],s=u.completion;if("root"===u.tryLoc)return r("end");if(u.tryLoc<=this.prev){var a=e.call(u,"catchLoc"),f=e.call(u,"finallyLoc");if(a&&f){if(this.prev<u.catchLoc)return r(u.catchLoc,!0);if(this.prev<u.finallyLoc)return r(u.finallyLoc)}else if(a){if(this.prev<u.catchLoc)return r(u.catchLoc,!0)}else{if(!f)throw new Error("try statement without catch or finally");if(this.prev<u.finallyLoc)return r(u.finallyLoc)}}}},abrupt:function(t,n){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&e.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=n&&n<=o.finallyLoc&&(o=null);var u=o?o.completion:{};return u.type=t,u.arg=n,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(u)},complete:function(t,n){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&n&&(this.next=n),y},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),k(i),y}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc===t){var r=i.completion;if("throw"===r.type){var e=r.arg;k(i)}return e}}throw new Error("illegal catch attempt")},delegateYield:function(t,i,r){return this.delegate={iterator:A(t),resultName:i,nextLoc:r},"next"===this.method&&(this.arg=n),y}},t}("object"===r(t=i.nmd(t))?t.exports:{});try{regeneratorRuntime=e}catch(t){"object"===("undefined"==typeof globalThis?"undefined":r(globalThis))?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}},617:function(t,n,i){var r=i(279);t.exports=function(t,n,i){var e=i&&i.debug||!1,o=i&&i.startIndex||0;e&&console.log("starting findTagByName with",n," and ",i);var u=r(t,"<".concat(n,"[ >]"),o);if(e&&console.log("start:",u),-1!==u){var s=t.slice(u+n.length),a=r(s,"[ /]"+n+">",0),f=-1===a;f&&(a=r(s,"[ /]>",0));var h=u+n.length+a+1+(f?0:n.length)+1;if(e&&console.log("end:",h),-1!==h){var c=t.slice(u,h);return{inner:f?null:c.slice(c.indexOf(">")+1,c.lastIndexOf("<")),outer:c,start:u,end:h}}}}},51:function(t,n,i){var r=i(617);t.exports=function(t,n,i){for(var e,o=[],u=i&&i.debug||!1,s=i&&i.startIndex||0;e=r(t,n,{debug:u,startIndex:s});)s=e.end,o.push(e);return u&&console.log("findTagsByName found",o.length,"tags"),o}},802:function(t){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}t.exports=function(t,i,r){var e=r&&r.debug||!1;e&&console.log("getting "+i+" in "+t);var o="object"===n(t)?t.outer:t,u="".concat(i,'\\="([^"]*)"');e&&console.log("pattern:",u);var s=new RegExp(u).exec(o);if(e&&console.log("match:",s),s)return s[1]}},279:function(t){t.exports=function(t,n,i){var r=new RegExp(n).exec(t.slice(i));return r?i+r.index:-1}},518:function(t){"use strict";t.exports=function(t){t.prototype[Symbol.iterator]=regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=this.head;case 1:if(!n){t.next=7;break}return t.next=4,n.value;case 4:n=n.next,t.next=1;break;case 7:case"end":return t.stop()}}),t,this)}))}},692:function(t,n,i){"use strict";function r(t){var n=this;if(n instanceof r||(n=new r),n.tail=null,n.head=null,n.length=0,t&&"function"==typeof t.forEach)t.forEach((function(t){n.push(t)}));else if(arguments.length>0)for(var i=0,e=arguments.length;i<e;i++)n.push(arguments[i]);return n}function e(t,n,i){var r=n===t.head?new s(i,null,n,t):new s(i,n,n.next,t);return null===r.next&&(t.tail=r),null===r.prev&&(t.head=r),t.length++,r}function o(t,n){t.tail=new s(n,t.tail,null,t),t.head||(t.head=t.tail),t.length++}function u(t,n){t.head=new s(n,null,t.head,t),t.tail||(t.tail=t.head),t.length++}function s(t,n,i,r){if(!(this instanceof s))return new s(t,n,i,r);this.list=r,this.value=t,n?(n.next=this,this.prev=n):this.prev=null,i?(i.prev=this,this.next=i):this.next=null}t.exports=r,r.Node=s,r.create=r,r.prototype.removeNode=function(t){if(t.list!==this)throw new Error("removing node which does not belong to this list");var n=t.next,i=t.prev;return n&&(n.prev=i),i&&(i.next=n),t===this.head&&(this.head=n),t===this.tail&&(this.tail=i),t.list.length--,t.next=null,t.prev=null,t.list=null,n},r.prototype.unshiftNode=function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var n=this.head;t.list=this,t.next=n,n&&(n.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}},r.prototype.pushNode=function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var n=this.tail;t.list=this,t.prev=n,n&&(n.next=t),this.tail=t,this.head||(this.head=t),this.length++}},r.prototype.push=function(){for(var t=0,n=arguments.length;t<n;t++)o(this,arguments[t]);return this.length},r.prototype.unshift=function(){for(var t=0,n=arguments.length;t<n;t++)u(this,arguments[t]);return this.length},r.prototype.pop=function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}},r.prototype.shift=function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}},r.prototype.forEach=function(t,n){n=n||this;for(var i=this.head,r=0;null!==i;r++)t.call(n,i.value,r,this),i=i.next},r.prototype.forEachReverse=function(t,n){n=n||this;for(var i=this.tail,r=this.length-1;null!==i;r--)t.call(n,i.value,r,this),i=i.prev},r.prototype.get=function(t){for(var n=0,i=this.head;null!==i&&n<t;n++)i=i.next;if(n===t&&null!==i)return i.value},r.prototype.getReverse=function(t){for(var n=0,i=this.tail;null!==i&&n<t;n++)i=i.prev;if(n===t&&null!==i)return i.value},r.prototype.map=function(t,n){n=n||this;for(var i=new r,e=this.head;null!==e;)i.push(t.call(n,e.value,this)),e=e.next;return i},r.prototype.mapReverse=function(t,n){n=n||this;for(var i=new r,e=this.tail;null!==e;)i.push(t.call(n,e.value,this)),e=e.prev;return i},r.prototype.reduce=function(t,n){var i,r=this.head;if(arguments.length>1)i=n;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,i=this.head.value}for(var e=0;null!==r;e++)i=t(i,r.value,e),r=r.next;return i},r.prototype.reduceReverse=function(t,n){var i,r=this.tail;if(arguments.length>1)i=n;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,i=this.tail.value}for(var e=this.length-1;null!==r;e--)i=t(i,r.value,e),r=r.prev;return i},r.prototype.toArray=function(){for(var t=new Array(this.length),n=0,i=this.head;null!==i;n++)t[n]=i.value,i=i.next;return t},r.prototype.toArrayReverse=function(){for(var t=new Array(this.length),n=0,i=this.tail;null!==i;n++)t[n]=i.value,i=i.prev;return t},r.prototype.slice=function(t,n){(n=n||this.length)<0&&(n+=this.length),(t=t||0)<0&&(t+=this.length);var i=new r;if(n<t||n<0)return i;t<0&&(t=0),n>this.length&&(n=this.length);for(var e=0,o=this.head;null!==o&&e<t;e++)o=o.next;for(;null!==o&&e<n;e++,o=o.next)i.push(o.value);return i},r.prototype.sliceReverse=function(t,n){(n=n||this.length)<0&&(n+=this.length),(t=t||0)<0&&(t+=this.length);var i=new r;if(n<t||n<0)return i;t<0&&(t=0),n>this.length&&(n=this.length);for(var e=this.length,o=this.tail;null!==o&&e>n;e--)o=o.prev;for(;null!==o&&e>t;e--,o=o.prev)i.push(o.value);return i},r.prototype.splice=function(t,n){t>this.length&&(t=this.length-1),t<0&&(t=this.length+t);for(var i=0,r=this.head;null!==r&&i<t;i++)r=r.next;var o=[];for(i=0;r&&i<n;i++)o.push(r.value),r=this.removeNode(r);null===r&&(r=this.tail),r!==this.head&&r!==this.tail&&(r=r.prev);for(i=0;i<(arguments.length<=2?0:arguments.length-2);i++)r=e(this,r,i+2<2||arguments.length<=i+2?void 0:arguments[i+2]);return o},r.prototype.reverse=function(){for(var t=this.head,n=this.tail,i=t;null!==i;i=i.prev){var r=i.prev;i.prev=i.next,i.next=r}return this.head=n,this.tail=t,this};try{i(518)(r)}catch(t){}},752:function(){},640:function(){},630:function(){},198:function(t,n,i){"use strict";function r(t,n,i){for(var r,o,u=i||e,s=0,a=t.length,f=!1;s<a;)(o=+u(t[r=s+(a-s>>1)],n))<0?s=r+1:(a=r,f=!o);return f?s:~s}function e(t,n){return t>n?1:t<n?-1:0}function o(t,n){return t.indexOf(n)>=0}function u(t,n,i){var r=t.length;if(t[0]<=n)return 0;if(n<=t[r-1])return r-1;var e=void 0;if(i>0){for(e=1;e<r;++e)if(t[e]<n)return e-1}else if(i<0){for(e=1;e<r;++e)if(t[e]<=n)return e}else for(e=1;e<r;++e){if(t[e]==n)return e;if(t[e]<n)return"function"==typeof i?i(n,t[e-1],t[e])>0?e-1:e:t[e-1]-n<n-t[e]?e-1:e}return r-1}function s(t,n,i){for(;n<i;){var r=t[n];t[n]=t[i],t[i]=r,++n,--i}}function a(t,n){for(var i=Array.isArray(n)?n:[n],r=i.length,e=0;e<r;e++)t[t.length]=i[e]}function f(t,n){for(var i,r=t.length>>>0,e=0;e<r;e++)if(n(i=t[e],e,t))return i;return null}function h(t,n){var i=t.length;if(i!==n.length)return!1;for(var r=0;r<i;r++)if(t[r]!==n[r])return!1;return!0}function c(t,n){var i;return!t.every((function(r,e){return i=e,!n(r,e,t)}))?i:-1}function l(t,n,i){var r=n||e;return t.every((function(n,e){if(0===e)return!0;var o=r(t[e-1],n);return!(o>0||i&&0===o)}))}function v(){return function(){throw new Error("Unimplemented abstract method.")}()}i.d(n,{default:function(){return pF}});var p=0;function d(t){return t.ol_uid||(t.ol_uid=String(++p))}var y,m="6.14.2-dev",w=(y=function(t,n){return(y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}y(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),b=function(t){function n(n){var i=this,r="Assertion failed. See https://openlayers.org/en/"+("v"+m.split("-")[0])+"/doc/errors/#"+n+" for details.";return(i=t.call(this,r)||this).code=n,i.name="AssertionError",i.message=r,i}return w(n,t),n}(Error);function g(t,n){if(!t)throw new b(n)}function x(t,n,i){return Math.min(Math.max(t,n),i)}var _="cosh"in Math?Math.cosh:function(t){var n=Math.exp(t);return(n+1/n)/2},M="log2"in Math?Math.log2:function(t){return Math.log(t)*Math.LOG2E};function O(t,n,i,r,e,o){var u=e-i,s=o-r;if(0!==u||0!==s){var a=((t-i)*u+(n-r)*s)/(u*u+s*s);a>1?(i=e,r=o):a>0&&(i+=u*a,r+=s*a)}return S(t,n,i,r)}function S(t,n,i,r){var e=i-t,o=r-n;return e*e+o*o}function j(t){for(var n=t.length,i=0;i<n;i++){for(var r=i,e=Math.abs(t[i][i]),o=i+1;o<n;o++){var u=Math.abs(t[o][i]);u>e&&(e=u,r=o)}if(0===e)return null;var s=t[r];t[r]=t[i],t[i]=s;for(var a=i+1;a<n;a++)for(var f=-t[a][i]/t[i][i],h=i;h<n+1;h++)i==h?t[a][h]=0:t[a][h]+=f*t[i][h]}for(var c=new Array(n),l=n-1;l>=0;l--){c[l]=t[l][n]/t[l][l];for(var v=l-1;v>=0;v--)t[v][n]-=t[v][l]*c[l]}return c}function E(t){return 180*t/Math.PI}function k(t){return t*Math.PI/180}function T(t,n){var i=t%n;return i*n<0?i+n:i}function A(t,n,i){return t+i*(n-t)}function C(t,n){var i=Math.pow(10,n);return Math.round(t*i)/i}function P(t,n){return Math.round(C(t,n))}function R(t,n){return Math.floor(C(t,n))}function I(t,n){return Math.ceil(C(t,n))}function N(t,n,i){return function(r,e,o,u,s){if(r){if(!e&&!n)return r;var a=n?0:o[0]*e,f=n?0:o[1]*e,h=s?s[0]:0,c=s?s[1]:0,l=t[0]+a/2+h,v=t[2]-a/2+h,p=t[1]+f/2+c,d=t[3]-f/2+c;l>v&&(v=l=(v+l)/2),p>d&&(d=p=(d+p)/2);var y=x(r[0],l,v),m=x(r[1],p,d);if(u&&i&&e){var w=30*e;y+=-w*Math.log(1+Math.max(0,l-r[0])/w)+w*Math.log(1+Math.max(0,r[0]-v)/w),m+=-w*Math.log(1+Math.max(0,p-r[1])/w)+w*Math.log(1+Math.max(0,r[1]-d)/w)}return[y,m]}}}function z(t){return t}function F(t){t.stopPropagation()}var L=function(){function t(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}return t.prototype.preventDefault=function(){this.defaultPrevented=!0},t.prototype.stopPropagation=function(){this.propagationStopped=!0},t}(),G="propertychange",D=function(){function t(){this.disposed=!1}return t.prototype.dispose=function(){this.disposed||(this.disposed=!0,this.disposeInternal())},t.prototype.disposeInternal=function(){},t}();function U(){return!0}function q(){return!1}function B(){}function X(t){var n,i,r,e=!1;return function(){var o=Array.prototype.slice.call(arguments);return e&&this===r&&h(o,i)||(e=!0,r=this,i=o,n=t.apply(this,arguments)),n}}function V(t){return function(){var n;try{n=t()}catch(t){return Promise.reject(t)}return n instanceof Promise?n:Promise.resolve(n)}()}var W="function"==typeof Object.assign?Object.assign:function(t,n){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(t),r=1,e=arguments.length;r<e;++r){var o=arguments[r];if(null!=o)for(var u in o)o.hasOwnProperty(u)&&(i[u]=o[u])}return i};function Y(t){for(var n in t)delete t[n]}var Z="function"==typeof Object.values?Object.values:function(t){var n=[];for(var i in t)n.push(t[i]);return n};function H(t){var n;for(n in t)return!1;return!n}var K=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),J=function(t){function n(n){var i=t.call(this)||this;return i.t=n,i._=null,i.O=null,i.S=null,i}return K(n,t),n.prototype.addEventListener=function(t,n){if(t&&n){var i=this.S||(this.S={}),r=i[t]||(i[t]=[]);-1===r.indexOf(n)&&r.push(n)}},n.prototype.dispatchEvent=function(t){var n="string"==typeof t,i=n?t:t.type,r=this.S&&this.S[i];if(r){var e=n?new L(t):t;e.target||(e.target=this.t||this);var o,u=this.O||(this.O={}),s=this._||(this._={});i in u||(u[i]=0,s[i]=0),++u[i];for(var a=0,f=r.length;a<f;++a)if(!1===(o="handleEvent"in r[a]?r[a].handleEvent(e):r[a].call(this,e))||e.propagationStopped){o=!1;break}if(0==--u[i]){var h=s[i];for(delete s[i];h--;)this.removeEventListener(i,B);delete u[i]}return o}},n.prototype.disposeInternal=function(){this.S&&Y(this.S)},n.prototype.getListeners=function(t){return this.S&&this.S[t]||void 0},n.prototype.hasListener=function(t){return!!this.S&&(t?t in this.S:Object.keys(this.S).length>0)},n.prototype.removeEventListener=function(t,n){var i=this.S&&this.S[t];if(i){var r=i.indexOf(n);-1!==r&&(this._&&t in this._?(i[r]=B,++this._[t]):(i.splice(r,1),0===i.length&&delete this.S[t]))}},n}(D),$="change",Q="error",tt="contextmenu",nt="click",it="dblclick",rt="dragenter",et="dragover",ot="drop",ut="keydown",st="keypress",at="load",ft="resize",ht="touchmove",ct="wheel";function lt(t,n,i,r,e){if(r&&r!==t&&(i=i.bind(r)),e){var o=i;i=function(){t.removeEventListener(n,i),o.apply(this,arguments)}}var u={target:t,type:n,listener:i};return t.addEventListener(n,i),u}function vt(t,n,i,r){return lt(t,n,i,r,!0)}function pt(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),Y(t))}var dt=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),yt=function(t){function n(){var n=t.call(this)||this;return n.on=n.onInternal,n.once=n.onceInternal,n.un=n.unInternal,n.T=0,n}return dt(n,t),n.prototype.changed=function(){++this.T,this.dispatchEvent($)},n.prototype.getRevision=function(){return this.T},n.prototype.onInternal=function(t,n){if(Array.isArray(t)){for(var i=t.length,r=new Array(i),e=0;e<i;++e)r[e]=lt(this,t[e],n);return r}return lt(this,t,n)},n.prototype.onceInternal=function(t,n){var i;if(Array.isArray(t)){var r=t.length;i=new Array(r);for(var e=0;e<r;++e)i[e]=vt(this,t[e],n)}else i=vt(this,t,n);return n.ol_key=i,i},n.prototype.unInternal=function(t,n){var i=n.ol_key;if(i)mt(i);else if(Array.isArray(t))for(var r=0,e=t.length;r<e;++r)this.removeEventListener(t[r],n);else this.removeEventListener(t,n)},n}(J);function mt(t){if(Array.isArray(t))for(var n=0,i=t.length;n<i;++n)pt(t[n]);else pt(t)}yt.prototype.on,yt.prototype.once,yt.prototype.un;var wt=yt,bt=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),gt=function(t){function n(n,i,r){var e=t.call(this,n)||this;return e.key=i,e.oldValue=r,e}return bt(n,t),n}(L),xt=function(t){function n(n){var i=t.call(this)||this;return i.on,i.once,i.un,d(i),i.A=null,void 0!==n&&i.setProperties(n),i}return bt(n,t),n.prototype.get=function(t){var n;return this.A&&this.A.hasOwnProperty(t)&&(n=this.A[t]),n},n.prototype.getKeys=function(){return this.A&&Object.keys(this.A)||[]},n.prototype.getProperties=function(){return this.A&&W({},this.A)||{}},n.prototype.hasProperties=function(){return!!this.A},n.prototype.notify=function(t,n){var i;i="change:".concat(t),this.hasListener(i)&&this.dispatchEvent(new gt(i,t,n)),i=G,this.hasListener(i)&&this.dispatchEvent(new gt(i,t,n))},n.prototype.addChangeListener=function(t,n){this.addEventListener("change:".concat(t),n)},n.prototype.removeChangeListener=function(t,n){this.removeEventListener("change:".concat(t),n)},n.prototype.set=function(t,n,i){var r=this.A||(this.A={});if(i)r[t]=n;else{var e=r[t];r[t]=n,e!==n&&this.notify(t,e)}},n.prototype.setProperties=function(t,n){for(var i in t)this.set(i,t[i],n)},n.prototype.applyProperties=function(t){t.A&&W(this.A||(this.A={}),t.A)},n.prototype.unset=function(t,n){if(this.A&&t in this.A){var i=this.A[t];delete this.A[t],H(this.A)&&(this.A=null),n||this.notify(t,i)}},n}(wt),_t="add",Mt="remove",Ot=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),St="length",jt=function(t){function n(n,i,r){var e=t.call(this,n)||this;return e.element=i,e.index=r,e}return Ot(n,t),n}(L),Et=function(t){function n(n,i){var r=t.call(this)||this;r.on,r.once,r.un;var e=i||{};if(r.C=!!e.unique,r.P=n||[],r.C)for(var o=0,u=r.P.length;o<u;++o)r.R(r.P[o],o);return r.G(),r}return Ot(n,t),n.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},n.prototype.extend=function(t){for(var n=0,i=t.length;n<i;++n)this.push(t[n]);return this},n.prototype.forEach=function(t){for(var n=this.P,i=0,r=n.length;i<r;++i)t(n[i],i,n)},n.prototype.getArray=function(){return this.P},n.prototype.item=function(t){return this.P[t]},n.prototype.getLength=function(){return this.get(St)},n.prototype.insertAt=function(t,n){this.C&&this.R(n),this.P.splice(t,0,n),this.G(),this.dispatchEvent(new jt(_t,n,t))},n.prototype.pop=function(){return this.removeAt(this.getLength()-1)},n.prototype.push=function(t){this.C&&this.R(t);var n=this.getLength();return this.insertAt(n,t),this.getLength()},n.prototype.remove=function(t){for(var n=this.P,i=0,r=n.length;i<r;++i)if(n[i]===t)return this.removeAt(i)},n.prototype.removeAt=function(t){var n=this.P[t];return this.P.splice(t,1),this.G(),this.dispatchEvent(new jt(Mt,n,t)),n},n.prototype.setAt=function(t,n){var i=this.getLength();if(t<i){this.C&&this.R(n,t);var r=this.P[t];this.P[t]=n,this.dispatchEvent(new jt(Mt,r,t)),this.dispatchEvent(new jt(_t,n,t))}else{for(var e=i;e<t;++e)this.insertAt(e,void 0);this.insertAt(t,n)}},n.prototype.G=function(){this.set(St,this.P.length)},n.prototype.R=function(t,n){for(var i=0,r=this.P.length;i<r;++i)if(this.P[i]===t&&i!==n)throw new b(58)},n}(xt),kt=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,Tt=/^([a-z]*)$|^hsla?\(.*\)$/i;function At(t){return"string"==typeof t?t:Nt(t)}function Ct(t){var n=document.createElement("div");if(n.style.color=t,""!==n.style.color){document.body.appendChild(n);var i=getComputedStyle(n).color;return document.body.removeChild(n),i}return""}var Pt=function(){var t={},n=0;return function(i){var r;if(t.hasOwnProperty(i))r=t[i];else{if(n>=1024){var e=0;for(var o in t)0==(3&e++)&&(delete t[o],--n)}r=function(t){var n,i,r,e,o;Tt.exec(t)&&(t=Ct(t));if(kt.exec(t)){var u=t.length-1,s=void 0;s=u<=4?1:2;var a=4===u||8===u;n=parseInt(t.substr(1+0*s,s),16),i=parseInt(t.substr(1+1*s,s),16),r=parseInt(t.substr(1+2*s,s),16),e=a?parseInt(t.substr(1+3*s,s),16):255,1==s&&(n=(n<<4)+n,i=(i<<4)+i,r=(r<<4)+r,a&&(e=(e<<4)+e)),o=[n,i,r,e/255]}else 0==t.indexOf("rgba(")?It(o=t.slice(5,-1).split(",").map(Number)):0==t.indexOf("rgb(")?((o=t.slice(4,-1).split(",").map(Number)).push(1),It(o)):g(!1,14);return o}(i),t[i]=r,++n}return r}}();function Rt(t){return Array.isArray(t)?t:Pt(t)}function It(t){return t[0]=x(t[0]+.5|0,0,255),t[1]=x(t[1]+.5|0,0,255),t[2]=x(t[2]+.5|0,0,255),t[3]=x(t[3],0,1),t}function Nt(t){var n=t[0];n!=(0|n)&&(n=n+.5|0);var i=t[1];i!=(0|i)&&(i=i+.5|0);var r=t[2];return r!=(0|r)&&(r=r+.5|0),"rgba("+n+","+i+","+r+","+(void 0===t[3]?1:Math.round(100*t[3])/100)+")"}function zt(t){return Tt.test(t)&&(t=Ct(t)),kt.test(t)||0===t.indexOf("rgba(")||0===t.indexOf("rgb(")}function Ft(t){return Array.isArray(t)?Nt(t):t}var Lt="postrender",Gt="movestart",Dt="moveend",Ut="loadstart",qt="loadend",Bt="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"",Xt=-1!==Bt.indexOf("firefox"),Vt=-1!==Bt.indexOf("safari")&&-1==Bt.indexOf("chrom"),Wt=Vt&&!!(Bt.indexOf("version/15.4")>=0||Bt.match(/cpu (os|iphone os) 15_4 like mac os x/)),Yt=-1!==Bt.indexOf("webkit")&&-1==Bt.indexOf("edge"),Zt=-1!==Bt.indexOf("macintosh"),Ht="undefined"!=typeof devicePixelRatio?devicePixelRatio:1,Kt="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope,Jt="undefined"!=typeof Image&&Image.prototype.decode,$t=function(){var t=!1;try{var n=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,n),window.removeEventListener("_",null,n)}catch(t){}return t}();function Qt(t,n,i,r){var e;return e=i&&i.length?i.shift():Kt?new OffscreenCanvas(t||300,n||300):document.createElement("canvas"),t&&(e.width=t),n&&(e.height=n),e.getContext("2d",r)}function tn(t){var n=t.offsetWidth,i=getComputedStyle(t);return n+=parseInt(i.marginLeft,10)+parseInt(i.marginRight,10)}function nn(t){var n=t.offsetHeight,i=getComputedStyle(t);return n+=parseInt(i.marginTop,10)+parseInt(i.marginBottom,10)}function rn(t,n){var i=n.parentNode;i&&i.replaceChild(t,n)}function en(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}function on(t){for(;t.lastChild;)t.removeChild(t.lastChild)}function un(t,n){for(var i=t.childNodes,r=0;;++r){var e=i[r],o=n[r];if(!e&&!o)break;e!==o&&(e?o?t.insertBefore(o,e):(t.removeChild(e),--r):t.appendChild(o))}}var sn=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),an=function(t){function n(n){var i=t.call(this)||this,r=n.element;return!r||n.target||r.style.pointerEvents||(r.style.pointerEvents="auto"),i.element=r||null,i.D=null,i.U=null,i.listenerKeys=[],n.render&&(i.render=n.render),n.target&&i.setTarget(n.target),i}return sn(n,t),n.prototype.disposeInternal=function(){en(this.element),t.prototype.disposeInternal.call(this)},n.prototype.getMap=function(){return this.U},n.prototype.setMap=function(t){this.U&&en(this.element);for(var n=0,i=this.listenerKeys.length;n<i;++n)pt(this.listenerKeys[n]);(this.listenerKeys.length=0,this.U=t,t)&&((this.D?this.D:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==B&&this.listenerKeys.push(lt(t,Lt,this.render,this)),t.render())},n.prototype.render=function(t){},n.prototype.setTarget=function(t){this.D="string"==typeof t?document.getElementById(t):t},n}(xt),fn="ol-hidden",hn="ol-selectable",cn="ol-unselectable",ln="ol-unsupported",vn="ol-control",pn="ol-collapsed",dn=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$"].join(""),"i"),yn=["style","variant","weight","size","lineHeight","family"],mn=function(t){var n=t.match(dn);if(!n)return null;for(var i={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"},r=0,e=yn.length;r<e;++r){var o=n[r+1];void 0!==o&&(i[yn[r]]=o)}return i.families=i.family.split(/,\s?/),i};function wn(t){return 1===t?"":String(Math.round(100*t)/100)}var bn="opacity",gn="visible",xn="extent",_n="zIndex",Mn="maxResolution",On="minResolution",Sn="maxZoom",jn="minZoom",En="source",kn="map";function Tn(t){return(Tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var An=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Cn=function(t){function n(n){var i=t.call(this)||this;i.on,i.once,i.un,i.q=n.background;var r=W({},n);return"object"===Tn(n.properties)&&(delete r.properties,W(r,n.properties)),r[bn]=void 0!==n.opacity?n.opacity:1,g("number"==typeof r[bn],64),r[gn]=void 0===n.visible||n.visible,r[_n]=n.zIndex,r[Mn]=void 0!==n.maxResolution?n.maxResolution:1/0,r[On]=void 0!==n.minResolution?n.minResolution:0,r[jn]=void 0!==n.minZoom?n.minZoom:-1/0,r[Sn]=void 0!==n.maxZoom?n.maxZoom:1/0,i.B=void 0!==r.className?r.className:"ol-layer",delete r.className,i.setProperties(r),i.V=null,i}return An(n,t),n.prototype.getBackground=function(){return this.q},n.prototype.getClassName=function(){return this.B},n.prototype.getLayerState=function(t){var n=this.V||{layer:this,managed:void 0===t||t},i=this.getZIndex();return n.opacity=x(Math.round(100*this.getOpacity())/100,0,1),n.visible=this.getVisible(),n.extent=this.getExtent(),n.zIndex=void 0!==i||n.managed?i:1/0,n.maxResolution=this.getMaxResolution(),n.minResolution=Math.max(this.getMinResolution(),0),n.minZoom=this.getMinZoom(),n.maxZoom=this.getMaxZoom(),this.V=n,n},n.prototype.getLayersArray=function(t){return v()},n.prototype.getLayerStatesArray=function(t){return v()},n.prototype.getExtent=function(){return this.get(xn)},n.prototype.getMaxResolution=function(){return this.get(Mn)},n.prototype.getMinResolution=function(){return this.get(On)},n.prototype.getMinZoom=function(){return this.get(jn)},n.prototype.getMaxZoom=function(){return this.get(Sn)},n.prototype.getOpacity=function(){return this.get(bn)},n.prototype.getSourceState=function(){return v()},n.prototype.getVisible=function(){return this.get(gn)},n.prototype.getZIndex=function(){return this.get(_n)},n.prototype.setBackground=function(t){this.q=t,this.changed()},n.prototype.setExtent=function(t){this.set(xn,t)},n.prototype.setMaxResolution=function(t){this.set(Mn,t)},n.prototype.setMinResolution=function(t){this.set(On,t)},n.prototype.setMaxZoom=function(t){this.set(Sn,t)},n.prototype.setMinZoom=function(t){this.set(jn,t)},n.prototype.setOpacity=function(t){g("number"==typeof t,64),this.set(bn,t)},n.prototype.setVisible=function(t){this.set(gn,t)},n.prototype.setZIndex=function(t){this.set(_n,t)},n.prototype.disposeInternal=function(){this.V&&(this.V.layer=null,this.V=null),t.prototype.disposeInternal.call(this)},n}(xt),Pn="prerender",Rn="postrender",In="precompose",Nn="postcompose",zn="rendercomplete",Fn="undefined",Ln="loading",Gn="ready",Dn="error",Un=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();function qn(t,n){if(!t.visible)return!1;var i=n.resolution;if(i<t.minResolution||i>=t.maxResolution)return!1;var r=n.zoom;return r>t.minZoom&&r<=t.maxZoom}var Bn=function(t){function n(n){var i=this,r=W({},n);delete r.source,(i=t.call(this,r)||this).on,i.once,i.un,i.W=null,i.H=null,i.K=null,i.$=null,i.rendered=!1,n.render&&(i.render=n.render),n.map&&i.setMap(n.map),i.addChangeListener(En,i.tt);var e=n.source?n.source:null;return i.setSource(e),i}return Un(n,t),n.prototype.getLayersArray=function(t){var n=t||[];return n.push(this),n},n.prototype.getLayerStatesArray=function(t){var n=t||[];return n.push(this.getLayerState()),n},n.prototype.getSource=function(){return this.get(En)||null},n.prototype.getRenderSource=function(){return this.getSource()},n.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():Fn},n.prototype.nt=function(){this.changed()},n.prototype.tt=function(){this.K&&(pt(this.K),this.K=null);var t=this.getSource();t&&(this.K=lt(t,$,this.nt,this)),this.changed()},n.prototype.getFeatures=function(t){return this.$?this.$.getFeatures(t):new Promise((function(t){return t([])}))},n.prototype.getData=function(t){return this.$&&this.rendered?this.$.getData(t):null},n.prototype.render=function(t,n){var i=this.getRenderer();if(i.prepareFrame(t))return this.rendered=!0,i.renderFrame(t,n)},n.prototype.unrender=function(){this.rendered=!1},n.prototype.setMapInternal=function(t){t||this.unrender(),this.set(kn,t)},n.prototype.getMapInternal=function(){return this.get(kn)},n.prototype.setMap=function(t){this.W&&(pt(this.W),this.W=null),t||this.changed(),this.H&&(pt(this.H),this.H=null),t&&(this.W=lt(t,In,(function(t){var n=t.frameState.layerStatesArray,i=this.getLayerState(!1);g(!n.some((function(t){return t.layer===i.layer})),67),n.push(i)}),this),this.H=lt(this,$,t.render,t),this.changed())},n.prototype.setSource=function(t){this.set(En,t)},n.prototype.getRenderer=function(){return this.$||(this.$=this.createRenderer()),this.$},n.prototype.hasRenderer=function(){return!!this.$},n.prototype.createRenderer=function(){return null},n.prototype.disposeInternal=function(){this.$&&(this.$.dispose(),delete this.$),this.setSource(null),t.prototype.disposeInternal.call(this)},n}(Cn),Xn=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Vn=function(t){function n(n){var i=this,r=n||{};(i=t.call(this,{element:document.createElement("div"),render:r.render,target:r.target})||this).it=document.createElement("ul"),i.rt=void 0===r.collapsed||r.collapsed,i.et=i.rt,i.ot=void 0!==r.collapsible,i.ut=void 0===r.collapsible||r.collapsible,i.ut||(i.rt=!1);var e=void 0!==r.className?r.className:"ol-attribution",o=void 0!==r.tipLabel?r.tipLabel:"Attributions",u=void 0!==r.expandClassName?r.expandClassName:e+"-expand",s=void 0!==r.collapseLabel?r.collapseLabel:"›",a=void 0!==r.collapseClassName?r.collapseClassName:e+"-collapse";"string"==typeof s?(i.st=document.createElement("span"),i.st.textContent=s,i.st.className=a):i.st=s;var f=void 0!==r.label?r.label:"i";"string"==typeof f?(i.ft=document.createElement("span"),i.ft.textContent=f,i.ft.className=u):i.ft=f;var h=i.ut&&!i.rt?i.st:i.ft;i.ht=document.createElement("button"),i.ht.setAttribute("type","button"),i.ht.setAttribute("aria-expanded",String(!i.rt)),i.ht.title=o,i.ht.appendChild(h),i.ht.addEventListener(nt,i.ct.bind(i),!1);var c=e+" "+"ol-unselectable "+vn+(i.rt&&i.ut?" ol-collapsed":"")+(i.ut?"":" ol-uncollapsible"),l=i.element;return l.className=c,l.appendChild(i.ht),l.appendChild(i.it),i.lt=[],i.vt=!0,i}return Xn(n,t),n.prototype.dt=function(t){for(var n={},i=[],r=!0,e=t.layerStatesArray,o=0,u=e.length;o<u;++o){var s=e[o];if(qn(s,t.viewState)){var a=s.layer.getSource();if(a){var f=a.getAttributions();if(f){var h=f(t);if(h)if(r=r&&!1!==a.getAttributionsCollapsible(),Array.isArray(h))for(var c=0,l=h.length;c<l;++c)h[c]in n||(i.push(h[c]),n[h[c]]=!0);else h in n||(i.push(h),n[h]=!0)}}}}return this.ot||this.setCollapsible(r),i},n.prototype.yt=function(t){if(t){var n=this.dt(t),i=n.length>0;if(this.vt!=i&&(this.element.style.display=i?"":"none",this.vt=i),!h(n,this.lt)){on(this.it);for(var r=0,e=n.length;r<e;++r){var o=document.createElement("li");o.innerHTML=n[r],this.it.appendChild(o)}this.lt=n}}else this.vt&&(this.element.style.display="none",this.vt=!1)},n.prototype.ct=function(t){t.preventDefault(),this.wt(),this.et=this.rt},n.prototype.wt=function(){this.element.classList.toggle(pn),this.rt?rn(this.st,this.ft):rn(this.ft,this.st),this.rt=!this.rt,this.ht.setAttribute("aria-expanded",String(!this.rt))},n.prototype.getCollapsible=function(){return this.ut},n.prototype.setCollapsible=function(t){this.ut!==t&&(this.ut=t,this.element.classList.toggle("ol-uncollapsible"),this.et&&this.wt())},n.prototype.setCollapsed=function(t){this.et=t,this.ut&&this.rt!==t&&this.wt()},n.prototype.getCollapsed=function(){return this.rt},n.prototype.render=function(t){this.yt(t.frameState)},n}(an),Wn="layergroup",Yn="size",Zn="target",Hn="view",Kn=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Jn=["fullscreenchange","webkitfullscreenchange","MSFullscreenChange"],$n="enterfullscreen",Qn="leavefullscreen";function ti(t){var n=t.body;return!!(n.webkitRequestFullscreen||n.msRequestFullscreen&&t.msFullscreenEnabled||n.requestFullscreen&&t.fullscreenEnabled)}function ni(t){return!!(t.webkitIsFullScreen||t.msFullscreenElement||t.fullscreenElement)}function ii(t){t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen()}var ri=function(t){function n(n){var i=this,r=n||{};(i=t.call(this,{element:document.createElement("div"),target:r.target})||this).on,i.once,i.un,i.bt=void 0!==r.keys&&r.keys,i.gt=r.source,i.xt=!1,i._t=i.Mt.bind(i),i.Ot=void 0!==r.className?r.className:"ol-full-screen",i.St=[],i.jt=void 0!==r.activeClassName?r.activeClassName.split(" "):[i.Ot+"-true"],i.Et=void 0!==r.inactiveClassName?r.inactiveClassName.split(" "):[i.Ot+"-false"];var e=void 0!==r.label?r.label:"⤢";i.kt="string"==typeof e?document.createTextNode(e):e;var o=void 0!==r.labelActive?r.labelActive:"×";i.Tt="string"==typeof o?document.createTextNode(o):o;var u=r.tipLabel?r.tipLabel:"Toggle full-screen";return i.At=document.createElement("button"),i.At.title=u,i.At.setAttribute("type","button"),i.At.appendChild(i.kt),i.At.addEventListener(nt,i.ct.bind(i),!1),i.Ct(i.At,i.xt),i.element.className="".concat(i.Ot," ").concat(cn," ").concat(vn),i.element.appendChild(i.At),i}return Kn(n,t),n.prototype.ct=function(t){t.preventDefault(),this.Pt()},n.prototype.Pt=function(){var t=this.getMap();if(t){var n=t.getOwnerDocument();if(ti(n))if(ni(n))!function(t){t.exitFullscreen?t.exitFullscreen():t.msExitFullscreen?t.msExitFullscreen():t.webkitExitFullscreen&&t.webkitExitFullscreen()}(n);else{var i=void 0;i=this.gt?"string"==typeof this.gt?n.getElementById(this.gt):this.gt:t.getTargetElement(),this.bt?function(t){t.webkitRequestFullscreen?t.webkitRequestFullscreen():ii(t)}(i):ii(i)}}},n.prototype.Rt=function(){var t=this.getMap();if(t){var n=this.xt;this.xt=ni(t.getOwnerDocument()),n!==this.xt&&(this.Ct(this.At,this.xt),this.xt?(rn(this.Tt,this.kt),this.dispatchEvent($n)):(rn(this.kt,this.Tt),this.dispatchEvent(Qn)),t.updateSize())}},n.prototype.Ct=function(t,n){var i,r,e,o;n?((i=t.classList).remove.apply(i,this.Et),(r=t.classList).add.apply(r,this.jt)):((e=t.classList).remove.apply(e,this.jt),(o=t.classList).add.apply(o,this.Et))},n.prototype.setMap=function(n){var i=this.getMap();i&&i.removeChangeListener(Zn,this._t),t.prototype.setMap.call(this,n),this.Mt(),n&&n.addChangeListener(Zn,this._t)},n.prototype.Mt=function(){for(var t=this.St,n=0,i=t.length;n<i;++n)pt(t[n]);t.length=0;var r=this.getMap();if(r){var e=r.getOwnerDocument();ti(e)?this.element.classList.remove(ln):this.element.classList.add(ln);for(n=0,i=Jn.length;n<i;++n)t.push(lt(e,Jn[n],this.Rt,this));this.Rt()}},n}(an),ei="pointermove",oi="pointerdown",ui="pointerup",si="pointerout",ai={RADIANS:"radians",DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},fi={9001:ai.METERS,9002:ai.FEET,9003:ai.USFEET,9101:ai.RADIANS,9102:ai.DEGREES};function hi(t){return fi[t]}var ci={};ci[ai.RADIANS]=6370997/(2*Math.PI),ci[ai.DEGREES]=2*Math.PI*6370997/360,ci[ai.FEET]=.3048,ci[ai.METERS]=1,ci[ai.USFEET]=1200/3937;var li=ai,vi=function(){function t(t){this.Nt=t.code,this.zt=t.units,this.Ft=void 0!==t.extent?t.extent:null,this.Lt=void 0!==t.worldExtent?t.worldExtent:null,this.Gt=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.Dt=void 0!==t.global&&t.global,this.Ut=!(!this.Dt||!this.Ft),this.qt=t.getPointResolution,this.Bt=null,this.Xt=t.metersPerUnit}return t.prototype.canWrapX=function(){return this.Ut},t.prototype.getCode=function(){return this.Nt},t.prototype.getExtent=function(){return this.Ft},t.prototype.getUnits=function(){return this.zt},t.prototype.getMetersPerUnit=function(){return this.Xt||ci[this.zt]},t.prototype.getWorldExtent=function(){return this.Lt},t.prototype.getAxisOrientation=function(){return this.Gt},t.prototype.isGlobal=function(){return this.Dt},t.prototype.setGlobal=function(t){this.Dt=t,this.Ut=!(!t||!this.Ft)},t.prototype.getDefaultTileGrid=function(){return this.Bt},t.prototype.setDefaultTileGrid=function(t){this.Bt=t},t.prototype.setExtent=function(t){this.Ft=t,this.Ut=!(!this.Dt||!t)},t.prototype.setWorldExtent=function(t){this.Lt=t},t.prototype.setGetPointResolution=function(t){this.qt=t},t.prototype.getPointResolutionFunc=function(){return this.qt},t}(),pi=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),di=6378137,yi=Math.PI*di,mi=[-yi,-yi,yi,yi],wi=[-180,-85,180,85],bi=di*Math.log(Math.tan(Math.PI/2)),gi=function(t){function n(n){return t.call(this,{code:n,units:li.METERS,extent:mi,global:!0,worldExtent:wi,getPointResolution:function(t,n){return t/_(n[1]/di)}})||this}return pi(n,t),n}(vi),xi=[new gi("EPSG:3857"),new gi("EPSG:102100"),new gi("EPSG:102113"),new gi("EPSG:900913"),new gi("http://www.opengis.net/def/crs/EPSG/0/3857"),new gi("http://www.opengis.net/gml/srs/epsg.xml#3857")];function _i(t,n,i){var r=t.length,e=i>1?i:2,o=n;void 0===o&&(o=e>2?t.slice():new Array(r));for(var u=0;u<r;u+=e){o[u]=yi*t[u]/180;var s=di*Math.log(Math.tan(Math.PI*(+t[u+1]+90)/360));s>bi?s=bi:s<-bi&&(s=-bi),o[u+1]=s}return o}function Mi(t,n,i){var r=t.length,e=i>1?i:2,o=n;void 0===o&&(o=e>2?t.slice():new Array(r));for(var u=0;u<r;u+=e)o[u]=180*t[u]/yi,o[u+1]=360*Math.atan(Math.exp(t[u+1]/di))/Math.PI-90;return o}var Oi=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Si=6378137,ji=[-180,-90,180,90],Ei=Math.PI*Si/180,ki=function(t){function n(n,i){return t.call(this,{code:n,units:li.DEGREES,extent:ji,axisOrientation:i,global:!0,metersPerUnit:Ei,worldExtent:ji})||this}return Oi(n,t),n}(vi),Ti=[new ki("CRS:84"),new ki("EPSG:4326","neu"),new ki("urn:ogc:def:crs:OGC:1.3:CRS84"),new ki("urn:ogc:def:crs:OGC:2:84"),new ki("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new ki("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new ki("http://www.opengis.net/def/crs/EPSG/0/4326","neu")],Ai={};function Ci(){Ai={}}function Pi(t){return Ai[t]||Ai[t.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function Ri(t,n){Ai[t]=n}var Ii={};function Ni(){Ii={}}function zi(t,n,i){var r=t.getCode(),e=n.getCode();r in Ii||(Ii[r]={}),Ii[r][e]=i}function Fi(t,n){var i;return t in Ii&&n in Ii[t]&&(i=Ii[t][n]),i}var Li="bottom-left",Gi="bottom-right",Di="top-left",Ui="top-right",qi=0,Bi=1,Xi=2,Vi=4,Wi=8,Yi=16;function Zi(t){for(var n=ir(),i=0,r=t.length;i<r;++i)hr(n,t[i]);return n}function Hi(t,n,i){return i?(i[0]=t[0]-n,i[1]=t[1]-n,i[2]=t[2]+n,i[3]=t[3]+n,i):[t[0]-n,t[1]-n,t[2]+n,t[3]+n]}function Ki(t,n){return n?(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n):t.slice()}function Ji(t,n,i){var r,e;return(r=n<t[0]?t[0]-n:t[2]<n?n-t[2]:0)*r+(e=i<t[1]?t[1]-i:t[3]<i?i-t[3]:0)*e}function $i(t,n){return tr(t,n[0],n[1])}function Qi(t,n){return t[0]<=n[0]&&n[2]<=t[2]&&t[1]<=n[1]&&n[3]<=t[3]}function tr(t,n,i){return t[0]<=n&&n<=t[2]&&t[1]<=i&&i<=t[3]}function nr(t,n){var i=t[0],r=t[1],e=t[2],o=t[3],u=n[0],s=n[1],a=qi;return u<i?a|=Yi:u>e&&(a|=Vi),s<r?a|=Wi:s>o&&(a|=Xi),a===qi&&(a=Bi),a}function ir(){return[1/0,1/0,-1/0,-1/0]}function rr(t,n,i,r,e){return e?(e[0]=t,e[1]=n,e[2]=i,e[3]=r,e):[t,n,i,r]}function er(t){return rr(1/0,1/0,-1/0,-1/0,t)}function or(t,n){var i=t[0],r=t[1];return rr(i,r,i,r,n)}function ur(t,n,i,r,e){return lr(er(e),t,n,i,r)}function sr(t,n){return t[0]==n[0]&&t[2]==n[2]&&t[1]==n[1]&&t[3]==n[3]}function ar(t,n,i){return Math.abs(t[0]-n[0])<i&&Math.abs(t[2]-n[2])<i&&Math.abs(t[1]-n[1])<i&&Math.abs(t[3]-n[3])<i}function fr(t,n){return n[0]<t[0]&&(t[0]=n[0]),n[2]>t[2]&&(t[2]=n[2]),n[1]<t[1]&&(t[1]=n[1]),n[3]>t[3]&&(t[3]=n[3]),t}function hr(t,n){n[0]<t[0]&&(t[0]=n[0]),n[0]>t[2]&&(t[2]=n[0]),n[1]<t[1]&&(t[1]=n[1]),n[1]>t[3]&&(t[3]=n[1])}function cr(t,n){for(var i=0,r=n.length;i<r;++i)hr(t,n[i]);return t}function lr(t,n,i,r,e){for(;i<r;i+=e)pr(t,n[i],n[i+1]);return t}function vr(t,n){for(var i=0,r=n.length;i<r;++i)cr(t,n[i]);return t}function pr(t,n,i){t[0]=Math.min(t[0],n),t[1]=Math.min(t[1],i),t[2]=Math.max(t[2],n),t[3]=Math.max(t[3],i)}function dr(t,n){var i;return(i=n(mr(t)))||(i=n(wr(t)))||(i=n(Sr(t)))?i:(i=n(Or(t)))||!1}function yr(t){var n=0;return kr(t)||(n=jr(t)*_r(t)),n}function mr(t){return[t[0],t[1]]}function wr(t){return[t[2],t[1]]}function br(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function gr(t,n){var i;return n===Li?i=mr(t):n===Gi?i=wr(t):n===Di?i=Or(t):n===Ui?i=Sr(t):g(!1,13),i}function xr(t,n,i,r,e){var o=n*r[0]/2,u=n*r[1]/2,s=Math.cos(i),a=Math.sin(i),f=o*s,h=o*a,c=u*s,l=u*a,v=t[0],p=t[1],d=v-f+l,y=v-f-l,m=v+f-l,w=v+f+l,b=p-h-c,g=p-h+c,x=p+h+c,_=p+h-c;return rr(Math.min(d,y,m,w),Math.min(b,g,x,_),Math.max(d,y,m,w),Math.max(b,g,x,_),e)}function _r(t){return t[3]-t[1]}function Mr(t,n,i){var r=i||[1/0,1/0,-1/0,-1/0];return Er(t,n)?(t[0]>n[0]?r[0]=t[0]:r[0]=n[0],t[1]>n[1]?r[1]=t[1]:r[1]=n[1],t[2]<n[2]?r[2]=t[2]:r[2]=n[2],t[3]<n[3]?r[3]=t[3]:r[3]=n[3]):er(r),r}function Or(t){return[t[0],t[3]]}function Sr(t){return[t[2],t[3]]}function jr(t){return t[2]-t[0]}function Er(t,n){return t[0]<=n[2]&&t[2]>=n[0]&&t[1]<=n[3]&&t[3]>=n[1]}function kr(t){return t[2]<t[0]||t[3]<t[1]}function Tr(t,n){return n?(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n):t}function Ar(t,n){var i=(t[2]-t[0])/2*(n-1),r=(t[3]-t[1])/2*(n-1);t[0]-=i,t[2]+=i,t[1]-=r,t[3]+=r}function Cr(t,n,i){var r=!1,e=nr(t,n),o=nr(t,i);if(e===Bi||o===Bi)r=!0;else{var u=t[0],s=t[1],a=t[2],f=t[3],h=n[0],c=n[1],l=i[0],v=i[1],p=(v-c)/(l-h),d=void 0,y=void 0;o&Xi&&!(e&Xi)&&(r=(d=l-(v-f)/p)>=u&&d<=a),r||!(o&Vi)||e&Vi||(r=(y=v-(l-a)*p)>=s&&y<=f),r||!(o&Wi)||e&Wi||(r=(d=l-(v-s)/p)>=u&&d<=a),r||!(o&Yi)||e&Yi||(r=(y=v-(l-u)*p)>=s&&y<=f)}return r}function Pr(t,n,i,r){var e=[];if(r>1)for(var o=t[2]-t[0],u=t[3]-t[1],s=0;s<r;++s)e.push(t[0]+o*s/r,t[1],t[2],t[1]+u*s/r,t[2]-o*s/r,t[3],t[0],t[3]-u*s/r);else e=[t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]];n(e,e,2);for(var a=[],f=[],h=(s=0,e.length);s<h;s+=2)a.push(e[s]),f.push(e[s+1]);return function(t,n,i){return rr(Math.min.apply(null,t),Math.min.apply(null,n),Math.max.apply(null,t),Math.max.apply(null,n),i)}(a,f,i)}function Rr(t,n){var i=n.getExtent(),r=br(t);if(n.canWrapX()&&(r[0]<i[0]||r[0]>=i[2])){var e=jr(i),o=Math.floor((r[0]-i[0])/e)*e;t[0]-=o,t[2]-=o}return t}function Ir(t,n,i){var r=void 0!==i?t.toFixed(i):""+t,e=r.indexOf(".");return(e=-1===e?r.length:e)>n?r:new Array(1+n-e).join("0")+r}function Nr(t,n){for(var i=(""+t).split("."),r=(""+n).split("."),e=0;e<Math.max(i.length,r.length);e++){var o=parseInt(i[e]||"0",10),u=parseInt(r[e]||"0",10);if(o>u)return 1;if(u>o)return-1}return 0}function zr(t,n){return t[0]+=+n[0],t[1]+=+n[1],t}function Fr(t,n){var i=n.getRadius(),r=n.getCenter(),e=r[0],o=r[1],u=t[0]-e,s=t[1]-o;0===u&&0===s&&(u=1);var a=Math.sqrt(u*u+s*s);return[e+i*u/a,o+i*s/a]}function Lr(t,n){var i,r,e=t[0],o=t[1],u=n[0],s=n[1],a=u[0],f=u[1],h=s[0],c=s[1],l=h-a,v=c-f,p=0===l&&0===v?0:(l*(e-a)+v*(o-f))/(l*l+v*v||0);return p<=0?(i=a,r=f):p>=1?(i=h,r=c):(i=a+p*l,r=f+p*v),[i,r]}function Gr(t,n,i){var r=T(n+180,360)-180,e=Math.abs(3600*r),o=i||0,u=Math.pow(10,o),s=Math.floor(e/3600),a=Math.floor((e-3600*s)/60),f=e-3600*s-60*a;return(f=Math.ceil(f*u)/u)>=60&&(f=0,a+=1),a>=60&&(a=0,s+=1),s+"° "+Ir(a,2)+"′ "+Ir(f,2,o)+"″"+(0==r?"":" "+t.charAt(r<0?1:0))}function Dr(t,n,i){return t?n.replace("{x}",t[0].toFixed(i)).replace("{y}",t[1].toFixed(i)):""}function Ur(t,n){for(var i=!0,r=t.length-1;r>=0;--r)if(t[r]!=n[r]){i=!1;break}return i}function qr(t,n){var i=Math.cos(n),r=Math.sin(n),e=t[0]*i-t[1]*r,o=t[1]*i+t[0]*r;return t[0]=e,t[1]=o,t}function Br(t,n){return t[0]*=n,t[1]*=n,t}function Xr(t,n){var i=t[0]-n[0],r=t[1]-n[1];return i*i+r*r}function Vr(t,n){return Math.sqrt(Xr(t,n))}function Wr(t,n){return Xr(t,Lr(t,n))}function Yr(t,n){return Dr(t,"{x}, {y}",n)}function Zr(t,n){if(n.canWrapX()){var i=jr(n.getExtent()),r=Hr(t,n,i);r&&(t[0]-=r*i)}return t}function Hr(t,n,i){var r=n.getExtent(),e=0;if(n.canWrapX()&&(t[0]<r[0]||t[0]>r[2])){var o=i||jr(r);e=Math.floor((t[0]-r[0])/o)}return e}var Kr={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},Jr=6371008.8;function $r(t,n,i){var r=i||Jr,e=k(t[1]),o=k(n[1]),u=(o-e)/2,s=k(n[0]-t[0])/2,a=Math.sin(u)*Math.sin(u)+Math.sin(s)*Math.sin(s)*Math.cos(e)*Math.cos(o);return 2*r*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}function Qr(t,n){for(var i=0,r=0,e=t.length;r<e-1;++r)i+=$r(t[r],t[r+1],n);return i}function te(t,n){for(var i=0,r=t.length,e=t[r-1][0],o=t[r-1][1],u=0;u<r;u++){var s=t[u][0],a=t[u][1];i+=k(s-e)*(2+Math.sin(k(o))+Math.sin(k(a))),e=s,o=a}return i*n*n/2}function ne(t,n,i,r){var e=r||Jr,o=k(t[1]),u=k(t[0]),s=n/e,a=Math.asin(Math.sin(o)*Math.cos(s)+Math.cos(o)*Math.sin(s)*Math.cos(i));return[E(u+Math.atan2(Math.sin(i)*Math.sin(s)*Math.cos(o),Math.cos(s)-Math.sin(o)*Math.sin(a))),E(a)]}var ie=!0;function re(t){ie=!(void 0===t||t)}function ee(t,n,i){var r;if(void 0!==n){for(var e=0,o=t.length;e<o;++e)n[e]=t[e];r=n}else r=t.slice();return r}function oe(t,n,i){if(void 0!==n&&t!==n){for(var r=0,e=t.length;r<e;++r)n[r]=t[r];t=n}return t}function ue(t){Ri(t.getCode(),t),zi(t,t,ee)}function se(t){t.forEach(ue)}function ae(t){return"string"==typeof t?Pi(t):t||null}function fe(t,n,i,r){var e,o=(t=ae(t)).getPointResolutionFunc();if(o){if(e=o(n,i),r&&r!==t.getUnits())(s=t.getMetersPerUnit())&&(e=e*s/ci[r])}else{var u=t.getUnits();if(u==li.DEGREES&&!r||r==li.DEGREES)e=n;else{var s,a=me(t,ae("EPSG:4326"));if(a===oe&&u!==li.DEGREES)e=n*t.getMetersPerUnit();else{var f=[i[0]-n/2,i[1],i[0]+n/2,i[1],i[0],i[1]-n/2,i[0],i[1]+n/2];e=($r((f=a(f,f,2)).slice(0,2),f.slice(2,4))+$r(f.slice(4,6),f.slice(6,8)))/2}void 0!==(s=r?ci[r]:t.getMetersPerUnit())&&(e/=s)}}return e}function he(t){se(t),t.forEach((function(n){t.forEach((function(t){n!==t&&zi(n,t,ee)}))}))}function ce(t,n,i,r){t.forEach((function(t){n.forEach((function(n){zi(t,n,i),zi(n,t,r)}))}))}function le(t,n){return t?"string"==typeof t?ae(t):t:ae(n)}function ve(t){return function(n,i,r){for(var e=n.length,o=void 0!==r?r:2,u=void 0!==i?i:new Array(e),s=0;s<e;s+=o)for(var a=t(n.slice(s,s+o)),f=a.length,h=0,c=o;h<c;++h)u[s+h]=h>=f?n[s+h]:a[h];return u}}function pe(t,n,i,r){var e=ae(t),o=ae(n);zi(e,o,ve(i)),zi(o,e,ve(r))}function de(t,n){return re(),be(t,"EPSG:4326",void 0!==n?n:"EPSG:3857")}function ye(t,n){if(t===n)return!0;var i=t.getUnits()===n.getUnits();return(t.getCode()===n.getCode()||me(t,n)===ee)&&i}function me(t,n){var i=Fi(t.getCode(),n.getCode());return i||(i=oe),i}function we(t,n){return me(ae(t),ae(n))}function be(t,n,i){return we(n,i)(t,void 0,t.length)}function ge(t,n,i,r){return Pr(t,we(n,i),void 0,r)}var xe=null;function _e(t){xe=ae(t)}function Me(){return xe}function Oe(t,n){return xe?be(t,n,xe):t}function Se(t,n){return xe?be(t,xe,n):(ie&&!Ur(t,[0,0])&&t[0]>=-180&&t[0]<=180&&t[1]>=-90&&t[1]<=90&&(ie=!1,console.warn("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),t)}function je(t,n){return xe?ge(t,n,xe):t}function Ee(t,n){return xe?ge(t,xe,n):t}function ke(t,n){if(!xe)return t;var i=ae(n).getUnits(),r=xe.getUnits();return i&&r?t*ci[i]/ci[r]:t}function Te(t,n){if(!xe)return t;var i=ae(n).getUnits(),r=xe.getUnits();return i&&r?t*ci[r]/ci[i]:t}function Ae(t,n,i){return function(r){var e,o;if(t.canWrapX()){var u=t.getExtent(),s=jr(u);(o=Hr(r=r.slice(0),t,s))&&(r[0]=r[0]-o*s),r[0]=x(r[0],u[0],u[2]),r[1]=x(r[1],u[1],u[3]),e=i(r)}else e=i(r);return o&&n.canWrapX()&&(e[0]+=o*jr(n.getExtent())),e}}function Ce(){he(xi),he(Ti),ce(Ti,xi,_i,Mi)}Ce();var Pe,Re=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Ie="projection",Ne="coordinateFormat",ze=function(t){function n(n){var i=this,r=n||{},e=document.createElement("div");e.className=void 0!==r.className?r.className:"ol-mouse-position",(i=t.call(this,{element:e,render:r.render,target:r.target})||this).on,i.once,i.un,i.addChangeListener(Ie,i.Vt),r.coordinateFormat&&i.setCoordinateFormat(r.coordinateFormat),r.projection&&i.setProjection(r.projection);var o=!0,u="&#160;";return"undefinedHTML"in r?(void 0!==r.undefinedHTML&&(u=r.undefinedHTML),o=!!u):"placeholder"in r&&(!1===r.placeholder?o=!1:u=String(r.placeholder)),i.Wt=u,i.Yt=o,i.Zt=e.innerHTML,i.Ht=null,i.Kt=null,i}return Re(n,t),n.prototype.Vt=function(){this.Kt=null},n.prototype.getCoordinateFormat=function(){return this.get(Ne)},n.prototype.getProjection=function(){return this.get(Ie)},n.prototype.handleMouseMove=function(t){var n=this.getMap();this.Jt(n.getEventPixel(t))},n.prototype.handleMouseOut=function(t){this.Jt(null)},n.prototype.setMap=function(n){if(t.prototype.setMap.call(this,n),n){var i=n.getViewport();this.listenerKeys.push(lt(i,ei,this.handleMouseMove,this)),this.Yt&&this.listenerKeys.push(lt(i,si,this.handleMouseOut,this)),this.Jt(null)}},n.prototype.setCoordinateFormat=function(t){this.set(Ne,t)},n.prototype.setProjection=function(t){this.set(Ie,ae(t))},n.prototype.Jt=function(t){var n=this.Wt;if(t&&this.Ht){if(!this.Kt){var i=this.getProjection();this.Kt=i?me(this.Ht,i):oe}var r=this.getMap().getCoordinateFromPixelInternal(t);if(r){var e=Me();e&&(this.Kt=me(this.Ht,e)),this.Kt(r,r);var o=this.getCoordinateFormat();n=o?o(r):r.toString()}}this.Zt&&n===this.Zt||(this.element.innerHTML=n,this.Zt=n)},n.prototype.render=function(t){var n=t.frameState;n?this.Ht!=n.viewState.projection&&(this.Ht=n.viewState.projection,this.Kt=null):this.Ht=null},n}(an),Fe=new Array(6);function Le(){return[1,0,0,1,0,0]}function Ge(t){return Ue(t,1,0,0,1,0,0)}function De(t,n){var i=t[0],r=t[1],e=t[2],o=t[3],u=t[4],s=t[5],a=n[0],f=n[1],h=n[2],c=n[3],l=n[4],v=n[5];return t[0]=i*a+e*f,t[1]=r*a+o*f,t[2]=i*h+e*c,t[3]=r*h+o*c,t[4]=i*l+e*v+u,t[5]=r*l+o*v+s,t}function Ue(t,n,i,r,e,o,u){return t[0]=n,t[1]=i,t[2]=r,t[3]=e,t[4]=o,t[5]=u,t}function qe(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t}function Be(t,n){var i=n[0],r=n[1];return n[0]=t[0]*i+t[2]*r+t[4],n[1]=t[1]*i+t[3]*r+t[5],n}function Xe(t,n){var i=Math.cos(n),r=Math.sin(n);return De(t,Ue(Fe,i,r,-r,i,0,0))}function Ve(t,n,i){return De(t,Ue(Fe,n,0,0,i,0,0))}function We(t,n,i){return Ue(t,n,0,0,i,0,0)}function Ye(t,n,i){return De(t,Ue(Fe,1,0,0,1,n,i))}function Ze(t,n,i,r,e,o,u,s){var a=Math.sin(o),f=Math.cos(o);return t[0]=r*f,t[1]=e*a,t[2]=-r*a,t[3]=e*f,t[4]=u*r*f-s*r*a+n,t[5]=u*e*a+s*e*f+i,t}function He(t,n){var i=Ke(n);g(0!==i,32);var r=n[0],e=n[1],o=n[2],u=n[3],s=n[4],a=n[5];return t[0]=u/i,t[1]=-e/i,t[2]=-o/i,t[3]=r/i,t[4]=(o*a-u*s)/i,t[5]=-(r*a-e*s)/i,t}function Ke(t){return t[0]*t[3]-t[1]*t[2]}function Je(t){var n="matrix("+t.join(", ")+")";if(Kt)return n;var i=Pe||(Pe=document.createElement("div"));return i.style.transform=n,i.style.transform}var $e=function(){function t(){this.$t={},this.Qt=0,this.tn=32}return t.prototype.clear=function(){this.$t={},this.Qt=0},t.prototype.canExpireCache=function(){return this.Qt>this.tn},t.prototype.expire=function(){if(this.canExpireCache()){var t=0;for(var n in this.$t){var i=this.$t[n];0!=(3&t++)||i.hasListener()||(delete this.$t[n],--this.Qt)}}},t.prototype.get=function(t,n,i){var r=Qe(t,n,i);return r in this.$t?this.$t[r]:null},t.prototype.set=function(t,n,i,r){var e=Qe(t,n,i);this.$t[e]=r,++this.Qt},t.prototype.setSize=function(t){this.tn=t,this.expire()},t}();function Qe(t,n,i){return n+":"+t+":"+(i?At(i):"null")}var to=$e,no=new $e,io=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();function ro(t,n){no.expire()}var eo=function(t){function n(n){var i=t.call(this)||this;return i.U=n,i}return io(n,t),n.prototype.dispatchRenderEvent=function(t,n){v()},n.prototype.calculateMatrices2D=function(t){var n=t.viewState,i=t.coordinateToPixelTransform,r=t.pixelToCoordinateTransform;Ze(i,t.size[0]/2,t.size[1]/2,1/n.resolution,-1/n.resolution,-n.rotation,-n.center[0],-n.center[1]),He(r,i)},n.prototype.forEachFeatureAtCoordinate=function(t,n,i,r,e,o,u,s){var a,f=n.viewState;function h(t,n,i,r){return e.call(o,n,t?i:null,r)}var c=f.projection,l=Zr(t.slice(),c),v=[[0,0]];if(c.canWrapX()&&r){var p=jr(c.getExtent());v.push([-p,0],[p,0])}for(var d=n.layerStatesArray,y=d.length,m=[],w=[],b=0;b<v.length;b++)for(var g=y-1;g>=0;--g){var x=d[g],_=x.layer;if(_.hasRenderer()&&qn(x,f)&&u.call(s,_)){var M=_.getRenderer(),O=_.getSource();if(M&&O){var S=O.getWrapX()?l:t,j=h.bind(null,x.managed);w[0]=S[0]+v[b][0],w[1]=S[1]+v[b][1],a=M.forEachFeatureAtCoordinate(w,n,i,j,m)}if(a)return a}}if(0!==m.length){var E=1/m.length;return m.forEach((function(t,n){return t.distanceSq+=n*E})),m.sort((function(t,n){return t.distanceSq-n.distanceSq})),m.some((function(t){return a=t.callback(t.feature,t.layer,t.geometry)})),a}},n.prototype.forEachLayerAtPixel=function(t,n,i,r,e){return v()},n.prototype.hasFeatureAtCoordinate=function(t,n,i,r,e,o){return void 0!==this.forEachFeatureAtCoordinate(t,n,i,r,U,this,e,o)},n.prototype.getMap=function(){return this.U},n.prototype.renderFrame=function(t){v()},n.prototype.scheduleExpireIconCache=function(t){no.canExpireCache()&&t.postRenderFunctions.push(ro)},n}(D),oo=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),uo=function(t){function n(n,i,r,e){var o=t.call(this,n)||this;return o.inversePixelTransform=i,o.frameState=r,o.context=e,o}return oo(n,t),n}(L),so="10px sans-serif",ao="#000",fo="round",ho=[],co="round",lo=10,vo="#000",po="center",yo="middle",mo=[0,0,0,0],wo=new xt,bo=new J;bo.setSize=function(){console.warn("labelCache is deprecated.")};var go,xo,_o=null,Mo={},Oo=function(){var t,n,i="32px ",r=["monospace","serif"],e=r.length,o="wmytzilWMYTZIL@#/&?$%10";function u(t,u,s){for(var a=!0,f=0;f<e;++f){var h=r[f];if(n=Eo(t+" "+u+" "+i+h,o),s!=h){var c=Eo(t+" "+u+" "+i+s+","+h,o);a=a&&c!=n}}return!!a}function s(){for(var n=!0,i=wo.getKeys(),r=0,e=i.length;r<e;++r){var o=i[r];wo.get(o)<100&&(u.apply(this,o.split("\n"))?(Y(Mo),_o=null,go=void 0,wo.set(o,100)):(wo.set(o,wo.get(o)+1,!0),n=!1))}n&&(clearInterval(t),t=void 0)}return function(n){var i=mn(n);if(i)for(var r=i.families,e=0,o=r.length;e<o;++e){var a=r[e],f=i.style+"\n"+i.weight+"\n"+a;void 0===wo.get(f)&&(wo.set(f,100,!0),u(i.style,i.weight,a)||(wo.set(f,0,!0),void 0===t&&(t=setInterval(s,32))))}}}(),So=function(t){var n=Mo[t];if(null==n){if(Kt){var i=mn(t),r=jo(t,"Žg");n=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else xo||((xo=document.createElement("div")).innerHTML="M",xo.style.minHeight="0",xo.style.maxHeight="none",xo.style.height="auto",xo.style.padding="0",xo.style.border="none",xo.style.position="absolute",xo.style.display="block",xo.style.left="-99999px"),xo.style.font=t,document.body.appendChild(xo),n=xo.offsetHeight,document.body.removeChild(xo);Mo[t]=n}return n};function jo(t,n){return _o||(_o=Qt(1,1)),t!=go&&(_o.font=t,go=_o.font),_o.measureText(n)}function Eo(t,n){return jo(t,n).width}function ko(t,n,i){if(n in i)return i[n];var r=Eo(t,n);return i[n]=r,r}function To(t,n){for(var i=[],r=[],e=[],o=0,u=0,s=0,a=0,f=0,h=n.length;f<=h;f+=2){var c=n[f];if("\n"!==c&&f!==h){var l=n[f+1]||t.font,v=Eo(l,c);i.push(v),u+=v;var p=So(l);r.push(p),a=Math.max(a,p)}else o=Math.max(o,u),e.push(u),u=0,s+=a}return{width:o,height:s,widths:i,heights:r,lineWidths:e}}function Ao(t,n,i,r,e,o,u,s,a,f,h){t.save(),1!==i&&(t.globalAlpha*=i),n&&t.setTransform.apply(t,n),r.contextInstructions?(t.translate(a,f),t.scale(h[0],h[1]),function(t,n){for(var i=t.contextInstructions,r=0,e=i.length;r<e;r+=2)Array.isArray(i[r+1])?n[i[r]].apply(n,i[r+1]):n[i[r]]=i[r+1]}(r,t)):h[0]<0||h[1]<0?(t.translate(a,f),t.scale(h[0],h[1]),t.drawImage(r,e,o,u,s,0,0,u,s)):t.drawImage(r,e,o,u,s,a,f,u*h[0],s*h[1]),t.restore()}var Co=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Po=function(t){function n(n){var i=t.call(this,n)||this;i.nn=lt(wo,G,n.redrawText.bind(n)),i.rn=document.createElement("div");var r=i.rn.style;r.position="absolute",r.width="100%",r.height="100%",r.zIndex="0",i.rn.className="ol-unselectable ol-layers";var e=n.getViewport();return e.insertBefore(i.rn,e.firstChild||null),i.en=[],i.vt=!0,i}return Co(n,t),n.prototype.dispatchRenderEvent=function(t,n){var i=this.getMap();if(i.hasListener(t)){var r=new uo(t,void 0,n);i.dispatchEvent(r)}},n.prototype.disposeInternal=function(){pt(this.nn),this.rn.parentNode.removeChild(this.rn),t.prototype.disposeInternal.call(this)},n.prototype.renderFrame=function(t){if(t){this.calculateMatrices2D(t),this.dispatchRenderEvent(In,t);var n=t.layerStatesArray.sort((function(t,n){return t.zIndex-n.zIndex})),i=t.viewState;this.en.length=0;for(var r=[],e=null,o=0,u=n.length;o<u;++o){var s=n[o];t.layerIndex=o;var a=s.layer,f=a.getSourceState();if(!qn(s,i)||f!=Gn&&f!=Fn)a.unrender();else{var h=a.render(t,e);h&&(h!==e&&(this.en.push(h),e=h),"getDeclutter"in a&&r.push(a))}}for(o=r.length-1;o>=0;--o)r[o].renderDeclutter(t);un(this.rn,this.en),this.dispatchRenderEvent(Nn,t),this.vt||(this.rn.style.display="",this.vt=!0),this.scheduleExpireIconCache(t)}else this.vt&&(this.rn.style.display="none",this.vt=!1)},n.prototype.forEachLayerAtPixel=function(t,n,i,r,e){for(var o=n.viewState,u=n.layerStatesArray,s=u.length-1;s>=0;--s){var a=u[s],f=a.layer;if(f.hasRenderer()&&qn(a,o)&&e(f)){var h=f.getRenderer().getDataAtPixel(t,n,i);if(h){var c=r(f,h);if(c)return c}}}},n}(eo),Ro="bottom-left",Io="bottom-center",No="bottom-right",zo="center-left",Fo="center-center",Lo="center-right",Go="top-left",Do="top-center",Uo="top-right";function qo(t){return(qo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var Bo=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Xo="element",Vo="map",Wo="offset",Yo="position",Zo="positioning",Ho=function(t){function n(n){var i=t.call(this)||this;i.on,i.once,i.un,i.options=n,i.id=n.id,i.insertFirst=void 0===n.insertFirst||n.insertFirst,i.stopEvent=void 0===n.stopEvent||n.stopEvent,i.element=document.createElement("div"),i.element.className=void 0!==n.className?n.className:"ol-overlay-container ol-selectable",i.element.style.position="absolute",i.element.style.pointerEvents="auto";var r=n.autoPan;return r&&"object"!==qo(r)&&(r={animation:n.autoPanAnimation,margin:n.autoPanMargin}),i.autoPan=r||!1,i.rendered={Kt:"",visible:!0},i.mapPostrenderListenerKey=null,i.addChangeListener(Xo,i.handleElementChanged),i.addChangeListener(Vo,i.handleMapChanged),i.addChangeListener(Wo,i.handleOffsetChanged),i.addChangeListener(Yo,i.handlePositionChanged),i.addChangeListener(Zo,i.handlePositioningChanged),void 0!==n.element&&i.setElement(n.element),i.setOffset(void 0!==n.offset?n.offset:[0,0]),i.setPositioning(void 0!==n.positioning?n.positioning:Go),void 0!==n.position&&i.setPosition(n.position),i}return Bo(n,t),n.prototype.getElement=function(){return this.get(Xo)},n.prototype.getId=function(){return this.id},n.prototype.getMap=function(){return this.get(Vo)||null},n.prototype.getOffset=function(){return this.get(Wo)},n.prototype.getPosition=function(){return this.get(Yo)},n.prototype.getPositioning=function(){return this.get(Zo)},n.prototype.handleElementChanged=function(){on(this.element);var t=this.getElement();t&&this.element.appendChild(t)},n.prototype.handleMapChanged=function(){this.mapPostrenderListenerKey&&(en(this.element),pt(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);var t=this.getMap();if(t){this.mapPostrenderListenerKey=lt(t,Lt,this.render,this),this.updatePixelPosition();var n=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?n.insertBefore(this.element,n.childNodes[0]||null):n.appendChild(this.element),this.performAutoPan()}},n.prototype.render=function(){this.updatePixelPosition()},n.prototype.handleOffsetChanged=function(){this.updatePixelPosition()},n.prototype.handlePositionChanged=function(){this.updatePixelPosition(),this.performAutoPan()},n.prototype.handlePositioningChanged=function(){this.updatePixelPosition()},n.prototype.setElement=function(t){this.set(Xo,t)},n.prototype.setMap=function(t){this.set(Vo,t)},n.prototype.setOffset=function(t){this.set(Wo,t)},n.prototype.setPosition=function(t){this.set(Yo,t)},n.prototype.performAutoPan=function(){this.autoPan&&this.panIntoView(this.autoPan)},n.prototype.panIntoView=function(t){var n=this.getMap();if(n&&n.getTargetElement()&&this.get(Yo)){var i=this.getRect(n.getTargetElement(),n.getSize()),r=this.getElement(),e=this.getRect(r,[tn(r),nn(r)]),o=t||{},u=void 0===o.margin?20:o.margin;if(!Qi(i,e)){var s=e[0]-i[0],a=i[2]-e[2],f=e[1]-i[1],h=i[3]-e[3],c=[0,0];if(s<0?c[0]=s-u:a<0&&(c[0]=Math.abs(a)+u),f<0?c[1]=f-u:h<0&&(c[1]=Math.abs(h)+u),0!==c[0]||0!==c[1]){var l=n.getView().getCenterInternal(),v=n.getPixelFromCoordinateInternal(l);if(!v)return;var p=[v[0]+c[0],v[1]+c[1]],d=o.animation||{};n.getView().animateInternal({center:n.getCoordinateFromPixelInternal(p),duration:d.duration,easing:d.easing})}}}},n.prototype.getRect=function(t,n){var i=t.getBoundingClientRect(),r=i.left+window.pageXOffset,e=i.top+window.pageYOffset;return[r,e,r+n[0],e+n[1]]},n.prototype.setPositioning=function(t){this.set(Zo,t)},n.prototype.setVisible=function(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)},n.prototype.updatePixelPosition=function(){var t=this.getMap(),n=this.getPosition();if(t&&t.isRendered()&&n){var i=t.getPixelFromCoordinate(n),r=t.getSize();this.updateRenderedPosition(i,r)}else this.setVisible(!1)},n.prototype.updateRenderedPosition=function(t,n){var i=this.element.style,r=this.getOffset(),e=this.getPositioning();this.setVisible(!0);var o=Math.round(t[0]+r[0])+"px",u=Math.round(t[1]+r[1])+"px",s="0%",a="0%";e==No||e==Lo||e==Uo?s="-100%":e!=Io&&e!=Fo&&e!=Do||(s="-50%"),e==Ro||e==Io||e==No?a="-100%":e!=zo&&e!=Fo&&e!=Lo||(a="-50%");var f="translate(".concat(s,", ").concat(a,") translate(").concat(o,", ").concat(u,")");this.rendered.Kt!=f&&(this.rendered.Kt=f,i.transform=f,i.msTransform=f)},n.prototype.getOptions=function(){return this.options},n}(xt),Ko=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Jo=function(t){function n(n,i){var r=t.call(this,n)||this;return r.layer=i,r}return Ko(n,t),n}(L),$o="layers",Qo=function(t){function n(n){var i=this,r=n||{},e=W({},r);delete e.layers;var o=r.layers;return(i=t.call(this,e)||this).on,i.once,i.un,i.sn=[],i.an={},i.addChangeListener($o,i.fn),o?Array.isArray(o)?o=new Et(o.slice(),{unique:!0}):g("function"==typeof o.getArray,43):o=new Et(void 0,{unique:!0}),i.setLayers(o),i}return Ko(n,t),n.prototype.hn=function(){this.changed()},n.prototype.fn=function(){this.sn.forEach(pt),this.sn.length=0;var t=this.getLayers();for(var n in this.sn.push(lt(t,_t,this.cn,this),lt(t,Mt,this.vn,this)),this.an)this.an[n].forEach(pt);Y(this.an);for(var i=t.getArray(),r=0,e=i.length;r<e;r++){var o=i[r];this.pn(o),this.dispatchEvent(new Jo("addlayer",o))}this.changed()},n.prototype.pn=function(t){var i=[lt(t,G,this.hn,this),lt(t,$,this.hn,this)];t instanceof n&&i.push(lt(t,"addlayer",this.dn,this),lt(t,"removelayer",this.yn,this)),this.an[d(t)]=i},n.prototype.dn=function(t){this.dispatchEvent(new Jo("addlayer",t.layer))},n.prototype.yn=function(t){this.dispatchEvent(new Jo("removelayer",t.layer))},n.prototype.cn=function(t){var n=t.element;this.pn(n),this.dispatchEvent(new Jo("addlayer",n)),this.changed()},n.prototype.vn=function(t){var n=t.element,i=d(n);this.an[i].forEach(pt),delete this.an[i],this.dispatchEvent(new Jo("removelayer",n)),this.changed()},n.prototype.getLayers=function(){return this.get($o)},n.prototype.setLayers=function(t){var n=this.getLayers();if(n)for(var i=n.getArray(),r=0,e=i.length;r<e;++r)this.dispatchEvent(new Jo("removelayer",i[r]));this.set($o,t)},n.prototype.getLayersArray=function(t){var n=void 0!==t?t:[];return this.getLayers().forEach((function(t){t.getLayersArray(n)})),n},n.prototype.getLayerStatesArray=function(t){var n=void 0!==t?t:[],i=n.length;this.getLayers().forEach((function(t){t.getLayerStatesArray(n)}));var r=this.getLayerState(),e=r.zIndex;t||void 0!==r.zIndex||(e=0);for(var o=i,u=n.length;o<u;o++){var s=n[o];s.opacity*=r.opacity,s.visible=s.visible&&r.visible,s.maxResolution=Math.min(s.maxResolution,r.maxResolution),s.minResolution=Math.max(s.minResolution,r.minResolution),s.minZoom=Math.max(s.minZoom,r.minZoom),s.maxZoom=Math.min(s.maxZoom,r.maxZoom),void 0!==r.extent&&(void 0!==s.extent?s.extent=Mr(s.extent,r.extent):s.extent=r.extent),void 0===s.zIndex&&(s.zIndex=e)}return n},n.prototype.getSourceState=function(){return Gn},n}(Cn),tu=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),nu=function(t){function n(n,i,r){var e=t.call(this,n)||this;return e.map=i,e.frameState=void 0!==r?r:null,e}return tu(n,t),n}(L),iu=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ru=function(t){function n(n,i,r,e,o){var u=t.call(this,n,i,o)||this;return u.originalEvent=r,u.mn=null,u.wn=null,u.dragging=void 0!==e&&e,u}return iu(n,t),Object.defineProperty(n.prototype,"pixel",{get:function(){return this.mn||(this.mn=this.map.getEventPixel(this.originalEvent)),this.mn},set:function(t){this.mn=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"coordinate",{get:function(){return this.wn||(this.wn=this.map.getCoordinateFromPixel(this.pixel)),this.wn},set:function(t){this.wn=t},enumerable:!1,configurable:!0}),n.prototype.preventDefault=function(){t.prototype.preventDefault.call(this),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()},n.prototype.stopPropagation=function(){t.prototype.stopPropagation.call(this),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()},n}(nu),eu={SINGLECLICK:"singleclick",CLICK:nt,DBLCLICK:it,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},ou=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),uu=function(t){function n(n,i){var r=t.call(this,n)||this;r.U=n,r.bn,r.gn=!1,r.xn=!1,r._n=[],r.Mn=void 0===i?1:i,r.On=null;var e=r.U.getViewport();return r.Sn=0,r.jn={},r.rn=e,r.En=lt(e,oi,r.kn,r),r.Tn,r.An=lt(e,ei,r.Cn,r),r.Pn=r.Rn.bind(r),r.rn.addEventListener(ht,r.Pn,!!$t&&{passive:!1}),r}return ou(n,t),n.prototype.In=function(t){var n=new ru(eu.CLICK,this.U,t);this.dispatchEvent(n),void 0!==this.bn?(clearTimeout(this.bn),this.bn=void 0,n=new ru(eu.DBLCLICK,this.U,t),this.dispatchEvent(n)):this.bn=setTimeout(function(){this.bn=void 0;var n=new ru(eu.SINGLECLICK,this.U,t);this.dispatchEvent(n)}.bind(this),250)},n.prototype.Nn=function(t){var n=t;n.type==eu.POINTERUP||n.type==eu.POINTERCANCEL?delete this.jn[n.pointerId]:n.type==eu.POINTERDOWN&&(this.jn[n.pointerId]=!0),this.Sn=Object.keys(this.jn).length},n.prototype.zn=function(t){this.Nn(t);var n=new ru(eu.POINTERUP,this.U,t);this.dispatchEvent(n),this.gn&&!n.defaultPrevented&&!this.xn&&this.Fn(t)&&this.In(this.On),0===this.Sn&&(this._n.forEach(pt),this._n.length=0,this.xn=!1,this.On=null)},n.prototype.Fn=function(t){return 0===t.button},n.prototype.kn=function(t){this.gn=0===this.Sn,this.Nn(t);var n=new ru(eu.POINTERDOWN,this.U,t);for(var i in this.dispatchEvent(n),this.On={},t){var r=t[i];this.On[i]="function"==typeof r?B:r}if(0===this._n.length){var e=this.U.getOwnerDocument();this._n.push(lt(e,eu.POINTERMOVE,this.Ln,this),lt(e,eu.POINTERUP,this.zn,this),lt(this.rn,eu.POINTERCANCEL,this.zn,this)),this.rn.getRootNode&&this.rn.getRootNode()!==e&&this._n.push(lt(this.rn.getRootNode(),eu.POINTERUP,this.zn,this))}},n.prototype.Ln=function(t){if(this.Gn(t)){this.xn=!0;var n=new ru(eu.POINTERDRAG,this.U,t,this.xn);this.dispatchEvent(n)}},n.prototype.Cn=function(t){this.Tn=t;var n=!(!this.On||!this.Gn(t));this.dispatchEvent(new ru(t.type,this.U,t,n))},n.prototype.Rn=function(t){var n=this.Tn;n&&!n.defaultPrevented||"boolean"==typeof t.cancelable&&!0!==t.cancelable||t.preventDefault()},n.prototype.Gn=function(t){return this.xn||Math.abs(t.clientX-this.On.clientX)>this.Mn||Math.abs(t.clientY-this.On.clientY)>this.Mn},n.prototype.disposeInternal=function(){this.An&&(pt(this.An),this.An=null),this.rn.removeEventListener(ht,this.Pn),this.En&&(pt(this.En),this.En=null),this._n.forEach(pt),this._n.length=0,this.rn=null,t.prototype.disposeInternal.call(this)},n}(J),su=1/0,au=function(){function t(t,n){this.Dn=t,this.Un=n,this.qn=[],this.Bn=[],this.Xn={}}return t.prototype.clear=function(){this.qn.length=0,this.Bn.length=0,Y(this.Xn)},t.prototype.dequeue=function(){var t=this.qn,n=this.Bn,i=t[0];1==t.length?(t.length=0,n.length=0):(t[0]=t.pop(),n[0]=n.pop(),this.Vn(0));var r=this.Un(i);return delete this.Xn[r],i},t.prototype.enqueue=function(t){g(!(this.Un(t)in this.Xn),31);var n=this.Dn(t);return n!=su&&(this.qn.push(t),this.Bn.push(n),this.Xn[this.Un(t)]=!0,this.Wn(0,this.qn.length-1),!0)},t.prototype.getCount=function(){return this.qn.length},t.prototype.Yn=function(t){return 2*t+1},t.prototype.Zn=function(t){return 2*t+2},t.prototype.Hn=function(t){return t-1>>1},t.prototype.Kn=function(){var t;for(t=(this.qn.length>>1)-1;t>=0;t--)this.Vn(t)},t.prototype.isEmpty=function(){return 0===this.qn.length},t.prototype.isKeyQueued=function(t){return t in this.Xn},t.prototype.isQueued=function(t){return this.isKeyQueued(this.Un(t))},t.prototype.Vn=function(t){for(var n=this.qn,i=this.Bn,r=n.length,e=n[t],o=i[t],u=t;t<r>>1;){var s=this.Yn(t),a=this.Zn(t),f=a<r&&i[a]<i[s]?a:s;n[t]=n[f],i[t]=i[f],t=f}n[t]=e,i[t]=o,this.Wn(u,t)},t.prototype.Wn=function(t,n){for(var i=this.qn,r=this.Bn,e=i[n],o=r[n];n>t;){var u=this.Hn(n);if(!(r[u]>o))break;i[n]=i[u],r[n]=r[u],n=u}i[n]=e,r[n]=o},t.prototype.reprioritize=function(){var t,n,i,r=this.Dn,e=this.qn,o=this.Bn,u=0,s=e.length;for(n=0;n<s;++n)(i=r(t=e[n]))==su?delete this.Xn[this.Un(t)]:(o[u]=i,e[u++]=t);e.length=u,o.length=u,this.Kn()},t}(),fu=0,hu=1,cu=2,lu=3,vu=4,pu=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),du=function(t){function n(n,i){var r=t.call(this,(function(t){return n.apply(null,t)}),(function(t){return t[0].getKey()}))||this;return r.Jn=r.handleTileChange.bind(r),r.$n=i,r.Qn=0,r.ti={},r}return pu(n,t),n.prototype.enqueue=function(n){var i=t.prototype.enqueue.call(this,n);i&&n[0].addEventListener($,this.Jn);return i},n.prototype.getTilesLoading=function(){return this.Qn},n.prototype.handleTileChange=function(t){var n=t.target,i=n.getState();if(i===cu||i===lu||i===vu){n.removeEventListener($,this.Jn);var r=n.getKey();r in this.ti&&(delete this.ti[r],--this.Qn),this.$n()}},n.prototype.loadMoreTiles=function(t,n){for(var i,r,e=0;this.Qn<t&&e<n&&this.getCount()>0;)r=(i=this.dequeue()[0]).getKey(),i.getState()!==fu||r in this.ti||(this.ti[r]=!0,++this.Qn,++e,i.load())},n}(au);function yu(t,n,i,r,e){if(!t||!(i in t.wantedTiles))return su;if(!t.wantedTiles[i][n.getKey()])return su;var o=t.viewState.center,u=r[0]-o[0],s=r[1]-o[1];return 65536*Math.log(e)+Math.sqrt(u*u+s*s)/e}var mu=0,wu=1,bu={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},gu=256;function xu(t,n,i,r){var e=jr(n)/i[0],o=_r(n)/i[1];return r?Math.min(t,Math.max(e,o)):Math.min(t,Math.min(e,o))}function _u(t,n,i){var r=Math.min(t,n);return r*=Math.log(1+50*Math.max(0,t/n-1))/50+1,i&&(r=Math.max(r,i),r/=Math.log(1+50*Math.max(0,i/t-1))/50+1),x(r,i/2,2*n)}function Mu(t,n,i,r){return function(e,o,s,a){if(void 0!==e){var f=t[0],h=t[t.length-1],c=i?xu(f,i,s,r):f;if(a)return void 0===n||n?_u(e,c,h):x(e,h,c);var l=Math.min(c,e),v=Math.floor(u(t,l,o));return t[v]>c&&v<t.length-1?t[v+1]:t[v]}}}function Ou(t,n,i,r,e,o){return function(u,s,a,f){if(void 0!==u){var h=e?xu(n,e,a,o):n,c=void 0!==i?i:0;if(f)return void 0===r||r?_u(u,h,c):x(u,c,h);var l=Math.ceil(Math.log(n/h)/Math.log(t)-1e-9),v=-s*(.5-1e-9)+.5,p=Math.min(h,u),d=Math.floor(Math.log(n/p)/Math.log(t)+v),y=Math.max(l,d);return x(n/Math.pow(t,y),c,h)}}}function Su(t,n,i,r,e){return function(o,u,s,a){if(void 0!==o){var f=r?xu(t,r,s,e):t;return(void 0===i||i)&&a?_u(o,f,n):x(o,n,f)}}}function ju(t){return void 0!==t?0:void 0}function Eu(t){return void 0!==t?t:void 0}function ku(t){var n=2*Math.PI/t;return function(t,i){return i?t:void 0!==t?t=Math.floor(t/n+.5)*n:void 0}}function Tu(t){var n=t||k(5);return function(t,i){return i?t:void 0!==t?Math.abs(t)<=n?0:t:void 0}}function Au(t){return Math.pow(t,3)}function Cu(t){return 1-Au(1-t)}function Pu(t){return 3*t*t-2*t*t*t}function Ru(t){return t}var Iu="XY",Nu="XYZ",zu="XYM",Fu="XYZM";function Lu(t,n,i,r,e,o){for(var u=o||[],s=0,a=n;a<i;a+=r){var f=t[a],h=t[a+1];u[s++]=e[0]*f+e[2]*h+e[4],u[s++]=e[1]*f+e[3]*h+e[5]}return o&&u.length!=s&&(u.length=s),u}function Gu(t,n,i,r,e,o,u){for(var s=u||[],a=Math.cos(e),f=Math.sin(e),h=o[0],c=o[1],l=0,v=n;v<i;v+=r){var p=t[v]-h,d=t[v+1]-c;s[l++]=h+p*a-d*f,s[l++]=c+p*f+d*a;for(var y=v+2;y<v+r;++y)s[l++]=t[y]}return u&&s.length!=l&&(s.length=l),s}function Du(t,n,i,r,e,o,u,s){for(var a=s||[],f=u[0],h=u[1],c=0,l=n;l<i;l+=r){var v=t[l]-f,p=t[l+1]-h;a[c++]=f+e*v,a[c++]=h+o*p;for(var d=l+2;d<l+r;++d)a[c++]=t[d]}return s&&a.length!=c&&(a.length=c),a}function Uu(t,n,i,r,e,o,u){for(var s=u||[],a=0,f=n;f<i;f+=r){s[a++]=t[f]+e,s[a++]=t[f+1]+o;for(var h=f+2;h<f+r;++h)s[a++]=t[h]}return u&&s.length!=a&&(s.length=a),s}var qu=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Bu=[1,0,0,1,0,0],Xu=function(t){function n(){var n=t.call(this)||this;return n.Ft=[1/0,1/0,-1/0,-1/0],n.ni=-1,n.simplifiedGeometryMaxMinSquaredTolerance=0,n.simplifiedGeometryRevision=0,n.simplifyTransformedInternal=X((function(t,n,i){if(!i)return this.getSimplifiedGeometry(n);var r=this.clone();return r.applyTransform(i),r.getSimplifiedGeometry(n)})),n}return qu(n,t),n.prototype.simplifyTransformed=function(t,n){return this.simplifyTransformedInternal(this.getRevision(),t,n)},n.prototype.clone=function(){return v()},n.prototype.closestPointXY=function(t,n,i,r){return v()},n.prototype.containsXY=function(t,n){var i=this.getClosestPoint([t,n]);return i[0]===t&&i[1]===n},n.prototype.getClosestPoint=function(t,n){var i=n||[NaN,NaN];return this.closestPointXY(t[0],t[1],i,1/0),i},n.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},n.prototype.computeExtent=function(t){return v()},n.prototype.getExtent=function(t){if(this.ni!=this.getRevision()){var n=this.computeExtent(this.Ft);(isNaN(n[0])||isNaN(n[1]))&&er(n),this.ni=this.getRevision()}return Tr(this.Ft,t)},n.prototype.rotate=function(t,n){v()},n.prototype.scale=function(t,n,i){v()},n.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},n.prototype.getSimplifiedGeometry=function(t){return v()},n.prototype.getType=function(){return v()},n.prototype.applyTransform=function(t){v()},n.prototype.intersectsExtent=function(t){return v()},n.prototype.translate=function(t,n){v()},n.prototype.transform=function(t,n){var i=ae(t),r=i.getUnits()==li.TILE_PIXELS?function(t,r,e){var o=i.getExtent(),u=i.getWorldExtent(),s=_r(u)/_r(o);return Ze(Bu,u[0],u[3],s,-s,0,0,0),Lu(t,0,t.length,e,Bu,r),we(i,n)(t,r,e)}:we(i,n);return this.applyTransform(r),this},n}(xt),Vu=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();function Wu(t){var n;return t==Iu?n=2:t==Nu||t==zu?n=3:t==Fu&&(n=4),n}function Yu(t,n,i){var r=t.getFlatCoordinates();if(r){var e=t.getStride();return Lu(r,0,r.length,e,n,i)}return null}var Zu=function(t){function n(){var n=t.call(this)||this;return n.layout=Iu,n.stride=2,n.flatCoordinates=null,n}return Vu(n,t),n.prototype.computeExtent=function(t){return ur(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},n.prototype.getCoordinates=function(){return v()},n.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},n.prototype.getFlatCoordinates=function(){return this.flatCoordinates},n.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},n.prototype.getLayout=function(){return this.layout},n.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var n=this.getSimplifiedGeometryInternal(t);return n.getFlatCoordinates().length<this.flatCoordinates.length?n:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},n.prototype.getSimplifiedGeometryInternal=function(t){return this},n.prototype.getStride=function(){return this.stride},n.prototype.setFlatCoordinates=function(t,n){this.stride=Wu(t),this.layout=t,this.flatCoordinates=n},n.prototype.setCoordinates=function(t,n){v()},n.prototype.setLayout=function(t,n,i){var r;if(t)r=Wu(t);else{for(var e=0;e<i;++e){if(0===n.length)return this.layout=Iu,void(this.stride=2);n=n[0]}t=function(t){var n;2==t?n=Iu:3==t?n=Nu:4==t&&(n=Fu);return n}(r=n.length)}this.layout=t,this.stride=r},n.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},n.prototype.rotate=function(t,n){var i=this.getFlatCoordinates();if(i){var r=this.getStride();Gu(i,0,i.length,r,t,n,i),this.changed()}},n.prototype.scale=function(t,n,i){var r=n;void 0===r&&(r=t);var e=i;e||(e=br(this.getExtent()));var o=this.getFlatCoordinates();if(o){var u=this.getStride();Du(o,0,o.length,u,t,r,e,o),this.changed()}},n.prototype.translate=function(t,n){var i=this.getFlatCoordinates();if(i){var r=this.getStride();Uu(i,0,i.length,r,t,n,i),this.changed()}},n}(Xu);function Hu(t,n,i,r,e,o,u){var s,a=t[n],f=t[n+1],h=t[i]-a,c=t[i+1]-f;if(0===h&&0===c)s=n;else{var l=((e-a)*h+(o-f)*c)/(h*h+c*c);if(l>1)s=i;else{if(l>0){for(var v=0;v<r;++v)u[v]=A(t[n+v],t[i+v],l);return void(u.length=r)}s=n}}for(v=0;v<r;++v)u[v]=t[s+v];u.length=r}function Ku(t,n,i,r,e){var o=t[n],u=t[n+1];for(n+=r;n<i;n+=r){var s=t[n],a=t[n+1],f=S(o,u,s,a);f>e&&(e=f),o=s,u=a}return e}function Ju(t,n,i,r,e){for(var o=0,u=i.length;o<u;++o){var s=i[o];e=Ku(t,n,s,r,e),n=s}return e}function $u(t,n,i,r,e){for(var o=0,u=i.length;o<u;++o){var s=i[o];e=Ju(t,n,s,r,e),n=s[s.length-1]}return e}function Qu(t,n,i,r,e,o,u,s,a,f,h){if(n==i)return f;var c,l;if(0===e){if((l=S(u,s,t[n],t[n+1]))<f){for(c=0;c<r;++c)a[c]=t[n+c];return a.length=r,l}return f}for(var v=h||[NaN,NaN],p=n+r;p<i;)if(Hu(t,p-r,p,r,u,s,v),(l=S(u,s,v[0],v[1]))<f){for(f=l,c=0;c<r;++c)a[c]=v[c];a.length=r,p+=r}else p+=r*Math.max((Math.sqrt(l)-Math.sqrt(f))/e|0,1);if(o&&(Hu(t,i-r,n,r,u,s,v),(l=S(u,s,v[0],v[1]))<f)){for(f=l,c=0;c<r;++c)a[c]=v[c];a.length=r}return f}function ts(t,n,i,r,e,o,u,s,a,f,h){for(var c=h||[NaN,NaN],l=0,v=i.length;l<v;++l){var p=i[l];f=Qu(t,n,p,r,e,o,u,s,a,f,c),n=p}return f}function ns(t,n,i,r,e,o,u,s,a,f,h){for(var c=h||[NaN,NaN],l=0,v=i.length;l<v;++l){var p=i[l];f=ts(t,n,p,r,e,o,u,s,a,f,c),n=p[p.length-1]}return f}function is(t,n,i,r){for(var e=0,o=i.length;e<o;++e)t[n++]=i[e];return n}function rs(t,n,i,r){for(var e=0,o=i.length;e<o;++e)for(var u=i[e],s=0;s<r;++s)t[n++]=u[s];return n}function es(t,n,i,r,e){for(var o=e||[],u=0,s=0,a=i.length;s<a;++s){var f=rs(t,n,i[s],r);o[u++]=f,n=f}return o.length=u,o}function os(t,n,i,r,e){for(var o=e||[],u=0,s=0,a=i.length;s<a;++s){var f=es(t,n,i[s],r,o[u]);o[u++]=f,n=f[f.length-1]}return o.length=u,o}function us(t,n,i,r,e,o,u){var s=(i-n)/r;if(s<3){for(;n<i;n+=r)o[u++]=t[n],o[u++]=t[n+1];return u}var a=new Array(s);a[0]=1,a[s-1]=1;for(var f=[n,i-r],h=0;f.length>0;){for(var c=f.pop(),l=f.pop(),v=0,p=t[l],d=t[l+1],y=t[c],m=t[c+1],w=l+r;w<c;w+=r){var b=O(t[w],t[w+1],p,d,y,m);b>v&&(h=w,v=b)}v>e&&(a[(h-n)/r]=1,l+r<h&&f.push(l,h),h+r<c&&f.push(h,c))}for(w=0;w<s;++w)a[w]&&(o[u++]=t[n+w*r],o[u++]=t[n+w*r+1]);return u}function ss(t,n,i,r,e,o,u,s){for(var a=0,f=i.length;a<f;++a){var h=i[a];u=us(t,n,h,r,e,o,u),s.push(u),n=h}return u}function as(t,n,i,r,e,o,u){if(i<=n+r){for(;n<i;n+=r)o[u++]=t[n],o[u++]=t[n+1];return u}var s=t[n],a=t[n+1];o[u++]=s,o[u++]=a;var f=s,h=a;for(n+=r;n<i;n+=r)S(s,a,f=t[n],h=t[n+1])>e&&(o[u++]=f,o[u++]=h,s=f,a=h);return f==s&&h==a||(o[u++]=f,o[u++]=h),u}function fs(t,n){return n*Math.round(t/n)}function hs(t,n,i,r,e,o,u){if(n==i)return u;var s,a,f=fs(t[n],e),h=fs(t[n+1],e);n+=r,o[u++]=f,o[u++]=h;do{if(s=fs(t[n],e),a=fs(t[n+1],e),(n+=r)==i)return o[u++]=s,o[u++]=a,u}while(s==f&&a==h);for(;n<i;){var c=fs(t[n],e),l=fs(t[n+1],e);if(n+=r,c!=s||l!=a){var v=s-f,p=a-h,d=c-f,y=l-h;v*y==p*d&&(v<0&&d<v||v==d||v>0&&d>v)&&(p<0&&y<p||p==y||p>0&&y>p)?(s=c,a=l):(o[u++]=s,o[u++]=a,f=s,h=a,s=c,a=l)}}return o[u++]=s,o[u++]=a,u}function cs(t,n,i,r,e,o,u,s){for(var a=0,f=i.length;a<f;++a){var h=i[a];u=hs(t,n,h,r,e,o,u),s.push(u),n=h}return u}function ls(t,n,i,r,e,o,u,s){for(var a=0,f=i.length;a<f;++a){var h=i[a],c=[];u=cs(t,n,h,r,e,o,u,c),s.push(c),n=h[h.length-1]}return u}function vs(t,n,i,r,e){for(var o=void 0!==e?e:[],u=0,s=n;s<i;s+=r)o[u++]=t.slice(s,s+r);return o.length=u,o}function ps(t,n,i,r,e){for(var o=void 0!==e?e:[],u=0,s=0,a=i.length;s<a;++s){var f=i[s];o[u++]=vs(t,n,f,r,o[u]),n=f}return o.length=u,o}function ds(t,n,i,r,e){for(var o=void 0!==e?e:[],u=0,s=0,a=i.length;s<a;++s){var f=i[s];o[u++]=ps(t,n,f,r,o[u]),n=f[f.length-1]}return o.length=u,o}function ys(t,n,i,r){for(var e=0,o=t[i-r],u=t[i-r+1];n<i;n+=r){var s=t[n],a=t[n+1];e+=u*s-o*a,o=s,u=a}return e/2}function ms(t,n,i,r){for(var e=0,o=0,u=i.length;o<u;++o){var s=i[o];e+=ys(t,n,s,r),n=s}return e}function ws(t,n,i,r){for(var e=0,o=0,u=i.length;o<u;++o){var s=i[o];e+=ms(t,n,s,r),n=s[s.length-1]}return e}var bs=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),gs=function(t){function n(n,i){var r=t.call(this)||this;return r.ii=-1,r.ri=-1,void 0===i||Array.isArray(n[0])?r.setCoordinates(n,i):r.setFlatCoordinates(i,n),r}return bs(n,t),n.prototype.clone=function(){return new n(this.flatCoordinates.slice(),this.layout)},n.prototype.closestPointXY=function(t,n,i,r){return r<Ji(this.getExtent(),t,n)?r:(this.ri!=this.getRevision()&&(this.ii=Math.sqrt(Ku(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.ri=this.getRevision()),Qu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.ii,!0,t,n,i,r))},n.prototype.getArea=function(){return ys(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},n.prototype.getCoordinates=function(){return vs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},n.prototype.getSimplifiedGeometryInternal=function(t){var i=[];return i.length=us(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0),new n(i,Iu)},n.prototype.getType=function(){return Kr.LINEAR_RING},n.prototype.intersectsExtent=function(t){return!1},n.prototype.setCoordinates=function(t,n){this.setLayout(n,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=rs(this.flatCoordinates,0,t,this.stride),this.changed()},n}(Zu),xs=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),_s=function(t){function n(n,i){var r=t.call(this)||this;return r.setCoordinates(n,i),r}return xs(n,t),n.prototype.clone=function(){var t=new n(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t},n.prototype.closestPointXY=function(t,n,i,r){var e=this.flatCoordinates,o=S(t,n,e[0],e[1]);if(o<r){for(var u=this.stride,s=0;s<u;++s)i[s]=e[s];return i.length=u,o}return r},n.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},n.prototype.computeExtent=function(t){return or(this.flatCoordinates,t)},n.prototype.getType=function(){return Kr.POINT},n.prototype.intersectsExtent=function(t){return tr(t,this.flatCoordinates[0],this.flatCoordinates[1])},n.prototype.setCoordinates=function(t,n){this.setLayout(n,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=is(this.flatCoordinates,0,t,this.stride),this.changed()},n}(Zu);function Ms(t,n,i,r,e){return!dr(e,(function(e){return!Os(t,n,i,r,e[0],e[1])}))}function Os(t,n,i,r,e,o){for(var u=0,s=t[i-r],a=t[i-r+1];n<i;n+=r){var f=t[n],h=t[n+1];a<=o?h>o&&(f-s)*(o-a)-(e-s)*(h-a)>0&&u++:h<=o&&(f-s)*(o-a)-(e-s)*(h-a)<0&&u--,s=f,a=h}return 0!==u}function Ss(t,n,i,r,e,o){if(0===i.length)return!1;if(!Os(t,n,i[0],r,e,o))return!1;for(var u=1,s=i.length;u<s;++u)if(Os(t,i[u-1],i[u],r,e,o))return!1;return!0}function js(t,n,i,r,e,o){if(0===i.length)return!1;for(var u=0,s=i.length;u<s;++u){var a=i[u];if(Ss(t,n,a,r,e,o))return!0;n=a[a.length-1]}return!1}function Es(t,n,i,r,o,u,s){for(var a,f,h,c,l,v,p,d=o[u+1],y=[],m=0,w=i.length;m<w;++m){var b=i[m];for(c=t[b-r],v=t[b-r+1],a=n;a<b;a+=r)l=t[a],p=t[a+1],(d<=v&&p<=d||v<=d&&d<=p)&&(h=(d-v)/(p-v)*(l-c)+c,y.push(h)),c=l,v=p}var g=NaN,x=-1/0;for(y.sort(e),c=y[0],a=1,f=y.length;a<f;++a){l=y[a];var _=Math.abs(l-c);_>x&&Ss(t,n,i,r,h=(c+l)/2,d)&&(g=h,x=_),c=l}return isNaN(g)&&(g=o[u]),s?(s.push(g,d,x),s):[g,d,x]}function ks(t,n,i,r,e){for(var o=[],u=0,s=i.length;u<s;++u){var a=i[u];o=Es(t,n,a,r,e,2*u,o),n=a[a.length-1]}return o}function Ts(t,n,i,r,e){var o;for(n+=r;n<i;n+=r)if(o=e(t.slice(n-r,n),t.slice(n,n+r)))return o;return!1}function As(t,n,i,r,e){var o=lr([1/0,1/0,-1/0,-1/0],t,n,i,r);return!!Er(e,o)&&(!!Qi(e,o)||(o[0]>=e[0]&&o[2]<=e[2]||(o[1]>=e[1]&&o[3]<=e[3]||Ts(t,n,i,r,(function(t,n){return Cr(e,t,n)})))))}function Cs(t,n,i,r,e){for(var o=0,u=i.length;o<u;++o){if(As(t,n,i[o],r,e))return!0;n=i[o]}return!1}function Ps(t,n,i,r,e){return!!As(t,n,i,r,e)||(!!Os(t,n,i,r,e[0],e[1])||(!!Os(t,n,i,r,e[0],e[3])||(!!Os(t,n,i,r,e[2],e[1])||!!Os(t,n,i,r,e[2],e[3]))))}function Rs(t,n,i,r,e){if(!Ps(t,n,i[0],r,e))return!1;if(1===i.length)return!0;for(var o=1,u=i.length;o<u;++o)if(Ms(t,i[o-1],i[o],r,e)&&!As(t,i[o-1],i[o],r,e))return!1;return!0}function Is(t,n,i,r,e){for(var o=0,u=i.length;o<u;++o){var s=i[o];if(Rs(t,n,s,r,e))return!0;n=s[s.length-1]}return!1}function Ns(t,n,i,r){for(;n<i-r;){for(var e=0;e<r;++e){var o=t[n+e];t[n+e]=t[i-r+e],t[i-r+e]=o}n+=r,i-=r}}function zs(t,n,i,r){for(var e=0,o=t[i-r],u=t[i-r+1];n<i;n+=r){var s=t[n],a=t[n+1];e+=(s-o)*(a+u),o=s,u=a}return 0===e?void 0:e>0}function Fs(t,n,i,r,e){for(var o=void 0!==e&&e,u=0,s=i.length;u<s;++u){var a=i[u],f=zs(t,n,a,r);if(0===u){if(o&&f||!o&&!f)return!1}else if(o&&!f||!o&&f)return!1;n=a}return!0}function Ls(t,n,i,r,e){for(var o=0,u=i.length;o<u;++o){var s=i[o];if(!Fs(t,n,s,r,e))return!1;s.length&&(n=s[s.length-1])}return!0}function Gs(t,n,i,r,e){for(var o=void 0!==e&&e,u=0,s=i.length;u<s;++u){var a=i[u],f=zs(t,n,a,r);(0===u?o&&f||!o&&!f:o&&!f||!o&&f)&&Ns(t,n,a,r),n=a}return n}function Ds(t,n,i,r,e){for(var o=0,u=i.length;o<u;++o)n=Gs(t,n,i[o],r,e);return n}function Us(t,n){for(var i=[],r=0,e=0,o=0,u=n.length;o<u;++o){var s=n[o];if(zs(t,r,s,2)){if(0===i.length)continue;i[i.length-1].push(n[e])}else i.push(n.slice(e,o+1));e=o+1,r=s}return i}var qs=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Bs=function(t){function n(n,i,r){var e=t.call(this)||this;return e.ei=[],e.oi=-1,e.ui=null,e.ii=-1,e.ri=-1,e.si=-1,e.ai=null,void 0!==i&&r?(e.setFlatCoordinates(i,n),e.ei=r):e.setCoordinates(n,i),e}return qs(n,t),n.prototype.appendLinearRing=function(t){this.flatCoordinates?a(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ei.push(this.flatCoordinates.length),this.changed()},n.prototype.clone=function(){var t=new n(this.flatCoordinates.slice(),this.layout,this.ei.slice());return t.applyProperties(this),t},n.prototype.closestPointXY=function(t,n,i,r){return r<Ji(this.getExtent(),t,n)?r:(this.ri!=this.getRevision()&&(this.ii=Math.sqrt(Ju(this.flatCoordinates,0,this.ei,this.stride,0)),this.ri=this.getRevision()),ts(this.flatCoordinates,0,this.ei,this.stride,this.ii,!0,t,n,i,r))},n.prototype.containsXY=function(t,n){return Ss(this.getOrientedFlatCoordinates(),0,this.ei,this.stride,t,n)},n.prototype.getArea=function(){return ms(this.getOrientedFlatCoordinates(),0,this.ei,this.stride)},n.prototype.getCoordinates=function(t){var n;return void 0!==t?Gs(n=this.getOrientedFlatCoordinates().slice(),0,this.ei,this.stride,t):n=this.flatCoordinates,ps(n,0,this.ei,this.stride)},n.prototype.getEnds=function(){return this.ei},n.prototype.getFlatInteriorPoint=function(){if(this.oi!=this.getRevision()){var t=br(this.getExtent());this.ui=Es(this.getOrientedFlatCoordinates(),0,this.ei,this.stride,t,0),this.oi=this.getRevision()}return this.ui},n.prototype.getInteriorPoint=function(){return new _s(this.getFlatInteriorPoint(),zu)},n.prototype.getLinearRingCount=function(){return this.ei.length},n.prototype.getLinearRing=function(t){return t<0||this.ei.length<=t?null:new gs(this.flatCoordinates.slice(0===t?0:this.ei[t-1],this.ei[t]),this.layout)},n.prototype.getLinearRings=function(){for(var t=this.layout,n=this.flatCoordinates,i=this.ei,r=[],e=0,o=0,u=i.length;o<u;++o){var s=i[o],a=new gs(n.slice(e,s),t);r.push(a),e=s}return r},n.prototype.getOrientedFlatCoordinates=function(){if(this.si!=this.getRevision()){var t=this.flatCoordinates;Fs(t,0,this.ei,this.stride)?this.ai=t:(this.ai=t.slice(),this.ai.length=Gs(this.ai,0,this.ei,this.stride)),this.si=this.getRevision()}return this.ai},n.prototype.getSimplifiedGeometryInternal=function(t){var i=[],r=[];return i.length=cs(this.flatCoordinates,0,this.ei,this.stride,Math.sqrt(t),i,0,r),new n(i,Iu,r)},n.prototype.getType=function(){return Kr.POLYGON},n.prototype.intersectsExtent=function(t){return Rs(this.getOrientedFlatCoordinates(),0,this.ei,this.stride,t)},n.prototype.setCoordinates=function(t,n){this.setLayout(n,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=es(this.flatCoordinates,0,t,this.stride,this.ei);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()},n}(Zu),Xs=Bs;function Vs(t,n,i,r){for(var e=i||32,o=[],u=0;u<e;++u)a(o,ne(t,n,2*Math.PI*u/e,r));return o.push(o[0],o[1]),new Bs(o,Iu,[o.length])}function Ws(t){var n=t[0],i=t[1],r=t[2],e=t[3],o=[n,i,n,e,r,e,r,i,n,i];return new Bs(o,Iu,[o.length])}function Ys(t,n,i){for(var r=n||32,e=t.getStride(),o=t.getLayout(),u=t.getCenter(),s=e*(r+1),a=new Array(s),f=0;f<s;f+=e){a[f]=0,a[f+1]=0;for(var h=2;h<e;h++)a[f+h]=u[h]}var c=[a.length],l=new Bs(a,o,c);return Zs(l,u,t.getRadius(),i),l}function Zs(t,n,i,r){for(var e=t.getFlatCoordinates(),o=t.getStride(),u=e.length/o-1,s=r||0,a=0;a<=u;++a){var f=a*o,h=s+2*T(a,u)*Math.PI/u;e[f]=n[0]+i*Math.cos(h),e[f+1]=n[1]+i*Math.sin(h)}t.changed()}var Hs=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();function Ks(t,n){setTimeout((function(){t(n)}),0)}function Js(t){if(void 0!==t.extent){var n=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return N(t.extent,t.constrainOnlyCenter,n)}var i=le(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&i.isGlobal()){var r=i.getExtent().slice();return r[0]=-1/0,r[2]=1/0,N(r,!1,!1)}return z}function $s(t){var n,i,r,e=void 0!==t.minZoom?t.minZoom:0,o=void 0!==t.maxZoom?t.maxZoom:28,u=void 0!==t.zoomFactor?t.zoomFactor:2,s=void 0!==t.multiWorld&&t.multiWorld,a=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,f=void 0!==t.showFullExtent&&t.showFullExtent,h=le(t.projection,"EPSG:3857"),c=h.getExtent(),l=t.constrainOnlyCenter,v=t.extent;if(s||v||!h.isGlobal()||(l=!1,v=c),void 0!==t.resolutions){var p=t.resolutions;i=p[e],r=void 0!==p[o]?p[o]:p[p.length-1],n=t.constrainResolution?Mu(p,a,!l&&v,f):Su(i,r,a,!l&&v,f)}else{var d=(c?Math.max(jr(c),_r(c)):360*ci[li.DEGREES]/h.getMetersPerUnit())/gu/Math.pow(2,0),y=d/Math.pow(2,28);void 0!==(i=t.maxResolution)?e=0:i=d/Math.pow(u,e),void 0===(r=t.minResolution)&&(r=void 0!==t.maxZoom?void 0!==t.maxResolution?i/Math.pow(u,o):d/Math.pow(u,o):y),o=e+Math.floor(Math.log(i/r)/Math.log(u)),r=i/Math.pow(u,o-e),n=t.constrainResolution?Ou(u,i,r,a,!l&&v,f):Su(i,r,a,!l&&v,f)}return{constraint:n,maxResolution:i,minResolution:r,minZoom:e,zoomFactor:u}}function Qs(t){if(void 0===t.enableRotation||t.enableRotation){var n=t.constrainRotation;return void 0===n||!0===n?Tu():!1===n?Eu:"number"==typeof n?ku(n):Eu}return ju}function ta(t){return!(t.sourceCenter&&t.targetCenter&&!Ur(t.sourceCenter,t.targetCenter))&&(t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation)}function na(t,n,i,r,e){var o=Math.cos(-e),u=Math.sin(-e),s=t[0]*o-t[1]*u,a=t[1]*o+t[0]*u;return[(s+=(n[0]/2-i[0])*r)*o-(a+=(i[1]-n[1]/2)*r)*(u=-u),a*o+s*u]}var ia=function(t){function n(n){var i=t.call(this)||this;i.on,i.once,i.un;var r=W({},n);return i.fi=[0,0],i.hi=[],i.ci,i.li=le(r.projection,"EPSG:3857"),i.vi=[100,100],i.di=null,i.yi,i.mi,i.wi=null,i.bi,i.gi,i.xi=void 0,r.projection&&re(),r.center&&(r.center=Se(r.center,i.li)),r.extent&&(r.extent=Ee(r.extent,i.li)),i._i(r),i}return Hs(n,t),n.prototype._i=function(t){var n=W({},t);for(var i in bu)delete n[i];this.setProperties(n,!0);var r=$s(t);this.Mi=r.maxResolution,this.Oi=r.minResolution,this.Si=r.zoomFactor,this.ji=t.resolutions,this.Ei=t.padding,this.ki=r.minZoom;var e=Js(t),o=r.constraint,u=Qs(t);this.Ti={center:e,resolution:o,rotation:u},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom)},Object.defineProperty(n.prototype,"padding",{get:function(){return this.Ei},set:function(t){var n=this.Ei;this.Ei=t;var i=this.getCenter();if(i){var r=t||[0,0,0,0];n=n||[0,0,0,0];var e=this.getResolution(),o=e/2*(r[3]-n[3]+n[1]-r[1]),u=e/2*(r[0]-n[0]+n[2]-r[2]);this.setCenterInternal([i[0]+o,i[1]-u])}},enumerable:!1,configurable:!0}),n.prototype.Ai=function(t){var n=this.getProperties();return void 0!==n.resolution?n.resolution=this.getResolution():n.zoom=this.getZoom(),n.center=this.getCenterInternal(),n.rotation=this.getRotation(),W({},n,t)},n.prototype.animate=function(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var n=new Array(arguments.length),i=0;i<n.length;++i){var r=arguments[i];r.center&&((r=W({},r)).center=Se(r.center,this.getProjection())),r.anchor&&((r=W({},r)).anchor=Se(r.anchor,this.getProjection())),n[i]=r}this.animateInternal.apply(this,n)},n.prototype.animateInternal=function(t){var n,i=arguments.length;i>1&&"function"==typeof arguments[i-1]&&(n=arguments[i-1],--i);for(var r=0;r<i&&!this.isDef();++r){var e=arguments[r];e.center&&this.setCenterInternal(e.center),void 0!==e.zoom?this.setZoom(e.zoom):e.resolution&&this.setResolution(e.resolution),void 0!==e.rotation&&this.setRotation(e.rotation)}if(r!==i){for(var o=Date.now(),u=this.di.slice(),s=this.yi,a=this.mi,f=[];r<i;++r){var h=arguments[r],c={start:o,complete:!1,anchor:h.anchor,duration:void 0!==h.duration?h.duration:1e3,easing:h.easing||Pu,callback:n};if(h.center&&(c.sourceCenter=u,c.targetCenter=h.center.slice(),u=c.targetCenter),void 0!==h.zoom?(c.sourceResolution=s,c.targetResolution=this.getResolutionForZoom(h.zoom),s=c.targetResolution):h.resolution&&(c.sourceResolution=s,c.targetResolution=h.resolution,s=c.targetResolution),void 0!==h.rotation){c.sourceRotation=a;var l=T(h.rotation-a+Math.PI,2*Math.PI)-Math.PI;c.targetRotation=a+l,a=c.targetRotation}ta(c)?c.complete=!0:o+=c.duration,f.push(c)}this.hi.push(f),this.setHint(mu,1),this.Ci()}else n&&Ks(n,!0)},n.prototype.getAnimating=function(){return this.fi[mu]>0},n.prototype.getInteracting=function(){return this.fi[wu]>0},n.prototype.cancelAnimations=function(){var t;this.setHint(mu,-this.fi[mu]);for(var n=0,i=this.hi.length;n<i;++n){var r=this.hi[n];if(r[0].callback&&Ks(r[0].callback,!1),!t)for(var e=0,o=r.length;e<o;++e){var u=r[e];if(!u.complete){t=u.anchor;break}}}this.hi.length=0,this.xi=t,this.wi=null,this.bi=NaN,this.gi=NaN},n.prototype.Ci=function(){if(void 0!==this.ci&&(cancelAnimationFrame(this.ci),this.ci=void 0),this.getAnimating()){for(var t=Date.now(),n=!1,i=this.hi.length-1;i>=0;--i){for(var r=this.hi[i],e=!0,o=0,u=r.length;o<u;++o){var s=r[o];if(!s.complete){var a=t-s.start,f=s.duration>0?a/s.duration:1;f>=1?(s.complete=!0,f=1):e=!1;var h=s.easing(f);if(s.sourceCenter){var c=s.sourceCenter[0],l=s.sourceCenter[1],v=s.targetCenter[0],p=s.targetCenter[1];this.wi=s.targetCenter;var d=c+h*(v-c),y=l+h*(p-l);this.di=[d,y]}if(s.sourceResolution&&s.targetResolution){var m=1===h?s.targetResolution:s.sourceResolution+h*(s.targetResolution-s.sourceResolution);if(s.anchor){var w=this.Pi(this.getRotation()),b=this.Ti.resolution(m,0,w,!0);this.di=this.calculateCenterZoom(b,s.anchor)}this.bi=s.targetResolution,this.yi=m,this.Ri(!0)}if(void 0!==s.sourceRotation&&void 0!==s.targetRotation){var g=1===h?T(s.targetRotation+Math.PI,2*Math.PI)-Math.PI:s.sourceRotation+h*(s.targetRotation-s.sourceRotation);if(s.anchor){var x=this.Ti.rotation(g,!0);this.di=this.calculateCenterRotate(x,s.anchor)}this.gi=s.targetRotation,this.mi=g}if(this.Ri(!0),n=!0,!s.complete)break}}if(e){this.hi[i]=null,this.setHint(mu,-1),this.wi=null,this.bi=NaN,this.gi=NaN;var _=r[0].callback;_&&Ks(_,!0)}}this.hi=this.hi.filter(Boolean),n&&void 0===this.ci&&(this.ci=requestAnimationFrame(this.Ci.bind(this)))}},n.prototype.calculateCenterRotate=function(t,n){var i,r=this.getCenterInternal();return void 0!==r&&(qr(i=[r[0]-n[0],r[1]-n[1]],t-this.getRotation()),zr(i,n)),i},n.prototype.calculateCenterZoom=function(t,n){var i,r=this.getCenterInternal(),e=this.getResolution();void 0!==r&&void 0!==e&&(i=[n[0]-t*(n[0]-r[0])/e,n[1]-t*(n[1]-r[1])/e]);return i},n.prototype.Pi=function(t){var n=this.vi;if(t){var i=n[0],r=n[1];return[Math.abs(i*Math.cos(t))+Math.abs(r*Math.sin(t)),Math.abs(i*Math.sin(t))+Math.abs(r*Math.cos(t))]}return n},n.prototype.setViewportSize=function(t){this.vi=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)},n.prototype.getCenter=function(){var t=this.getCenterInternal();return t?Oe(t,this.getProjection()):t},n.prototype.getCenterInternal=function(){return this.get(bu.CENTER)},n.prototype.getConstraints=function(){return this.Ti},n.prototype.getConstrainResolution=function(){return this.get("constrainResolution")},n.prototype.getHints=function(t){return void 0!==t?(t[0]=this.fi[0],t[1]=this.fi[1],t):this.fi.slice()},n.prototype.calculateExtent=function(t){return je(this.calculateExtentInternal(t),this.getProjection())},n.prototype.calculateExtentInternal=function(t){var n=t||this.Ii(),i=this.getCenterInternal();g(i,1);var r=this.getResolution();g(void 0!==r,2);var e=this.getRotation();return g(void 0!==e,3),xr(i,r,e,n)},n.prototype.getMaxResolution=function(){return this.Mi},n.prototype.getMinResolution=function(){return this.Oi},n.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.Oi)},n.prototype.setMaxZoom=function(t){this._i(this.Ai({maxZoom:t}))},n.prototype.getMinZoom=function(){return this.getZoomForResolution(this.Mi)},n.prototype.setMinZoom=function(t){this._i(this.Ai({minZoom:t}))},n.prototype.setConstrainResolution=function(t){this._i(this.Ai({constrainResolution:t}))},n.prototype.getProjection=function(){return this.li},n.prototype.getResolution=function(){return this.get(bu.RESOLUTION)},n.prototype.getResolutions=function(){return this.ji},n.prototype.getResolutionForExtent=function(t,n){return this.getResolutionForExtentInternal(Ee(t,this.getProjection()),n)},n.prototype.getResolutionForExtentInternal=function(t,n){var i=n||this.Ii(),r=jr(t)/i[0],e=_r(t)/i[1];return Math.max(r,e)},n.prototype.getResolutionForValueFunction=function(t){var n=t||2,i=this.getConstrainedResolution(this.Mi),r=this.Oi,e=Math.log(i/r)/Math.log(n);return function(t){return i/Math.pow(n,t*e)}},n.prototype.getRotation=function(){return this.get(bu.ROTATION)},n.prototype.getValueForResolutionFunction=function(t){var n=Math.log(t||2),i=this.getConstrainedResolution(this.Mi),r=this.Oi,e=Math.log(i/r)/n;return function(t){return Math.log(i/t)/n/e}},n.prototype.Ii=function(t){var n=this.Pi(t),i=this.Ei;return i&&(n=[n[0]-i[1]-i[3],n[1]-i[0]-i[2]]),n},n.prototype.getState=function(){var t=this.getProjection(),n=this.getResolution(),i=this.getRotation(),r=this.getCenterInternal(),e=this.Ei;if(e){var o=this.Ii();r=na(r,this.Pi(),[o[0]/2+e[3],o[1]/2+e[0]],n,i)}return{center:r.slice(0),projection:void 0!==t?t:null,resolution:n,nextCenter:this.wi,nextResolution:this.bi,nextRotation:this.gi,rotation:i,zoom:this.getZoom()}},n.prototype.getZoom=function(){var t,n=this.getResolution();return void 0!==n&&(t=this.getZoomForResolution(n)),t},n.prototype.getZoomForResolution=function(t){var n,i,r=this.ki||0;if(this.ji){var e=u(this.ji,t,1);r=e,n=this.ji[e],i=e==this.ji.length-1?2:n/this.ji[e+1]}else n=this.Mi,i=this.Si;return r+Math.log(n/t)/Math.log(i)},n.prototype.getResolutionForZoom=function(t){if(this.ji){if(this.ji.length<=1)return 0;var n=x(Math.floor(t),0,this.ji.length-2),i=this.ji[n]/this.ji[n+1];return this.ji[n]/Math.pow(i,x(t-n,0,1))}return this.Mi/Math.pow(this.Si,t-this.ki)},n.prototype.fit=function(t,n){var i;if(g(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,24),Array.isArray(t))g(!kr(t),25),i=Ws(r=Ee(t,this.getProjection()));else if(t.getType()===Kr.CIRCLE){var r;(i=Ws(r=Ee(t.getExtent(),this.getProjection()))).rotate(this.getRotation(),br(r))}else{var e=Me();i=e?t.clone().transform(e,this.getProjection()):t}this.fitInternal(i,n)},n.prototype.rotatedExtentForGeometry=function(t){for(var n=this.getRotation(),i=Math.cos(n),r=Math.sin(-n),e=t.getFlatCoordinates(),o=t.getStride(),u=1/0,s=1/0,a=-1/0,f=-1/0,h=0,c=e.length;h<c;h+=o){var l=e[h]*i-e[h+1]*r,v=e[h]*r+e[h+1]*i;u=Math.min(u,l),s=Math.min(s,v),a=Math.max(a,l),f=Math.max(f,v)}return[u,s,a,f]},n.prototype.fitInternal=function(t,n){var i=n||{},r=i.size;r||(r=this.Ii());var e,o=void 0!==i.padding?i.padding:[0,0,0,0],u=void 0!==i.nearest&&i.nearest;e=void 0!==i.minResolution?i.minResolution:void 0!==i.maxZoom?this.getResolutionForZoom(i.maxZoom):0;var s=this.rotatedExtentForGeometry(t),a=this.getResolutionForExtentInternal(s,[r[0]-o[1]-o[3],r[1]-o[0]-o[2]]);a=isNaN(a)?e:Math.max(a,e),a=this.getConstrainedResolution(a,u?0:1);var f=this.getRotation(),h=Math.sin(f),c=Math.cos(f),l=br(s);l[0]+=(o[1]-o[3])/2*a,l[1]+=(o[0]-o[2])/2*a;var v=l[0]*c-l[1]*h,p=l[1]*c+l[0]*h,d=this.getConstrainedCenter([v,p],a),y=i.callback?i.callback:B;void 0!==i.duration?this.animateInternal({resolution:a,center:d,duration:i.duration,easing:i.easing},y):(this.yi=a,this.di=d,this.Ri(!1,!0),Ks(y,!0))},n.prototype.centerOn=function(t,n,i){this.centerOnInternal(Se(t,this.getProjection()),n,i)},n.prototype.centerOnInternal=function(t,n,i){this.setCenterInternal(na(t,n,i,this.getResolution(),this.getRotation()))},n.prototype.calculateCenterShift=function(t,n,i,r){var e,o=this.Ei;if(o&&t){var u=this.Ii(-i),s=na(t,r,[u[0]/2+o[3],u[1]/2+o[0]],n,i);e=[t[0]-s[0],t[1]-s[1]]}return e},n.prototype.isDef=function(){return!!this.getCenterInternal()&&void 0!==this.getResolution()},n.prototype.adjustCenter=function(t){var n=Oe(this.di,this.getProjection());this.setCenter([n[0]+t[0],n[1]+t[1]])},n.prototype.adjustCenterInternal=function(t){var n=this.di;this.setCenterInternal([n[0]+t[0],n[1]+t[1]])},n.prototype.adjustResolution=function(t,n){var i=n&&Se(n,this.getProjection());this.adjustResolutionInternal(t,i)},n.prototype.adjustResolutionInternal=function(t,n){var i=this.getAnimating()||this.getInteracting(),r=this.Pi(this.getRotation()),e=this.Ti.resolution(this.yi*t,0,r,i);n&&(this.di=this.calculateCenterZoom(e,n)),this.yi*=t,this.Ri()},n.prototype.adjustZoom=function(t,n){this.adjustResolution(Math.pow(this.Si,-t),n)},n.prototype.adjustRotation=function(t,n){n&&(n=Se(n,this.getProjection())),this.adjustRotationInternal(t,n)},n.prototype.adjustRotationInternal=function(t,n){var i=this.getAnimating()||this.getInteracting(),r=this.Ti.rotation(this.mi+t,i);n&&(this.di=this.calculateCenterRotate(r,n)),this.mi+=t,this.Ri()},n.prototype.setCenter=function(t){this.setCenterInternal(t?Se(t,this.getProjection()):t)},n.prototype.setCenterInternal=function(t){this.di=t,this.Ri()},n.prototype.setHint=function(t,n){return this.fi[t]+=n,this.changed(),this.fi[t]},n.prototype.setResolution=function(t){this.yi=t,this.Ri()},n.prototype.setRotation=function(t){this.mi=t,this.Ri()},n.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},n.prototype.Ri=function(t,n){var i=this.getAnimating()||this.getInteracting()||n,r=this.Ti.rotation(this.mi,i),e=this.Pi(r),o=this.Ti.resolution(this.yi,0,e,i),u=this.Ti.center(this.di,o,e,i,this.calculateCenterShift(this.di,o,r,e));this.get(bu.ROTATION)!==r&&this.set(bu.ROTATION,r),this.get(bu.RESOLUTION)!==o&&(this.set(bu.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),u&&this.get(bu.CENTER)&&Ur(this.get(bu.CENTER),u)||this.set(bu.CENTER,u),this.getAnimating()&&!t&&this.cancelAnimations(),this.xi=void 0},n.prototype.resolveConstraints=function(t,n,i){var r=void 0!==t?t:200,e=n||0,o=this.Ti.rotation(this.mi),u=this.Pi(o),s=this.Ti.resolution(this.yi,e,u),a=this.Ti.center(this.di,s,u,!1,this.calculateCenterShift(this.di,s,o,u));if(0===r&&!this.xi)return this.yi=s,this.mi=o,this.di=a,void this.Ri();var f=i||(0===r?this.xi:void 0);this.xi=void 0,this.getResolution()===s&&this.getRotation()===o&&this.getCenterInternal()&&Ur(this.getCenterInternal(),a)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:o,center:a,resolution:s,duration:r,easing:Cu,anchor:f}))},n.prototype.beginInteraction=function(){this.resolveConstraints(0),this.setHint(wu,1)},n.prototype.endInteraction=function(t,n,i){var r=i&&Se(i,this.getProjection());this.endInteractionInternal(t,n,r)},n.prototype.endInteractionInternal=function(t,n,i){this.setHint(wu,-1),this.resolveConstraints(t,n,i)},n.prototype.getConstrainedCenter=function(t,n){var i=this.Pi(this.getRotation());return this.Ti.center(t,n||this.getResolution(),i)},n.prototype.getConstrainedZoom=function(t,n){var i=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(i,n))},n.prototype.getConstrainedResolution=function(t,n){var i=n||0,r=this.Pi(this.getRotation());return this.Ti.resolution(t,i,r)},n}(xt);function ra(t,n,i){return void 0===i&&(i=[0,0]),i[0]=t[0]+2*n,i[1]=t[1]+2*n,i}function ea(t){return t[0]>0&&t[1]>0}function oa(t,n,i){return void 0===i&&(i=[0,0]),i[0]=t[0]*n+.5|0,i[1]=t[1]*n+.5|0,i}function ua(t,n){return Array.isArray(t)?t:(void 0===n?n=[t,t]:(n[0]=t,n[1]=t),n)}var sa=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();function aa(t){t instanceof Bn?t.setMapInternal(null):t instanceof Qo&&t.getLayers().forEach(aa)}function fa(t,n){if(t instanceof Bn)t.setMapInternal(n);else if(t instanceof Qo)for(var i=t.getLayers().getArray(),r=0,e=i.length;r<e;++r)fa(i[r],n)}var ha=function(t){function n(n){var i=t.call(this)||this;i.on,i.once,i.un;var r=function(t){var n=null;void 0!==t.keyboardEventTarget&&(n="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);var i,r,e,o={},u=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new Qo({layers:t.layers});o[Wn]=u,o[Zn]=t.target,o[Hn]=t.view instanceof ia?t.view:new ia,void 0!==t.controls&&(Array.isArray(t.controls)?i=new Et(t.controls.slice()):(g("function"==typeof t.controls.getArray,47),i=t.controls));void 0!==t.interactions&&(Array.isArray(t.interactions)?r=new Et(t.interactions.slice()):(g("function"==typeof t.interactions.getArray,48),r=t.interactions));void 0!==t.overlays?Array.isArray(t.overlays)?e=new Et(t.overlays.slice()):(g("function"==typeof t.overlays.getArray,49),e=t.overlays):e=new Et;return{controls:i,interactions:r,keyboardEventTarget:n,overlays:e,values:o}}(n);i.Ni,i.zi=!0,i.Fi=i.handleBrowserEvent.bind(i),i.Li=void 0!==n.maxTilesLoading?n.maxTilesLoading:16,i.Gi=void 0!==n.pixelRatio?n.pixelRatio:Ht,i.Di,i.Ui,i.qi=function(){this.Ui=void 0,this.Bi(Date.now())}.bind(i),i.Xi=[1,0,0,1,0,0],i.Vi=[1,0,0,1,0,0],i.Wi=0,i.Yi=null,i.Zi=null,i.Hi=null,i.Ki=null,i.Ji=null,i.$i=document.createElement("div"),i.$i.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),i.$i.style.position="relative",i.$i.style.overflow="hidden",i.$i.style.width="100%",i.$i.style.height="100%",i.Qi=document.createElement("div"),i.Qi.style.position="absolute",i.Qi.style.zIndex="0",i.Qi.style.width="100%",i.Qi.style.height="100%",i.Qi.style.pointerEvents="none",i.Qi.className="ol-overlaycontainer",i.$i.appendChild(i.Qi),i.tr=document.createElement("div"),i.tr.style.position="absolute",i.tr.style.zIndex="0",i.tr.style.width="100%",i.tr.style.height="100%",i.tr.style.pointerEvents="none",i.tr.className="ol-overlaycontainer-stopevent",i.$i.appendChild(i.tr),i.nr=null,i.Mn=n.moveTolerance,i.ir=r.keyboardEventTarget,i.rr=null,i.controls=r.controls||new Et,i.interactions=r.interactions||new Et,i.er=r.overlays,i.ur={},i.$=null,i.sr=[],i.ar=new du(i.getTilePriority.bind(i),i.hr.bind(i)),i.addChangeListener(Wn,i.cr),i.addChangeListener(Hn,i.lr),i.addChangeListener(Yn,i.vr),i.addChangeListener(Zn,i.pr),i.setProperties(r.values);var e=i;return!n.view||n.view instanceof ia||n.view.then((function(t){e.setView(new ia(t))})),i.controls.addEventListener(_t,function(t){t.element.setMap(this)}.bind(i)),i.controls.addEventListener(Mt,function(t){t.element.setMap(null)}.bind(i)),i.interactions.addEventListener(_t,function(t){t.element.setMap(this)}.bind(i)),i.interactions.addEventListener(Mt,function(t){t.element.setMap(null)}.bind(i)),i.er.addEventListener(_t,function(t){this.dr(t.element)}.bind(i)),i.er.addEventListener(Mt,function(t){var n=t.element.getId();void 0!==n&&delete this.ur[n.toString()],t.element.setMap(null)}.bind(i)),i.controls.forEach(function(t){t.setMap(this)}.bind(i)),i.interactions.forEach(function(t){t.setMap(this)}.bind(i)),i.er.forEach(i.dr.bind(i)),i}return sa(n,t),n.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},n.prototype.addControl=function(t){this.getControls().push(t)},n.prototype.addInteraction=function(t){this.getInteractions().push(t)},n.prototype.addLayer=function(t){this.getLayerGroup().getLayers().push(t)},n.prototype.yr=function(t){fa(t.layer,this)},n.prototype.addOverlay=function(t){this.getOverlays().push(t)},n.prototype.dr=function(t){var n=t.getId();void 0!==n&&(this.ur[n.toString()]=t),t.setMap(this)},n.prototype.disposeInternal=function(){this.setTarget(null),t.prototype.disposeInternal.call(this)},n.prototype.forEachFeatureAtPixel=function(t,n,i){if(this.Yi&&this.$){var r=this.getCoordinateFromPixelInternal(t),e=void 0!==(i=void 0!==i?i:{}).hitTolerance?i.hitTolerance:0,o=void 0!==i.layerFilter?i.layerFilter:U,u=!1!==i.checkWrapped;return this.$.forEachFeatureAtCoordinate(r,this.Yi,e,u,n,null,o,null)}},n.prototype.getFeaturesAtPixel=function(t,n){var i=[];return this.forEachFeatureAtPixel(t,(function(t){i.push(t)}),n),i},n.prototype.getAllLayers=function(){var t=[];return function n(i){i.forEach((function(i){i instanceof Qo?n(i.getLayers()):t.push(i)}))}(this.getLayers()),t},n.prototype.forEachLayerAtPixel=function(t,n,i){if(this.Yi&&this.$){var r=i||{},e=void 0!==r.hitTolerance?r.hitTolerance:0,o=r.layerFilter||U;return this.$.forEachLayerAtPixel(t,this.Yi,e,n,o)}},n.prototype.hasFeatureAtPixel=function(t,n){if(!this.Yi||!this.$)return!1;var i=this.getCoordinateFromPixelInternal(t),r=void 0!==(n=void 0!==n?n:{}).layerFilter?n.layerFilter:U,e=void 0!==n.hitTolerance?n.hitTolerance:0,o=!1!==n.checkWrapped;return this.$.hasFeatureAtCoordinate(i,this.Yi,e,o,r,null)},n.prototype.getEventCoordinate=function(t){return this.getCoordinateFromPixel(this.getEventPixel(t))},n.prototype.getEventCoordinateInternal=function(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))},n.prototype.getEventPixel=function(t){var n=this.$i.getBoundingClientRect(),i="changedTouches"in t?t.changedTouches[0]:t;return[i.clientX-n.left,i.clientY-n.top]},n.prototype.getTarget=function(){return this.get(Zn)},n.prototype.getTargetElement=function(){var t=this.getTarget();return void 0!==t?"string"==typeof t?document.getElementById(t):t:null},n.prototype.getCoordinateFromPixel=function(t){return Oe(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())},n.prototype.getCoordinateFromPixelInternal=function(t){var n=this.Yi;return n?Be(n.pixelToCoordinateTransform,t.slice()):null},n.prototype.getControls=function(){return this.controls},n.prototype.getOverlays=function(){return this.er},n.prototype.getOverlayById=function(t){var n=this.ur[t.toString()];return void 0!==n?n:null},n.prototype.getInteractions=function(){return this.interactions},n.prototype.getLayerGroup=function(){return this.get(Wn)},n.prototype.setLayers=function(t){var n=this.getLayerGroup();if(t instanceof Et)n.setLayers(t);else{var i=n.getLayers();i.clear(),i.extend(t)}},n.prototype.getLayers=function(){return this.getLayerGroup().getLayers()},n.prototype.getLoadingOrNotReady=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),n=0,i=t.length;n<i;++n){var r=t[n];if(r.visible){var e=r.layer.getRenderer();if(e&&!e.ready)return!0;var o=r.layer.getSource();if(o&&o.loading)return!0}}return!1},n.prototype.getPixelFromCoordinate=function(t){var n=Se(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(n)},n.prototype.getPixelFromCoordinateInternal=function(t){var n=this.Yi;return n?Be(n.coordinateToPixelTransform,t.slice(0,2)):null},n.prototype.getRenderer=function(){return this.$},n.prototype.getSize=function(){return this.get(Yn)},n.prototype.getView=function(){return this.get(Hn)},n.prototype.getViewport=function(){return this.$i},n.prototype.getOverlayContainer=function(){return this.Qi},n.prototype.getOverlayContainerStopEvent=function(){return this.tr},n.prototype.getOwnerDocument=function(){var t=this.getTargetElement();return t?t.ownerDocument:document},n.prototype.getTilePriority=function(t,n,i,r){return yu(this.Yi,t,n,i,r)},n.prototype.handleBrowserEvent=function(t,n){var i=n||t.type,r=new ru(i,this,t);this.handleMapBrowserEvent(r)},n.prototype.handleMapBrowserEvent=function(t){if(this.Yi){var n=t.originalEvent,i=n.type;if(i===oi||i===ct||i===ut){var r=this.getOwnerDocument(),e=this.$i.getRootNode?this.$i.getRootNode():r,o=n.target;if(this.tr.contains(o)||!(e===r?r.documentElement:e).contains(o))return}if(t.frameState=this.Yi,!1!==this.dispatchEvent(t))for(var u=this.getInteractions().getArray().slice(),s=u.length-1;s>=0;s--){var a=u[s];if(a.getMap()===this&&a.getActive()&&this.getTargetElement())if(!a.handleEvent(t)||t.propagationStopped)break}}},n.prototype.handlePostRender=function(){var t=this.Yi,n=this.ar;if(!n.isEmpty()){var i=this.Li,r=i;if(t){var e=t.viewHints;if(e[mu]||e[wu]){var o=Date.now()-t.time>8;i=o?0:8,r=o?0:2}}n.getTilesLoading()<i&&(n.reprioritize(),n.loadMoreTiles(i,r))}t&&this.$&&!t.animate&&(!0===this.Ni?(this.hasListener(zn)&&this.$.dispatchRenderEvent(zn,t),!1===this.zi&&(this.zi=!0,this.dispatchEvent(new nu(qt,this,t)))):!0===this.zi&&(this.zi=!1,this.dispatchEvent(new nu(Ut,this,t))));for(var u=this.sr,s=0,a=u.length;s<a;++s)u[s](this,t);u.length=0},n.prototype.vr=function(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()},n.prototype.pr=function(){if(this.nr){for(var t=0,n=this.rr.length;t<n;++t)pt(this.rr[t]);this.rr=null,this.$i.removeEventListener(tt,this.Fi),this.$i.removeEventListener(ct,this.Fi),this.nr.dispose(),this.nr=null,en(this.$i)}var i=this.getTargetElement();if(i){for(var r in i.appendChild(this.$i),this.$||(this.$=this.createRenderer()),this.nr=new uu(this,this.Mn),eu)this.nr.addEventListener(eu[r],this.handleMapBrowserEvent.bind(this));this.$i.addEventListener(tt,this.Fi,!1),this.$i.addEventListener(ct,this.Fi,!!$t&&{passive:!1});var e=this.getOwnerDocument().defaultView,o=this.ir?this.ir:i;this.rr=[lt(o,ut,this.handleBrowserEvent,this),lt(o,st,this.handleBrowserEvent,this),lt(e,ft,this.updateSize,this)]}else this.$&&(clearTimeout(this.Di),this.Di=void 0,this.sr.length=0,this.$.dispose(),this.$=null),this.Ui&&(cancelAnimationFrame(this.Ui),this.Ui=void 0);this.updateSize()},n.prototype.hr=function(){this.render()},n.prototype.mr=function(){this.render()},n.prototype.lr=function(){this.Hi&&(pt(this.Hi),this.Hi=null),this.Ki&&(pt(this.Ki),this.Ki=null);var t=this.getView();t&&(this.wr(),this.Hi=lt(t,G,this.mr,this),this.Ki=lt(t,$,this.mr,this),t.resolveConstraints(0)),this.render()},n.prototype.cr=function(){this.Ji&&(this.Ji.forEach(pt),this.Ji=null);var t=this.getLayerGroup();t&&(this.yr(new Jo("addlayer",t)),this.Ji=[lt(t,G,this.render,this),lt(t,$,this.render,this),lt(t,"addlayer",this.yr,this),lt(t,"removelayer",this.br,this)]),this.render()},n.prototype.isRendered=function(){return!!this.Yi},n.prototype.renderSync=function(){this.Ui&&cancelAnimationFrame(this.Ui),this.qi()},n.prototype.redrawText=function(){for(var t=this.getLayerGroup().getLayerStatesArray(),n=0,i=t.length;n<i;++n){var r=t[n].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}},n.prototype.render=function(){this.$&&void 0===this.Ui&&(this.Ui=requestAnimationFrame(this.qi))},n.prototype.removeControl=function(t){return this.getControls().remove(t)},n.prototype.removeInteraction=function(t){return this.getInteractions().remove(t)},n.prototype.removeLayer=function(t){return this.getLayerGroup().getLayers().remove(t)},n.prototype.br=function(t){aa(t.layer)},n.prototype.removeOverlay=function(t){return this.getOverlays().remove(t)},n.prototype.Bi=function(t){var n=this,i=this.getSize(),r=this.getView(),e=this.Yi,o=null;if(void 0!==i&&ea(i)&&r&&r.isDef()){var u=r.getHints(this.Yi?this.Yi.viewHints:void 0),s=r.getState();if(o={animate:!1,coordinateToPixelTransform:this.Xi,declutterTree:null,extent:xr(s.center,s.resolution,s.rotation,i),index:this.Wi++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.Gi,pixelToCoordinateTransform:this.Vi,postRenderFunctions:[],size:i,tileQueue:this.ar,time:t,usedTiles:{},viewState:s,viewHints:u,wantedTiles:{},mapId:d(this),renderTargets:{}},s.nextCenter&&s.nextResolution){var a=isNaN(s.nextRotation)?s.rotation:s.nextRotation;o.nextExtent=xr(s.nextCenter,s.nextResolution,a,i)}}if(this.Yi=o,this.$.renderFrame(o),o){if(o.animate&&this.render(),Array.prototype.push.apply(this.sr,o.postRenderFunctions),e)(!this.Zi||!kr(this.Zi)&&!sr(o.extent,this.Zi))&&(this.dispatchEvent(new nu(Gt,this,e)),this.Zi=er(this.Zi));this.Zi&&!o.viewHints[mu]&&!o.viewHints[wu]&&!sr(o.extent,this.Zi)&&(this.dispatchEvent(new nu(Dt,this,o)),Ki(o.extent,this.Zi))}this.dispatchEvent(new nu(Lt,this,o)),this.Ni=this.hasListener(Ut)||this.hasListener(qt)||this.hasListener(zn)?!this.ar.getTilesLoading()&&!this.ar.getCount()&&!this.getLoadingOrNotReady():void 0,this.Di||(this.Di=setTimeout((function(){n.Di=void 0,n.handlePostRender()}),0))},n.prototype.setLayerGroup=function(t){var n=this.getLayerGroup();n&&this.br(new Jo("removelayer",n)),this.set(Wn,t)},n.prototype.setSize=function(t){this.set(Yn,t)},n.prototype.setTarget=function(t){this.set(Zn,t)},n.prototype.setView=function(t){if(!t||t instanceof ia)this.set(Hn,t);else{this.set(Hn,new ia);var n=this;t.then((function(t){n.setView(new ia(t))}))}},n.prototype.updateSize=function(){var t=this.getTargetElement(),n=void 0;if(t){var i=getComputedStyle(t),r=t.offsetWidth-parseFloat(i.borderLeftWidth)-parseFloat(i.paddingLeft)-parseFloat(i.paddingRight)-parseFloat(i.borderRightWidth),e=t.offsetHeight-parseFloat(i.borderTopWidth)-parseFloat(i.paddingTop)-parseFloat(i.paddingBottom)-parseFloat(i.borderBottomWidth);isNaN(r)||isNaN(e)||!ea(n=[r,e])&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&console.warn("No map visible because the map container's width or height are 0.")}this.setSize(n),this.wr()},n.prototype.wr=function(){var t=this.getView();if(t){var n=void 0,i=getComputedStyle(this.$i);i.width&&i.height&&(n=[parseInt(i.width,10),parseInt(i.height,10)]),t.setViewportSize(n)}},n}(xt),ca=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),la=.75,va=.1,pa=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return ca(n,t),n.prototype.createRenderer=function(){return new Po(this)},n}(ha),da=function(t){function n(n){var i=this,r=n||{};(i=t.call(this,{element:document.createElement("div"),render:r.render,target:r.target})||this).gr=i._r.bind(i),i.rt=void 0===r.collapsed||r.collapsed,i.ut=void 0===r.collapsible||r.collapsible,i.ut||(i.rt=!1),i.Mr=void 0!==r.rotateWithView&&r.rotateWithView,i.Sr=void 0;var e=void 0!==r.className?r.className:"ol-overviewmap",o=void 0!==r.tipLabel?r.tipLabel:"Overview map",u=void 0!==r.collapseLabel?r.collapseLabel:"‹";"string"==typeof u?(i.st=document.createElement("span"),i.st.textContent=u):i.st=u;var s=void 0!==r.label?r.label:"›";"string"==typeof s?(i.ft=document.createElement("span"),i.ft.textContent=s):i.ft=s;var a=i.ut&&!i.rt?i.st:i.ft,f=document.createElement("button");f.setAttribute("type","button"),f.title=o,f.appendChild(a),f.addEventListener(nt,i.ct.bind(i),!1),i.jr=document.createElement("div"),i.jr.className="ol-overviewmap-map",i.Er=r.view,i.kr=new pa({view:r.view});var h=i.kr;r.layers&&r.layers.forEach((function(t){h.addLayer(t)}));var c=document.createElement("div");c.className="ol-overviewmap-box",c.style.boxSizing="border-box",i.Tr=new Ho({position:[0,0],positioning:Fo,element:c}),i.kr.addOverlay(i.Tr);var l=e+" "+"ol-unselectable "+vn+(i.rt&&i.ut?" ol-collapsed":"")+(i.ut?"":" ol-uncollapsible"),v=i.element;v.className=l,v.appendChild(i.jr),v.appendChild(f);var p=i,d=i.Tr,y=i.Tr.getElement(),m=function(t){var n,i={clientX:(n=t).clientX,clientY:n.clientY},r=h.getEventCoordinateInternal(i);d.setPosition(r)},w=function t(n){var i=h.getEventCoordinateInternal(n);p.getMap().getView().setCenterInternal(i),window.removeEventListener("mousemove",m),window.removeEventListener("mouseup",t)};return y.addEventListener("mousedown",(function(){window.addEventListener("mousemove",m),window.addEventListener("mouseup",w)})),i}return ca(n,t),n.prototype.setMap=function(n){var i=this.getMap();if(n!==i){if(i){var r=i.getView();r&&this.Ar(r),this.kr.setTarget(null)}if(t.prototype.setMap.call(this,n),n){this.kr.setTarget(this.jr),this.listenerKeys.push(lt(n,G,this.Cr,this));var e=n.getView();e&&(this.Pr(e),e.isDef()&&(this.kr.updateSize(),this.Rr())),this.kr.isRendered()||this.Ir()}}},n.prototype.Cr=function(t){if(t.key===Hn){var n=t.oldValue;n&&this.Ar(n);var i=this.getMap().getView();this.Pr(i)}else this.kr.isRendered()||t.key!==Zn&&t.key!==Yn||this.kr.updateSize()},n.prototype.Pr=function(t){if(!this.Er){var n=new ia({projection:t.getProjection()});this.kr.setView(n)}t.addChangeListener(bu.ROTATION,this.gr),this._r()},n.prototype.Ar=function(t){t.removeChangeListener(bu.ROTATION,this.gr)},n.prototype._r=function(){this.Mr&&this.kr.getView().setRotation(this.getMap().getView().getRotation())},n.prototype.Nr=function(){var t=this.getMap(),n=this.kr;if(t.isRendered()&&n.isRendered()){var i=t.getSize(),r=t.getView().calculateExtentInternal(i);if(!this.Sr||!sr(r,this.Sr)){this.Sr=r;var e=n.getSize(),o=n.getView().calculateExtentInternal(e),u=n.getPixelFromCoordinateInternal(Or(r)),s=n.getPixelFromCoordinateInternal(wr(r)),a=Math.abs(u[0]-s[0]),f=Math.abs(u[1]-s[1]),h=e[0],c=e[1];a<h*va||f<c*va||a>h*la||f>c*la?this.Rr():Qi(o,r)||this.zr()}}},n.prototype.Rr=function(){var t=this.getMap(),n=this.kr,i=t.getSize(),r=t.getView().calculateExtentInternal(i),e=n.getView(),o=Math.log(7.5)/Math.LN2;Ar(r,1/(Math.pow(2,o/2)*va)),e.fitInternal(Ws(r))},n.prototype.zr=function(){var t=this.getMap(),n=this.kr,i=t.getView();n.getView().setCenterInternal(i.getCenterInternal())},n.prototype.Fr=function(){var t=this.getMap(),n=this.kr;if(t.isRendered()&&n.isRendered()){var i=t.getSize(),r=t.getView(),e=n.getView(),o=this.Mr?0:-r.getRotation(),u=this.Tr,s=this.Tr.getElement(),a=r.getCenterInternal(),f=r.getResolution(),h=e.getResolution(),c=i[0]*f/h,l=i[1]*f/h;if(u.setPosition(a),s){s.style.width=c+"px",s.style.height=l+"px";var v="rotate("+o+"rad)";s.style.transform=v}}},n.prototype.Ir=function(){this.Lr||(this.Lr=vt(this.kr,Lt,(function(t){delete this.Lr,this.Fr()}),this))},n.prototype.ct=function(t){t.preventDefault(),this.wt()},n.prototype.wt=function(){this.element.classList.toggle(pn),this.rt?rn(this.st,this.ft):rn(this.ft,this.st),this.rt=!this.rt;var t=this.kr;if(!this.rt){if(t.isRendered())return this.Sr=void 0,void t.render();t.updateSize(),this.Rr(),this.Ir()}},n.prototype.getCollapsible=function(){return this.ut},n.prototype.setCollapsible=function(t){this.ut!==t&&(this.ut=t,this.element.classList.toggle("ol-uncollapsible"),!t&&this.rt&&this.wt())},n.prototype.setCollapsed=function(t){this.ut&&this.rt!==t&&this.wt()},n.prototype.getCollapsed=function(){return this.rt},n.prototype.getRotateWithView=function(){return this.Mr},n.prototype.setRotateWithView=function(t){this.Mr!==t&&(this.Mr=t,0!==this.getMap().getView().getRotation()&&(this.Mr?this._r():this.kr.getView().setRotation(0),this.Sr=void 0,this.Nr(),this.Fr()))},n.prototype.getOverviewMap=function(){return this.kr},n.prototype.render=function(t){this.Nr(),this.Fr()},n}(an),ya=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ma=function(t){function n(n){var i=this,r=n||{};i=t.call(this,{element:document.createElement("div"),render:r.render,target:r.target})||this;var e=void 0!==r.className?r.className:"ol-rotate",o=void 0!==r.label?r.label:"⇧",u=void 0!==r.compassClassName?r.compassClassName:"ol-compass";i.ft=null,"string"==typeof o?(i.ft=document.createElement("span"),i.ft.className=u,i.ft.textContent=o):(i.ft=o,i.ft.classList.add(u));var s=r.tipLabel?r.tipLabel:"Reset rotation",a=document.createElement("button");a.className=e+"-reset",a.setAttribute("type","button"),a.title=s,a.appendChild(i.ft),a.addEventListener(nt,i.ct.bind(i),!1);var f=e+" "+"ol-unselectable "+vn,h=i.element;return h.className=f,h.appendChild(a),i.Gr=r.resetNorth?r.resetNorth:void 0,i.Dr=void 0!==r.duration?r.duration:250,i.Ur=void 0===r.autoHide||r.autoHide,i.qr=void 0,i.Ur&&i.element.classList.add(fn),i}return ya(n,t),n.prototype.ct=function(t){t.preventDefault(),void 0!==this.Gr?this.Gr():this.Br()},n.prototype.Br=function(){var t=this.getMap().getView();if(t){var n=t.getRotation();void 0!==n&&(this.Dr>0&&n%(2*Math.PI)!=0?t.animate({rotation:0,duration:this.Dr,easing:Cu}):t.setRotation(0))}},n.prototype.render=function(t){var n=t.frameState;if(n){var i=n.viewState.rotation;if(i!=this.qr){var r="rotate("+i+"rad)";if(this.Ur){var e=this.element.classList.contains(fn);e||0!==i?e&&0!==i&&this.element.classList.remove(fn):this.element.classList.add(fn)}this.ft.style.transform=r}this.qr=i}},n}(an),wa=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ba="units",ga="degrees",xa="imperial",_a="nautical",Ma="metric",Oa="us",Sa=[1,2,5],ja=25.4/.28,Ea=function(t){function n(n){var i=this,r=n||{},e=void 0!==r.className?r.className:r.bar?"ol-scale-bar":"ol-scale-line";return(i=t.call(this,{element:document.createElement("div"),render:r.render,target:r.target})||this).on,i.once,i.un,i.Xr=document.createElement("div"),i.Xr.className=e+"-inner",i.element.className=e+" "+cn,i.element.appendChild(i.Xr),i.Vr=null,i.Wr=void 0!==r.minWidth?r.minWidth:64,i.Yr=r.maxWidth,i.vt=!1,i.Zr=void 0,i.Zt="",i.addChangeListener(ba,i.Hr),i.setUnits(r.units||Ma),i.Kr=r.bar||!1,i.Jr=r.steps||4,i.$r=r.text||!1,i.Qr=r.dpi||void 0,i}return wa(n,t),n.prototype.getUnits=function(){return this.get(ba)},n.prototype.Hr=function(){this.yt()},n.prototype.setUnits=function(t){this.set(ba,t)},n.prototype.setDpi=function(t){this.Qr=t},n.prototype.yt=function(){var t=this.Vr;if(t){var n=t.center,i=t.projection,r=this.getUnits(),e=r==ga?li.DEGREES:li.METERS,o=fe(i,t.resolution,n,e),u=this.Wr*(this.Qr||ja)/ja,s=void 0!==this.Yr?this.Yr*(this.Qr||ja)/ja:void 0,a=u*o,f="";if(r==ga){var h=ci[li.DEGREES];(a*=h)<h/60?(f="″",o*=3600):a<h?(f="′",o*=60):f="°"}else r==xa?a<.9144?(f="in",o/=.0254):a<1609.344?(f="ft",o/=.3048):(f="mi",o/=1609.344):r==_a?(o/=1852,f="NM"):r==Ma?a<.001?(f="μm",o*=1e6):a<1?(f="mm",o*=1e3):a<1e3?f="m":(f="km",o/=1e3):r==Oa?a<.9144?(f="in",o*=39.37):a<1609.344?(f="ft",o/=.30480061):(f="mi",o/=1609.3472):g(!1,33);for(var c,l,v,p,d,y,m,w=3*Math.floor(Math.log(u*o)/Math.log(10));;){v=Math.floor(w/3);var b=Math.pow(10,v);if(c=Sa[(w%3+3)%3]*b,l=Math.round(c/o),isNaN(l))return this.element.style.display="none",void(this.vt=!1);if(void 0!==s&&l>=s){c=p,l=d,v=y;break}if(l>=u)break;p=c,d=l,y=v,++w}m=this.Kr?this.createScaleBar(l,c,f):c.toFixed(v<0?-v:0)+" "+f,this.Zt!=m&&(this.Xr.innerHTML=m,this.Zt=m),this.Zr!=l&&(this.Xr.style.width=l+"px",this.Zr=l),this.vt||(this.element.style.display="",this.vt=!0)}else this.vt&&(this.element.style.display="none",this.vt=!1)},n.prototype.createScaleBar=function(t,n,i){for(var r="1 : "+Math.round(this.getScaleForResolution()).toLocaleString(),e=[],o=t/this.Jr,u="#ffffff",s=0;s<this.Jr;s++)0===s&&e.push(this.createMarker("absolute",s)),e.push('<div><div class="ol-scale-singlebar" style="width: '+o+"px;background-color: "+u+';"></div>'+this.createMarker("relative",s)+(s%2==0||2===this.Jr?this.createStepText(s,t,!1,n,i):"")+"</div>"),s===this.Jr-1&&e.push(this.createStepText(s+1,t,!0,n,i)),u="#ffffff"===u?"#000000":"#ffffff";return'<div style="display: flex;">'+(this.$r?'<div class="ol-scale-text" style="width: '+t+'px;">'+r+"</div>":"")+e.join("")+"</div>"},n.prototype.createMarker=function(t,n){return'<div class="ol-scale-step-marker" style="position: '+t+";top: "+("absolute"===t?3:-10)+'px;"></div>'},n.prototype.createStepText=function(t,n,i,r,e){var o=(0===t?0:Math.round(r/this.Jr*t*100)/100)+(0===t?"":" "+e);return'<div class="ol-scale-step-text" style="margin-left: '+(0===t?-3:n/this.Jr*-1)+"px;text-align: "+(0===t?"left":"center")+"; min-width: "+(0===t?0:n/this.Jr*2)+"px;left: "+(i?n+"px":"unset")+';">'+o+"</div>"},n.prototype.getScaleForResolution=function(){var t=fe(this.Vr.projection,this.Vr.resolution,this.Vr.center,li.METERS),n=this.Qr||ja;return parseFloat(t.toString())*(1e3/25.4)*n},n.prototype.render=function(t){var n=t.frameState;this.Vr=n?n.viewState:null,this.yt()},n}(an),ka=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Ta=function(t){function n(n){var i=this,r=n||{};i=t.call(this,{element:document.createElement("div"),target:r.target})||this;var e=void 0!==r.className?r.className:"ol-zoom",o=void 0!==r.delta?r.delta:1,u=void 0!==r.zoomInClassName?r.zoomInClassName:e+"-in",s=void 0!==r.zoomOutClassName?r.zoomOutClassName:e+"-out",a=void 0!==r.zoomInLabel?r.zoomInLabel:"+",f=void 0!==r.zoomOutLabel?r.zoomOutLabel:"–",h=void 0!==r.zoomInTipLabel?r.zoomInTipLabel:"Zoom in",c=void 0!==r.zoomOutTipLabel?r.zoomOutTipLabel:"Zoom out",l=document.createElement("button");l.className=u,l.setAttribute("type","button"),l.title=h,l.appendChild("string"==typeof a?document.createTextNode(a):a),l.addEventListener(nt,i.ct.bind(i,o),!1);var v=document.createElement("button");v.className=s,v.setAttribute("type","button"),v.title=c,v.appendChild("string"==typeof f?document.createTextNode(f):f),v.addEventListener(nt,i.ct.bind(i,-o),!1);var p=e+" "+"ol-unselectable "+vn,d=i.element;return d.className=p,d.appendChild(l),d.appendChild(v),i.Dr=void 0!==r.duration?r.duration:250,i}return ka(n,t),n.prototype.ct=function(t,n){n.preventDefault(),this.te(t)},n.prototype.te=function(t){var n=this.getMap().getView();if(n){var i=n.getZoom();if(void 0!==i){var r=n.getConstrainedZoom(i+t);this.Dr>0?(n.getAnimating()&&n.cancelAnimations(),n.animate({zoom:r,duration:this.Dr,easing:Cu})):n.setZoom(r)}}},n}(an),Aa=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Ca=0,Pa=1,Ra=function(t){function n(n){var i=this,r=n||{};(i=t.call(this,{element:document.createElement("div"),render:r.render})||this)._n=[],i.ne=void 0,i.ie=Ca,i.xn,i.re=0,i.ee=0,i.oe,i.ue,i.se=null,i.ae=!1,i.Dr=void 0!==r.duration?r.duration:200;var e=void 0!==r.className?r.className:"ol-zoomslider",o=document.createElement("button");o.setAttribute("type","button"),o.className=e+"-thumb "+cn;var u=i.element;return u.className=e+" "+"ol-unselectable "+vn,u.appendChild(o),u.addEventListener(oi,i.fe.bind(i),!1),u.addEventListener(ei,i.he.bind(i),!1),u.addEventListener(ui,i.ce.bind(i),!1),u.addEventListener(nt,i.le.bind(i),!1),o.addEventListener(nt,F,!1),i}return Aa(n,t),n.prototype.setMap=function(n){t.prototype.setMap.call(this,n),n&&n.render()},n.prototype.ve=function(){var t=this.element,n=t.offsetWidth,i=t.offsetHeight;if(0===n&&0===i)return this.ae=!1;var r=getComputedStyle(t);n-=parseFloat(r.paddingRight)+parseFloat(r.paddingLeft),i-=parseFloat(r.paddingTop)+parseFloat(r.paddingBottom);var e=t.firstElementChild,o=getComputedStyle(e),u=e.offsetWidth+parseFloat(o.marginRight)+parseFloat(o.marginLeft),s=e.offsetHeight+parseFloat(o.marginTop)+parseFloat(o.marginBottom);return this.se=[u,s],n>i?(this.ie=Pa,this.ee=n-u):(this.ie=Ca,this.re=i-s),this.ae=!0},n.prototype.le=function(t){var n=this.getMap().getView(),i=this.pe(t.offsetX-this.se[0]/2,t.offsetY-this.se[1]/2),r=this.de(i),e=n.getConstrainedZoom(n.getZoomForResolution(r));n.animateInternal({zoom:e,duration:this.Dr,easing:Cu})},n.prototype.fe=function(t){if(!this.xn&&t.target===this.element.firstElementChild){var n=this.element.firstElementChild;if(this.getMap().getView().beginInteraction(),this.oe=t.clientX-parseFloat(n.style.left),this.ue=t.clientY-parseFloat(n.style.top),this.xn=!0,0===this._n.length){var i=this.he,r=this.ce,e=this.getMap().getOwnerDocument();this._n.push(lt(e,ei,i,this),lt(e,ui,r,this))}}},n.prototype.he=function(t){if(this.xn){var n=t.clientX-this.oe,i=t.clientY-this.ue,r=this.pe(n,i);this.ne=this.de(r),this.getMap().getView().setResolution(this.ne)}},n.prototype.ce=function(t){this.xn&&(this.getMap().getView().endInteraction(),this.xn=!1,this.oe=void 0,this.ue=void 0,this._n.forEach(pt),this._n.length=0)},n.prototype.ye=function(t){var n=this.me(t),i=this.element.firstElementChild;this.ie==Pa?i.style.left=this.ee*n+"px":i.style.top=this.re*n+"px"},n.prototype.pe=function(t,n){return x(this.ie===Pa?t/this.ee:n/this.re,0,1)},n.prototype.de=function(t){return this.getMap().getView().getResolutionForValueFunction()(1-t)},n.prototype.me=function(t){return x(1-this.getMap().getView().getValueForResolutionFunction()(t),0,1)},n.prototype.render=function(t){if(t.frameState&&(this.ae||this.ve())){var n=t.frameState.viewState.resolution;this.ne=n,this.ye(n)}},n}(an),Ia=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Na=function(t){function n(n){var i=this,r=n||{};(i=t.call(this,{element:document.createElement("div"),target:r.target})||this).extent=r.extent?r.extent:null;var e=void 0!==r.className?r.className:"ol-zoom-extent",o=void 0!==r.label?r.label:"E",u=void 0!==r.tipLabel?r.tipLabel:"Fit to extent",s=document.createElement("button");s.setAttribute("type","button"),s.title=u,s.appendChild("string"==typeof o?document.createTextNode(o):o),s.addEventListener(nt,i.ct.bind(i),!1);var a=e+" "+"ol-unselectable "+vn,f=i.element;return f.className=a,f.appendChild(s),i}return Ia(n,t),n.prototype.ct=function(t){t.preventDefault(),this.handleZoomToExtent()},n.prototype.handleZoomToExtent=function(){var t=this.getMap().getView(),n=this.extent?this.extent:t.getProjection().getExtent();t.fitInternal(Ws(n))},n}(an);function za(t){var n=t||{},i=new Et;return(void 0===n.zoom||n.zoom)&&i.push(new Ta(n.zoomOptions)),(void 0===n.rotate||n.rotate)&&i.push(new ma(n.rotateOptions)),(void 0===n.attribution||n.attribution)&&i.push(new Vn(n.attributionOptions)),i}var Fa=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),La=function(t){function n(n,i,r){var e=t.call(this)||this,o=r||{};return e.tileCoord=n,e.state=i,e.interimTile=null,e.key="",e.we=void 0===o.transition?250:o.transition,e.be={},e.interpolate=!!o.interpolate,e}return Fa(n,t),n.prototype.changed=function(){this.dispatchEvent($)},n.prototype.release=function(){},n.prototype.getKey=function(){return this.key+"/"+this.tileCoord},n.prototype.getInterimTile=function(){if(!this.interimTile)return this;var t=this.interimTile;do{if(t.getState()==cu)return this.we=0,t;t=t.interimTile}while(t);return this},n.prototype.refreshInterimChain=function(){if(this.interimTile){var t=this.interimTile,n=this;do{if(t.getState()==cu){t.interimTile=null;break}t.getState()==hu?n=t:t.getState()==fu?n.interimTile=t.interimTile:n=t,t=n.interimTile}while(t)}},n.prototype.getTileCoord=function(){return this.tileCoord},n.prototype.getState=function(){return this.state},n.prototype.setState=function(t){if(this.state!==lu&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()},n.prototype.load=function(){v()},n.prototype.getAlpha=function(t,n){if(!this.we)return 1;var i=this.be[t];if(i){if(-1===i)return 1}else i=n,this.be[t]=i;var r=n-i+1e3/60;return r>=this.we?1:Au(r/this.we)},n.prototype.inTransition=function(t){return!!this.we&&-1!==this.be[t]},n.prototype.endTransition=function(t){this.we&&(this.be[t]=-1)},n}(J),Ga=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Da=function(t){function n(n){var i=this,r=fu;return(i=t.call(this,n.tileCoord,r,{transition:n.transition,interpolate:n.interpolate})||this).ge=n.loader,i.xe=null,i._e=null,i.Me=n.size||[256,256],i}return Ga(n,t),n.prototype.getSize=function(){return this.Me},n.prototype.getData=function(){return this.xe},n.prototype.getError=function(){return this._e},n.prototype.load=function(){if(this.state===fu||this.state===lu){this.state=hu,this.changed();var t=this;this.ge().then((function(n){t.xe=n,t.state=cu,t.changed()})).catch((function(n){t._e=n,t.state=lu,t.changed()}))}},n}(La);function Ua(t){var n=arguments;return function(t){for(var i=!0,r=0,e=n.length;r<e&&(i=i&&n[r](t));++r);return i}}var qa=function(t){var n=t.originalEvent;return n.altKey&&!(n.metaKey||n.ctrlKey)&&!n.shiftKey},Ba=function(t){var n=t.originalEvent;return n.altKey&&!(n.metaKey||n.ctrlKey)&&n.shiftKey},Xa=function(t){var n=t.map.getTargetElement(),i=t.map.getOwnerDocument().activeElement;return n.contains(i)},Va=function(t){return!t.map.getTargetElement().hasAttribute("tabindex")||Xa(t)},Wa=U,Ya=function(t){var n=t.originalEvent;return 0==n.button&&!(Yt&&Zt&&n.ctrlKey)},Za=q,Ha=function(t){return t.type==eu.SINGLECLICK},Ka=function(t){var n=t.originalEvent;return!n.altKey&&!(n.metaKey||n.ctrlKey)&&!n.shiftKey},Ja=function(t){var n=t.originalEvent;return!n.altKey&&!(n.metaKey||n.ctrlKey)&&n.shiftKey},$a=function(t){var n=t.originalEvent.target.tagName;return"INPUT"!==n&&"SELECT"!==n&&"TEXTAREA"!==n},Qa=function(t){var n=t.originalEvent;return g(void 0!==n,56),"mouse"==n.pointerType},tf=function(t){var n=t.originalEvent;return g(void 0!==n,56),n.isPrimary&&0===n.button},nf=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();function rf(t){return"function"==typeof t?t:(Array.isArray(t)?n=t:(g("function"==typeof t.getZIndex,41),n=[t]),function(){return n});var n}var ef=function(t){function n(n){var i=t.call(this)||this;if(i.on,i.once,i.un,i.Oe=void 0,i.Se="geometry",i.je=null,i.Ee=void 0,i.ke=null,i.addChangeListener(i.Se,i.Te),n)if("function"==typeof n.getSimplifiedGeometry){var r=n;i.setGeometry(r)}else{var e=n;i.setProperties(e)}return i}return nf(n,t),n.prototype.clone=function(){var t=new n(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());var i=this.getGeometry();i&&t.setGeometry(i.clone());var r=this.getStyle();return r&&t.setStyle(r),t},n.prototype.getGeometry=function(){return this.get(this.Se)},n.prototype.getId=function(){return this.Oe},n.prototype.getGeometryName=function(){return this.Se},n.prototype.getStyle=function(){return this.je},n.prototype.getStyleFunction=function(){return this.Ee},n.prototype.Ae=function(){this.changed()},n.prototype.Te=function(){this.ke&&(pt(this.ke),this.ke=null);var t=this.getGeometry();t&&(this.ke=lt(t,$,this.Ae,this)),this.changed()},n.prototype.setGeometry=function(t){this.set(this.Se,t)},n.prototype.setStyle=function(t){this.je=t,this.Ee=t?rf(t):void 0,this.changed()},n.prototype.setId=function(t){this.Oe=t,this.changed()},n.prototype.setGeometryName=function(t){this.removeChangeListener(this.Se,this.Te),this.Se=t,this.addChangeListener(this.Se,this.Te),this.Te()},n}(xt),of="arraybuffer",uf="json",sf="text",af="xml",ff=!1;function hf(t,n,i,r,e,o,u){var s=new XMLHttpRequest;s.open("GET","function"==typeof t?t(i,r,e):t,!0),n.getType()==of&&(s.responseType="arraybuffer"),s.withCredentials=ff,s.onload=function(t){if(!s.status||s.status>=200&&s.status<300){var r=n.getType(),a=void 0;r==uf||r==sf?a=s.responseText:r==af?(a=s.responseXML)||(a=(new DOMParser).parseFromString(s.responseText,"application/xml")):r==of&&(a=s.response),a?o(n.readFeatures(a,{extent:i,featureProjection:e}),n.readProjection(a)):u()}else u()},s.onerror=u,s.send()}function cf(t,n){return function(i,r,e,o,u){var s=this;hf(t,n,i,r,e,(function(t,n){s.addFeatures(t),void 0!==o&&o(t)}),u||B)}}var lf=function(){function t(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.supportedMediaTypes=null}return t.prototype.getReadOptions=function(t,n){var i;if(n){var r=n.dataProjection?ae(n.dataProjection):this.readProjection(t);n.extent&&r&&r.getUnits()===li.TILE_PIXELS&&(r=ae(r)).setWorldExtent(n.extent),i={dataProjection:r,featureProjection:n.featureProjection}}return this.adaptOptions(i)},t.prototype.adaptOptions=function(t){return W({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection},t)},t.prototype.getType=function(){return v()},t.prototype.readFeature=function(t,n){return v()},t.prototype.readFeatures=function(t,n){return v()},t.prototype.readGeometry=function(t,n){return v()},t.prototype.readProjection=function(t){return v()},t.prototype.writeFeature=function(t,n){return v()},t.prototype.writeFeatures=function(t,n){return v()},t.prototype.writeGeometry=function(t,n){return v()},t}();function vf(t,n,i){var r,e=i?ae(i.featureProjection):null,o=i?ae(i.dataProjection):null;if(r=e&&o&&!ye(e,o)?(n?t.clone():t).transform(n?e:o,n?o:e):t,n&&i&&void 0!==i.decimals){var u=Math.pow(10,i.decimals);r===t&&(r=t.clone()),r.applyTransform((function(t){for(var n=0,i=t.length;n<i;++n)t[n]=Math.round(t[n]*u)/u;return t}))}return r}function pf(t,n){var i=n?ae(n.featureProjection):null,r=n?ae(n.dataProjection):null;return i&&r&&!ye(i,r)?ge(t,r,i):t}var df=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();function yf(t){if("string"==typeof t){var n=JSON.parse(t);return n||null}return null!==t?t:null}var mf=function(t){function n(){return t.call(this)||this}return df(n,t),n.prototype.getType=function(){return uf},n.prototype.readFeature=function(t,n){return this.readFeatureFromObject(yf(t),this.getReadOptions(t,n))},n.prototype.readFeatures=function(t,n){return this.readFeaturesFromObject(yf(t),this.getReadOptions(t,n))},n.prototype.readFeatureFromObject=function(t,n){return v()},n.prototype.readFeaturesFromObject=function(t,n){return v()},n.prototype.readGeometry=function(t,n){return this.readGeometryFromObject(yf(t),this.getReadOptions(t,n))},n.prototype.readGeometryFromObject=function(t,n){return v()},n.prototype.readProjection=function(t){return this.readProjectionFromObject(yf(t))},n.prototype.readProjectionFromObject=function(t){return v()},n.prototype.writeFeature=function(t,n){return JSON.stringify(this.writeFeatureObject(t,n))},n.prototype.writeFeatureObject=function(t,n){return v()},n.prototype.writeFeatures=function(t,n){return JSON.stringify(this.writeFeaturesObject(t,n))},n.prototype.writeFeaturesObject=function(t,n){return v()},n.prototype.writeGeometry=function(t,n){return JSON.stringify(this.writeGeometryObject(t,n))},n.prototype.writeGeometryObject=function(t,n){return v()},n}(lf);function wf(t,n,i,e,o,u,s){var a,f,h=(i-n)/e;if(1===h)a=n;else if(2===h)a=n,f=o;else if(0!==h){for(var c=t[n],l=t[n+1],v=0,p=[0],d=n+e;d<i;d+=e){var y=t[d],m=t[d+1];v+=Math.sqrt((y-c)*(y-c)+(m-l)*(m-l)),p.push(v),c=y,l=m}var w=o*v,b=r(p,w);b<0?(f=(w-p[-b-2])/(p[-b-1]-p[-b-2]),a=n+(-b-2)*e):a=n+b*e}var g=s>1?s:2,x=u||new Array(g);for(d=0;d<g;++d)x[d]=void 0===a?NaN:void 0===f?t[a+d]:A(t[a+d],t[a+e+d],f);return x}function bf(t,n,i,r,e,o){if(i==n)return null;var u;if(e<t[n+r-1])return o?((u=t.slice(n,n+r))[r-1]=e,u):null;if(t[i-1]<e)return o?((u=t.slice(i-r,i))[r-1]=e,u):null;if(e==t[n+r-1])return t.slice(n,n+r);for(var s=n/r,a=i/r;s<a;){var f=s+a>>1;e<t[(f+1)*r-1]?a=f:s=f+1}var h=t[s*r-1];if(e==h)return t.slice((s-1)*r,(s-1)*r+r);var c=(e-h)/(t[(s+1)*r-1]-h);u=[];for(var l=0;l<r-1;++l)u.push(A(t[(s-1)*r+l],t[s*r+l],c));return u.push(e),u}function gf(t,n,i,r,e,o,u){if(u)return bf(t,n,i[i.length-1],r,e,o);var s;if(e<t[r-1])return o?((s=t.slice(0,r))[r-1]=e,s):null;if(t[t.length-1]<e)return o?((s=t.slice(t.length-r))[r-1]=e,s):null;for(var a=0,f=i.length;a<f;++a){var h=i[a];if(n!=h){if(e<t[n+r-1])return null;if(e<=t[h-1])return bf(t,n,h,r,e,!1);n=h}}return null}function xf(t,n,i,r){for(var e=t[n],o=t[n+1],u=0,s=n+r;s<i;s+=r){var a=t[s],f=t[s+1];u+=Math.sqrt((a-e)*(a-e)+(f-o)*(f-o)),e=a,o=f}return u}var _f=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Mf=function(t){function n(n,i){var r=t.call(this)||this;return r.Ce=null,r.Pe=-1,r.ii=-1,r.ri=-1,void 0===i||Array.isArray(n[0])?r.setCoordinates(n,i):r.setFlatCoordinates(i,n),r}return _f(n,t),n.prototype.appendCoordinate=function(t){this.flatCoordinates?a(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()},n.prototype.clone=function(){var t=new n(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t},n.prototype.closestPointXY=function(t,n,i,r){return r<Ji(this.getExtent(),t,n)?r:(this.ri!=this.getRevision()&&(this.ii=Math.sqrt(Ku(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.ri=this.getRevision()),Qu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.ii,!1,t,n,i,r))},n.prototype.forEachSegment=function(t){return Ts(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},n.prototype.getCoordinateAtM=function(t,n){if(this.layout!=zu&&this.layout!=Fu)return null;var i=void 0!==n&&n;return bf(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i)},n.prototype.getCoordinates=function(){return vs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},n.prototype.getCoordinateAt=function(t,n){return wf(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,n,this.stride)},n.prototype.getLength=function(){return xf(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},n.prototype.getFlatMidpoint=function(){return this.Pe!=this.getRevision()&&(this.Ce=this.getCoordinateAt(.5,this.Ce),this.Pe=this.getRevision()),this.Ce},n.prototype.getSimplifiedGeometryInternal=function(t){var i=[];return i.length=us(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0),new n(i,Iu)},n.prototype.getType=function(){return Kr.LINE_STRING},n.prototype.intersectsExtent=function(t){return As(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},n.prototype.setCoordinates=function(t,n){this.setLayout(n,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=rs(this.flatCoordinates,0,t,this.stride),this.changed()},n}(Zu),Of=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Sf=function(t){function n(n,i,r){var e=t.call(this)||this;if(e.ei=[],e.ii=-1,e.ri=-1,Array.isArray(n[0]))e.setCoordinates(n,i);else if(void 0!==i&&r)e.setFlatCoordinates(i,n),e.ei=r;else{for(var o=e.getLayout(),u=n,s=[],f=[],h=0,c=u.length;h<c;++h){var l=u[h];0===h&&(o=l.getLayout()),a(s,l.getFlatCoordinates()),f.push(s.length)}e.setFlatCoordinates(o,s),e.ei=f}return e}return Of(n,t),n.prototype.appendLineString=function(t){this.flatCoordinates?a(this.flatCoordinates,t.getFlatCoordinates().slice()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ei.push(this.flatCoordinates.length),this.changed()},n.prototype.clone=function(){var t=new n(this.flatCoordinates.slice(),this.layout,this.ei.slice());return t.applyProperties(this),t},n.prototype.closestPointXY=function(t,n,i,r){return r<Ji(this.getExtent(),t,n)?r:(this.ri!=this.getRevision()&&(this.ii=Math.sqrt(Ju(this.flatCoordinates,0,this.ei,this.stride,0)),this.ri=this.getRevision()),ts(this.flatCoordinates,0,this.ei,this.stride,this.ii,!1,t,n,i,r))},n.prototype.getCoordinateAtM=function(t,n,i){if(this.layout!=zu&&this.layout!=Fu||0===this.flatCoordinates.length)return null;var r=void 0!==n&&n,e=void 0!==i&&i;return gf(this.flatCoordinates,0,this.ei,this.stride,t,r,e)},n.prototype.getCoordinates=function(){return ps(this.flatCoordinates,0,this.ei,this.stride)},n.prototype.getEnds=function(){return this.ei},n.prototype.getLineString=function(t){return t<0||this.ei.length<=t?null:new Mf(this.flatCoordinates.slice(0===t?0:this.ei[t-1],this.ei[t]),this.layout)},n.prototype.getLineStrings=function(){for(var t=this.flatCoordinates,n=this.ei,i=this.layout,r=[],e=0,o=0,u=n.length;o<u;++o){var s=n[o],a=new Mf(t.slice(e,s),i);r.push(a),e=s}return r},n.prototype.getFlatMidpoints=function(){for(var t=[],n=this.flatCoordinates,i=0,r=this.ei,e=this.stride,o=0,u=r.length;o<u;++o){var s=r[o];a(t,wf(n,i,s,e,.5)),i=s}return t},n.prototype.getSimplifiedGeometryInternal=function(t){var i=[],r=[];return i.length=ss(this.flatCoordinates,0,this.ei,this.stride,t,i,0,r),new n(i,Iu,r)},n.prototype.getType=function(){return Kr.MULTI_LINE_STRING},n.prototype.intersectsExtent=function(t){return Cs(this.flatCoordinates,0,this.ei,this.stride,t)},n.prototype.setCoordinates=function(t,n){this.setLayout(n,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var i=es(this.flatCoordinates,0,t,this.stride,this.ei);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()},n}(Zu),jf=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Ef=function(t){function n(n,i){var r=t.call(this)||this;return i&&!Array.isArray(n[0])?r.setFlatCoordinates(i,n):r.setCoordinates(n,i),r}return jf(n,t),n.prototype.appendPoint=function(t){this.flatCoordinates?a(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.changed()},n.prototype.clone=function(){var t=new n(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t},n.prototype.closestPointXY=function(t,n,i,r){if(r<Ji(this.getExtent(),t,n))return r;for(var e=this.flatCoordinates,o=this.stride,u=0,s=e.length;u<s;u+=o){var a=S(t,n,e[u],e[u+1]);if(a<r){r=a;for(var f=0;f<o;++f)i[f]=e[u+f];i.length=o}}return r},n.prototype.getCoordinates=function(){return vs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},n.prototype.getPoint=function(t){var n=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return t<0||n<=t?null:new _s(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)},n.prototype.getPoints=function(){for(var t=this.flatCoordinates,n=this.layout,i=this.stride,r=[],e=0,o=t.length;e<o;e+=i){var u=new _s(t.slice(e,e+i),n);r.push(u)}return r},n.prototype.getType=function(){return Kr.MULTI_POINT},n.prototype.intersectsExtent=function(t){for(var n=this.flatCoordinates,i=this.stride,r=0,e=n.length;r<e;r+=i){if(tr(t,n[r],n[r+1]))return!0}return!1},n.prototype.setCoordinates=function(t,n){this.setLayout(n,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=rs(this.flatCoordinates,0,t,this.stride),this.changed()},n}(Zu);function kf(t,n,i,r){for(var e=[],o=[1/0,1/0,-1/0,-1/0],u=0,s=i.length;u<s;++u){var a=i[u];o=ur(t,n,a[0],r),e.push((o[0]+o[2])/2,(o[1]+o[3])/2),n=a[a.length-1]}return e}var Tf=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Af=function(t){function n(n,i,r){var e=t.call(this)||this;if(e.Re=[],e.Ne=-1,e.ze=null,e.ii=-1,e.ri=-1,e.si=-1,e.ai=null,!r&&!Array.isArray(n[0])){for(var o=e.getLayout(),u=n,s=[],f=[],h=0,c=u.length;h<c;++h){var l=u[h];0===h&&(o=l.getLayout());for(var v=s.length,p=l.getEnds(),d=0,y=p.length;d<y;++d)p[d]+=v;a(s,l.getFlatCoordinates()),f.push(p)}i=o,n=s,r=f}return void 0!==i&&r?(e.setFlatCoordinates(i,n),e.Re=r):e.setCoordinates(n,i),e}return Tf(n,t),n.prototype.appendPolygon=function(t){var n;if(this.flatCoordinates){var i=this.flatCoordinates.length;a(this.flatCoordinates,t.getFlatCoordinates());for(var r=0,e=(n=t.getEnds().slice()).length;r<e;++r)n[r]+=i}else this.flatCoordinates=t.getFlatCoordinates().slice(),n=t.getEnds().slice(),this.Re.push();this.Re.push(n),this.changed()},n.prototype.clone=function(){for(var t=this.Re.length,i=new Array(t),r=0;r<t;++r)i[r]=this.Re[r].slice();var e=new n(this.flatCoordinates.slice(),this.layout,i);return e.applyProperties(this),e},n.prototype.closestPointXY=function(t,n,i,r){return r<Ji(this.getExtent(),t,n)?r:(this.ri!=this.getRevision()&&(this.ii=Math.sqrt($u(this.flatCoordinates,0,this.Re,this.stride,0)),this.ri=this.getRevision()),ns(this.getOrientedFlatCoordinates(),0,this.Re,this.stride,this.ii,!0,t,n,i,r))},n.prototype.containsXY=function(t,n){return js(this.getOrientedFlatCoordinates(),0,this.Re,this.stride,t,n)},n.prototype.getArea=function(){return ws(this.getOrientedFlatCoordinates(),0,this.Re,this.stride)},n.prototype.getCoordinates=function(t){var n;return void 0!==t?Ds(n=this.getOrientedFlatCoordinates().slice(),0,this.Re,this.stride,t):n=this.flatCoordinates,ds(n,0,this.Re,this.stride)},n.prototype.getEndss=function(){return this.Re},n.prototype.getFlatInteriorPoints=function(){if(this.Ne!=this.getRevision()){var t=kf(this.flatCoordinates,0,this.Re,this.stride);this.ze=ks(this.getOrientedFlatCoordinates(),0,this.Re,this.stride,t),this.Ne=this.getRevision()}return this.ze},n.prototype.getInteriorPoints=function(){return new Ef(this.getFlatInteriorPoints().slice(),zu)},n.prototype.getOrientedFlatCoordinates=function(){if(this.si!=this.getRevision()){var t=this.flatCoordinates;Ls(t,0,this.Re,this.stride)?this.ai=t:(this.ai=t.slice(),this.ai.length=Ds(this.ai,0,this.Re,this.stride)),this.si=this.getRevision()}return this.ai},n.prototype.getSimplifiedGeometryInternal=function(t){var i=[],r=[];return i.length=ls(this.flatCoordinates,0,this.Re,this.stride,Math.sqrt(t),i,0,r),new n(i,Iu,r)},n.prototype.getPolygon=function(t){if(t<0||this.Re.length<=t)return null;var n;if(0===t)n=0;else{var i=this.Re[t-1];n=i[i.length-1]}var r=this.Re[t].slice(),e=r[r.length-1];if(0!==n)for(var o=0,u=r.length;o<u;++o)r[o]-=n;return new Xs(this.flatCoordinates.slice(n,e),this.layout,r)},n.prototype.getPolygons=function(){for(var t=this.layout,n=this.flatCoordinates,i=this.Re,r=[],e=0,o=0,u=i.length;o<u;++o){var s=i[o].slice(),a=s[s.length-1];if(0!==e)for(var f=0,h=s.length;f<h;++f)s[f]-=e;var c=new Xs(n.slice(e,a),t,s);r.push(c),e=a}return r},n.prototype.getType=function(){return Kr.MULTI_POLYGON},n.prototype.intersectsExtent=function(t){return Is(this.getOrientedFlatCoordinates(),0,this.Re,this.stride,t)},n.prototype.setCoordinates=function(t,n){this.setLayout(n,t,3),this.flatCoordinates||(this.flatCoordinates=[]);var i=os(this.flatCoordinates,0,t,this.stride,this.Re);if(0===i.length)this.flatCoordinates.length=0;else{var r=i[i.length-1];this.flatCoordinates.length=0===r.length?0:r[r.length-1]}this.changed()},n}(Zu),Cf=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Pf={};Pf[Kr.POINT]=function(t){var n;n=void 0!==t.m&&void 0!==t.z?new _s([t.x,t.y,t.z,t.m],Fu):void 0!==t.z?new _s([t.x,t.y,t.z],Nu):void 0!==t.m?new _s([t.x,t.y,t.m],zu):new _s([t.x,t.y]);return n},Pf[Kr.LINE_STRING]=function(t){var n=Nf(t);return new Mf(t.paths[0],n)},Pf[Kr.POLYGON]=function(t){var n=Nf(t);return new Xs(t.rings,n)},Pf[Kr.MULTI_POINT]=function(t){var n=Nf(t);return new Ef(t.points,n)},Pf[Kr.MULTI_LINE_STRING]=function(t){var n=Nf(t);return new Sf(t.paths,n)},Pf[Kr.MULTI_POLYGON]=function(t){var n=Nf(t);return new Af(t.rings,n)};var Rf={};function If(t,n){var i,r,e;if(!t)return null;if("number"==typeof t.x&&"number"==typeof t.y)e=Kr.POINT;else if(t.points)e=Kr.MULTI_POINT;else if(t.paths){e=1===t.paths.length?Kr.LINE_STRING:Kr.MULTI_LINE_STRING}else if(t.rings){var o=t,u=Nf(o),s=function(t,n){var i,r,e=[],o=[],u=[];for(i=0,r=t.length;i<r;++i){e.length=0,rs(e,0,t[i],n.length),zs(e,0,e.length,n.length)?o.push([t[i]]):u.push(t[i])}for(;u.length;){var s=u.shift(),a=!1;for(i=o.length-1;i>=0;i--){var f=o[i][0];if(Qi(new gs(f).getExtent(),new gs(s).getExtent())){o[i].push(s),a=!0;break}}a||o.push([s.reverse()])}return o}(o.rings,u);1===s.length?(e=Kr.POLYGON,t=W({},t,((i={}).rings=s[0],i))):(e=Kr.MULTI_POLYGON,t=W({},t,((r={}).rings=s,r)))}return vf((0,Pf[e])(t),!1,n)}function Nf(t){var n=Iu;return!0===t.hasZ&&!0===t.hasM?n=Fu:!0===t.hasZ?n=Nu:!0===t.hasM&&(n=zu),n}function zf(t){var n=t.getLayout();return{hasZ:n===Nu||n===Fu,hasM:n===zu||n===Fu}}function Ff(t,n){return(0,Rf[t.getType()])(vf(t,!0,n),n)}Rf[Kr.POINT]=function(t,n){var i,r=t.getCoordinates(),e=t.getLayout();e===Nu?i={x:r[0],y:r[1],z:r[2]}:e===zu?i={x:r[0],y:r[1],m:r[2]}:e===Fu?i={x:r[0],y:r[1],z:r[2],m:r[3]}:e===Iu?i={x:r[0],y:r[1]}:g(!1,34);return i},Rf[Kr.LINE_STRING]=function(t,n){var i=zf(t);return{hasZ:i.hasZ,hasM:i.hasM,paths:[t.getCoordinates()]}},Rf[Kr.POLYGON]=function(t,n){var i=zf(t);return{hasZ:i.hasZ,hasM:i.hasM,rings:t.getCoordinates(!1)}},Rf[Kr.MULTI_POINT]=function(t,n){var i=zf(t);return{hasZ:i.hasZ,hasM:i.hasM,points:t.getCoordinates()}},Rf[Kr.MULTI_LINE_STRING]=function(t,n){var i=zf(t);return{hasZ:i.hasZ,hasM:i.hasM,paths:t.getCoordinates()}},Rf[Kr.MULTI_POLYGON]=function(t,n){for(var i=zf(t),r=t.getCoordinates(!1),e=[],o=0;o<r.length;o++)for(var u=r[o].length-1;u>=0;u--)e.push(r[o][u]);return{hasZ:i.hasZ,hasM:i.hasM,rings:e}};var Lf=function(t){function n(n){var i=this,r=n||{};return(i=t.call(this)||this).Se=r.geometryName,i}return Cf(n,t),n.prototype.readFeatureFromObject=function(t,n,i){var r=t,e=If(r.geometry,n),o=new ef;if(this.Se&&o.setGeometryName(this.Se),o.setGeometry(e),r.attributes){o.setProperties(r.attributes,!0);var u=r.attributes[i];void 0!==u&&o.setId(u)}return o},n.prototype.readFeaturesFromObject=function(t,n){var i=n||{};if(t.features){for(var r=[],e=t.features,o=0,u=e.length;o<u;++o)r.push(this.readFeatureFromObject(e[o],i,t.objectIdFieldName));return r}return[this.readFeatureFromObject(t,i)]},n.prototype.readGeometryFromObject=function(t,n){return If(t,n)},n.prototype.readProjectionFromObject=function(t){return t.spatialReference&&void 0!==t.spatialReference.wkid?ae("EPSG:"+t.spatialReference.wkid):null},n.prototype.writeGeometryObject=function(t,n){return Ff(t,this.adaptOptions(n))},n.prototype.writeFeatureObject=function(t,n){n=this.adaptOptions(n);var i={};if(!t.hasProperties())return i.attributes={},i;var r=t.getProperties(),e=t.getGeometry();if(e){i.geometry=Ff(e,n);var o=n&&(n.dataProjection||n.featureProjection);o&&(i.geometry.spatialReference={wkid:Number(ae(o).getCode().split(":").pop())}),delete r[t.getGeometryName()]}return H(r)?i.attributes={}:i.attributes=r,i},n.prototype.writeFeaturesObject=function(t,n){n=this.adaptOptions(n);for(var i=[],r=0,e=t.length;r<e;++r)i.push(this.writeFeatureObject(t[r],n));return{features:i}},n}(mf),Gf=function(){function t(t){this.Fe=t}return t.prototype.getTagName=function(){return this.Fe},t}(),Df=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Uf=function(t){function n(n,i){var r=t.call(this,n)||this;return r.conditions=i,g(r.conditions.length>=2,57),r}return Df(n,t),n}(Gf),qf=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Bf=function(t){function n(n){return t.call(this,"And",Array.prototype.slice.call(arguments))||this}return qf(n,t),n}(Uf),Xf=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Vf=function(t){function n(n,i,r){var e=t.call(this,"BBOX")||this;if(e.geometryName=n,e.extent=i,4!==i.length)throw new Error("Expected an extent with four values ([minX, minY, maxX, maxY])");return e.srsName=r,e}return Xf(n,t),n}(Gf),Wf=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Yf=function(t){function n(n,i){var r=t.call(this,n)||this;return r.propertyName=i,r}return Wf(n,t),n}(Gf),Zf=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Hf=function(t){function n(n,i,r,e){var o=t.call(this,n,i)||this;return o.expression=r,o.matchCase=e,o}return Zf(n,t),n}(Yf),Kf=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Jf=function(t){function n(n,i,r,e){var o=t.call(this,n)||this;return o.geometryName=i||"the_geom",o.geometry=r,o.srsName=e,o}return Kf(n,t),n}(Gf),$f=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Qf=function(t){function n(n,i,r){return t.call(this,"Contains",n,i,r)||this}return $f(n,t),n}(Jf),th=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),nh=function(t){function n(n,i,r){return t.call(this,"Disjoint",n,i,r)||this}return th(n,t),n}(Jf),ih=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),rh=function(t){function n(n,i,r){var e=t.call(this,"During",n)||this;return e.begin=i,e.end=r,e}return ih(n,t),n}(Yf),eh=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),oh=function(t){function n(n,i,r,e,o){var u=t.call(this,"DWithin",n,i,o)||this;return u.distance=r,u.unit=e,u}return eh(n,t),n}(Jf),uh=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),sh=function(t){function n(n,i,r){return t.call(this,"PropertyIsEqualTo",n,i,r)||this}return uh(n,t),n}(Hf),ah=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),fh=function(t){function n(n,i){return t.call(this,"PropertyIsGreaterThan",n,i)||this}return ah(n,t),n}(Hf),hh=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ch=function(t){function n(n,i){return t.call(this,"PropertyIsGreaterThanOrEqualTo",n,i)||this}return hh(n,t),n}(Hf),lh=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),vh=function(t){function n(n,i,r){return t.call(this,"Intersects",n,i,r)||this}return lh(n,t),n}(Jf),ph=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),dh=function(t){function n(n,i,r){var e=t.call(this,"PropertyIsBetween",n)||this;return e.lowerBoundary=i,e.upperBoundary=r,e}return ph(n,t),n}(Yf),yh=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),mh=function(t){function n(n,i,r,e,o,u){var s=t.call(this,"PropertyIsLike",n)||this;return s.pattern=i,s.wildCard=void 0!==r?r:"*",s.singleChar=void 0!==e?e:".",s.escapeChar=void 0!==o?o:"!",s.matchCase=u,s}return yh(n,t),n}(Yf),wh=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),bh=function(t){function n(n){return t.call(this,"PropertyIsNull",n)||this}return wh(n,t),n}(Yf),gh=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),xh=function(t){function n(n,i){return t.call(this,"PropertyIsLessThan",n,i)||this}return gh(n,t),n}(Hf),_h=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Mh=function(t){function n(n,i){return t.call(this,"PropertyIsLessThanOrEqualTo",n,i)||this}return _h(n,t),n}(Hf),Oh=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Sh=function(t){function n(n){var i=t.call(this,"Not")||this;return i.condition=n,i}return Oh(n,t),n}(Gf),jh=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Eh=function(t){function n(n,i,r){return t.call(this,"PropertyIsNotEqualTo",n,i,r)||this}return jh(n,t),n}(Hf),kh=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Th=function(t){function n(n){return t.call(this,"Or",Array.prototype.slice.call(arguments))||this}return kh(n,t),n}(Uf),Ah=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Ch=function(t){function n(n){var i=t.call(this,"ResourceId")||this;return i.rid=n,i}return Ah(n,t),n}(Gf),Ph=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Rh=function(t){function n(n,i,r){return t.call(this,"Within",n,i,r)||this}return Ph(n,t),n}(Jf);function Ih(t){var n=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(Bf,n))}function Nh(t,n,i){return new Vf(t,n,i)}var zh=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();function Fh(t){for(var n=[],i=0,r=t.length;i<r;++i)n.push(t[i].clone());return n}var Lh=function(t){function n(n){var i=t.call(this)||this;return i.Le=n||null,i.Ge=[],i.De(),i}return zh(n,t),n.prototype.Ue=function(){this.Ge.forEach(pt),this.Ge.length=0},n.prototype.De=function(){if(this.Le)for(var t=0,n=this.Le.length;t<n;++t)this.Ge.push(lt(this.Le[t],$,this.changed,this))},n.prototype.clone=function(){var t=new n(null);return t.setGeometries(this.Le),t.applyProperties(this),t},n.prototype.closestPointXY=function(t,n,i,r){if(r<Ji(this.getExtent(),t,n))return r;for(var e=this.Le,o=0,u=e.length;o<u;++o)r=e[o].closestPointXY(t,n,i,r);return r},n.prototype.containsXY=function(t,n){for(var i=this.Le,r=0,e=i.length;r<e;++r)if(i[r].containsXY(t,n))return!0;return!1},n.prototype.computeExtent=function(t){er(t);for(var n=this.Le,i=0,r=n.length;i<r;++i)fr(t,n[i].getExtent());return t},n.prototype.getGeometries=function(){return Fh(this.Le)},n.prototype.getGeometriesArray=function(){return this.Le},n.prototype.getGeometriesArrayRecursive=function(){for(var t=[],n=this.Le,i=0,r=n.length;i<r;++i)n[i].getType()===this.getType()?t=t.concat(n[i].getGeometriesArrayRecursive()):t.push(n[i]);return t},n.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;for(var i=[],r=this.Le,e=!1,o=0,u=r.length;o<u;++o){var s=r[o],a=s.getSimplifiedGeometry(t);i.push(a),a!==s&&(e=!0)}if(e){var f=new n(null);return f.setGeometriesArray(i),f}return this.simplifiedGeometryMaxMinSquaredTolerance=t,this},n.prototype.getType=function(){return Kr.GEOMETRY_COLLECTION},n.prototype.intersectsExtent=function(t){for(var n=this.Le,i=0,r=n.length;i<r;++i)if(n[i].intersectsExtent(t))return!0;return!1},n.prototype.isEmpty=function(){return 0===this.Le.length},n.prototype.rotate=function(t,n){for(var i=this.Le,r=0,e=i.length;r<e;++r)i[r].rotate(t,n);this.changed()},n.prototype.scale=function(t,n,i){var r=i;r||(r=br(this.getExtent()));for(var e=this.Le,o=0,u=e.length;o<u;++o)e[o].scale(t,n,r);this.changed()},n.prototype.setGeometries=function(t){this.setGeometriesArray(Fh(t))},n.prototype.setGeometriesArray=function(t){this.Ue(),this.Le=t,this.De(),this.changed()},n.prototype.applyTransform=function(t){for(var n=this.Le,i=0,r=n.length;i<r;++i)n[i].applyTransform(t);this.changed()},n.prototype.translate=function(t,n){for(var i=this.Le,r=0,e=i.length;r<e;++r)i[r].translate(t,n);this.changed()},n.prototype.disposeInternal=function(){this.Ue(),t.prototype.disposeInternal.call(this)},n}(Xu),Gh=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();function Dh(t,n){if(!t)return null;var i;switch(t.type){case Kr.POINT:i=function(t){return new _s(t.coordinates)}(t);break;case Kr.LINE_STRING:i=function(t){return new Mf(t.coordinates)}(t);break;case Kr.POLYGON:i=function(t){return new Xs(t.coordinates)}(t);break;case Kr.MULTI_POINT:i=function(t){return new Ef(t.coordinates)}(t);break;case Kr.MULTI_LINE_STRING:i=function(t){return new Sf(t.coordinates)}(t);break;case Kr.MULTI_POLYGON:i=function(t){return new Af(t.coordinates)}(t);break;case Kr.GEOMETRY_COLLECTION:i=function(t,n){var i=t.geometries.map((function(t){return Dh(t,n)}));return new Lh(i)}(t);break;default:throw new Error("Unsupported GeoJSON type: "+t.type)}return vf(i,!1,n)}function Uh(t,n){var i,r=(t=vf(t,!0,n)).getType();switch(r){case Kr.POINT:i=function(t,n){return{type:"Point",coordinates:t.getCoordinates()}}(t);break;case Kr.LINE_STRING:i=function(t,n){return{type:"LineString",coordinates:t.getCoordinates()}}(t);break;case Kr.POLYGON:i=function(t,n){var i;n&&(i=n.rightHanded);return{type:"Polygon",coordinates:t.getCoordinates(i)}}(t,n);break;case Kr.MULTI_POINT:i=function(t,n){return{type:"MultiPoint",coordinates:t.getCoordinates()}}(t);break;case Kr.MULTI_LINE_STRING:i=function(t,n){return{type:"MultiLineString",coordinates:t.getCoordinates()}}(t);break;case Kr.MULTI_POLYGON:i=function(t,n){var i;n&&(i=n.rightHanded);return{type:"MultiPolygon",coordinates:t.getCoordinates(i)}}(t,n);break;case Kr.GEOMETRY_COLLECTION:i=function(t,n){return{type:"GeometryCollection",geometries:t.getGeometriesArray().map((function(t){var i=W({},n);return delete i.featureProjection,Uh(t,i)}))}}(t,n);break;case Kr.CIRCLE:i={type:"GeometryCollection",geometries:[]};break;default:throw new Error("Unsupported geometry type: "+r)}return i}var qh=function(t){function n(n){var i=this,r=n||{};return(i=t.call(this)||this).dataProjection=ae(r.dataProjection?r.dataProjection:"EPSG:4326"),r.featureProjection&&(i.defaultFeatureProjection=ae(r.featureProjection)),i.Se=r.geometryName,i.qe=r.extractGeometryName,i.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"],i}return Gh(n,t),n.prototype.readFeatureFromObject=function(t,n){var i=null,r=Dh((i="Feature"===t.type?t:{type:"Feature",geometry:t,properties:null}).geometry,n),e=new ef;return this.Se?e.setGeometryName(this.Se):this.qe&&"geometry_name"in i!==void 0&&e.setGeometryName(i.geometry_name),e.setGeometry(r),"id"in i&&e.setId(i.id),i.properties&&e.setProperties(i.properties,!0),e},n.prototype.readFeaturesFromObject=function(t,n){var i=null;if("FeatureCollection"===t.type){i=[];for(var r=t.features,e=0,o=r.length;e<o;++e)i.push(this.readFeatureFromObject(r[e],n))}else i=[this.readFeatureFromObject(t,n)];return i},n.prototype.readGeometryFromObject=function(t,n){return Dh(t,n)},n.prototype.readProjectionFromObject=function(t){var n,i=t.crs;return i?"name"==i.type?n=ae(i.properties.name):"EPSG"===i.type?n=ae("EPSG:"+i.properties.code):g(!1,36):n=this.dataProjection,n},n.prototype.writeFeatureObject=function(t,n){n=this.adaptOptions(n);var i={type:"Feature",geometry:null,properties:null},r=t.getId();if(void 0!==r&&(i.id=r),!t.hasProperties())return i;var e=t.getProperties(),o=t.getGeometry();return o&&(i.geometry=Uh(o,n),delete e[t.getGeometryName()]),H(e)||(i.properties=e),i},n.prototype.writeFeaturesObject=function(t,n){n=this.adaptOptions(n);for(var i=[],r=0,e=t.length;r<e;++r)i.push(this.writeFeatureObject(t[r],n));return{type:"FeatureCollection",features:i}},n.prototype.writeGeometryObject=function(t,n){return Uh(t,this.adaptOptions(n))},n}(mf),Bh="http://www.w3.org/2001/XMLSchema-instance";function Xh(t,n){return pc().createElementNS(t,n)}function Vh(t,n){return Wh(t,n,[]).join("")}function Wh(t,n,i){if(t.nodeType==Node.CDATA_SECTION_NODE||t.nodeType==Node.TEXT_NODE)n?i.push(String(t.nodeValue).replace(/(\r\n|\r|\n)/g,"")):i.push(t.nodeValue);else{var r=void 0;for(r=t.firstChild;r;r=r.nextSibling)Wh(r,n,i)}return i}function Yh(t){return"documentElement"in t}function Zh(t,n,i){return t.getAttributeNS(n,i)||""}function Hh(t){return(new DOMParser).parseFromString(t,"application/xml")}function Kh(t,n){return function(i,r){var e=t.call(void 0!==n?n:this,i,r);void 0!==e&&a(r[r.length-1],e)}}function Jh(t,n){return function(i,r){var e=t.call(void 0!==n?n:this,i,r);void 0!==e&&r[r.length-1].push(e)}}function $h(t,n){return function(i,r){var e=t.call(void 0!==n?n:this,i,r);void 0!==e&&(r[r.length-1]=e)}}function Qh(t,n,i){return function(r,e){var o=t.call(void 0!==i?i:this,r,e);if(void 0!==o){var u=e[e.length-1],s=void 0!==n?n:r.localName,a=void 0;s in u?a=u[s]:(a=[],u[s]=a),a.push(o)}}}function tc(t,n,i){return function(r,e){var o=t.call(void 0!==i?i:this,r,e);void 0!==o&&(e[e.length-1][void 0!==n?n:r.localName]=o)}}function nc(t,n){return function(i,r,e){t.call(void 0!==n?n:this,i,r,e),e[e.length-1].node.appendChild(i)}}function ic(t,n){var i,r;return function(n,e,o){if(void 0===i){i={};var u={};u[n.localName]=t,i[n.namespaceURI]=u,r=rc(n.localName)}fc(i,r,e,o)}}function rc(t,n){var i=t;return function(t,r,e){var o=r[r.length-1].node,u=i;return void 0===u&&(u=e),Xh(void 0!==n?n:o.namespaceURI,u)}}var ec=rc();function oc(t,n){for(var i=n.length,r=new Array(i),e=0;e<i;++e)r[e]=t[n[e]];return r}function uc(t,n,i){var r,e,o=void 0!==i?i:{};for(r=0,e=t.length;r<e;++r)o[t[r]]=n;return o}function sc(t,n,i,r){var e;for(e=n.firstElementChild;e;e=e.nextElementSibling){var o=t[e.namespaceURI];if(void 0!==o){var u=o[e.localName];void 0!==u&&u.call(r,e,i)}}}function ac(t,n,i,r,e){return r.push(t),sc(n,i,r,e),r.pop()}function fc(t,n,i,r,e,o){for(var u,s,a=(void 0!==e?e:i).length,f=0;f<a;++f)void 0!==(u=i[f])&&void 0!==(s=n.call(void 0!==o?o:this,u,r,void 0!==e?e[f]:void 0))&&t[s.namespaceURI][s.localName].call(o,s,u,r)}function hc(t,n,i,r,e,o,u){return e.push(t),fc(n,i,r,e,o,u),e.pop()}var cc=void 0;function lc(){return void 0===cc&&"undefined"!=typeof XMLSerializer&&(cc=new XMLSerializer),cc}var vc=void 0;function pc(){return void 0===vc&&"undefined"!=typeof document&&(vc=document.implementation.createDocument("","",null)),vc}var dc=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),yc=function(t){function n(){var n=t.call(this)||this;return n.Be=lc(),n}return dc(n,t),n.prototype.getType=function(){return af},n.prototype.readFeature=function(t,n){if(t){if("string"==typeof t){var i=Hh(t);return this.readFeatureFromDocument(i,n)}return Yh(t)?this.readFeatureFromDocument(t,n):this.readFeatureFromNode(t,n)}return null},n.prototype.readFeatureFromDocument=function(t,n){var i=this.readFeaturesFromDocument(t,n);return i.length>0?i[0]:null},n.prototype.readFeatureFromNode=function(t,n){return null},n.prototype.readFeatures=function(t,n){if(t){if("string"==typeof t){var i=Hh(t);return this.readFeaturesFromDocument(i,n)}return Yh(t)?this.readFeaturesFromDocument(t,n):this.readFeaturesFromNode(t,n)}return[]},n.prototype.readFeaturesFromDocument=function(t,n){for(var i=[],r=t.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&a(i,this.readFeaturesFromNode(r,n));return i},n.prototype.readFeaturesFromNode=function(t,n){return v()},n.prototype.readGeometry=function(t,n){if(t){if("string"==typeof t){var i=Hh(t);return this.readGeometryFromDocument(i,n)}return Yh(t)?this.readGeometryFromDocument(t,n):this.readGeometryFromNode(t,n)}return null},n.prototype.readGeometryFromDocument=function(t,n){return null},n.prototype.readGeometryFromNode=function(t,n){return null},n.prototype.readProjection=function(t){if(t){if("string"==typeof t){var n=Hh(t);return this.readProjectionFromDocument(n)}return Yh(t)?this.readProjectionFromDocument(t):this.readProjectionFromNode(t)}return null},n.prototype.readProjectionFromDocument=function(t){return this.dataProjection},n.prototype.readProjectionFromNode=function(t){return this.dataProjection},n.prototype.writeFeature=function(t,n){var i=this.writeFeatureNode(t,n);return this.Be.serializeToString(i)},n.prototype.writeFeatureNode=function(t,n){return null},n.prototype.writeFeatures=function(t,n){var i=this.writeFeaturesNode(t,n);return this.Be.serializeToString(i)},n.prototype.writeFeaturesNode=function(t,n){return null},n.prototype.writeGeometry=function(t,n){var i=this.writeGeometryNode(t,n);return this.Be.serializeToString(i)},n.prototype.writeGeometryNode=function(t,n){return null},n}(lf),mc=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),wc="http://www.opengis.net/gml",bc=/^[\s\xa0]*$/,gc=function(t){function n(n){var i=t.call(this)||this,r=n||{};return i.featureType=r.featureType,i.featureNS=r.featureNS,i.srsName=r.srsName,i.schemaLocation="",i.FEATURE_COLLECTION_PARSERS={},i.FEATURE_COLLECTION_PARSERS[i.namespace]={featureMember:Jh(i.readFeaturesInternal),featureMembers:$h(i.readFeaturesInternal)},i.supportedMediaTypes=["application/gml+xml"],i}return mc(n,t),n.prototype.readFeaturesInternal=function(t,n){var i=t.localName,r=null;if("FeatureCollection"==i)r=ac([],this.FEATURE_COLLECTION_PARSERS,t,n,this);else if("featureMembers"==i||"featureMember"==i||"member"==i){var e=n[0],o=e.featureType,u=e.featureNS;if(!o&&t.childNodes){o=[],u={};for(var s=0,a=t.childNodes.length;s<a;++s){var f=t.childNodes[s];if(1===f.nodeType){var h=f.nodeName.split(":").pop();if(-1===o.indexOf(h)){var c="",l=0,v=f.namespaceURI;for(var p in u){if(u[p]===v){c=p;break}++l}c||(u[c="p"+l]=v),o.push(c+":"+h)}}}"featureMember"!=i&&(e.featureType=o,e.featureNS=u)}if("string"==typeof u){var d=u;(u={}).p0=d}var y={},m=Array.isArray(o)?o:[o];for(var w in u){var b={};for(s=0,a=m.length;s<a;++s){(-1===m[s].indexOf(":")?"p0":m[s].split(":")[0])===w&&(b[m[s].split(":").pop()]="featureMembers"==i?Jh(this.readFeatureElement,this):$h(this.readFeatureElement,this))}y[u[w]]=b}r=ac("featureMember"==i||"member"==i?void 0:[],y,t,n)}return null===r&&(r=[]),r},n.prototype.readGeometryOrExtent=function(t,n){var i=n[0];return i.srsName=t.firstElementChild.getAttribute("srsName"),i.srsDimension=t.firstElementChild.getAttribute("srsDimension"),ac(null,this.GEOMETRY_PARSERS,t,n,this)},n.prototype.readExtentElement=function(t,n){var i=n[0],r=this.readGeometryOrExtent(t,n);return r?pf(r,i):void 0},n.prototype.readGeometryElement=function(t,n){var i=n[0],r=this.readGeometryOrExtent(t,n);return r?vf(r,!1,i):void 0},n.prototype.readFeatureElementInternal=function(t,n,i){for(var r,e={},o=t.firstElementChild;o;o=o.nextElementSibling){var u=void 0,s=o.localName;0===o.childNodes.length||1===o.childNodes.length&&(3===o.firstChild.nodeType||4===o.firstChild.nodeType)?(u=Vh(o,!1),bc.test(u)&&(u=void 0)):(i&&(u="boundedBy"===s?this.readExtentElement(o,n):this.readGeometryElement(o,n)),u?"boundedBy"!==s&&(r=s):u=this.readFeatureElementInternal(o,n,!1));var a=o.attributes.length;if(a>0){u={Xe:u};for(var f=0;f<a;f++){u[o.attributes[f].name]=o.attributes[f].value}}e[s]?(e[s]instanceof Array||(e[s]=[e[s]]),e[s].push(u)):e[s]=u}if(i){var h=new ef(e);r&&h.setGeometryName(r);var c=t.getAttribute("fid")||Zh(t,this.namespace,"id");return c&&h.setId(c),h}return e},n.prototype.readFeatureElement=function(t,n){return this.readFeatureElementInternal(t,n,!0)},n.prototype.readPoint=function(t,n){var i=this.readFlatCoordinatesFromNode(t,n);if(i)return new _s(i,Nu)},n.prototype.readMultiPoint=function(t,n){var i=ac([],this.MULTIPOINT_PARSERS,t,n,this);return i?new Ef(i):void 0},n.prototype.readMultiLineString=function(t,n){var i=ac([],this.MULTILINESTRING_PARSERS,t,n,this);if(i)return new Sf(i)},n.prototype.readMultiPolygon=function(t,n){var i=ac([],this.MULTIPOLYGON_PARSERS,t,n,this);if(i)return new Af(i)},n.prototype.pointMemberParser=function(t,n){sc(this.POINTMEMBER_PARSERS,t,n,this)},n.prototype.lineStringMemberParser=function(t,n){sc(this.LINESTRINGMEMBER_PARSERS,t,n,this)},n.prototype.polygonMemberParser=function(t,n){sc(this.POLYGONMEMBER_PARSERS,t,n,this)},n.prototype.readLineString=function(t,n){var i=this.readFlatCoordinatesFromNode(t,n);return i?new Mf(i,Nu):void 0},n.prototype.readFlatLinearRing=function(t,n){var i=ac(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,t,n,this);return i||void 0},n.prototype.readLinearRing=function(t,n){var i=this.readFlatCoordinatesFromNode(t,n);if(i)return new gs(i,Nu)},n.prototype.readPolygon=function(t,n){var i=ac([null],this.FLAT_LINEAR_RINGS_PARSERS,t,n,this);if(i&&i[0]){var r,e=i[0],o=[e.length],u=void 0;for(u=1,r=i.length;u<r;++u)a(e,i[u]),o.push(e.length);return new Xs(e,Nu,o)}},n.prototype.readFlatCoordinatesFromNode=function(t,n){return ac(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,t,n,this)},n.prototype.readGeometryFromNode=function(t,n){var i=this.readGeometryElement(t,[this.getReadOptions(t,n||{})]);return i||null},n.prototype.readFeaturesFromNode=function(t,n){var i={featureType:this.featureType,featureNS:this.featureNS};return n&&W(i,this.getReadOptions(t,n)),this.readFeaturesInternal(t,[i])||[]},n.prototype.readProjectionFromNode=function(t){return ae(this.srsName?this.srsName:t.firstElementChild.getAttribute("srsName"))},n}(yc);gc.prototype.namespace=wc,gc.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{}},gc.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{}},gc.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{}},gc.prototype.MULTIPOINT_PARSERS={"http://www.opengis.net/gml":{pointMember:Jh(gc.prototype.pointMemberParser),pointMembers:Jh(gc.prototype.pointMemberParser)}},gc.prototype.MULTILINESTRING_PARSERS={"http://www.opengis.net/gml":{lineStringMember:Jh(gc.prototype.lineStringMemberParser),lineStringMembers:Jh(gc.prototype.lineStringMemberParser)}},gc.prototype.MULTIPOLYGON_PARSERS={"http://www.opengis.net/gml":{polygonMember:Jh(gc.prototype.polygonMemberParser),polygonMembers:Jh(gc.prototype.polygonMemberParser)}},gc.prototype.POINTMEMBER_PARSERS={"http://www.opengis.net/gml":{Point:Jh(gc.prototype.readFlatCoordinatesFromNode)}},gc.prototype.LINESTRINGMEMBER_PARSERS={"http://www.opengis.net/gml":{LineString:Jh(gc.prototype.readLineString)}},gc.prototype.POLYGONMEMBER_PARSERS={"http://www.opengis.net/gml":{Polygon:Jh(gc.prototype.readPolygon)}},gc.prototype.RING_PARSERS={"http://www.opengis.net/gml":{LinearRing:$h(gc.prototype.readFlatLinearRing)}};var xc=gc;function _c(t){return Mc(Vh(t,!1))}function Mc(t){var n=/^\s*(true|1)|(false|0)\s*$/.exec(t);return n?void 0!==n[1]||!1:void 0}function Oc(t){var n=Vh(t,!1),i=Date.parse(n);return isNaN(i)?void 0:i/1e3}function Sc(t){return jc(Vh(t,!1))}function jc(t){var n=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(t);return n?parseFloat(n[1]):void 0}function Ec(t){return kc(Vh(t,!1))}function kc(t){var n=/^\s*(\d+)\s*$/.exec(t);return n?parseInt(n[1],10):void 0}function Tc(t){return Vh(t,!1).trim()}function Ac(t,n){Nc(t,n?"1":"0")}function Cc(t,n){t.appendChild(pc().createCDATASection(n))}function Pc(t,n){var i=new Date(1e3*n),r=i.getUTCFullYear()+"-"+Ir(i.getUTCMonth()+1,2)+"-"+Ir(i.getUTCDate(),2)+"T"+Ir(i.getUTCHours(),2)+":"+Ir(i.getUTCMinutes(),2)+":"+Ir(i.getUTCSeconds(),2)+"Z";t.appendChild(pc().createTextNode(r))}function Rc(t,n){var i=n.toPrecision();t.appendChild(pc().createTextNode(i))}function Ic(t,n){var i=n.toString();t.appendChild(pc().createTextNode(i))}function Nc(t,n){t.appendChild(pc().createTextNode(n))}var zc=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Fc={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"},Lc=function(t){function n(n){var i=this,r=n||{};return(i=t.call(this,r)||this).FEATURE_COLLECTION_PARSERS[wc].featureMember=Jh(i.readFeaturesInternal),i.schemaLocation=r.schemaLocation?r.schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/2.1.2/feature.xsd",i}return zc(n,t),n.prototype.readFlatCoordinates=function(t,n){var i=Vh(t,!1).replace(/^\s*|\s*$/g,""),r=n[0].srsName,e="enu";if(r){var o=ae(r);o&&(e=o.getAxisOrientation())}for(var u=i.trim().split(/\s+/),s=[],a=0,f=u.length;a<f;a++){var h=u[a].split(/,+/),c=parseFloat(h[0]),l=parseFloat(h[1]),v=3===h.length?parseFloat(h[2]):0;"en"===e.substr(0,2)?s.push(c,l,v):s.push(l,c,v)}return s},n.prototype.readBox=function(t,n){var i=ac([null],this.Ve,t,n,this);return rr(i[1][0],i[1][1],i[1][3],i[1][4])},n.prototype.innerBoundaryIsParser=function(t,n){var i=ac(void 0,this.RING_PARSERS,t,n,this);i&&n[n.length-1].push(i)},n.prototype.outerBoundaryIsParser=function(t,n){var i=ac(void 0,this.RING_PARSERS,t,n,this);i&&(n[n.length-1][0]=i)},n.prototype.We=function(t,n,i){var r,e=n[n.length-1],o=e.multiSurface,u=e.surface,s=e.multiCurve;return Array.isArray(t)?r="Envelope":"MultiPolygon"===(r=t.getType())&&!0===o?r="MultiSurface":"Polygon"===r&&!0===u?r="Surface":"MultiLineString"===r&&!0===s&&(r="MultiCurve"),Xh("http://www.opengis.net/gml",r)},n.prototype.writeFeatureElement=function(t,n,i){var r=n.getId();r&&t.setAttribute("fid",r);var e=i[i.length-1],o=e.featureNS,u=n.getGeometryName();e.serializers||(e.serializers={},e.serializers[o]={});var s=[],a=[];if(n.hasProperties()){var f=n.getProperties();for(var h in f){var c=f[h];null!==c&&(s.push(h),a.push(c),h==u||"function"==typeof c.getSimplifiedGeometry?h in e.serializers[o]||(e.serializers[o][h]=nc(this.writeGeometryElement,this)):h in e.serializers[o]||(e.serializers[o][h]=nc(Nc)))}}var l=W({},e);l.node=t,hc(l,e.serializers,rc(void 0,o),a,i,s)},n.prototype.writeCurveOrLineString=function(t,n,i){var r=i[i.length-1].srsName;if("LineStringSegment"!==t.nodeName&&r&&t.setAttribute("srsName",r),"LineString"===t.nodeName||"LineStringSegment"===t.nodeName){var e=this.Ye(t.namespaceURI);t.appendChild(e),this.Ze(e,n,i)}else if("Curve"===t.nodeName){var o=Xh(t.namespaceURI,"segments");t.appendChild(o),this.He(o,n,i)}},n.prototype.writeLineStringOrCurveMember=function(t,n,i){var r=this.We(n,i);r&&(t.appendChild(r),this.writeCurveOrLineString(r,n,i))},n.prototype.writeMultiCurveOrLineString=function(t,n,i){var r=i[i.length-1],e=r.hasZ,o=r.srsName,u=r.curve;o&&t.setAttribute("srsName",o);var s=n.getLineStrings();hc({node:t,hasZ:e,srsName:o,curve:u},this.LINESTRINGORCURVEMEMBER_SERIALIZERS,this.Ke,s,i,void 0,this)},n.prototype.writeGeometryElement=function(t,n,i){var r,e=i[i.length-1],o=W({},e);o.node=t,r=Array.isArray(n)?pf(n,e):vf(n,!0,e),hc(o,this.GEOMETRY_SERIALIZERS,this.We,[r],i,void 0,this)},n.prototype.Ye=function(t){var n=Xh(t,"coordinates");return n.setAttribute("decimal","."),n.setAttribute("cs",","),n.setAttribute("ts"," "),n},n.prototype.Ze=function(t,n,i){for(var r=i[i.length-1],e=r.hasZ,o=r.srsName,u=n.getCoordinates(),s=u.length,a=new Array(s),f=0;f<s;++f){var h=u[f];a[f]=this.Je(h,o,e)}Nc(t,a.join(" "))},n.prototype.He=function(t,n,i){var r=Xh(t.namespaceURI,"LineStringSegment");t.appendChild(r),this.writeCurveOrLineString(r,n,i)},n.prototype.writeSurfaceOrPolygon=function(t,n,i){var r=i[i.length-1],e=r.hasZ,o=r.srsName;if("PolygonPatch"!==t.nodeName&&o&&t.setAttribute("srsName",o),"Polygon"===t.nodeName||"PolygonPatch"===t.nodeName){var u=n.getLinearRings();hc({node:t,hasZ:e,srsName:o},this.RING_SERIALIZERS,this.$e,u,i,void 0,this)}else if("Surface"===t.nodeName){var s=Xh(t.namespaceURI,"patches");t.appendChild(s),this.Qe(s,n,i)}},n.prototype.$e=function(t,n,i){var r=n[n.length-1],e=r.node,o=r.exteriorWritten;return void 0===o&&(r.exteriorWritten=!0),Xh(e.namespaceURI,void 0!==o?"innerBoundaryIs":"outerBoundaryIs")},n.prototype.Qe=function(t,n,i){var r=Xh(t.namespaceURI,"PolygonPatch");t.appendChild(r),this.writeSurfaceOrPolygon(r,n,i)},n.prototype.writeRing=function(t,n,i){var r=Xh(t.namespaceURI,"LinearRing");t.appendChild(r),this.writeLinearRing(r,n,i)},n.prototype.Je=function(t,n,i){var r="enu";n&&(r=ae(n).getAxisOrientation());var e="en"===r.substr(0,2)?t[0]+","+t[1]:t[1]+","+t[0];i&&(e+=","+(t[2]||0));return e},n.prototype.writePoint=function(t,n,i){var r=i[i.length-1],e=r.hasZ,o=r.srsName;o&&t.setAttribute("srsName",o);var u=this.Ye(t.namespaceURI);t.appendChild(u);var s=n.getCoordinates();Nc(u,this.Je(s,o,e))},n.prototype.writeMultiPoint=function(t,n,i){var r=i[i.length-1],e=r.hasZ,o=r.srsName;o&&t.setAttribute("srsName",o);var u=n.getPoints();hc({node:t,hasZ:e,srsName:o},this.POINTMEMBER_SERIALIZERS,rc("pointMember"),u,i,void 0,this)},n.prototype.writePointMember=function(t,n,i){var r=Xh(t.namespaceURI,"Point");t.appendChild(r),this.writePoint(r,n,i)},n.prototype.writeLinearRing=function(t,n,i){var r=i[i.length-1].srsName;r&&t.setAttribute("srsName",r);var e=this.Ye(t.namespaceURI);t.appendChild(e),this.Ze(e,n,i)},n.prototype.writeMultiSurfaceOrPolygon=function(t,n,i){var r=i[i.length-1],e=r.hasZ,o=r.srsName,u=r.surface;o&&t.setAttribute("srsName",o);var s=n.getPolygons();hc({node:t,hasZ:e,srsName:o,surface:u},this.SURFACEORPOLYGONMEMBER_SERIALIZERS,this.Ke,s,i,void 0,this)},n.prototype.writeSurfaceOrPolygonMember=function(t,n,i){var r=this.We(n,i);r&&(t.appendChild(r),this.writeSurfaceOrPolygon(r,n,i))},n.prototype.writeEnvelope=function(t,n,i){var r=i[i.length-1].srsName;r&&t.setAttribute("srsName",r);var e=[n[0]+" "+n[1],n[2]+" "+n[3]];hc({node:t},this.ENVELOPE_SERIALIZERS,ec,e,i,["lowerCorner","upperCorner"],this)},n.prototype.Ke=function(t,n,i){var r=n[n.length-1].node;return Xh("http://www.opengis.net/gml",Fc[r.nodeName])},n}(xc);Lc.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{coordinates:$h(Lc.prototype.readFlatCoordinates)}},Lc.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{innerBoundaryIs:Lc.prototype.innerBoundaryIsParser,outerBoundaryIs:Lc.prototype.outerBoundaryIsParser}},Lc.prototype.Ve={"http://www.opengis.net/gml":{coordinates:Jh(Lc.prototype.readFlatCoordinates)}},Lc.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:$h(xc.prototype.readPoint),MultiPoint:$h(xc.prototype.readMultiPoint),LineString:$h(xc.prototype.readLineString),MultiLineString:$h(xc.prototype.readMultiLineString),LinearRing:$h(xc.prototype.readLinearRing),Polygon:$h(xc.prototype.readPolygon),MultiPolygon:$h(xc.prototype.readMultiPolygon),Box:$h(Lc.prototype.readBox)}},Lc.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml":{Curve:nc(Lc.prototype.writeCurveOrLineString),MultiCurve:nc(Lc.prototype.writeMultiCurveOrLineString),Point:nc(Lc.prototype.writePoint),MultiPoint:nc(Lc.prototype.writeMultiPoint),LineString:nc(Lc.prototype.writeCurveOrLineString),MultiLineString:nc(Lc.prototype.writeMultiCurveOrLineString),LinearRing:nc(Lc.prototype.writeLinearRing),Polygon:nc(Lc.prototype.writeSurfaceOrPolygon),MultiPolygon:nc(Lc.prototype.writeMultiSurfaceOrPolygon),Surface:nc(Lc.prototype.writeSurfaceOrPolygon),MultiSurface:nc(Lc.prototype.writeMultiSurfaceOrPolygon),Envelope:nc(Lc.prototype.writeEnvelope)}},Lc.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{lineStringMember:nc(Lc.prototype.writeLineStringOrCurveMember),curveMember:nc(Lc.prototype.writeLineStringOrCurveMember)}},Lc.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml":{outerBoundaryIs:nc(Lc.prototype.writeRing),innerBoundaryIs:nc(Lc.prototype.writeRing)}},Lc.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{pointMember:nc(Lc.prototype.writePointMember)}},Lc.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{surfaceMember:nc(Lc.prototype.writeSurfaceOrPolygonMember),polygonMember:nc(Lc.prototype.writeSurfaceOrPolygonMember)}},Lc.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml":{lowerCorner:nc(Nc),upperCorner:nc(Nc)}};var Gc=Lc,Dc=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Uc={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"},qc=function(t){function n(n){var i=this,r=n||{};return(i=t.call(this,r)||this).no=void 0!==r.surface&&r.surface,i.io=void 0!==r.curve&&r.curve,i.ro=void 0===r.multiCurve||r.multiCurve,i.eo=void 0===r.multiSurface||r.multiSurface,i.schemaLocation=r.schemaLocation?r.schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd",i.hasZ=void 0!==r.hasZ&&r.hasZ,i}return Dc(n,t),n.prototype.readMultiCurve=function(t,n){var i=ac([],this.MULTICURVE_PARSERS,t,n,this);return i?new Sf(i):void 0},n.prototype.readMultiSurface=function(t,n){var i=ac([],this.MULTISURFACE_PARSERS,t,n,this);if(i)return new Af(i)},n.prototype.curveMemberParser=function(t,n){sc(this.CURVEMEMBER_PARSERS,t,n,this)},n.prototype.surfaceMemberParser=function(t,n){sc(this.SURFACEMEMBER_PARSERS,t,n,this)},n.prototype.readPatch=function(t,n){return ac([null],this.PATCHES_PARSERS,t,n,this)},n.prototype.readSegment=function(t,n){return ac([null],this.SEGMENTS_PARSERS,t,n,this)},n.prototype.readPolygonPatch=function(t,n){return ac([null],this.FLAT_LINEAR_RINGS_PARSERS,t,n,this)},n.prototype.readLineStringSegment=function(t,n){return ac([null],this.GEOMETRY_FLAT_COORDINATES_PARSERS,t,n,this)},n.prototype.interiorParser=function(t,n){var i=ac(void 0,this.RING_PARSERS,t,n,this);i&&n[n.length-1].push(i)},n.prototype.exteriorParser=function(t,n){var i=ac(void 0,this.RING_PARSERS,t,n,this);i&&(n[n.length-1][0]=i)},n.prototype.readSurface=function(t,n){var i=ac([null],this.SURFACE_PARSERS,t,n,this);if(i&&i[0]){var r,e=i[0],o=[e.length],u=void 0;for(u=1,r=i.length;u<r;++u)a(e,i[u]),o.push(e.length);return new Xs(e,Nu,o)}},n.prototype.readCurve=function(t,n){var i=ac([null],this.CURVE_PARSERS,t,n,this);return i?new Mf(i,Nu):void 0},n.prototype.readEnvelope=function(t,n){var i=ac([null],this.ENVELOPE_PARSERS,t,n,this);return rr(i[1][0],i[1][1],i[2][0],i[2][1])},n.prototype.readFlatPos=function(t,n){for(var i,r=Vh(t,!1),e=/^\s*([+\-]?\d*\.?\d+(?:[eE][+\-]?\d+)?)\s*/,o=[];i=e.exec(r);)o.push(parseFloat(i[1])),r=r.substr(i[0].length);if(""===r){var u=n[0].srsName,s="enu";if(u)s=ae(u).getAxisOrientation();if("neu"===s){var a,f=void 0;for(f=0,a=o.length;f<a;f+=3){var h=o[f],c=o[f+1];o[f]=c,o[f+1]=h}}var l=o.length;if(2==l&&o.push(0),0!==l)return o}},n.prototype.readFlatPosList=function(t,n){var i=Vh(t,!1).replace(/^\s*|\s*$/g,""),r=n[0],e=r.srsName,o=r.srsDimension,u="enu";e&&(u=ae(e).getAxisOrientation());var s,a,f,h=i.split(/\s+/),c=2;t.getAttribute("srsDimension")?c=kc(t.getAttribute("srsDimension")):t.getAttribute("dimension")?c=kc(t.getAttribute("dimension")):t.parentNode.getAttribute("srsDimension")?c=kc(t.parentNode.getAttribute("srsDimension")):o&&(c=kc(o));for(var l=[],v=0,p=h.length;v<p;v+=c)s=parseFloat(h[v]),a=parseFloat(h[v+1]),f=3===c?parseFloat(h[v+2]):0,"en"===u.substr(0,2)?l.push(s,a,f):l.push(a,s,f);return l},n.prototype.oo=function(t,n,i){var r=i[i.length-1],e=r.hasZ,o=e?"3":"2";t.setAttribute("srsDimension",o);var u=r.srsName,s="enu";u&&(s=ae(u).getAxisOrientation());var a,f=n.getCoordinates();(a="en"===s.substr(0,2)?f[0]+" "+f[1]:f[1]+" "+f[0],e)&&(a+=" "+(f[2]||0));Nc(t,a)},n.prototype.Je=function(t,n,i){var r="enu";n&&(r=ae(n).getAxisOrientation());var e="en"===r.substr(0,2)?t[0]+" "+t[1]:t[1]+" "+t[0];i&&(e+=" "+(t[2]||0));return e},n.prototype.uo=function(t,n,i){var r=i[i.length-1],e=r.hasZ,o=e?"3":"2";t.setAttribute("srsDimension",o);for(var u,s=r.srsName,a=n.getCoordinates(),f=a.length,h=new Array(f),c=0;c<f;++c)u=a[c],h[c]=this.Je(u,s,e);Nc(t,h.join(" "))},n.prototype.writePoint=function(t,n,i){var r=i[i.length-1].srsName;r&&t.setAttribute("srsName",r);var e=Xh(t.namespaceURI,"pos");t.appendChild(e),this.oo(e,n,i)},n.prototype.writeEnvelope=function(t,n,i){var r=i[i.length-1].srsName;r&&t.setAttribute("srsName",r);var e=[n[0]+" "+n[1],n[2]+" "+n[3]];hc({node:t},this.ENVELOPE_SERIALIZERS,ec,e,i,["lowerCorner","upperCorner"],this)},n.prototype.writeLinearRing=function(t,n,i){var r=i[i.length-1].srsName;r&&t.setAttribute("srsName",r);var e=Xh(t.namespaceURI,"posList");t.appendChild(e),this.uo(e,n,i)},n.prototype.$e=function(t,n,i){var r=n[n.length-1],e=r.node,o=r.exteriorWritten;return void 0===o&&(r.exteriorWritten=!0),Xh(e.namespaceURI,void 0!==o?"interior":"exterior")},n.prototype.writeSurfaceOrPolygon=function(t,n,i){var r=i[i.length-1],e=r.hasZ,o=r.srsName;if("PolygonPatch"!==t.nodeName&&o&&t.setAttribute("srsName",o),"Polygon"===t.nodeName||"PolygonPatch"===t.nodeName){var u=n.getLinearRings();hc({node:t,hasZ:e,srsName:o},this.RING_SERIALIZERS,this.$e,u,i,void 0,this)}else if("Surface"===t.nodeName){var s=Xh(t.namespaceURI,"patches");t.appendChild(s),this.Qe(s,n,i)}},n.prototype.writeCurveOrLineString=function(t,n,i){var r=i[i.length-1].srsName;if("LineStringSegment"!==t.nodeName&&r&&t.setAttribute("srsName",r),"LineString"===t.nodeName||"LineStringSegment"===t.nodeName){var e=Xh(t.namespaceURI,"posList");t.appendChild(e),this.uo(e,n,i)}else if("Curve"===t.nodeName){var o=Xh(t.namespaceURI,"segments");t.appendChild(o),this.He(o,n,i)}},n.prototype.writeMultiSurfaceOrPolygon=function(t,n,i){var r=i[i.length-1],e=r.hasZ,o=r.srsName,u=r.surface;o&&t.setAttribute("srsName",o);var s=n.getPolygons();hc({node:t,hasZ:e,srsName:o,surface:u},this.SURFACEORPOLYGONMEMBER_SERIALIZERS,this.Ke,s,i,void 0,this)},n.prototype.writeMultiPoint=function(t,n,i){var r=i[i.length-1],e=r.srsName,o=r.hasZ;e&&t.setAttribute("srsName",e);var u=n.getPoints();hc({node:t,hasZ:o,srsName:e},this.POINTMEMBER_SERIALIZERS,rc("pointMember"),u,i,void 0,this)},n.prototype.writeMultiCurveOrLineString=function(t,n,i){var r=i[i.length-1],e=r.hasZ,o=r.srsName,u=r.curve;o&&t.setAttribute("srsName",o);var s=n.getLineStrings();hc({node:t,hasZ:e,srsName:o,curve:u},this.LINESTRINGORCURVEMEMBER_SERIALIZERS,this.Ke,s,i,void 0,this)},n.prototype.writeRing=function(t,n,i){var r=Xh(t.namespaceURI,"LinearRing");t.appendChild(r),this.writeLinearRing(r,n,i)},n.prototype.writeSurfaceOrPolygonMember=function(t,n,i){var r=this.We(n,i);r&&(t.appendChild(r),this.writeSurfaceOrPolygon(r,n,i))},n.prototype.writePointMember=function(t,n,i){var r=Xh(t.namespaceURI,"Point");t.appendChild(r),this.writePoint(r,n,i)},n.prototype.writeLineStringOrCurveMember=function(t,n,i){var r=this.We(n,i);r&&(t.appendChild(r),this.writeCurveOrLineString(r,n,i))},n.prototype.Qe=function(t,n,i){var r=Xh(t.namespaceURI,"PolygonPatch");t.appendChild(r),this.writeSurfaceOrPolygon(r,n,i)},n.prototype.He=function(t,n,i){var r=Xh(t.namespaceURI,"LineStringSegment");t.appendChild(r),this.writeCurveOrLineString(r,n,i)},n.prototype.writeGeometryElement=function(t,n,i){var r,e=i[i.length-1],o=W({},e);o.node=t,r=Array.isArray(n)?pf(n,e):vf(n,!0,e),hc(o,this.GEOMETRY_SERIALIZERS,this.We,[r],i,void 0,this)},n.prototype.writeFeatureElement=function(t,n,i){var r=n.getId();r&&t.setAttribute("fid",r);var e=i[i.length-1],o=e.featureNS,u=n.getGeometryName();e.serializers||(e.serializers={},e.serializers[o]={});var s=[],a=[];if(n.hasProperties()){var f=n.getProperties();for(var h in f){var c=f[h];null!==c&&(s.push(h),a.push(c),h==u||"function"==typeof c.getSimplifiedGeometry?h in e.serializers[o]||(e.serializers[o][h]=nc(this.writeGeometryElement,this)):h in e.serializers[o]||(e.serializers[o][h]=nc(Nc)))}}var l=W({},e);l.node=t,hc(l,e.serializers,rc(void 0,o),a,i,s)},n.prototype.so=function(t,n,i){var r=i[i.length-1],e=r.featureType,o=r.featureNS,u={};u[o]={},u[o][e]=nc(this.writeFeatureElement,this);var s=W({},r);s.node=t,hc(s,u,rc(e,o),n,i)},n.prototype.Ke=function(t,n,i){var r=n[n.length-1].node;return Xh(this.namespace,Uc[r.nodeName])},n.prototype.We=function(t,n,i){var r,e=n[n.length-1],o=e.multiSurface,u=e.surface,s=e.curve,a=e.multiCurve;return Array.isArray(t)?r="Envelope":"MultiPolygon"===(r=t.getType())&&!0===o?r="MultiSurface":"Polygon"===r&&!0===u?r="Surface":"LineString"===r&&!0===s?r="Curve":"MultiLineString"===r&&!0===a&&(r="MultiCurve"),Xh(this.namespace,r)},n.prototype.writeGeometryNode=function(t,n){n=this.adaptOptions(n);var i=Xh(this.namespace,"geom"),r={node:i,hasZ:this.hasZ,srsName:this.srsName,curve:this.io,surface:this.no,multiSurface:this.eo,multiCurve:this.ro};return n&&W(r,n),this.writeGeometryElement(i,t,[r]),i},n.prototype.writeFeaturesNode=function(t,n){n=this.adaptOptions(n);var i=Xh(this.namespace,"featureMembers");i.setAttributeNS(Bh,"xsi:schemaLocation",this.schemaLocation);var r={srsName:this.srsName,hasZ:this.hasZ,curve:this.io,surface:this.no,multiSurface:this.eo,multiCurve:this.ro,featureNS:this.featureNS,featureType:this.featureType};return n&&W(r,n),this.so(i,t,[r]),i},n}(xc);qc.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{pos:$h(qc.prototype.readFlatPos),posList:$h(qc.prototype.readFlatPosList),coordinates:$h(Gc.prototype.readFlatCoordinates)}},qc.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{interior:qc.prototype.interiorParser,exterior:qc.prototype.exteriorParser}},qc.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:$h(xc.prototype.readPoint),MultiPoint:$h(xc.prototype.readMultiPoint),LineString:$h(xc.prototype.readLineString),MultiLineString:$h(xc.prototype.readMultiLineString),LinearRing:$h(xc.prototype.readLinearRing),Polygon:$h(xc.prototype.readPolygon),MultiPolygon:$h(xc.prototype.readMultiPolygon),Surface:$h(qc.prototype.readSurface),MultiSurface:$h(qc.prototype.readMultiSurface),Curve:$h(qc.prototype.readCurve),MultiCurve:$h(qc.prototype.readMultiCurve),Envelope:$h(qc.prototype.readEnvelope)}},qc.prototype.MULTICURVE_PARSERS={"http://www.opengis.net/gml":{curveMember:Jh(qc.prototype.curveMemberParser),curveMembers:Jh(qc.prototype.curveMemberParser)}},qc.prototype.MULTISURFACE_PARSERS={"http://www.opengis.net/gml":{surfaceMember:Jh(qc.prototype.surfaceMemberParser),surfaceMembers:Jh(qc.prototype.surfaceMemberParser)}},qc.prototype.CURVEMEMBER_PARSERS={"http://www.opengis.net/gml":{LineString:Jh(xc.prototype.readLineString),Curve:Jh(qc.prototype.readCurve)}},qc.prototype.SURFACEMEMBER_PARSERS={"http://www.opengis.net/gml":{Polygon:Jh(xc.prototype.readPolygon),Surface:Jh(qc.prototype.readSurface)}},qc.prototype.SURFACE_PARSERS={"http://www.opengis.net/gml":{patches:$h(qc.prototype.readPatch)}},qc.prototype.CURVE_PARSERS={"http://www.opengis.net/gml":{segments:$h(qc.prototype.readSegment)}},qc.prototype.ENVELOPE_PARSERS={"http://www.opengis.net/gml":{lowerCorner:Jh(qc.prototype.readFlatPosList),upperCorner:Jh(qc.prototype.readFlatPosList)}},qc.prototype.PATCHES_PARSERS={"http://www.opengis.net/gml":{PolygonPatch:$h(qc.prototype.readPolygonPatch)}},qc.prototype.SEGMENTS_PARSERS={"http://www.opengis.net/gml":{LineStringSegment:$h(qc.prototype.readLineStringSegment)}},qc.prototype.writeFeatures,qc.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml":{exterior:nc(qc.prototype.writeRing),interior:nc(qc.prototype.writeRing)}},qc.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml":{lowerCorner:nc(Nc),upperCorner:nc(Nc)}},qc.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{surfaceMember:nc(qc.prototype.writeSurfaceOrPolygonMember),polygonMember:nc(qc.prototype.writeSurfaceOrPolygonMember)}},qc.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{pointMember:nc(qc.prototype.writePointMember)}},qc.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{lineStringMember:nc(qc.prototype.writeLineStringOrCurveMember),curveMember:nc(qc.prototype.writeLineStringOrCurveMember)}},qc.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml":{Curve:nc(qc.prototype.writeCurveOrLineString),MultiCurve:nc(qc.prototype.writeMultiCurveOrLineString),Point:nc(qc.prototype.writePoint),MultiPoint:nc(qc.prototype.writeMultiPoint),LineString:nc(qc.prototype.writeCurveOrLineString),MultiLineString:nc(qc.prototype.writeMultiCurveOrLineString),LinearRing:nc(qc.prototype.writeLinearRing),Polygon:nc(qc.prototype.writeSurfaceOrPolygon),MultiPolygon:nc(qc.prototype.writeMultiSurfaceOrPolygon),Surface:nc(qc.prototype.writeSurfaceOrPolygon),MultiSurface:nc(qc.prototype.writeMultiSurfaceOrPolygon),Envelope:nc(qc.prototype.writeEnvelope)}};var Bc=qc,Xc=Bc;Xc.prototype.writeFeatures,Xc.prototype.writeFeaturesNode;var Vc=Xc,Wc=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Yc=function(t){function n(n){var i=this,r=n||{};return(i=t.call(this,r)||this).schemaLocation=r.schemaLocation?r.schemaLocation:i.namespace+" http://schemas.opengis.net/gml/3.2.1/gml.xsd",i}return Wc(n,t),n}(Bc);Yc.prototype.namespace="http://www.opengis.net/gml/3.2",Yc.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml/3.2":{pos:$h(Bc.prototype.readFlatPos),posList:$h(Bc.prototype.readFlatPosList),coordinates:$h(Gc.prototype.readFlatCoordinates)}},Yc.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml/3.2":{interior:Bc.prototype.interiorParser,exterior:Bc.prototype.exteriorParser}},Yc.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml/3.2":{Point:$h(xc.prototype.readPoint),MultiPoint:$h(xc.prototype.readMultiPoint),LineString:$h(xc.prototype.readLineString),MultiLineString:$h(xc.prototype.readMultiLineString),LinearRing:$h(xc.prototype.readLinearRing),Polygon:$h(xc.prototype.readPolygon),MultiPolygon:$h(xc.prototype.readMultiPolygon),Surface:$h(Yc.prototype.readSurface),MultiSurface:$h(Bc.prototype.readMultiSurface),Curve:$h(Yc.prototype.readCurve),MultiCurve:$h(Bc.prototype.readMultiCurve),Envelope:$h(Yc.prototype.readEnvelope)}},Yc.prototype.MULTICURVE_PARSERS={"http://www.opengis.net/gml/3.2":{curveMember:Jh(Bc.prototype.curveMemberParser),curveMembers:Jh(Bc.prototype.curveMemberParser)}},Yc.prototype.MULTISURFACE_PARSERS={"http://www.opengis.net/gml/3.2":{surfaceMember:Jh(Bc.prototype.surfaceMemberParser),surfaceMembers:Jh(Bc.prototype.surfaceMemberParser)}},Yc.prototype.CURVEMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{LineString:Jh(xc.prototype.readLineString),Curve:Jh(Bc.prototype.readCurve)}},Yc.prototype.SURFACEMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Polygon:Jh(xc.prototype.readPolygon),Surface:Jh(Bc.prototype.readSurface)}},Yc.prototype.SURFACE_PARSERS={"http://www.opengis.net/gml/3.2":{patches:$h(Bc.prototype.readPatch)}},Yc.prototype.CURVE_PARSERS={"http://www.opengis.net/gml/3.2":{segments:$h(Bc.prototype.readSegment)}},Yc.prototype.ENVELOPE_PARSERS={"http://www.opengis.net/gml/3.2":{lowerCorner:Jh(Bc.prototype.readFlatPosList),upperCorner:Jh(Bc.prototype.readFlatPosList)}},Yc.prototype.PATCHES_PARSERS={"http://www.opengis.net/gml/3.2":{PolygonPatch:$h(Bc.prototype.readPolygonPatch)}},Yc.prototype.SEGMENTS_PARSERS={"http://www.opengis.net/gml/3.2":{LineStringSegment:$h(Bc.prototype.readLineStringSegment)}},Yc.prototype.MULTIPOINT_PARSERS={"http://www.opengis.net/gml/3.2":{pointMember:Jh(xc.prototype.pointMemberParser),pointMembers:Jh(xc.prototype.pointMemberParser)}},Yc.prototype.MULTILINESTRING_PARSERS={"http://www.opengis.net/gml/3.2":{lineStringMember:Jh(xc.prototype.lineStringMemberParser),lineStringMembers:Jh(xc.prototype.lineStringMemberParser)}},Yc.prototype.MULTIPOLYGON_PARSERS={"http://www.opengis.net/gml/3.2":{polygonMember:Jh(xc.prototype.polygonMemberParser),polygonMembers:Jh(xc.prototype.polygonMemberParser)}},Yc.prototype.POINTMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Point:Jh(xc.prototype.readFlatCoordinatesFromNode)}},Yc.prototype.LINESTRINGMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{LineString:Jh(xc.prototype.readLineString)}},Yc.prototype.POLYGONMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Polygon:Jh(xc.prototype.readPolygon)}},Yc.prototype.RING_PARSERS={"http://www.opengis.net/gml/3.2":{LinearRing:$h(xc.prototype.readFlatLinearRing)}},Yc.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml/3.2":{exterior:nc(Bc.prototype.writeRing),interior:nc(Bc.prototype.writeRing)}},Yc.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml/3.2":{lowerCorner:nc(Nc),upperCorner:nc(Nc)}},Yc.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{surfaceMember:nc(Bc.prototype.writeSurfaceOrPolygonMember),polygonMember:nc(Bc.prototype.writeSurfaceOrPolygonMember)}},Yc.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{pointMember:nc(Bc.prototype.writePointMember)}},Yc.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{lineStringMember:nc(Bc.prototype.writeLineStringOrCurveMember),curveMember:nc(Bc.prototype.writeLineStringOrCurveMember)}},Yc.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml/3.2":{Curve:nc(Bc.prototype.writeCurveOrLineString),MultiCurve:nc(Bc.prototype.writeMultiCurveOrLineString),Point:nc(Yc.prototype.writePoint),MultiPoint:nc(Bc.prototype.writeMultiPoint),LineString:nc(Bc.prototype.writeCurveOrLineString),MultiLineString:nc(Bc.prototype.writeMultiCurveOrLineString),LinearRing:nc(Bc.prototype.writeLinearRing),Polygon:nc(Bc.prototype.writeSurfaceOrPolygon),MultiPolygon:nc(Bc.prototype.writeMultiSurfaceOrPolygon),Surface:nc(Bc.prototype.writeSurfaceOrPolygon),MultiSurface:nc(Bc.prototype.writeMultiSurfaceOrPolygon),Envelope:nc(Bc.prototype.writeEnvelope)}};var Zc=Yc,Hc=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Kc=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],Jc={rte:Sl,trk:jl,wpt:El},$c=uc(Kc,{rte:Jh(Sl),trk:Jh(jl),wpt:Jh(El)}),Qc=uc(Kc,{text:tc(Tc,"linkText"),type:tc(Tc,"linkType")}),tl=uc(Kc,{rte:nc((function(t,n,i){var r=i[0],e=n.getProperties(),o={node:t};o.properties=e;var u=n.getGeometry();if(u.getType()==Kr.LINE_STRING){var s=vf(u,!0,r);o.geometryLayout=s.getLayout(),e.rtept=s.getCoordinates()}var a=i[i.length-1].node,f=hl[a.namespaceURI],h=oc(e,f);hc(o,cl,ec,h,i,f)})),trk:nc((function(t,n,i){var r=i[0],e=n.getProperties(),o={node:t};o.properties=e;var u=n.getGeometry();if(u.getType()==Kr.MULTI_LINE_STRING){var s=vf(u,!0,r);e.trkseg=s.getLineStrings()}var a=i[i.length-1].node,f=vl[a.namespaceURI],h=oc(e,f);hc(o,pl,ec,h,i,f)})),wpt:nc((function(t,n,i){var r=i[0],e=i[i.length-1];e.properties=n.getProperties();var o=n.getGeometry();if(o.getType()==Kr.POINT){var u=vf(o,!0,r);e.geometryLayout=u.getLayout(),Tl(t,u.getCoordinates(),i)}}))}),nl=function(t){function n(n){var i=t.call(this)||this,r=n||{};return i.dataProjection=ae("EPSG:4326"),i.ao=r.readExtensions,i}return Hc(n,t),n.prototype.fo=function(t){t||(t=[]);for(var n=0,i=t.length;n<i;++n){var r=t[n];if(this.ao){var e=r.get("extensionsNode_")||null;this.ao(r,e)}r.set("extensionsNode_",void 0)}},n.prototype.readFeatureFromNode=function(t,n){if(!o(Kc,t.namespaceURI))return null;var i=Jc[t.localName];if(!i)return null;var r=i(t,[this.getReadOptions(t,n)]);return r?(this.fo([r]),r):null},n.prototype.readFeaturesFromNode=function(t,n){if(!o(Kc,t.namespaceURI))return[];if("gpx"==t.localName){var i=ac([],$c,t,[this.getReadOptions(t,n)]);return i?(this.fo(i),i):[]}return[]},n.prototype.writeFeaturesNode=function(t,n){n=this.adaptOptions(n);var i=Xh("http://www.topografix.com/GPX/1/1","gpx");return i.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xsi",Bh),i.setAttributeNS(Bh,"xsi:schemaLocation","http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd"),i.setAttribute("version","1.1"),i.setAttribute("creator","OpenLayers"),hc({node:i},tl,gl,t,[n]),i},n}(yc),il=uc(Kc,{name:tc(Tc),cmt:tc(Tc),desc:tc(Tc),src:tc(Tc),link:Ml,number:tc(Ec),extensions:Ol,type:tc(Tc),rtept:function(t,n){var i=ac({},rl,t,n);if(i){var r=n[n.length-1],e=r.flatCoordinates,o=r.layoutOptions;xl(e,o,t,i)}}}),rl=uc(Kc,{ele:tc(Sc),time:tc(Oc)}),el=uc(Kc,{name:tc(Tc),cmt:tc(Tc),desc:tc(Tc),src:tc(Tc),link:Ml,number:tc(Ec),type:tc(Tc),extensions:Ol,trkseg:function(t,n){var i=n[n.length-1];sc(ol,t,n);var r=i.flatCoordinates;i.ends.push(r.length)}}),ol=uc(Kc,{trkpt:function(t,n){var i=ac({},ul,t,n);if(i){var r=n[n.length-1],e=r.flatCoordinates,o=r.layoutOptions;xl(e,o,t,i)}}}),ul=uc(Kc,{ele:tc(Sc),time:tc(Oc)}),sl=uc(Kc,{ele:tc(Sc),time:tc(Oc),magvar:tc(Sc),geoidheight:tc(Sc),name:tc(Tc),cmt:tc(Tc),desc:tc(Tc),src:tc(Tc),link:Ml,sym:tc(Tc),type:tc(Tc),fix:tc(Tc),sat:tc(Ec),hdop:tc(Sc),vdop:tc(Sc),pdop:tc(Sc),ageofdgpsdata:tc(Sc),dgpsid:tc(Ec),extensions:Ol}),al=["text","type"],fl=uc(Kc,{text:nc(Nc),type:nc(Nc)}),hl=uc(Kc,["name","cmt","desc","src","link","number","type","rtept"]),cl=uc(Kc,{name:nc(Nc),cmt:nc(Nc),desc:nc(Nc),src:nc(Nc),link:nc(kl),number:nc(Ic),type:nc(Nc),rtept:ic(nc(Tl))}),ll=uc(Kc,["ele","time"]),vl=uc(Kc,["name","cmt","desc","src","link","number","type","trkseg"]),pl=uc(Kc,{name:nc(Nc),cmt:nc(Nc),desc:nc(Nc),src:nc(Nc),link:nc(kl),number:nc(Ic),type:nc(Nc),trkseg:ic(nc((function(t,n,i){var r={node:t};r.geometryLayout=n.getLayout(),r.properties={},hc(r,yl,dl,n.getCoordinates(),i)})))}),dl=rc("trkpt"),yl=uc(Kc,{trkpt:nc(Tl)}),ml=uc(Kc,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]),wl=uc(Kc,{ele:nc(Rc),time:nc(Pc),magvar:nc(Rc),geoidheight:nc(Rc),name:nc(Nc),cmt:nc(Nc),desc:nc(Nc),src:nc(Nc),link:nc(kl),sym:nc(Nc),type:nc(Nc),fix:nc(Nc),sat:nc(Ic),hdop:nc(Rc),vdop:nc(Rc),pdop:nc(Rc),ageofdgpsdata:nc(Rc),dgpsid:nc(Ic)}),bl={Point:"wpt",LineString:"rte",MultiLineString:"trk"};function gl(t,n,i){var r=t.getGeometry();if(r){var e=bl[r.getType()];if(e)return Xh(n[n.length-1].node.namespaceURI,e)}}function xl(t,n,i,r){return t.push(parseFloat(i.getAttribute("lon")),parseFloat(i.getAttribute("lat"))),"ele"in r?(t.push(r.ele),delete r.ele,n.hasZ=!0):t.push(0),"time"in r?(t.push(r.time),delete r.time,n.hasM=!0):t.push(0),t}function _l(t,n,i){var r=Iu,e=2;if(t.hasZ&&t.hasM?(r=Fu,e=4):t.hasZ?(r=Nu,e=3):t.hasM&&(r=zu,e=3),4!==e){for(var o=0,u=n.length/4;o<u;o++)n[o*e]=n[4*o],n[o*e+1]=n[4*o+1],t.hasZ&&(n[o*e+2]=n[4*o+2]),t.hasM&&(n[o*e+2]=n[4*o+3]);if(n.length=n.length/4*e,i)for(o=0,u=i.length;o<u;o++)i[o]=i[o]/4*e}return r}function Ml(t,n){var i=n[n.length-1],r=t.getAttribute("href");null!==r&&(i.link=r),sc(Qc,t,n)}function Ol(t,n){n[n.length-1].ho=t}function Sl(t,n){var i=n[0],r=ac({flatCoordinates:[],layoutOptions:{}},il,t,n);if(r){var e=r.flatCoordinates;delete r.flatCoordinates;var o=r.layoutOptions;delete r.layoutOptions;var u=_l(o,e),s=new Mf(e,u);vf(s,!1,i);var a=new ef(s);return a.setProperties(r,!0),a}}function jl(t,n){var i=n[0],r=ac({flatCoordinates:[],ends:[],layoutOptions:{}},el,t,n);if(r){var e=r.flatCoordinates;delete r.flatCoordinates;var o=r.ends;delete r.ends;var u=r.layoutOptions;delete r.layoutOptions;var s=_l(u,e,o),a=new Sf(e,s,o);vf(a,!1,i);var f=new ef(a);return f.setProperties(r,!0),f}}function El(t,n){var i=n[0],r=ac({},sl,t,n);if(r){var e={},o=xl([],e,t,r),u=_l(e,o),s=new _s(o,u);vf(s,!1,i);var a=new ef(s);return a.setProperties(r,!0),a}}function kl(t,n,i){t.setAttribute("href",n);var r=i[i.length-1].properties,e=[r.linkText,r.linkType];hc({node:t},fl,ec,e,i,al)}function Tl(t,n,i){var r=i[i.length-1],e=r.node.namespaceURI,o=r.properties;switch(t.setAttributeNS(null,"lat",String(n[1])),t.setAttributeNS(null,"lon",String(n[0])),r.geometryLayout){case Fu:0!==n[3]&&(o.time=n[3]);case Nu:0!==n[2]&&(o.ele=n[2]);break;case zu:0!==n[2]&&(o.time=n[2])}var u="rtept"==t.nodeName?ll[e]:ml[e],s=oc(o,u);hc({node:t,properties:o},wl,ec,s,i,u)}var Al=nl,Cl=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();function Pl(t){return"string"==typeof t?t:""}var Rl=function(t){function n(){return t.call(this)||this}return Cl(n,t),n.prototype.getType=function(){return sf},n.prototype.readFeature=function(t,n){return this.readFeatureFromText(Pl(t),this.adaptOptions(n))},n.prototype.readFeatureFromText=function(t,n){return v()},n.prototype.readFeatures=function(t,n){return this.readFeaturesFromText(Pl(t),this.adaptOptions(n))},n.prototype.readFeaturesFromText=function(t,n){return v()},n.prototype.readGeometry=function(t,n){return this.readGeometryFromText(Pl(t),this.adaptOptions(n))},n.prototype.readGeometryFromText=function(t,n){return v()},n.prototype.readProjection=function(t){return this.readProjectionFromText(Pl(t))},n.prototype.readProjectionFromText=function(t){return this.dataProjection},n.prototype.writeFeature=function(t,n){return this.writeFeatureText(t,this.adaptOptions(n))},n.prototype.writeFeatureText=function(t,n){return v()},n.prototype.writeFeatures=function(t,n){return this.writeFeaturesText(t,this.adaptOptions(n))},n.prototype.writeFeaturesText=function(t,n){return v()},n.prototype.writeGeometry=function(t,n){return this.writeGeometryText(t,this.adaptOptions(n))},n.prototype.writeGeometryText=function(t,n){return v()},n}(lf),Il=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Nl="barometric",zl="gps",Fl="none",Ll=/^B(\d{2})(\d{2})(\d{2})(\d{2})(\d{5})([NS])(\d{3})(\d{5})([EW])([AV])(\d{5})(\d{5})/,Gl=/^H.([A-Z]{3}).*?:(.*)/,Dl=/^HFDTE(\d{2})(\d{2})(\d{2})/,Ul=/\r\n|\r|\n/,ql=function(t){function n(n){var i=t.call(this)||this,r=n||{};return i.dataProjection=ae("EPSG:4326"),i.co=r.altitudeMode?r.altitudeMode:Fl,i}return Il(n,t),n.prototype.readFeatureFromText=function(t,n){var i,r,e=this.co,o=t.split(Ul),u={},s=[],a=2e3,f=0,h=1,c=-1;for(i=0,r=o.length;i<r;++i){var l=o[i],v=void 0;if("B"==l.charAt(0)){if(v=Ll.exec(l)){var p=parseInt(v[1],10),d=parseInt(v[2],10),y=parseInt(v[3],10),m=parseInt(v[4],10)+parseInt(v[5],10)/6e4;"S"==v[6]&&(m=-m);var w=parseInt(v[7],10)+parseInt(v[8],10)/6e4;if("W"==v[9]&&(w=-w),s.push(w,m),e!=Fl){var b=void 0;b=e==zl?parseInt(v[11],10):e==Nl?parseInt(v[12],10):0,s.push(b)}var g=Date.UTC(a,f,h,p,d,y);g<c&&(g=Date.UTC(a,f,h+1,p,d,y)),s.push(g/1e3),c=g}}else"H"==l.charAt(0)&&((v=Dl.exec(l))?(h=parseInt(v[1],10),f=parseInt(v[2],10)-1,a=2e3+parseInt(v[3],10)):(v=Gl.exec(l))&&(u[v[1]]=v[2].trim()))}if(0===s.length)return null;var x=new Mf(s,e==Fl?zu:Fu),_=new ef(vf(x,!1,n));return _.setProperties(u,!0),_},n.prototype.readFeaturesFromText=function(t,n){var i=this.readFeatureFromText(t,n);return i?[i]:[]},n}(Rl),Bl=function(t,n,i){if(i||2===arguments.length)for(var r,e=0,o=n.length;e<o;e++)!r&&e in n||(r||(r=Array.prototype.slice.call(n,0,e)),r[e]=n[e]);return t.concat(r||Array.prototype.slice.call(n))},Xl="version1",Vl="version2",Wl="version3",Yl={};Yl[Xl]={level0:{supports:[],formats:[],qualities:["native"]},level1:{supports:["regionByPx","sizeByW","sizeByH","sizeByPct"],formats:["jpg"],qualities:["native"]},level2:{supports:["regionByPx","regionByPct","sizeByW","sizeByH","sizeByPct","sizeByConfinedWh","sizeByWh"],formats:["jpg","png"],qualities:["native","color","grey","bitonal"]}},Yl[Vl]={level0:{supports:[],formats:["jpg"],qualities:["default"]},level1:{supports:["regionByPx","sizeByW","sizeByH","sizeByPct"],formats:["jpg"],qualities:["default"]},level2:{supports:["regionByPx","regionByPct","sizeByW","sizeByH","sizeByPct","sizeByConfinedWh","sizeByDistortedWh","sizeByWh"],formats:["jpg","png"],qualities:["default","bitonal"]}},Yl[Wl]={level0:{supports:[],formats:["jpg"],qualities:["default"]},level1:{supports:["regionByPx","regionSquare","sizeByW","sizeByH","sizeByWh"],formats:["jpg"],qualities:["default"]},level2:{supports:["regionByPx","regionSquare","regionByPct","sizeByW","sizeByH","sizeByPct","sizeByConfinedWh","sizeByWh"],formats:["jpg","png"],qualities:["default"]}},Yl.none={none:{supports:[],formats:[],qualities:[]}};var Zl=/^https?:\/\/library\.stanford\.edu\/iiif\/image-api\/(?:1\.1\/)?compliance\.html#level[0-2]$/,Hl=/^https?:\/\/iiif\.io\/api\/image\/2\/level[0-2](?:\.json)?$/,Kl=/(^https?:\/\/iiif\.io\/api\/image\/3\/level[0-2](?:\.json)?$)|(^level[0-2]$)/;var Jl={};Jl[Xl]=function(t){var n=t.getComplianceLevelSupportedFeatures();return void 0===n&&(n=Yl[Xl].level0),{url:void 0===t.imageInfo["@id"]?void 0:t.imageInfo["@id"].replace(/\/?(?:info\.json)?$/g,""),supports:n.supports,formats:Bl(Bl([],n.formats,!0),[void 0===t.imageInfo.formats?[]:t.imageInfo.formats],!1),qualities:Bl(Bl([],n.qualities,!0),[void 0===t.imageInfo.qualities?[]:t.imageInfo.qualities],!1),resolutions:t.imageInfo.scale_factors,tileSize:void 0!==t.imageInfo.tile_width?void 0!==t.imageInfo.tile_height?[t.imageInfo.tile_width,t.imageInfo.tile_height]:[t.imageInfo.tile_width,t.imageInfo.tile_width]:null!=t.imageInfo.tile_height?[t.imageInfo.tile_height,t.imageInfo.tile_height]:void 0}},Jl[Vl]=function(t){var n=t.getComplianceLevelSupportedFeatures(),i=Array.isArray(t.imageInfo.profile)&&t.imageInfo.profile.length>1,r=i&&t.imageInfo.profile[1].supports?t.imageInfo.profile[1].supports:[],e=i&&t.imageInfo.profile[1].formats?t.imageInfo.profile[1].formats:[],o=i&&t.imageInfo.profile[1].qualities?t.imageInfo.profile[1].qualities:[];return{url:t.imageInfo["@id"].replace(/\/?(?:info\.json)?$/g,""),sizes:void 0===t.imageInfo.sizes?void 0:t.imageInfo.sizes.map((function(t){return[t.width,t.height]})),tileSize:void 0===t.imageInfo.tiles?void 0:[t.imageInfo.tiles.map((function(t){return t.width}))[0],t.imageInfo.tiles.map((function(t){return void 0===t.height?t.width:t.height}))[0]],resolutions:void 0===t.imageInfo.tiles?void 0:t.imageInfo.tiles.map((function(t){return t.scaleFactors}))[0],supports:Bl(Bl([],n.supports,!0),r,!0),formats:Bl(Bl([],n.formats,!0),e,!0),qualities:Bl(Bl([],n.qualities,!0),o,!0)}},Jl[Wl]=function(t){var n=t.getComplianceLevelSupportedFeatures(),i=void 0===t.imageInfo.extraFormats?n.formats:Bl(Bl([],n.formats,!0),t.imageInfo.extraFormats,!0),r=void 0!==t.imageInfo.preferredFormats&&Array.isArray(t.imageInfo.preferredFormats)&&t.imageInfo.preferredFormats.length>0?t.imageInfo.preferredFormats.filter((function(t){return o(["jpg","png","gif"],t)})).reduce((function(t,n){return void 0===t&&o(i,n)?n:t}),void 0):void 0;return{url:t.imageInfo.id,sizes:void 0===t.imageInfo.sizes?void 0:t.imageInfo.sizes.map((function(t){return[t.width,t.height]})),tileSize:void 0===t.imageInfo.tiles?void 0:[t.imageInfo.tiles.map((function(t){return t.width}))[0],t.imageInfo.tiles.map((function(t){return t.height}))[0]],resolutions:void 0===t.imageInfo.tiles?void 0:t.imageInfo.tiles.map((function(t){return t.scaleFactors}))[0],supports:void 0===t.imageInfo.extraFeatures?n.supports:Bl(Bl([],n.supports,!0),t.imageInfo.extraFeatures,!0),formats:i,qualities:void 0===t.imageInfo.extraQualities?n.qualities:Bl(Bl([],n.qualities,!0),t.imageInfo.extraQualities,!0),preferredFormat:r}};var $l=function(){function t(t){this.setImageInfo(t)}return t.prototype.setImageInfo=function(t){this.imageInfo="string"==typeof t?JSON.parse(t):t},t.prototype.getImageApiVersion=function(){if(void 0!==this.imageInfo){var t=this.imageInfo["@context"]||"ol-no-context";"string"==typeof t&&(t=[t]);for(var n=0;n<t.length;n++)switch(t[n]){case"http://library.stanford.edu/iiif/image-api/1.1/context.json":case"http://iiif.io/api/image/1/context.json":return Xl;case"http://iiif.io/api/image/2/context.json":return Vl;case"http://iiif.io/api/image/3/context.json":return Wl;case"ol-no-context":if(this.getComplianceLevelEntryFromProfile(Xl)&&this.imageInfo.identifier)return Xl}g(!1,61)}},t.prototype.getComplianceLevelEntryFromProfile=function(t){if(void 0!==this.imageInfo&&void 0!==this.imageInfo.profile)switch(void 0===t&&(t=this.getImageApiVersion()),t){case Xl:if(Zl.test(this.imageInfo.profile))return this.imageInfo.profile;break;case Wl:if(Kl.test(this.imageInfo.profile))return this.imageInfo.profile;break;case Vl:if("string"==typeof this.imageInfo.profile&&Hl.test(this.imageInfo.profile))return this.imageInfo.profile;if(Array.isArray(this.imageInfo.profile)&&this.imageInfo.profile.length>0&&"string"==typeof this.imageInfo.profile[0]&&Hl.test(this.imageInfo.profile[0]))return this.imageInfo.profile[0]}},t.prototype.getComplianceLevelFromProfile=function(t){var n=this.getComplianceLevelEntryFromProfile(t);if(void 0!==n){var i=n.match(/level[0-2](?:\.json)?$/g);return Array.isArray(i)?i[0].replace(".json",""):void 0}},t.prototype.getComplianceLevelSupportedFeatures=function(){if(void 0!==this.imageInfo){var t=this.getImageApiVersion(),n=this.getComplianceLevelFromProfile(t);return void 0===n?Yl.none.none:Yl[t][n]}},t.prototype.getTileSourceOptions=function(t){var n=t||{},i=this.getImageApiVersion();if(void 0!==i){var r=void 0===i?void 0:Jl[i](this);if(void 0!==r)return{url:r.url,version:i,size:[this.imageInfo.width,this.imageInfo.height],sizes:r.sizes,format:void 0!==n.format&&o(r.formats,n.format)?n.format:void 0!==r.preferredFormat?r.preferredFormat:"jpg",supports:r.supports,quality:n.quality&&o(r.qualities,n.quality)?n.quality:o(r.qualities,"native")?"native":"default",resolutions:Array.isArray(r.resolutions)?r.resolutions.sort((function(t,n){return n-t})):void 0,tileSize:r.tileSize}}},t}(),Ql=function(){function t(t){var n=t||{};this.lo=void 0!==n.color?n.color:null}return t.prototype.clone=function(){var n=this.getColor();return new t({color:Array.isArray(n)?n.slice():n||void 0})},t.prototype.getColor=function(){return this.lo},t.prototype.setColor=function(t){this.lo=t},t}(),tv="fraction",nv="pixels",iv="bottom-left",rv="bottom-right",ev="top-left",ov="top-right",uv=0,sv=1,av=2,fv=3,hv=4,cv=function(){function t(t){this.vo=t.opacity,this.Mr=t.rotateWithView,this.qr=t.rotation,this.po=t.scale,this.do=ua(t.scale),this.yo=t.displacement,this.mo=t.declutterMode}return t.prototype.clone=function(){var n=this.getScale();return new t({opacity:this.getOpacity(),scale:Array.isArray(n)?n.slice():n,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})},t.prototype.getOpacity=function(){return this.vo},t.prototype.getRotateWithView=function(){return this.Mr},t.prototype.getRotation=function(){return this.qr},t.prototype.getScale=function(){return this.po},t.prototype.getScaleArray=function(){return this.do},t.prototype.getDisplacement=function(){return this.yo},t.prototype.getDeclutterMode=function(){return this.mo},t.prototype.getAnchor=function(){return v()},t.prototype.getImage=function(t){return v()},t.prototype.getHitDetectionImage=function(){return v()},t.prototype.getPixelRatio=function(t){return 1},t.prototype.getImageState=function(){return v()},t.prototype.getImageSize=function(){return v()},t.prototype.getOrigin=function(){return v()},t.prototype.getSize=function(){return v()},t.prototype.setDisplacement=function(t){this.yo=t},t.prototype.setOpacity=function(t){this.vo=t},t.prototype.setRotateWithView=function(t){this.Mr=t},t.prototype.setRotation=function(t){this.qr=t},t.prototype.setScale=function(t){this.po=t,this.do=ua(t)},t.prototype.listenImageChange=function(t){v()},t.prototype.load=function(){v()},t.prototype.unlistenImageChange=function(t){v()},t}(),lv=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),vv=function(t){function n(n,i,r,e){var o=t.call(this)||this;return o.extent=n,o.Gi=r,o.resolution=i,o.state=e,o}return lv(n,t),n.prototype.changed=function(){this.dispatchEvent($)},n.prototype.getExtent=function(){return this.extent},n.prototype.getImage=function(){return v()},n.prototype.getPixelRatio=function(){return this.Gi},n.prototype.getResolution=function(){return this.resolution},n.prototype.getState=function(){return this.state},n.prototype.load=function(){v()},n}(J),pv=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();function dv(t,n,i){var r=t,e=!0,o=!1,u=!1,s=[vt(r,at,(function(){u=!0,o||n()}))];return r.src&&Jt?(o=!0,r.decode().then((function(){e&&n()})).catch((function(t){e&&(u?n():i())}))):s.push(vt(r,Q,i)),function(){e=!1,s.forEach(pt)}}var yv=function(t){function n(n,i,r,e,o,u){var s=t.call(this,n,i,r,uv)||this;return s.wo=e,s.bo=new Image,null!==o&&(s.bo.crossOrigin=o),s.xo=null,s.state=uv,s._o=u,s}return pv(n,t),n.prototype.getImage=function(){return this.bo},n.prototype.Mo=function(){this.state=fv,this.Oo(),this.changed()},n.prototype.So=function(){void 0===this.resolution&&(this.resolution=_r(this.extent)/this.bo.height),this.state=av,this.Oo(),this.changed()},n.prototype.load=function(){this.state!=uv&&this.state!=fv||(this.state=sv,this.changed(),this._o(this,this.wo),this.xo=dv(this.bo,this.So.bind(this),this.Mo.bind(this)))},n.prototype.setImage=function(t){this.bo=t,this.resolution=_r(this.extent)/this.bo.height},n.prototype.Oo=function(){this.xo&&(this.xo(),this.xo=null)},n}(vv),mv=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),wv=null,bv=function(t){function n(n,i,r,e,o,u){var s=t.call(this)||this;return s.jo=null,s.bo=n||new Image,null!==e&&(s.bo.crossOrigin=e),s.Eo={},s.lo=u,s.xo=null,s.ko=o,s.Me=r,s.wo=i,s.To,s}return mv(n,t),n.prototype.Ao=function(){if(void 0===this.To&&this.ko===av){wv||(wv=Qt(1,1)),wv.drawImage(this.bo,0,0);try{wv.getImageData(0,0,1,1),this.To=!1}catch(t){wv=null,this.To=!0}}return!0===this.To},n.prototype.Co=function(){this.dispatchEvent($)},n.prototype.Mo=function(){this.ko=fv,this.Oo(),this.Co()},n.prototype.So=function(){this.ko=av,this.Me?(this.bo.width=this.Me[0],this.bo.height=this.Me[1]):this.Me=[this.bo.width,this.bo.height],this.Oo(),this.Co()},n.prototype.getImage=function(t){return this.Po(t),this.Eo[t]?this.Eo[t]:this.bo},n.prototype.getPixelRatio=function(t){return this.Po(t),this.Eo[t]?t:1},n.prototype.getImageState=function(){return this.ko},n.prototype.getHitDetectionImage=function(){if(!this.jo)if(this.Ao()){var t=this.Me[0],n=this.Me[1],i=Qt(t,n);i.fillRect(0,0,t,n),this.jo=i.canvas}else this.jo=this.bo;return this.jo},n.prototype.getSize=function(){return this.Me},n.prototype.getSrc=function(){return this.wo},n.prototype.load=function(){if(this.ko==uv){this.ko=sv;try{this.bo.src=this.wo}catch(t){this.Mo()}this.xo=dv(this.bo,this.So.bind(this),this.Mo.bind(this))}},n.prototype.Po=function(t){if(this.lo&&!this.Eo[t]&&this.ko===av){var n=document.createElement("canvas");this.Eo[t]=n,n.width=Math.ceil(this.bo.width*t),n.height=Math.ceil(this.bo.height*t);var i=n.getContext("2d");if(i.scale(t,t),i.drawImage(this.bo,0,0),i.globalCompositeOperation="multiply","multiply"===i.globalCompositeOperation||this.Ao())i.fillStyle=At(this.lo),i.fillRect(0,0,n.width/t,n.height/t),i.globalCompositeOperation="destination-in",i.drawImage(this.bo,0,0);else{for(var r=i.getImageData(0,0,n.width,n.height),e=r.data,o=this.lo[0]/255,u=this.lo[1]/255,s=this.lo[2]/255,a=this.lo[3],f=0,h=e.length;f<h;f+=4)e[f]*=o,e[f+1]*=u,e[f+2]*=s,e[f+3]*=a;i.putImageData(r,0,0)}}},n.prototype.Oo=function(){this.xo&&(this.xo(),this.xo=null)},n}(J);function gv(t,n,i,r,e,o){var u=no.get(n,r,o);return u||(u=new bv(t,n,i,r,e,o),no.set(n,r,o,u)),u}var xv=bv,_v=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Mv=function(t){function n(n){var i=this,r=n||{},e=void 0!==r.opacity?r.opacity:1,o=void 0!==r.rotation?r.rotation:0,u=void 0!==r.scale?r.scale:1,s=void 0!==r.rotateWithView&&r.rotateWithView;(i=t.call(this,{opacity:e,rotation:o,scale:u,displacement:void 0!==r.displacement?r.displacement:[0,0],rotateWithView:s,declutterMode:r.declutterMode})||this).Ro=void 0!==r.anchor?r.anchor:[.5,.5],i.Io=null,i.No=void 0!==r.anchorOrigin?r.anchorOrigin:ev,i.zo=void 0!==r.anchorXUnits?r.anchorXUnits:tv,i.Fo=void 0!==r.anchorYUnits?r.anchorYUnits:tv,i.Lo=void 0!==r.crossOrigin?r.crossOrigin:null;var a=void 0!==r.img?r.img:null;i.Go=r.imgSize;var f=r.src;g(!(void 0!==f&&a),4),g(!a||a&&i.Go,5),void 0!==f&&0!==f.length||!a||(f=a.src||d(a)),g(void 0!==f&&f.length>0,6);var h=void 0!==r.src?uv:av;return i.lo=void 0!==r.color?Rt(r.color):null,i.Do=gv(a,f,void 0!==i.Go?i.Go:null,i.Lo,h,i.lo),i.Uo=void 0!==r.offset?r.offset:[0,0],i.qo=void 0!==r.offsetOrigin?r.offsetOrigin:ev,i.Bo=null,i.Me=void 0!==r.size?r.size:null,i}return _v(n,t),n.prototype.clone=function(){var t=this.getScale();return new n({anchor:this.Ro.slice(),anchorOrigin:this.No,anchorXUnits:this.zo,anchorYUnits:this.Fo,color:this.lo&&this.lo.slice?this.lo.slice():this.lo||void 0,crossOrigin:this.Lo,imgSize:this.Go,offset:this.Uo.slice(),offsetOrigin:this.qo,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:Array.isArray(t)?t.slice():t,size:null!==this.Me?this.Me.slice():void 0,src:this.getSrc()})},n.prototype.getAnchor=function(){var t=this.Io;if(!t){t=this.Ro;var n=this.getSize();if(this.zo==tv||this.Fo==tv){if(!n)return null;t=this.Ro.slice(),this.zo==tv&&(t[0]*=n[0]),this.Fo==tv&&(t[1]*=n[1])}if(this.No!=ev){if(!n)return null;t===this.Ro&&(t=this.Ro.slice()),this.No!=ov&&this.No!=rv||(t[0]=-t[0]+n[0]),this.No!=iv&&this.No!=rv||(t[1]=-t[1]+n[1])}this.Io=t}var i=this.getDisplacement();return[t[0]-i[0],t[1]+i[1]]},n.prototype.setAnchor=function(t){this.Ro=t,this.Io=null},n.prototype.getColor=function(){return this.lo},n.prototype.getImage=function(t){return this.Do.getImage(t)},n.prototype.getPixelRatio=function(t){return this.Do.getPixelRatio(t)},n.prototype.getImageSize=function(){return this.Do.getSize()},n.prototype.getImageState=function(){return this.Do.getImageState()},n.prototype.getHitDetectionImage=function(){return this.Do.getHitDetectionImage()},n.prototype.getOrigin=function(){if(this.Bo)return this.Bo;var t=this.Uo;if(this.qo!=ev){var n=this.getSize(),i=this.Do.getSize();if(!n||!i)return null;t=t.slice(),this.qo!=ov&&this.qo!=rv||(t[0]=i[0]-n[0]-t[0]),this.qo!=iv&&this.qo!=rv||(t[1]=i[1]-n[1]-t[1])}return this.Bo=t,this.Bo},n.prototype.getSrc=function(){return this.Do.getSrc()},n.prototype.getSize=function(){return this.Me?this.Me:this.Do.getSize()},n.prototype.listenImageChange=function(t){this.Do.addEventListener($,t)},n.prototype.load=function(){this.Do.load()},n.prototype.unlistenImageChange=function(t){this.Do.removeEventListener($,t)},n}(cv),Ov=function(){function t(t){var n=t||{};this.lo=void 0!==n.color?n.color:null,this.Xo=n.lineCap,this.Vo=void 0!==n.lineDash?n.lineDash:null,this.Wo=n.lineDashOffset,this.Yo=n.lineJoin,this.Zo=n.miterLimit,this.Ho=n.width}return t.prototype.clone=function(){var n=this.getColor();return new t({color:Array.isArray(n)?n.slice():n||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},t.prototype.getColor=function(){return this.lo},t.prototype.getLineCap=function(){return this.Xo},t.prototype.getLineDash=function(){return this.Vo},t.prototype.getLineDashOffset=function(){return this.Wo},t.prototype.getLineJoin=function(){return this.Yo},t.prototype.getMiterLimit=function(){return this.Zo},t.prototype.getWidth=function(){return this.Ho},t.prototype.setColor=function(t){this.lo=t},t.prototype.setLineCap=function(t){this.Xo=t},t.prototype.setLineDash=function(t){this.Vo=t},t.prototype.setLineDashOffset=function(t){this.Wo=t},t.prototype.setLineJoin=function(t){this.Yo=t},t.prototype.setMiterLimit=function(t){this.Zo=t},t.prototype.setWidth=function(t){this.Ho=t},t}(),Sv=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),jv=function(t){function n(n){var i=this,r=void 0!==n.rotateWithView&&n.rotateWithView;return(i=t.call(this,{opacity:1,rotateWithView:r,rotation:void 0!==n.rotation?n.rotation:0,scale:void 0!==n.scale?n.scale:1,displacement:void 0!==n.displacement?n.displacement:[0,0],declutterMode:n.declutterMode})||this).Eo=void 0,i.Ko=null,i.Jo=void 0!==n.fill?n.fill:null,i.Bo=[0,0],i.$o=n.points,i.Qo=void 0!==n.radius?n.radius:n.radius1,i.tu=n.radius2,i.nu=void 0!==n.angle?n.angle:0,i.iu=void 0!==n.stroke?n.stroke:null,i.Me=null,i.ru=null,i.render(),i}return Sv(n,t),n.prototype.clone=function(){var t=this.getScale(),i=new n({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return i.setOpacity(this.getOpacity()),i},n.prototype.getAnchor=function(){var t=this.Me;if(!t)return null;var n=this.getDisplacement();return[t[0]/2-n[0],t[1]/2+n[1]]},n.prototype.getAngle=function(){return this.nu},n.prototype.getFill=function(){return this.Jo},n.prototype.getHitDetectionImage=function(){return this.Ko||this.eu(this.ru),this.Ko},n.prototype.getImage=function(t){var n=this.Eo[t];if(!n){var i=this.ru,r=Qt(i.size*t,i.size*t);this.ou(i,r,t),n=r.canvas,this.Eo[t]=n}return n},n.prototype.getPixelRatio=function(t){return t},n.prototype.getImageSize=function(){return this.Me},n.prototype.getImageState=function(){return av},n.prototype.getOrigin=function(){return this.Bo},n.prototype.getPoints=function(){return this.$o},n.prototype.getRadius=function(){return this.Qo},n.prototype.getRadius2=function(){return this.tu},n.prototype.getSize=function(){return this.Me},n.prototype.getStroke=function(){return this.iu},n.prototype.listenImageChange=function(t){},n.prototype.load=function(){},n.prototype.unlistenImageChange=function(t){},n.prototype.uu=function(t,n,i){if(0===n||this.$o===1/0||"bevel"!==t&&"miter"!==t)return n;var r=this.Qo,e=void 0===this.tu?r:this.tu;if(r<e){var o=r;r=e,e=o}var u=void 0===this.tu?this.$o:2*this.$o,s=2*Math.PI/u,a=e*Math.sin(s),f=r-Math.sqrt(e*e-a*a),h=Math.sqrt(a*a+f*f),c=h/a;if("miter"===t&&c<=i)return c*n;var l=n/2/c,v=n/2*(f/h),p=Math.sqrt((r+l)*(r+l)+v*v)-r;if(void 0===this.tu||"bevel"===t)return 2*p;var d=r*Math.sin(s),y=e-Math.sqrt(r*r-d*d),m=Math.sqrt(d*d+y*y)/d;if(m<=i){var w=m*n/2-e-r;return 2*Math.max(p,w)}return 2*p},n.prototype.createRenderOptions=function(){var t,n=co,i=0,r=null,e=0,o=0;this.iu&&(null===(t=this.iu.getColor())&&(t=vo),t=Ft(t),void 0===(o=this.iu.getWidth())&&(o=1),r=this.iu.getLineDash(),e=this.iu.getLineDashOffset(),void 0===(n=this.iu.getLineJoin())&&(n=co),void 0===(i=this.iu.getMiterLimit())&&(i=lo));var u=this.uu(n,o,i),s=Math.max(this.Qo,this.tu||0);return{strokeStyle:t,strokeWidth:o,size:Math.ceil(2*s+u),lineDash:r,lineDashOffset:e,lineJoin:n,miterLimit:i}},n.prototype.render=function(){this.ru=this.createRenderOptions();var t=this.ru.size;this.Eo={},this.Me=[t,t]},n.prototype.ou=function(t,n,i){if(n.scale(i,i),n.translate(t.size/2,t.size/2),this.su(n),this.Jo){var r=this.Jo.getColor();null===r&&(r=ao),n.fillStyle=Ft(r),n.fill()}this.iu&&(n.strokeStyle=t.strokeStyle,n.lineWidth=t.strokeWidth,n.setLineDash&&t.lineDash&&(n.setLineDash(t.lineDash),n.lineDashOffset=t.lineDashOffset),n.lineJoin=t.lineJoin,n.miterLimit=t.miterLimit,n.stroke())},n.prototype.eu=function(t){if(this.Jo){var n=this.Jo.getColor(),i=0;if("string"==typeof n&&(n=Rt(n)),null===n?i=1:Array.isArray(n)&&(i=4===n.length?n[3]:1),0===i){var r=Qt(t.size,t.size);this.Ko=r.canvas,this.au(t,r)}}this.Ko||(this.Ko=this.getImage(1))},n.prototype.su=function(t){var n=this.$o,i=this.Qo;if(n===1/0)t.arc(0,0,i,0,2*Math.PI);else{var r=void 0===this.tu?i:this.tu;void 0!==this.tu&&(n*=2);for(var e=this.nu-Math.PI/2,o=2*Math.PI/n,u=0;u<n;u++){var s=e+u*o,a=u%2==0?i:r;t.lineTo(a*Math.cos(s),a*Math.sin(s))}t.closePath()}},n.prototype.au=function(t,n){n.translate(t.size/2,t.size/2),this.su(n),n.fillStyle=ao,n.fill(),this.iu&&(n.strokeStyle=t.strokeStyle,n.lineWidth=t.strokeWidth,t.lineDash&&(n.setLineDash(t.lineDash),n.lineDashOffset=t.lineDashOffset),n.lineJoin=t.lineJoin,n.miterLimit=t.miterLimit,n.stroke())},n}(cv),Ev=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),kv=function(t){function n(n){var i=n||{};return t.call(this,{points:1/0,fill:i.fill,radius:i.radius,stroke:i.stroke,scale:void 0!==i.scale?i.scale:1,rotation:void 0!==i.rotation?i.rotation:0,rotateWithView:void 0!==i.rotateWithView&&i.rotateWithView,displacement:void 0!==i.displacement?i.displacement:[0,0],declutterMode:i.declutterMode})||this}return Ev(n,t),n.prototype.clone=function(){var t=this.getScale(),i=new n({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return i.setOpacity(this.getOpacity()),i},n.prototype.setRadius=function(t){this.Qo=t,this.render()},n}(jv);function Tv(t){return(Tv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var Av=function(){function t(t){var n=t||{};this.fu=null,this.hu=Nv,void 0!==n.geometry&&this.setGeometry(n.geometry),this.Jo=void 0!==n.fill?n.fill:null,this.bo=void 0!==n.image?n.image:null,this.$=void 0!==n.renderer?n.renderer:null,this.cu=void 0!==n.hitDetectionRenderer?n.hitDetectionRenderer:null,this.iu=void 0!==n.stroke?n.stroke:null,this.lu=void 0!==n.text?n.text:null,this.vu=n.zIndex}return t.prototype.clone=function(){var n=this.getGeometry();return n&&"object"===Tv(n)&&(n=n.clone()),new t({geometry:n,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer(),stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},t.prototype.getRenderer=function(){return this.$},t.prototype.setRenderer=function(t){this.$=t},t.prototype.setHitDetectionRenderer=function(t){this.cu=t},t.prototype.getHitDetectionRenderer=function(){return this.cu},t.prototype.getGeometry=function(){return this.fu},t.prototype.getGeometryFunction=function(){return this.hu},t.prototype.getFill=function(){return this.Jo},t.prototype.setFill=function(t){this.Jo=t},t.prototype.getImage=function(){return this.bo},t.prototype.setImage=function(t){this.bo=t},t.prototype.getStroke=function(){return this.iu},t.prototype.setStroke=function(t){this.iu=t},t.prototype.getText=function(){return this.lu},t.prototype.setText=function(t){this.lu=t},t.prototype.getZIndex=function(){return this.vu},t.prototype.setGeometry=function(t){"function"==typeof t?this.hu=t:"string"==typeof t?this.hu=function(n){return n.get(t)}:t?void 0!==t&&(this.hu=function(){return t}):this.hu=Nv,this.fu=t},t.prototype.setZIndex=function(t){this.vu=t},t}();function Cv(t){var n;if("function"==typeof t)n=t;else{var i;if(Array.isArray(t))i=t;else g("function"==typeof t.getZIndex,41),i=[t];n=function(){return i}}return n}var Pv=null;function Rv(t,n){if(!Pv){var i=new Ql({color:"rgba(255,255,255,0.4)"}),r=new Ov({color:"#3399CC",width:1.25});Pv=[new Av({image:new kv({fill:i,stroke:r,radius:5}),fill:i,stroke:r})]}return Pv}function Iv(){var t={},n=[255,255,255,1],i=[0,153,255,1];return t[Kr.POLYGON]=[new Av({fill:new Ql({color:[255,255,255,.5]})})],t[Kr.MULTI_POLYGON]=t[Kr.POLYGON],t[Kr.LINE_STRING]=[new Av({stroke:new Ov({color:n,width:5})}),new Av({stroke:new Ov({color:i,width:3})})],t[Kr.MULTI_LINE_STRING]=t[Kr.LINE_STRING],t[Kr.CIRCLE]=t[Kr.POLYGON].concat(t[Kr.LINE_STRING]),t[Kr.POINT]=[new Av({image:new kv({radius:6,fill:new Ql({color:i}),stroke:new Ov({color:n,width:1.5})}),zIndex:1/0})],t[Kr.MULTI_POINT]=t[Kr.POINT],t[Kr.GEOMETRY_COLLECTION]=t[Kr.POLYGON].concat(t[Kr.LINE_STRING],t[Kr.POINT]),t}function Nv(t){return t.getGeometry()}var zv=Av,Fv="point",Lv="line",Gv=function(){function t(t){var n=t||{};this.pu=n.font,this.qr=n.rotation,this.Mr=n.rotateWithView,this.po=n.scale,this.do=ua(void 0!==n.scale?n.scale:1),this.lu=n.text,this.du=n.textAlign,this.yu=n.justify,this.mu=n.textBaseline,this.Jo=void 0!==n.fill?n.fill:new Ql({color:"#333"}),this.wu=void 0!==n.maxAngle?n.maxAngle:Math.PI/4,this.bu=void 0!==n.placement?n.placement:Fv,this.gu=!!n.overflow,this.iu=void 0!==n.stroke?n.stroke:null,this.xu=void 0!==n.offsetX?n.offsetX:0,this._u=void 0!==n.offsetY?n.offsetY:0,this.Mu=n.backgroundFill?n.backgroundFill:null,this.Ou=n.backgroundStroke?n.backgroundStroke:null,this.Ei=void 0===n.padding?null:n.padding}return t.prototype.clone=function(){var n=this.getScale();return new t({font:this.getFont(),placement:this.getPlacement(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(n)?n.slice():n,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0})},t.prototype.getOverflow=function(){return this.gu},t.prototype.getFont=function(){return this.pu},t.prototype.getMaxAngle=function(){return this.wu},t.prototype.getPlacement=function(){return this.bu},t.prototype.getOffsetX=function(){return this.xu},t.prototype.getOffsetY=function(){return this._u},t.prototype.getFill=function(){return this.Jo},t.prototype.getRotateWithView=function(){return this.Mr},t.prototype.getRotation=function(){return this.qr},t.prototype.getScale=function(){return this.po},t.prototype.getScaleArray=function(){return this.do},t.prototype.getStroke=function(){return this.iu},t.prototype.getText=function(){return this.lu},t.prototype.getTextAlign=function(){return this.du},t.prototype.getJustify=function(){return this.yu},t.prototype.getTextBaseline=function(){return this.mu},t.prototype.getBackgroundFill=function(){return this.Mu},t.prototype.getBackgroundStroke=function(){return this.Ou},t.prototype.getPadding=function(){return this.Ei},t.prototype.setOverflow=function(t){this.gu=t},t.prototype.setFont=function(t){this.pu=t},t.prototype.setMaxAngle=function(t){this.wu=t},t.prototype.setOffsetX=function(t){this.xu=t},t.prototype.setOffsetY=function(t){this._u=t},t.prototype.setPlacement=function(t){this.bu=t},t.prototype.setRotateWithView=function(t){this.Mr=t},t.prototype.setFill=function(t){this.Jo=t},t.prototype.setRotation=function(t){this.qr=t},t.prototype.setScale=function(t){this.po=t,this.do=ua(void 0!==t?t:1)},t.prototype.setStroke=function(t){this.iu=t},t.prototype.setText=function(t){this.lu=t},t.prototype.setTextAlign=function(t){this.du=t},t.prototype.setJustify=function(t){this.yu=t},t.prototype.setTextBaseline=function(t){this.mu=t},t.prototype.setBackgroundFill=function(t){this.Mu=t},t.prototype.setBackgroundStroke=function(t){this.Ou=t},t.prototype.setPadding=function(t){this.Ei=t},t}();function Dv(t){return(Dv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var Uv,qv,Bv,Xv,Vv,Wv,Yv=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Zv=["http://www.google.com/kml/ext/2.2"],Hv=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"],Kv={fraction:tv,pixels:nv,insetPixels:nv},Jv=uc(Hv,{ExtendedData:Zp,Region:Hp,MultiGeometry:tc(Gp,"geometry"),LineString:tc(zp,"geometry"),LinearRing:tc(Fp,"geometry"),Point:tc(Dp,"geometry"),Polygon:tc(qp,"geometry"),Style:tc(Xp),StyleMap:function(t,n){var i=_p.call(this,t,n);if(!i)return;var r=n[n.length-1];Array.isArray(i)?r.Style=i:"string"==typeof i?r.styleUrl=i:g(!1,38)},address:tc(Tc),description:tc(Tc),name:tc(Tc),open:tc(_c),phoneNumber:tc(Tc),styleUrl:tc(bp),visibility:tc(_c)},uc(Zv,{MultiTrack:tc((function(t,n){var i=ac([],Tp,t,n);if(!i)return;return new Sf(i)}),"geometry"),Track:tc(Cp,"geometry")})),$v=uc(Hv,{ExtendedData:Zp,Region:Hp,Link:function(t,n){sc(Qv,t,n)},address:tc(Tc),description:tc(Tc),name:tc(Tc),open:tc(_c),phoneNumber:tc(Tc),visibility:tc(_c)}),Qv=uc(Hv,{href:tc(wp)}),tp=uc(Hv,{LatLonAltBox:function(t,n){var i=ac({},$p,t,n);if(!i)return;var r=n[n.length-1],e=[parseFloat(i.west),parseFloat(i.south),parseFloat(i.east),parseFloat(i.north)];r.extent=e,r.altitudeMode=i.altitudeMode,r.minAltitude=parseFloat(i.minAltitude),r.maxAltitude=parseFloat(i.maxAltitude)},Lod:function(t,n){var i=ac({},Qp,t,n);if(!i)return;var r=n[n.length-1];r.minLodPixels=parseFloat(i.minLodPixels),r.maxLodPixels=parseFloat(i.maxLodPixels),r.minFadeExtent=parseFloat(i.minFadeExtent),r.maxFadeExtent=parseFloat(i.maxFadeExtent)}}),np=uc(Hv,["Document","Placemark"]),ip=uc(Hv,{Document:nc((function(t,n,i){hc({node:t},ed,od,n,i,void 0,this)})),Placemark:nc(Td)}),rp=null;var ep,op=null;var up,sp=null;var ap=null;var fp=null;var hp,cp=null;function lp(t){return 32/Math.min(t[0],t[1])}function vp(t){return t}var pp=function(t){function n(n){var i=t.call(this)||this,r=n||{};return cp||(rp=new Ql({color:Uv=[255,255,255,1]}),Wv="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png",op=new Mv({anchor:qv=[20,2],anchorOrigin:iv,anchorXUnits:Bv=nv,anchorYUnits:Xv=nv,crossOrigin:"anonymous",rotation:0,scale:lp(Vv=[64,64]),size:Vv,src:Wv}),ep="NO_IMAGE",sp=new Ov({color:Uv,width:1}),up=new Ov({color:[51,51,51,1],width:2}),ap=new Gv({font:"bold 16px Helvetica",fill:rp,stroke:up,scale:.8}),fp=new zv({fill:rp,image:op,text:ap,stroke:sp,zIndex:0}),cp=[fp]),i.dataProjection=ae("EPSG:4326"),i.Su=r.defaultStyle?r.defaultStyle:cp,i.ju=void 0===r.extractStyles||r.extractStyles,i.Eu=void 0===r.writeStyles||r.writeStyles,i.ku={},i.Tu=void 0===r.showPointNames||r.showPointNames,i.Lo=void 0!==r.crossOrigin?r.crossOrigin:"anonymous",i.Au=r.iconUrlFunction?r.iconUrlFunction:vp,i.supportedMediaTypes=["application/vnd.google-earth.kml+xml"],i}return Yv(n,t),n.prototype.Cu=function(t,n){var i=ac([],uc(Hv,{Document:Kh(this.Cu,this),Folder:Kh(this.Cu,this),Placemark:Jh(this.Pu,this),Style:this.Ru.bind(this),StyleMap:this.Iu.bind(this)}),t,n,this);return i||void 0},n.prototype.Pu=function(t,n){var i=ac({geometry:null},Jv,t,n,this);if(i){var r=new ef,e=t.getAttribute("id");null!==e&&r.setId(e);var o=n[0],u=i.geometry;if(u&&vf(u,!1,o),r.setGeometry(u),delete i.geometry,this.ju){var s=function(t,n,i,r,e){return function(o,u){var s=e,a="",f=[];if(s){var h=o.getGeometry();if(h)if(h instanceof Lh)s=(f=h.getGeometriesArrayRecursive().filter((function(t){var n=t.getType();return n===Kr.POINT||n===Kr.MULTI_POINT}))).length>0;else{var c=h.getType();s=c===Kr.POINT||c===Kr.MULTI_POINT}}s&&(a=o.get("name"),(s=s&&!!a)&&a.search(/&[^&]+;/)>-1&&(hp||(hp=document.createElement("textarea")),hp.innerHTML=a,a=hp.value));var l=i;if(t?l=t:n&&(l=dp(n,i,r)),s){var v=function(t,n){var i=[0,0],r="start",e=t.getImage();if(e){var o=e.getSize();if(o&&2==o.length){var u=e.getScaleArray(),s=e.getAnchor();i[0]=u[0]*(o[0]-s[0]),i[1]=u[1]*(o[1]/2-s[1]),r="left"}}var a=t.getText();a?((a=a.clone()).setFont(a.getFont()||ap.getFont()),a.setScale(a.getScale()||ap.getScale()),a.setFill(a.getFill()||ap.getFill()),a.setStroke(a.getStroke()||up)):a=ap.clone();return a.setText(n),a.setOffsetX(i[0]),a.setOffsetY(i[1]),a.setTextAlign(r),new zv({image:e,text:a})}(l[0],a);return f.length>0?(v.setGeometry(new Lh(f)),[v,new zv({geometry:l[0].getGeometry(),image:null,fill:l[0].getFill(),stroke:l[0].getStroke(),text:null})].concat(l.slice(1))):v}return l}}(i.Style,i.styleUrl,this.Su,this.ku,this.Tu);r.setStyle(s)}return delete i.Style,r.setProperties(i,!0),r}},n.prototype.Ru=function(t,n){var i=t.getAttribute("id");if(null!==i){var r=Xp.call(this,t,n);if(r){var e=void 0,o=t.baseURI;if(o&&"about:blank"!=o||(o=window.location.href),o)e=new URL("#"+i,o).href;else e="#"+i;this.ku[e]=r}}},n.prototype.Iu=function(t,n){var i=t.getAttribute("id");if(null!==i){var r=_p.call(this,t,n);if(r){var e,o=t.baseURI;if(o&&"about:blank"!=o||(o=window.location.href),o)e=new URL("#"+i,o).href;else e="#"+i;this.ku[e]=r}}},n.prototype.readFeatureFromNode=function(t,n){if(!o(Hv,t.namespaceURI))return null;var i=this.Pu(t,[this.getReadOptions(t,n)]);return i||null},n.prototype.readFeaturesFromNode=function(t,n){if(!o(Hv,t.namespaceURI))return[];var i,r=t.localName;if("Document"==r||"Folder"==r)return(i=this.Cu(t,[this.getReadOptions(t,n)]))||[];if("Placemark"==r){var e=this.Pu(t,[this.getReadOptions(t,n)]);return e?[e]:[]}if("kml"==r){i=[];for(var u=t.firstElementChild;u;u=u.nextElementSibling){var s=this.readFeaturesFromNode(u,n);s&&a(i,s)}return i}return[]},n.prototype.readName=function(t){if(t){if("string"==typeof t){var n=Hh(t);return this.readNameFromDocument(n)}return Yh(t)?this.readNameFromDocument(t):this.readNameFromNode(t)}},n.prototype.readNameFromDocument=function(t){for(var n=t.firstChild;n;n=n.nextSibling)if(n.nodeType==Node.ELEMENT_NODE){var i=this.readNameFromNode(n);if(i)return i}},n.prototype.readNameFromNode=function(t){for(var n=t.firstElementChild;n;n=n.nextElementSibling)if(o(Hv,n.namespaceURI)&&"name"==n.localName)return Tc(n);for(n=t.firstElementChild;n;n=n.nextElementSibling){var i=n.localName;if(o(Hv,n.namespaceURI)&&("Document"==i||"Folder"==i||"Placemark"==i||"kml"==i)){var r=this.readNameFromNode(n);if(r)return r}}},n.prototype.readNetworkLinks=function(t){var n=[];if("string"==typeof t){var i=Hh(t);a(n,this.readNetworkLinksFromDocument(i))}else Yh(t)?a(n,this.readNetworkLinksFromDocument(t)):a(n,this.readNetworkLinksFromNode(t));return n},n.prototype.readNetworkLinksFromDocument=function(t){for(var n=[],i=t.firstChild;i;i=i.nextSibling)i.nodeType==Node.ELEMENT_NODE&&a(n,this.readNetworkLinksFromNode(i));return n},n.prototype.readNetworkLinksFromNode=function(t){for(var n=[],i=t.firstElementChild;i;i=i.nextElementSibling)if(o(Hv,i.namespaceURI)&&"NetworkLink"==i.localName){var r=ac({},$v,i,[]);n.push(r)}for(i=t.firstElementChild;i;i=i.nextElementSibling){var e=i.localName;!o(Hv,i.namespaceURI)||"Document"!=e&&"Folder"!=e&&"kml"!=e||a(n,this.readNetworkLinksFromNode(i))}return n},n.prototype.readRegion=function(t){var n=[];if("string"==typeof t){var i=Hh(t);a(n,this.readRegionFromDocument(i))}else Yh(t)?a(n,this.readRegionFromDocument(t)):a(n,this.readRegionFromNode(t));return n},n.prototype.readRegionFromDocument=function(t){for(var n=[],i=t.firstChild;i;i=i.nextSibling)i.nodeType==Node.ELEMENT_NODE&&a(n,this.readRegionFromNode(i));return n},n.prototype.readRegionFromNode=function(t){for(var n=[],i=t.firstElementChild;i;i=i.nextElementSibling)if(o(Hv,i.namespaceURI)&&"Region"==i.localName){var r=ac({},tp,i,[]);n.push(r)}for(i=t.firstElementChild;i;i=i.nextElementSibling){var e=i.localName;!o(Hv,i.namespaceURI)||"Document"!=e&&"Folder"!=e&&"kml"!=e||a(n,this.readRegionFromNode(i))}return n},n.prototype.writeFeaturesNode=function(t,n){n=this.adaptOptions(n);var i=Xh(Hv[4],"kml"),r="http://www.w3.org/2000/xmlns/";i.setAttributeNS(r,"xmlns:gx",Zv[0]),i.setAttributeNS(r,"xmlns:xsi",Bh),i.setAttributeNS(Bh,"xsi:schemaLocation","http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd");var e={node:i},o={};t.length>1?o.Document=t:1==t.length&&(o.Placemark=t[0]);var u=np[i.namespaceURI],s=oc(o,u);return hc(e,ip,ec,s,[n],u,this),i},n}(yc);function dp(t,n,i){return Array.isArray(t)?t:"string"==typeof t?dp(i[t],n,i):n}function yp(t){var n=Vh(t,!1),i=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(n);if(i){var r=i[1];return[parseInt(r.substr(6,2),16),parseInt(r.substr(4,2),16),parseInt(r.substr(2,2),16),parseInt(r.substr(0,2),16)/255]}}function mp(t){var n=Vh(t,!1),i=[];n=n.replace(/\s*,\s*/g,",");for(var r,e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?),([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|,|$)(?:([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|$))?\s*/i;r=e.exec(n);){var o=parseFloat(r[1]),u=parseFloat(r[2]),s=r[3]?parseFloat(r[3]):0;i.push(o,u,s),n=n.substr(r[0].length)}if(""===n)return i}function wp(t){var n=Vh(t,!1).trim(),i=t.baseURI;return i&&"about:blank"!=i||(i=window.location.href),i?new URL(n,i).href:n}function bp(t){var n=Vh(t,!1).trim().replace(/^(?!.*#)/,"#"),i=t.baseURI;return i&&"about:blank"!=i||(i=window.location.href),i?new URL(n,i).href:n}function gp(t){return Sc(t)}var xp=uc(Hv,{Pair:function(t,n){var i=ac({},Kp,t,n,this);if(!i)return;var r=i.key;if(r&&"normal"==r){var e=i.styleUrl;e&&(n[n.length-1]=e);var o=i.Style;o&&(n[n.length-1]=o)}}});function _p(t,n){return ac(void 0,xp,t,n,this)}var Mp=uc(Hv,{Icon:tc((function(t,n){var i=ac({},Pp,t,n);return i||null})),color:tc(yp),heading:tc(Sc),hotSpot:tc((function(t){var n,i=t.getAttribute("xunits"),r=t.getAttribute("yunits");return n="insetPixels"!==i?"insetPixels"!==r?iv:ev:"insetPixels"!==r?rv:ov,{x:parseFloat(t.getAttribute("x")),xunits:Kv[i],y:parseFloat(t.getAttribute("y")),yunits:Kv[r],origin:n}})),scale:tc(gp)});var Op=uc(Hv,{color:tc(yp),scale:tc(gp)});var Sp=uc(Hv,{color:tc(yp),width:tc(Sc)});var jp=uc(Hv,{color:tc(yp),fill:tc(_c),outline:tc(_c)});var Ep=uc(Hv,{coordinates:$h(mp)});function kp(t,n){return ac(null,Ep,t,n)}var Tp=uc(Zv,{Track:Jh(Cp)});var Ap=uc(Hv,{when:function(t,n){var i=n[n.length-1].whens,r=Vh(t,!1),e=Date.parse(r);i.push(isNaN(e)?0:e)}},uc(Zv,{coord:function(t,n){var i=n[n.length-1].coordinates,r=Vh(t,!1),e=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(r);if(e){var o=parseFloat(e[1]),u=parseFloat(e[2]),s=parseFloat(e[3]);i.push([o,u,s])}else i.push([])}}));function Cp(t,n){var i=ac({coordinates:[],whens:[]},Ap,t,n);if(i){for(var r=[],e=i.coordinates,o=i.whens,u=0,s=Math.min(e.length,o.length);u<s;++u)3==e[u].length&&r.push(e[u][0],e[u][1],e[u][2],o[u]);return new Mf(r,Fu)}}var Pp=uc(Hv,{href:tc(wp)},uc(Zv,{x:tc(Sc),y:tc(Sc),w:tc(Sc),h:tc(Sc)}));var Rp=uc(Hv,{coordinates:$h(mp)});function Ip(t,n){return ac(null,Rp,t,n)}var Np=uc(Hv,{extrude:tc(_c),tessellate:tc(_c),altitudeMode:tc(Tc)});function zp(t,n){var i=ac({},Np,t,n),r=Ip(t,n);if(r){var e=new Mf(r,Nu);return e.setProperties(i,!0),e}}function Fp(t,n){var i=ac({},Np,t,n),r=Ip(t,n);if(r){var e=new Xs(r,Nu,[r.length]);return e.setProperties(i,!0),e}}var Lp=uc(Hv,{LineString:Jh(zp),LinearRing:Jh(Fp),MultiGeometry:Jh(Gp),Point:Jh(Dp),Polygon:Jh(qp)});function Gp(t,n){var i,r=ac([],Lp,t,n);if(!r)return null;if(0===r.length)return new Lh(r);for(var e=!0,o=r[0].getType(),u=1,s=r.length;u<s;++u)if(r[u].getType()!=o){e=!1;break}if(e){var f=void 0,h=void 0;if(o==Kr.POINT){var c=r[0];f=c.getLayout(),h=c.getFlatCoordinates();for(u=1,s=r.length;u<s;++u)a(h,r[u].getFlatCoordinates());Vp(i=new Ef(h,f),r)}else o==Kr.LINE_STRING?Vp(i=new Sf(r),r):o==Kr.POLYGON?Vp(i=new Af(r),r):o==Kr.GEOMETRY_COLLECTION?i=new Lh(r):g(!1,37)}else i=new Lh(r);return i}function Dp(t,n){var i=ac({},Np,t,n),r=Ip(t,n);if(r){var e=new _s(r,Nu);return e.setProperties(i,!0),e}}var Up=uc(Hv,{innerBoundaryIs:function(t,n){var i=ac([],td,t,n);if(i.length>0){var r=n[n.length-1];r.push.apply(r,i)}},outerBoundaryIs:function(t,n){var i=ac(void 0,nd,t,n);if(i){n[n.length-1][0]=i}}});function qp(t,n){var i=ac({},Np,t,n),r=ac([null],Up,t,n);if(r&&r[0]){for(var e=r[0],o=[e.length],u=1,s=r.length;u<s;++u)a(e,r[u]),o.push(e.length);var f=new Xs(e,Nu,o);return f.setProperties(i,!0),f}}var Bp=uc(Hv,{IconStyle:function(t,n){var i=ac({},Mp,t,n);if(i){var r,e,o,u,s=n[n.length-1],a="Icon"in i?i.Icon:{},f=!("Icon"in i)||Object.keys(a).length>0,h=a.href;h?r=h:f&&(r=Wv);var c,l=iv,v=i.hotSpot;v?(e=[v.x,v.y],o=v.xunits,u=v.yunits,l=v.origin):/^http:\/\/maps\.(?:google|gstatic)\.com\//.test(r)&&(/pushpin/.test(r)?(e=qv,o=Bv,u=Xv):/arrow-reverse/.test(r)?(e=[54,42],o=Bv,u=Xv):/paddle/.test(r)&&(e=[32,1],o=Bv,u=Xv));var p,d=a.x,y=a.y;void 0!==d&&void 0!==y&&(c=[d,y]);var m,w=a.w,b=a.h;void 0!==w&&void 0!==b&&(p=[w,b]);var g=i.heading;void 0!==g&&(m=k(g));var x=i.scale,_=i.color;if(f){r==Wv&&(p=Vv);var M=new Mv({anchor:e,anchorOrigin:l,anchorXUnits:o,anchorYUnits:u,crossOrigin:this.Lo,offset:c,offsetOrigin:iv,rotation:m,scale:x,size:p,src:this.Au(r),color:_}),O=M.getScaleArray()[0],S=M.getSize();if(null===S){var j=M.getImageState();if(j===uv||j===sv){M.listenImageChange((function t(){var n=M.getImageState();if(n!==uv&&n!==sv){var i=M.getSize();if(i&&2==i.length){var r=lp(i);M.setScale(O*r)}M.unlistenImageChange(t)}})),j===uv&&M.load()}}else if(2==S.length){var E=lp(S);M.setScale(O*E)}s.imageStyle=M}else s.imageStyle=ep}},LabelStyle:function(t,n){var i=ac({},Op,t,n);if(i){var r=n[n.length-1],e=new Gv({fill:new Ql({color:"color"in i?i.color:Uv}),scale:i.scale});r.textStyle=e}},LineStyle:function(t,n){var i=ac({},Sp,t,n);if(i){var r=n[n.length-1],e=new Ov({color:"color"in i?i.color:Uv,width:"width"in i?i.width:1});r.strokeStyle=e}},PolyStyle:function(t,n){var i=ac({},jp,t,n);if(i){var r=n[n.length-1],e=new Ql({color:"color"in i?i.color:Uv});r.fillStyle=e;var o=i.fill;void 0!==o&&(r.fill=o);var u=i.outline;void 0!==u&&(r.outline=u)}}});function Xp(t,n){var i=ac({},Bp,t,n,this);if(!i)return null;var r,e="fillStyle"in i?i.fillStyle:rp,o=i.fill;void 0===o||o||(e=null),"imageStyle"in i?i.imageStyle!=ep&&(r=i.imageStyle):r=op;var u="textStyle"in i?i.textStyle:ap,s="strokeStyle"in i?i.strokeStyle:sp,a=i.outline;return void 0===a||a?[new zv({fill:e,image:r,stroke:s,text:u,zIndex:void 0})]:[new zv({geometry:function(t){var n=t.getGeometry(),i=n.getType();return i===Kr.GEOMETRY_COLLECTION?new Lh(n.getGeometriesArrayRecursive().filter((function(t){var n=t.getType();return n!==Kr.POLYGON&&n!==Kr.MULTI_POLYGON}))):i!==Kr.POLYGON&&i!==Kr.MULTI_POLYGON?n:void 0},fill:e,image:r,stroke:s,text:u,zIndex:void 0}),new zv({geometry:function(t){var n=t.getGeometry(),i=n.getType();return i===Kr.GEOMETRY_COLLECTION?new Lh(n.getGeometriesArrayRecursive().filter((function(t){var n=t.getType();return n===Kr.POLYGON||n===Kr.MULTI_POLYGON}))):i===Kr.POLYGON||i===Kr.MULTI_POLYGON?n:void 0},fill:e,stroke:null,zIndex:void 0})]}function Vp(t,n){var i,r,e,o=n.length,u=new Array(n.length),s=new Array(n.length),a=new Array(n.length);i=!1,r=!1,e=!1;for(var f=0;f<o;++f){var h=n[f];u[f]=h.get("extrude"),s[f]=h.get("tessellate"),a[f]=h.get("altitudeMode"),i=i||void 0!==u[f],r=r||void 0!==s[f],e=e||a[f]}i&&t.set("extrude",u),r&&t.set("tessellate",s),e&&t.set("altitudeMode",a)}var Wp=uc(Hv,{displayName:tc(Tc),value:tc(Tc)});var Yp=uc(Hv,{Data:function(t,n){var i=t.getAttribute("name");sc(Wp,t,n);var r=n[n.length-1];i&&r.displayName?r[i]={value:r.value,displayName:r.displayName,toString:function(){return r.value}}:null!==i?r[i]=r.value:null!==r.displayName&&(r[r.displayName]=r.value),delete r.value},SchemaData:function(t,n){sc(Jp,t,n)}});function Zp(t,n){sc(Yp,t,n)}function Hp(t,n){sc(tp,t,n)}var Kp=uc(Hv,{Style:tc(Xp),key:tc(Tc),styleUrl:tc(bp)});var Jp=uc(Hv,{SimpleData:function(t,n){var i=t.getAttribute("name");if(null!==i){var r=Tc(t);n[n.length-1][i]=r}}});var $p=uc(Hv,{altitudeMode:tc(Tc),minAltitude:tc(Sc),maxAltitude:tc(Sc),north:tc(Sc),south:tc(Sc),east:tc(Sc),west:tc(Sc)});var Qp=uc(Hv,{minLodPixels:tc(Sc),maxLodPixels:tc(Sc),minFadeExtent:tc(Sc),maxFadeExtent:tc(Sc)});var td=uc(Hv,{LinearRing:Jh(kp)});var nd=uc(Hv,{LinearRing:$h(kp)});function id(t,n){for(var i=Rt(n),r=[255*(4==i.length?i[3]:1),i[2],i[1],i[0]],e=0;e<4;++e){var o=Math.floor(r[e]).toString(16);r[e]=1==o.length?"0"+o:o}Nc(t,r.join(""))}var rd=uc(Hv,{Data:nc((function(t,n,i){t.setAttribute("name",n.name);var r={node:t},e=n.value;"object"==Dv(e)?(null!==e&&e.displayName&&hc(r,rd,ec,[e.displayName],i,["displayName"]),null!==e&&e.value&&hc(r,rd,ec,[e.value],i,["value"])):hc(r,rd,ec,[e],i,["value"])})),value:nc((function(t,n){Nc(t,n)})),displayName:nc((function(t,n){Cc(t,n)}))});var ed=uc(Hv,{Placemark:nc(Td)}),od=function(t,n,i){return Xh(n[n.length-1].node.namespaceURI,"Placemark")};var ud=rc("Data");var sd=uc(Hv,["href"],uc(Zv,["x","y","w","h"])),ad=uc(Hv,{href:nc(Nc)},uc(Zv,{x:nc(Rc),y:nc(Rc),w:nc(Rc),h:nc(Rc)})),fd=function(t,n,i){return Xh(Zv[0],"gx:"+i)};var hd=uc(Hv,["scale","heading","Icon","color","hotSpot"]),cd=uc(Hv,{Icon:nc((function(t,n,i){var r={node:t},e=i[i.length-1].node,o=sd[e.namespaceURI],u=oc(n,o);hc(r,ad,ec,u,i,o),u=oc(n,o=sd[Zv[0]]),hc(r,ad,fd,u,i,o)})),color:nc(id),heading:nc(Rc),hotSpot:nc((function(t,n){t.setAttribute("x",String(n.x)),t.setAttribute("y",String(n.y)),t.setAttribute("xunits",n.xunits),t.setAttribute("yunits",n.yunits)})),scale:nc(Gd)});var ld=uc(Hv,["color","scale"]),vd=uc(Hv,{color:nc(id),scale:nc(Gd)});var pd=uc(Hv,["color","width"]),dd=uc(Hv,{color:nc(id),width:nc(Rc)});var yd={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"},md=function(t,n,i){if(t)return Xh(n[n.length-1].node.namespaceURI,yd[t.getType()])},wd=rc("Point"),bd=rc("LineString"),gd=rc("LinearRing"),xd=rc("Polygon"),_d=uc(Hv,{LineString:nc(Pd),Point:nc(Pd),Polygon:nc(Fd),GeometryCollection:nc(Md)});function Md(t,n,i){var r,e={node:t},o=n.getType(),u=[];o===Kr.GEOMETRY_COLLECTION?(n.getGeometriesArrayRecursive().forEach((function(t){var n=t.getType();n===Kr.MULTI_POINT?u=u.concat(t.getPoints()):n===Kr.MULTI_LINE_STRING?u=u.concat(t.getLineStrings()):n===Kr.MULTI_POLYGON?u=u.concat(t.getPolygons()):n===Kr.POINT||n===Kr.LINE_STRING||n===Kr.POLYGON?u.push(t):g(!1,39)})),r=md):o===Kr.MULTI_POINT?(u=n.getPoints(),r=wd):o===Kr.MULTI_LINE_STRING?(u=n.getLineStrings(),r=bd):o===Kr.MULTI_POLYGON?(u=n.getPolygons(),r=xd):g(!1,39),hc(e,_d,r,u,i)}var Od=uc(Hv,{LinearRing:nc(Pd)});function Sd(t,n,i){hc({node:t},Od,gd,[n],i)}var jd=uc(Hv,{ExtendedData:nc((function(t,n,i){for(var r={node:t},e=n.names,o=n.values,u=e.length,s=0;s<u;s++)hc(r,rd,ud,[{name:e[s],value:o[s]}],i)})),MultiGeometry:nc(Md),LineString:nc(Pd),LinearRing:nc(Pd),Point:nc(Pd),Polygon:nc(Fd),Style:nc((function(t,n,i){var r={node:t},e={};if(n.pointStyles.length){var o=n.pointStyles[0].getText();o&&(e.LabelStyle=o);var u=n.pointStyles[0].getImage();u&&"function"==typeof u.getSrc&&(e.IconStyle=u)}if(n.lineStyles.length){(s=n.lineStyles[0].getStroke())&&(e.LineStyle=s)}if(n.polyStyles.length){var s;(s=n.polyStyles[0].getStroke())&&!e.LineStyle&&(e.LineStyle=s),e.PolyStyle=n.polyStyles[0]}var a=i[i.length-1].node,f=Dd[a.namespaceURI],h=oc(e,f);hc(r,Ud,ec,h,i,f)})),address:nc(Nc),description:nc(Nc),name:nc(Nc),open:nc(Ac),phoneNumber:nc(Nc),styleUrl:nc(Nc),visibility:nc(Ac)}),Ed=uc(Hv,["name","open","visibility","address","phoneNumber","description","styleUrl","Style"]),kd=rc("ExtendedData");function Td(t,n,i){var r={node:t};n.getId()&&t.setAttribute("id",n.getId());var e=n.getProperties(),o={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1};o[n.getGeometryName()]=1;var u=Object.keys(e||{}).sort().filter((function(t){return!o[t]})),s=n.getStyleFunction();if(s){var a=s(n,0);if(a){var f=Array.isArray(a)?a:[a],h=f;if(n.getGeometry()&&(h=f.filter((function(t){var i=t.getGeometryFunction()(n);if(i){var r=i.getType();return r===Kr.GEOMETRY_COLLECTION?i.getGeometriesArrayRecursive().filter((function(t){var n=t.getType();return n===Kr.POINT||n===Kr.MULTI_POINT})).length:r===Kr.POINT||r===Kr.MULTI_POINT}}))),this.Eu){var c=f,l=f;n.getGeometry()&&(c=f.filter((function(t){var i=t.getGeometryFunction()(n);if(i){var r=i.getType();return r===Kr.GEOMETRY_COLLECTION?i.getGeometriesArrayRecursive().filter((function(t){var n=t.getType();return n===Kr.LINE_STRING||n===Kr.MULTI_LINE_STRING})).length:r===Kr.LINE_STRING||r===Kr.MULTI_LINE_STRING}})),l=f.filter((function(t){var i=t.getGeometryFunction()(n);if(i){var r=i.getType();return r===Kr.GEOMETRY_COLLECTION?i.getGeometriesArrayRecursive().filter((function(t){var n=t.getType();return n===Kr.POLYGON||n===Kr.MULTI_POLYGON})).length:r===Kr.POLYGON||r===Kr.MULTI_POLYGON}}))),e.Style={pointStyles:h,lineStyles:c,polyStyles:l}}if(h.length&&void 0===e.name){var v=h[0].getText();v&&(e.name=v.getText())}}}var p=i[i.length-1].node,d=Ed[p.namespaceURI],y=oc(e,d);if(hc(r,jd,ec,y,i,d),u.length>0){var m=oc(e,u);hc(r,jd,kd,[{names:u,values:m}],i)}var w=i[0],b=n.getGeometry();b&&(b=vf(b,!0,w)),hc(r,jd,md,[b],i)}var Ad=uc(Hv,["extrude","tessellate","altitudeMode","coordinates"]),Cd=uc(Hv,{extrude:nc(Ac),tessellate:nc(Ac),altitudeMode:nc(Nc),coordinates:nc((function(t,n,i){var r,e=i[i.length-1],o=e.layout,u=e.stride;o==Iu||o==zu?r=2:o==Nu||o==Fu?r=3:g(!1,34);var s=n.length,a="";if(s>0){a+=n[0];for(var f=1;f<r;++f)a+=","+n[f];for(var h=u;h<s;h+=u){a+=" "+n[h];for(f=1;f<r;++f)a+=","+n[h+f]}}Nc(t,a)}))});function Pd(t,n,i){var r=n.getFlatCoordinates(),e={node:t};e.layout=n.getLayout(),e.stride=n.getStride();var o=n.getProperties();o.coordinates=r;var u=i[i.length-1].node,s=Ad[u.namespaceURI],a=oc(o,s);hc(e,Cd,ec,a,i,s)}var Rd=uc(Hv,["color","fill","outline"]),Id=uc(Hv,{outerBoundaryIs:nc(Sd),innerBoundaryIs:nc(Sd)}),Nd=rc("innerBoundaryIs"),zd=rc("outerBoundaryIs");function Fd(t,n,i){var r=n.getLinearRings(),e=r.shift(),o={node:t};hc(o,Id,Nd,r,i),hc(o,Id,zd,[e],i)}var Ld=uc(Hv,{color:nc(id),fill:nc(Ac),outline:nc(Ac)});function Gd(t,n){Rc(t,Math.round(1e6*n)/1e6)}var Dd=uc(Hv,["IconStyle","LabelStyle","LineStyle","PolyStyle"]),Ud=uc(Hv,{IconStyle:nc((function(t,n,i){var r={node:t},e={},o=n.getSrc(),u=n.getSize(),s=n.getImageSize(),a={href:o};if(u){a.w=u[0],a.h=u[1];var f=n.getAnchor(),h=n.getOrigin();if(h&&s&&0!==h[0]&&h[1]!==u[1]&&(a.x=h[0],a.y=s[1]-(h[1]+u[1])),f&&(f[0]!==u[0]/2||f[1]!==u[1]/2)){var c={x:f[0],xunits:nv,y:u[1]-f[1],yunits:nv};e.hotSpot=c}}e.Icon=a;var l=n.getScaleArray()[0],v=u;null===v&&(v=Vv),2==v.length&&(l/=lp(v)),1!==l&&(e.scale=l);var p=n.getRotation();0!==p&&(e.heading=p);var d=n.getColor();d&&(e.color=d);var y=i[i.length-1].node,m=hd[y.namespaceURI],w=oc(e,m);hc(r,cd,ec,w,i,m)})),LabelStyle:nc((function(t,n,i){var r={node:t},e={},o=n.getFill();o&&(e.color=o.getColor());var u=n.getScale();u&&1!==u&&(e.scale=u);var s=i[i.length-1].node,a=ld[s.namespaceURI],f=oc(e,a);hc(r,vd,ec,f,i,a)})),LineStyle:nc((function(t,n,i){var r={node:t},e={color:n.getColor(),width:Number(n.getWidth())||1},o=i[i.length-1].node,u=pd[o.namespaceURI],s=oc(e,u);hc(r,dd,ec,s,i,u)})),PolyStyle:nc((function(t,n,i){var r={node:t},e=n.getFill(),o=n.getStroke(),u={color:e?e.getColor():void 0,fill:!!e&&void 0,outline:!!o&&void 0},s=i[i.length-1].node,a=Rd[s.namespaceURI],f=oc(u,a);hc(r,Ld,ec,f,i,a)}))});var qd=pp,Bd=i(98),Xd=[1,0,0,1,0,0],Vd=function(){function t(t,n,i,r,e){this.styleFunction,this.Ft,this.Oe=e,this.Nu=t,this.zu=n,this.ze=null,this.Fu=null,this.ei=i,this.Lu=r}return t.prototype.get=function(t){return this.Lu[t]},t.prototype.getExtent=function(){return this.Ft||(this.Ft=this.Nu===Kr.POINT?or(this.zu):ur(this.zu,0,this.zu.length,2)),this.Ft},t.prototype.getFlatInteriorPoint=function(){if(!this.ze){var t=br(this.getExtent());this.ze=Es(this.zu,0,this.ei,2,t,0)}return this.ze},t.prototype.getFlatInteriorPoints=function(){if(!this.ze){var t=kf(this.zu,0,this.ei,2);this.ze=ks(this.zu,0,this.ei,2,t)}return this.ze},t.prototype.getFlatMidpoint=function(){return this.Fu||(this.Fu=wf(this.zu,0,this.zu.length,2,.5)),this.Fu},t.prototype.getFlatMidpoints=function(){if(!this.Fu){this.Fu=[];for(var t=this.zu,n=0,i=this.ei,r=0,e=i.length;r<e;++r){var o=i[r],u=wf(t,n,o,2,.5);a(this.Fu,u),n=o}}return this.Fu},t.prototype.getId=function(){return this.Oe},t.prototype.getOrientedFlatCoordinates=function(){return this.zu},t.prototype.getGeometry=function(){return this},t.prototype.getSimplifiedGeometry=function(t){return this},t.prototype.simplifyTransformed=function(t,n){return this},t.prototype.getProperties=function(){return this.Lu},t.prototype.getStride=function(){return 2},t.prototype.getStyleFunction=function(){return this.styleFunction},t.prototype.getType=function(){return this.Nu},t.prototype.transform=function(t){var n=(t=ae(t)).getExtent(),i=t.getWorldExtent();if(n&&i){var r=_r(i)/_r(n);Ze(Xd,i[0],i[3],r,-r,0,0,0),Lu(this.zu,0,this.zu.length,2,Xd,this.zu)}},t.prototype.getEnds=function(){return this.ei},t}();function Wd(t){var n=t.getType();switch(n){case Kr.POINT:return new _s(t.getFlatCoordinates());case Kr.MULTI_POINT:return new Ef(t.getFlatCoordinates(),Iu);case Kr.LINE_STRING:return new Mf(t.getFlatCoordinates(),Iu);case Kr.MULTI_LINE_STRING:return new Sf(t.getFlatCoordinates(),Iu,t.getEnds());case Kr.POLYGON:var i=t.getFlatCoordinates(),r=t.getEnds(),e=Us(i,r);return e.length>1?new Af(i,Iu,e):new Xs(i,Iu,r);default:throw new Error("Invalid geometry type:"+n)}}Vd.prototype.getEndss=Vd.prototype.getEnds,Vd.prototype.getFlatCoordinates=Vd.prototype.getOrientedFlatCoordinates;var Yd=Vd,Zd=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();function Hd(t,n,i){if(3===t){var r={keys:[],values:[],features:[]},e=i.readVarint()+i.pos;i.readFields(Kd,r,e),r.length=r.features.length,r.length&&(n[r.name]=r)}}function Kd(t,n,i){if(15===t)n.version=i.readVarint();else if(1===t)n.name=i.readString();else if(5===t)n.extent=i.readVarint();else if(2===t)n.features.push(i.pos);else if(3===t)n.keys.push(i.readString());else if(4===t){for(var r=null,e=i.readVarint()+i.pos;i.pos<e;)r=1===(t=i.readVarint()>>3)?i.readString():2===t?i.readFloat():3===t?i.readDouble():4===t?i.readVarint64():5===t?i.readVarint():6===t?i.readSVarint():7===t?i.readBoolean():null;n.values.push(r)}}function Jd(t,n,i){if(1==t)n.id=i.readVarint();else if(2==t)for(var r=i.readVarint()+i.pos;i.pos<r;){var e=n.layer.keys[i.readVarint()],o=n.layer.values[i.readVarint()];n.properties[e]=o}else 3==t?n.type=i.readVarint():4==t&&(n.geometry=i.pos)}function $d(t,n,i){t.pos=n.features[i];var r=t.readVarint()+t.pos,e={layer:n,type:0,properties:{}};return t.readFields(Jd,e,r),e}var Qd=function(t){function n(n){var i=t.call(this)||this,r=n||{};return i.dataProjection=new vi({code:"",units:li.TILE_PIXELS}),i.Gu=r.featureClass?r.featureClass:Yd,i.Se=r.geometryName,i.Du=r.layerName?r.layerName:"layer",i.Uu=r.layers?r.layers:null,i.qu=r.idProperty,i.supportedMediaTypes=["application/vnd.mapbox-vector-tile","application/x-protobuf"],i}return Zd(n,t),n.prototype.Bu=function(t,n,i,r){t.pos=n.geometry;for(var e=t.readVarint()+t.pos,o=1,u=0,s=0,a=0,f=0,h=0;t.pos<e;){if(!u){var c=t.readVarint();o=7&c,u=c>>3}u--,1===o||2===o?(s+=t.readSVarint(),a+=t.readSVarint(),1===o&&f>h&&(r.push(f),h=f),i.push(s,a),f+=2):7===o?f>h&&(i.push(i[h],i[h+1]),f+=2):g(!1,59)}f>h&&(r.push(f),h=f)},n.prototype.Xu=function(t,n,i){var r,e=n.type;if(0===e)return null;var o,u=n.properties;this.qu?(o=u[this.qu],delete u[this.qu]):o=n.id,u[this.Du]=n.layer.name;var s=[],a=[];this.Bu(t,n,s,a);var f=function(t,n){var i;1===t?i=1===n?Kr.POINT:Kr.MULTI_POINT:2===t?i=1===n?Kr.LINE_STRING:Kr.MULTI_LINE_STRING:3===t&&(i=Kr.POLYGON);return i}(e,a.length);if(this.Gu===Yd)(r=new this.Gu(f,s,a,u,o)).transform(i.dataProjection);else{var h=void 0;if(f==Kr.POLYGON){var c=Us(s,a);h=c.length>1?new Af(s,Iu,c):new Xs(s,Iu,a)}else h=f===Kr.POINT?new _s(s,Iu):f===Kr.LINE_STRING?new Mf(s,Iu):f===Kr.POLYGON?new Xs(s,Iu,a):f===Kr.MULTI_POINT?new Ef(s,Iu):f===Kr.MULTI_LINE_STRING?new Sf(s,Iu,a):null;r=new(0,this.Gu),this.Se&&r.setGeometryName(this.Se);var l=vf(h,!1,i);r.setGeometry(l),void 0!==o&&r.setId(o),r.setProperties(u,!0)}return r},n.prototype.getType=function(){return of},n.prototype.readFeatures=function(t,n){var i=this.Uu,r=this.adaptOptions(n),e=ae(r.dataProjection);e.setWorldExtent(r.extent),r.dataProjection=e;var o=new Bd(t),u=o.readFields(Hd,{}),s=[];for(var a in u)if(!i||-1!=i.indexOf(a)){var f=u[a],h=f?[0,0,f.extent,f.extent]:null;e.setExtent(h);for(var c=0,l=f.length;c<l;++c){var v=$d(o,f,c),p=this.Xu(o,v,r);null!==p&&s.push(p)}}return s},n.prototype.readProjection=function(t){return this.dataProjection},n.prototype.setLayers=function(t){this.Uu=t},n}(lf),ty=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ny=[null],iy=uc(ny,{nd:function(t,n){n[n.length-1].ndrefs.push(t.getAttribute("ref"))},tag:uy}),ry=uc(ny,{node:function(t,n){var i=n[0],r=n[n.length-1],e=t.getAttribute("id"),o=[parseFloat(t.getAttribute("lon")),parseFloat(t.getAttribute("lat"))];r.nodes[e]=o;var u=ac({tags:{}},oy,t,n);if(!H(u.tags)){var s=new _s(o);vf(s,!1,i);var a=new ef(s);void 0!==e&&a.setId(e),a.setProperties(u.tags,!0),r.features.push(a)}},way:function(t,n){var i=ac({id:t.getAttribute("id"),ndrefs:[],tags:{}},iy,t,n);n[n.length-1].ways.push(i)}}),ey=function(t){function n(){var n=t.call(this)||this;return n.dataProjection=ae("EPSG:4326"),n}return ty(n,t),n.prototype.readFeaturesFromNode=function(t,n){var i=this.getReadOptions(t,n);if("osm"==t.localName){for(var r=ac({nodes:{},ways:[],features:[]},ry,t,[i]),e=0;e<r.ways.length;e++){for(var o=r.ways[e],u=[],s=0,f=o.ndrefs.length;s<f;s++){a(u,r.nodes[o.ndrefs[s]])}var h=void 0;vf(h=o.ndrefs[0]==o.ndrefs[o.ndrefs.length-1]?new Xs(u,Iu,[u.length]):new Mf(u,Iu),!1,i);var c=new ef(h);void 0!==o.id&&c.setId(o.id),c.setProperties(o.tags,!0),r.features.push(c)}if(r.features)return r.features}return[]},n}(yc),oy=uc(ny,{tag:uy});function uy(t,n){n[n.length-1].tags[t.getAttribute("k")]=t.getAttribute("v")}var sy=ey,ay=function(){function t(){}return t.prototype.read=function(t){if(t){if("string"==typeof t){var n=Hh(t);return this.readFromDocument(n)}return Yh(t)?this.readFromDocument(t):this.readFromNode(t)}return null},t.prototype.readFromDocument=function(t){for(var n=t.firstChild;n;n=n.nextSibling)if(n.nodeType==Node.ELEMENT_NODE)return this.readFromNode(n);return null},t.prototype.readFromNode=function(t){},t}();function fy(t){return t.getAttributeNS("http://www.w3.org/1999/xlink","href")}var hy=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),cy=[null,"http://www.opengis.net/ows/1.1"],ly=uc(cy,{ServiceIdentification:tc((function(t,n){return ac({},Sy,t,n)})),ServiceProvider:tc((function(t,n){return ac({},jy,t,n)})),OperationsMetadata:tc((function(t,n){return ac({},xy,t,n)}))}),vy=function(t){function n(){return t.call(this)||this}return hy(n,t),n.prototype.readFromNode=function(t){var n=ac({},ly,t,[]);return n||null},n}(ay),py=uc(cy,{DeliveryPoint:tc(Tc),City:tc(Tc),AdministrativeArea:tc(Tc),PostalCode:tc(Tc),Country:tc(Tc),ElectronicMailAddress:tc(Tc)}),dy=uc(cy,{Value:Qh((function(t,n){return Tc(t)}))}),yy=uc(cy,{AllowedValues:tc((function(t,n){return ac({},dy,t,n)}))}),my=uc(cy,{Phone:tc((function(t,n){return ac({},_y,t,n)})),Address:tc((function(t,n){return ac({},py,t,n)}))}),wy=uc(cy,{HTTP:tc((function(t,n){return ac({},by,t,n)}))}),by=uc(cy,{Get:Qh((function(t,n){var i=fy(t);if(!i)return;return ac({href:i},My,t,n)})),Post:void 0}),gy=uc(cy,{DCP:tc((function(t,n){return ac({},wy,t,n)}))}),xy=uc(cy,{Operation:function(t,n){var i=t.getAttribute("name"),r=ac({},gy,t,n);if(!r)return;n[n.length-1][i]=r}}),_y=uc(cy,{Voice:tc(Tc),Facsimile:tc(Tc)}),My=uc(cy,{Constraint:Qh((function(t,n){var i=t.getAttribute("name");if(!i)return;return ac({name:i},yy,t,n)}))}),Oy=uc(cy,{IndividualName:tc(Tc),PositionName:tc(Tc),ContactInfo:tc((function(t,n){return ac({},my,t,n)}))}),Sy=uc(cy,{Abstract:tc(Tc),AccessConstraints:tc(Tc),Fees:tc(Tc),Title:tc(Tc),ServiceTypeVersion:tc(Tc),ServiceType:tc(Tc)}),jy=uc(cy,{ProviderName:tc(Tc),ProviderSite:tc(fy),ServiceContact:tc((function(t,n){return ac({},Oy,t,n)}))});var Ey=vy;function ky(t,n,i,r,e,o){var u,s;void 0!==e?(u=e,s=void 0!==o?o:0):(u=[],s=0);for(var a=n;a<i;){var f=t[a++];u[s++]=t[a++],u[s++]=f;for(var h=2;h<r;++h)u[s++]=t[a++]}return u.length=s,u}var Ty=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();function Ay(t,n,i){var r,e=i||1e5,o=new Array(n);for(r=0;r<n;++r)o[r]=0;for(var u=0,s=t.length;u<s;)for(r=0;r<n;++r,++u){var a=t[u],f=a-o[r];o[r]=a,t[u]=f}return Py(t,e)}function Cy(t,n,i){var r,e=i||1e5,o=new Array(n);for(r=0;r<n;++r)o[r]=0;for(var u=Ry(t,e),s=0,a=u.length;s<a;)for(r=0;r<n;++r,++s)o[r]+=u[s],u[s]=o[r];return u}function Py(t,n){for(var i=n||1e5,r=0,e=t.length;r<e;++r)t[r]=Math.round(t[r]*i);return Iy(t)}function Ry(t,n){for(var i=n||1e5,r=Ny(t),e=0,o=r.length;e<o;++e)r[e]/=i;return r}function Iy(t){for(var n=0,i=t.length;n<i;++n){var r=t[n];t[n]=r<0?~(r<<1):r<<1}return zy(t)}function Ny(t){for(var n=Fy(t),i=0,r=n.length;i<r;++i){var e=n[i];n[i]=1&e?~(e>>1):e>>1}return n}function zy(t){for(var n="",i=0,r=t.length;i<r;++i)n+=Ly(t[i]);return n}function Fy(t){for(var n=[],i=0,r=0,e=0,o=t.length;e<o;++e){var u=t.charCodeAt(e)-63;i|=(31&u)<<r,u<32?(n.push(i),i=0,r=0):r+=5}return n}function Ly(t){for(var n,i="";t>=32;)n=63+(32|31&t),i+=String.fromCharCode(n),t>>=5;return n=t+63,i+=String.fromCharCode(n)}var Gy=function(t){function n(n){var i=t.call(this)||this,r=n||{};return i.dataProjection=ae("EPSG:4326"),i.Vu=r.factor?r.factor:1e5,i.Wu=r.geometryLayout?r.geometryLayout:Iu,i}return Ty(n,t),n.prototype.readFeatureFromText=function(t,n){var i=this.readGeometryFromText(t,n);return new ef(i)},n.prototype.readFeaturesFromText=function(t,n){return[this.readFeatureFromText(t,n)]},n.prototype.readGeometryFromText=function(t,n){var i=Wu(this.Wu),r=Cy(t,i,this.Vu);ky(r,0,r.length,i,r);var e=vs(r,0,r.length,i);return vf(new Mf(e,this.Wu),!1,this.adaptOptions(n))},n.prototype.writeFeatureText=function(t,n){var i=t.getGeometry();return i?this.writeGeometryText(i,n):(g(!1,40),"")},n.prototype.writeFeaturesText=function(t,n){return this.writeFeatureText(t[0],n)},n.prototype.writeGeometryText=function(t,n){var i=(t=vf(t,!0,this.adaptOptions(n))).getFlatCoordinates(),r=t.getStride();return ky(i,0,i.length,r,i),Ay(i,r,this.Vu)},n}(Rl),Dy=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Uy=function(t){function n(n){var i=t.call(this)||this,r=n||{};return i.Du=r.layerName,i.Uu=r.layers?r.layers:null,i.dataProjection=ae(r.dataProjection?r.dataProjection:"EPSG:4326"),i}return Dy(n,t),n.prototype.readFeaturesFromObject=function(t,n){if("Topology"==t.type){var i=t,r=void 0,e=null,o=null;i.transform&&(e=(r=i.transform).scale,o=r.translate);var u=i.arcs;r&&function(t,n,i){for(var r=0,e=t.length;r<e;++r)Wy(t[r],n,i)}(u,e,o);var s=[],a=i.objects,f=this.Du,h=void 0;for(var c in a)this.Uu&&-1==this.Uu.indexOf(c)||("GeometryCollection"===a[c].type?(h=a[c],s.push.apply(s,Xy(h,u,e,o,f,c,n))):(h=a[c],s.push(Vy(h,u,e,o,f,c,n))));return s}return[]},n.prototype.readProjectionFromObject=function(t){return this.dataProjection},n}(mf),qy={Point:function(t,n,i){var r=t.coordinates;n&&i&&Yy(r,n,i);return new _s(r)},LineString:function(t,n){var i=By(t.arcs,n);return new Mf(i)},Polygon:function(t,n){for(var i=[],r=0,e=t.arcs.length;r<e;++r)i[r]=By(t.arcs[r],n);return new Xs(i)},MultiPoint:function(t,n,i){var r=t.coordinates;if(n&&i)for(var e=0,o=r.length;e<o;++e)Yy(r[e],n,i);return new Ef(r)},MultiLineString:function(t,n){for(var i=[],r=0,e=t.arcs.length;r<e;++r)i[r]=By(t.arcs[r],n);return new Sf(i)},MultiPolygon:function(t,n){for(var i=[],r=0,e=t.arcs.length;r<e;++r){for(var o=t.arcs[r],u=[],s=0,a=o.length;s<a;++s)u[s]=By(o[s],n);i[r]=u}return new Af(i)}};function By(t,n){for(var i,r=[],e=0,o=t.length;e<o;++e)if(i=t[e],e>0&&r.pop(),i>=0)for(var u=0,s=(a=n[i]).length;u<s;++u)r.push(a[u].slice(0));else{var a;for(u=(a=n[~i]).length-1;u>=0;--u)r.push(a[u].slice(0))}return r}function Xy(t,n,i,r,e,o,u){for(var s=t.geometries,a=[],f=0,h=s.length;f<h;++f)a[f]=Vy(s[f],n,i,r,e,o,u);return a}function Vy(t,n,i,r,e,o,u){var s=null,a=t.type;if(a){var f=qy[a];s=vf(s="Point"===a||"MultiPoint"===a?f(t,i,r):f(t,n),!1,u)}var h=new ef({geometry:s});void 0!==t.id&&h.setId(t.id);var c=t.properties;return e&&(c||(c={}),c[e]=o),c&&h.setProperties(c,!0),h}function Wy(t,n,i){for(var r=0,e=0,o=0,u=t.length;o<u;++o){var s=t[o];r+=s[0],e+=s[1],s[0]=r,s[1]=e,Yy(s,n,i)}}function Yy(t,n,i){t[0]=t[0]*n[0]+i[0],t[1]=t[1]*n[1]+i[1]}var Zy=Uy,Hy=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Ky={"http://www.opengis.net/gml":{boundedBy:tc(xc.prototype.readExtentElement,"bounds")},"http://www.opengis.net/wfs/2.0":{member:Jh(xc.prototype.readFeaturesInternal)}},Jy={"http://www.opengis.net/wfs":{totalInserted:tc(Ec),totalUpdated:tc(Ec),totalDeleted:tc(Ec)},"http://www.opengis.net/wfs/2.0":{totalInserted:tc(Ec),totalUpdated:tc(Ec),totalDeleted:tc(Ec)}},$y={"http://www.opengis.net/wfs":{TransactionSummary:tc(hm,"transactionSummary"),InsertResults:tc(pm,"insertIds")},"http://www.opengis.net/wfs/2.0":{TransactionSummary:tc(hm,"transactionSummary"),InsertResults:tc(pm,"insertIds")}},Qy={"http://www.opengis.net/wfs":{PropertyName:nc(Nc)},"http://www.opengis.net/wfs/2.0":{PropertyName:nc(Nc)}},tm={"http://www.opengis.net/wfs":{Insert:nc(dm),Update:nc(bm),Delete:nc(wm),Property:nc(gm),Native:nc(xm)},"http://www.opengis.net/wfs/2.0":{Insert:nc(dm),Update:nc(bm),Delete:nc(wm),Property:nc(gm),Native:nc(xm)}},nm="feature",im="http://www.w3.org/2000/xmlns/",rm={"2.0.0":"http://www.opengis.net/ogc/1.1","1.1.0":"http://www.opengis.net/ogc","1.0.0":"http://www.opengis.net/ogc"},em={"2.0.0":"http://www.opengis.net/wfs/2.0","1.1.0":"http://www.opengis.net/wfs","1.0.0":"http://www.opengis.net/wfs"},om={"2.0.0":"http://www.opengis.net/fes/2.0","1.1.0":"http://www.opengis.net/fes","1.0.0":"http://www.opengis.net/fes"},um={"2.0.0":"http://www.opengis.net/wfs/2.0 http://schemas.opengis.net/wfs/2.0/wfs.xsd","1.1.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd","1.0.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/wfs.xsd"},sm={"2.0.0":Zc,"1.1.0":Bc,"1.0.0":Gc},am=function(t){function n(n){var i=t.call(this)||this,r=n||{};return i.Yu=r.version?r.version:"1.1.0",i.Zu=r.featureType,i.Hu=r.featureNS,i.Ku=r.gmlFormat?r.gmlFormat:new sm[i.Yu],i.Ju=r.schemaLocation?r.schemaLocation:um[i.Yu],i}return Hy(n,t),n.prototype.getFeatureType=function(){return this.Zu},n.prototype.setFeatureType=function(t){this.Zu=t},n.prototype.readFeaturesFromNode=function(t,n){var i={node:t};W(i,{featureType:this.Zu,featureNS:this.Hu}),W(i,this.getReadOptions(t,n||{}));var r=[i],e=ac([],"2.0.0"===this.Yu?Ky:this.Ku.FEATURE_COLLECTION_PARSERS,t,r,this.Ku);return e||(e=[]),e},n.prototype.readTransactionResponse=function(t){if(t){if("string"==typeof t){var n=Hh(t);return this.readTransactionResponseFromDocument(n)}return Yh(t)?this.readTransactionResponseFromDocument(t):this.readTransactionResponseFromNode(t)}},n.prototype.readFeatureCollectionMetadata=function(t){if(t){if("string"==typeof t){var n=Hh(t);return this.readFeatureCollectionMetadataFromDocument(n)}return Yh(t)?this.readFeatureCollectionMetadataFromDocument(t):this.readFeatureCollectionMetadataFromNode(t)}},n.prototype.readFeatureCollectionMetadataFromDocument=function(t){for(var n=t.firstChild;n;n=n.nextSibling)if(n.nodeType==Node.ELEMENT_NODE)return this.readFeatureCollectionMetadataFromNode(n)},n.prototype.readFeatureCollectionMetadataFromNode=function(t){var n={},i=kc(t.getAttribute("numberOfFeatures"));return n.numberOfFeatures=i,ac(n,Ky,t,[],this.Ku)},n.prototype.readTransactionResponseFromDocument=function(t){for(var n=t.firstChild;n;n=n.nextSibling)if(n.nodeType==Node.ELEMENT_NODE)return this.readTransactionResponseFromNode(n)},n.prototype.readTransactionResponseFromNode=function(t){return ac({},$y,t,[])},n.prototype.writeGetFeature=function(t){var n=this,i=Xh(em[this.Yu],"GetFeature");i.setAttribute("service","WFS"),i.setAttribute("version",this.Yu),t.handle&&i.setAttribute("handle",t.handle),t.outputFormat&&i.setAttribute("outputFormat",t.outputFormat),void 0!==t.maxFeatures&&i.setAttribute("maxFeatures",String(t.maxFeatures)),t.resultType&&i.setAttribute("resultType",t.resultType),void 0!==t.startIndex&&i.setAttribute("startIndex",String(t.startIndex)),void 0!==t.count&&i.setAttribute("count",String(t.count)),void 0!==t.viewParams&&i.setAttribute("viewParams",t.viewParams),i.setAttributeNS(Bh,"xsi:schemaLocation",this.Ju);var r={node:i};if(W(r,{version:this.Yu,srsName:t.srsName,featureNS:t.featureNS?t.featureNS:this.Hu,featurePrefix:t.featurePrefix,propertyNames:t.propertyNames?t.propertyNames:[]}),g(Array.isArray(t.featureTypes),11),"string"==typeof t.featureTypes[0]){var e=t.filter;t.bbox&&(g(t.geometryName,12),e=this.combineBboxAndFilter(t.geometryName,t.bbox,t.srsName,e)),W(r,{geometryName:t.geometryName,filter:e}),Gm(i,t.featureTypes,[r])}else t.featureTypes.forEach((function(e){var o=n.combineBboxAndFilter(e.geometryName,e.bbox,t.srsName,t.filter);W(r,{geometryName:e.geometryName,filter:o}),Gm(i,[e.name],[r])}));return i},n.prototype.combineBboxAndFilter=function(t,n,i,r){var e=Nh(t,n,i);return r?Ih(r,e):e},n.prototype.writeTransaction=function(t,n,i,r){var e,o=[],u=r.version?r.version:this.Yu,s=Xh(em[u],"Transaction");s.setAttribute("service","WFS"),s.setAttribute("version",u),r&&(e=r.gmlOptions?r.gmlOptions:{},r.handle&&s.setAttribute("handle",r.handle)),s.setAttributeNS(Bh,"xsi:schemaLocation",um[u]);var a=function(t,n,i,r){var e,o=r.featurePrefix?r.featurePrefix:nm;"1.0.0"===i?e=2:"1.1.0"===i?e=3:"2.0.0"===i&&(e=3.2);return W({node:t},{version:i,featureNS:r.featureNS,featureType:r.featureType,featurePrefix:o,gmlVersion:e,hasZ:r.hasZ,srsName:r.srsName},n)}(s,e,u,r);return t&&fm("Insert",t,o,a),n&&fm("Update",n,o,a),i&&fm("Delete",i,o,a),r.nativeElements&&fm("Native",r.nativeElements,o,a),s},n.prototype.readProjectionFromDocument=function(t){for(var n=t.firstChild;n;n=n.nextSibling)if(n.nodeType==Node.ELEMENT_NODE)return this.readProjectionFromNode(n);return null},n.prototype.readProjectionFromNode=function(t){if(t.firstElementChild&&t.firstElementChild.firstElementChild)for(var n=(t=t.firstElementChild.firstElementChild).firstElementChild;n;n=n.nextElementSibling)if(0!==n.childNodes.length&&(1!==n.childNodes.length||3!==n.firstChild.nodeType)){var i=[{}];return this.Ku.readGeometryElement(n,i),ae(i.pop().srsName)}return null},n}(yc);function fm(t,n,i,r){hc(r,tm,rc(t),n,i)}function hm(t,n){return ac({},Jy,t,n)}var cm={"http://www.opengis.net/ogc":{FeatureId:Jh((function(t,n){return t.getAttribute("fid")}))},"http://www.opengis.net/ogc/1.1":{FeatureId:Jh((function(t,n){return t.getAttribute("fid")}))}};function lm(t,n){sc(cm,t,n)}var vm={"http://www.opengis.net/wfs":{Feature:lm},"http://www.opengis.net/wfs/2.0":{Feature:lm}};function pm(t,n){return ac([],vm,t,n)}function dm(t,n,i){var r=i[i.length-1],e=r.featureType,o=r.featureNS,u=r.gmlVersion,s=Xh(o,e);t.appendChild(s),2===u?Gc.prototype.writeFeatureElement(s,n,i):3===u?Bc.prototype.writeFeatureElement(s,n,i):Zc.prototype.writeFeatureElement(s,n,i)}function ym(t,n,i){var r=i[i.length-1].version,e=rm[r],o=Xh(e,"Filter"),u=Xh(e,"FeatureId");o.appendChild(u),u.setAttribute("fid",n),t.appendChild(o)}function mm(t,n){var i=(t=t||nm)+":";return 0===n.indexOf(i)?n:i+n}function wm(t,n,i){var r=i[i.length-1];g(void 0!==n.getId(),26);var e=r.featureType,o=r.featurePrefix,u=r.featureNS,s=mm(o,e);t.setAttribute("typeName",s),t.setAttributeNS(im,"xmlns:"+o,u);var a=n.getId();void 0!==a&&ym(t,a,i)}function bm(t,n,i){var r=i[i.length-1];g(void 0!==n.getId(),27);var e=r.version,o=r.featureType,u=r.featurePrefix,s=r.featureNS,a=mm(u,o),f=n.getGeometryName();t.setAttribute("typeName",a),t.setAttributeNS(im,"xmlns:"+u,s);var h=n.getId();if(void 0!==h){for(var c=n.getKeys(),l=[],v=0,p=c.length;v<p;v++){var d=n.get(c[v]);if(void 0!==d){var y=c[v];d&&"function"==typeof d.getSimplifiedGeometry&&(y=f),l.push({name:y,value:d})}}hc({version:e,gmlVersion:r.gmlVersion,node:t,hasZ:r.hasZ,srsName:r.srsName},tm,rc("Property"),l,i),ym(t,h,i)}}function gm(t,n,i){var r=i[i.length-1],e=r.version,o=em[e],u=Xh(o,"Name"),s=r.gmlVersion;if(t.appendChild(u),Nc(u,n.name),void 0!==n.value&&null!==n.value){var a=Xh(o,"Value");t.appendChild(a),n.value&&"function"==typeof n.value.getSimplifiedGeometry?2===s?Gc.prototype.writeGeometryElement(a,n.value,i):3===s?Bc.prototype.writeGeometryElement(a,n.value,i):Zc.prototype.writeGeometryElement(a,n.value,i):Nc(a,n.value)}}function xm(t,n,i){n.vendorId&&t.setAttribute("vendorId",n.vendorId),void 0!==n.safeToIgnore&&t.setAttribute("safeToIgnore",String(n.safeToIgnore)),void 0!==n.value&&Nc(t,n.value)}var _m={"http://www.opengis.net/wfs":{Query:nc(Mm)},"http://www.opengis.net/wfs/2.0":{Query:nc(Mm)},"http://www.opengis.net/ogc":{During:nc(km),And:nc(Tm),Or:nc(Tm),Not:nc(Am),BBOX:nc(Sm),Contains:nc(jm),Intersects:nc(jm),Within:nc(jm),DWithin:nc(Em),PropertyIsEqualTo:nc(Cm),PropertyIsNotEqualTo:nc(Cm),PropertyIsLessThan:nc(Cm),PropertyIsLessThanOrEqualTo:nc(Cm),PropertyIsGreaterThan:nc(Cm),PropertyIsGreaterThanOrEqualTo:nc(Cm),PropertyIsNull:nc(Pm),PropertyIsBetween:nc(Rm),PropertyIsLike:nc(Im)},"http://www.opengis.net/fes/2.0":{During:nc(km),And:nc(Tm),Or:nc(Tm),Not:nc(Am),BBOX:nc(Sm),Contains:nc(jm),Disjoint:nc(jm),Intersects:nc(jm),ResourceId:nc((function(t,n,i){t.setAttribute("rid",n.rid)})),Within:nc(jm),DWithin:nc(Em),PropertyIsEqualTo:nc(Cm),PropertyIsNotEqualTo:nc(Cm),PropertyIsLessThan:nc(Cm),PropertyIsLessThanOrEqualTo:nc(Cm),PropertyIsGreaterThan:nc(Cm),PropertyIsGreaterThanOrEqualTo:nc(Cm),PropertyIsNull:nc(Pm),PropertyIsBetween:nc(Rm),PropertyIsLike:nc(Im)}};function Mm(t,n,i){var r,e,o=i[i.length-1],u=o.version,s=o.featurePrefix,a=o.featureNS,f=o.propertyNames,h=o.srsName;r=s?mm(s,n):n,e="2.0.0"===u?"typeNames":"typeName",t.setAttribute(e,r),h&&t.setAttribute("srsName",h),a&&t.setAttributeNS(im,"xmlns:"+s,a);var c=W({},o);c.node=t,hc(c,Qy,rc("PropertyName"),f,i);var l=o.filter;if(l){var v=Xh(Dm(u),"Filter");t.appendChild(v),Om(v,l,i)}}function Om(t,n,i){var r=i[i.length-1],e={node:t};W(e,{context:r}),hc(e,_m,rc(n.getTagName()),[n],i)}function Sm(t,n,i){var r=i[i.length-1],e=r.context.version;r.srsName=n.srsName;var o=sm[e];Fm(e,t,n.geometryName),o.prototype.writeGeometryElement(t,n.extent,i)}function jm(t,n,i){var r=i[i.length-1],e=r.context.version;r.srsName=n.srsName;var o=sm[e];Fm(e,t,n.geometryName),o.prototype.writeGeometryElement(t,n.geometry,i)}function Em(t,n,i){var r=i[i.length-1].context.version;jm(t,n,i);var e=Xh(Dm(r),"Distance");Nc(e,n.distance.toString()),"2.0.0"===r?e.setAttribute("uom",n.unit):e.setAttribute("units",n.unit),t.appendChild(e)}function km(t,n,i){var r=i[i.length-1].context.version;Nm(om[r],"ValueReference",t,n.propertyName);var e=Xh(wc,"TimePeriod");t.appendChild(e);var o=Xh(wc,"begin");e.appendChild(o),Lm(o,n.begin);var u=Xh(wc,"end");e.appendChild(u),Lm(u,n.end)}function Tm(t,n,i){var r=i[i.length-1].context,e={node:t};W(e,{context:r});for(var o=n.conditions,u=0,s=o.length;u<s;++u){var a=o[u];hc(e,_m,rc(a.getTagName()),[a],i)}}function Am(t,n,i){var r=i[i.length-1].context,e={node:t};W(e,{context:r});var o=n.condition;hc(e,_m,rc(o.getTagName()),[o],i)}function Cm(t,n,i){var r=i[i.length-1].context.version;void 0!==n.matchCase&&t.setAttribute("matchCase",n.matchCase.toString()),Fm(r,t,n.propertyName),zm(r,t,""+n.expression)}function Pm(t,n,i){Fm(i[i.length-1].context.version,t,n.propertyName)}function Rm(t,n,i){var r=i[i.length-1].context.version,e=Dm(r);Fm(r,t,n.propertyName);var o=Xh(e,"LowerBoundary");t.appendChild(o),zm(r,o,""+n.lowerBoundary);var u=Xh(e,"UpperBoundary");t.appendChild(u),zm(r,u,""+n.upperBoundary)}function Im(t,n,i){var r=i[i.length-1].context.version;t.setAttribute("wildCard",n.wildCard),t.setAttribute("singleChar",n.singleChar),t.setAttribute("escapeChar",n.escapeChar),void 0!==n.matchCase&&t.setAttribute("matchCase",n.matchCase.toString()),Fm(r,t,n.propertyName),zm(r,t,""+n.pattern)}function Nm(t,n,i,r){var e=Xh(t,n);Nc(e,r),i.appendChild(e)}function zm(t,n,i){Nm(Dm(t),"Literal",n,i)}function Fm(t,n,i){"2.0.0"===t?Nm(om[t],"ValueReference",n,i):Nm(rm[t],"PropertyName",n,i)}function Lm(t,n){var i=Xh(wc,"TimeInstant");t.appendChild(i);var r=Xh(wc,"timePosition");i.appendChild(r),Nc(r,n)}function Gm(t,n,i){var r=i[i.length-1],e=W({},r);e.node=t,hc(e,_m,rc("Query"),n,i)}function Dm(t){return"2.0.0"===t?om[t]:rm[t]}var Um=am,qm=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Bm=1,Xm=2,Vm=3,Wm=4,Ym=5,Zm=6,Hm=7,Km=15,Jm=16,$m=17,Qm=function(){function t(t){this.Er=t,this.$u=0,this.Qu=!1,this.ts=!1,this.ns=!1,this.rs=!1,this.es=null,this.os=Iu}return t.prototype.readUint8=function(){return this.Er.getUint8(this.$u++)},t.prototype.readUint32=function(t){return this.Er.getUint32((this.$u+=4)-4,void 0!==t?t:this.ts)},t.prototype.readDouble=function(t){return this.Er.getFloat64((this.$u+=8)-8,void 0!==t?t:this.ts)},t.prototype.readPoint=function(){var t=[];return t.push(this.readDouble()),t.push(this.readDouble()),this.ns&&t.push(this.readDouble()),this.rs&&t.push(this.readDouble()),t},t.prototype.readLineString=function(){for(var t=this.readUint32(),n=[],i=0;i<t;i++)n.push(this.readPoint());return n},t.prototype.readPolygon=function(){for(var t=this.readUint32(),n=[],i=0;i<t;i++)n.push(this.readLineString());return n},t.prototype.readWkbHeader=function(t){var n=this.readUint8()>0,i=this.readUint32(n),r=Math.floor((268435455&i)/1e3),e=Boolean(2147483648&i)||1===r||3===r,o=Boolean(1073741824&i)||2===r||3===r,u=Boolean(536870912&i),s=(268435455&i)%1e3,a=["XY",e?"Z":"",o?"M":""].join(""),f=u?this.readUint32(n):null;if(void 0!==t&&t!==s)throw new Error("Unexpected WKB geometry type "+s);if(this.Qu){if(this.ts!==n)throw new Error("Inconsistent endian");if(this.os!==a)throw new Error("Inconsistent geometry layout");if(f&&this.es!==f)throw new Error("Inconsistent coordinate system (SRID)")}else this.ts=n,this.ns=e,this.rs=o,this.os=a,this.es=f,this.Qu=!0;return s},t.prototype.readWkbPayload=function(t){switch(t){case Bm:return this.readPoint();case Xm:return this.readLineString();case Vm:case $m:return this.readPolygon();case Wm:return this.readMultiPoint();case Ym:return this.readMultiLineString();case Zm:case Km:case Jm:return this.readMultiPolygon();case Hm:return this.readGeometryCollection();default:throw new Error("Unsupported WKB geometry type "+t+" is found")}},t.prototype.readWkbBlock=function(t){return this.readWkbPayload(this.readWkbHeader(t))},t.prototype.readWkbCollection=function(t,n){for(var i=this.readUint32(),r=[],e=0;e<i;e++){var o=t.call(this,n);o&&r.push(o)}return r},t.prototype.readMultiPoint=function(){return this.readWkbCollection(this.readWkbBlock,Bm)},t.prototype.readMultiLineString=function(){return this.readWkbCollection(this.readWkbBlock,Xm)},t.prototype.readMultiPolygon=function(){return this.readWkbCollection(this.readWkbBlock,Vm)},t.prototype.readGeometryCollection=function(){return this.readWkbCollection(this.readGeometry)},t.prototype.readGeometry=function(){var t=this.readWkbHeader(),n=this.readWkbPayload(t);switch(t){case Bm:return new _s(n,this.os);case Xm:return new Mf(n,this.os);case Vm:case $m:return new Xs(n,this.os);case Wm:return new Ef(n,this.os);case Ym:return new Sf(n,this.os);case Zm:case Km:case Jm:return new Af(n,this.os);case Hm:return new Lh(n);default:return null}},t.prototype.getSrid=function(){return this.es},t}(),tw=function(){function t(t){t=t||{},this.os=t.layout,this.ts=!1!==t.littleEndian,this.us=!1!==t.ewkb,this.ss=[],this.fs=W({X:0,Y:0,Z:0,M:0},t.nodata)}return t.prototype.writeUint8=function(t){this.ss.push([1,t])},t.prototype.writeUint32=function(t){this.ss.push([4,t])},t.prototype.writeDouble=function(t){this.ss.push([8,t])},t.prototype.writePoint=function(t,n){for(var i=W.apply(null,n.split("").map((function(n,i){var r;return(r={})[n]=t[i],r}))),r=0,e=this.os;r<e.length;r++){var o=e[r];this.writeDouble(o in i?i[o]:this.fs[o])}},t.prototype.writeLineString=function(t,n){this.writeUint32(t.length);for(var i=0;i<t.length;i++)this.writePoint(t[i],n)},t.prototype.writePolygon=function(t,n){this.writeUint32(t.length);for(var i=0;i<t.length;i++)this.writeLineString(t[i],n)},t.prototype.writeWkbHeader=function(t,n){t%=1e3,this.os.indexOf("Z")>=0&&(t+=this.us?2147483648:1e3),this.os.indexOf("M")>=0&&(t+=this.us?1073741824:2e3),this.us&&Number.isInteger(n)&&(t|=536870912),this.writeUint8(this.ts?1:0),this.writeUint32(t),this.us&&Number.isInteger(n)&&this.writeUint32(n)},t.prototype.writeMultiPoint=function(t,n){this.writeUint32(t.length);for(var i=0;i<t.length;i++)this.writeWkbHeader(1),this.writePoint(t[i],n)},t.prototype.writeMultiLineString=function(t,n){this.writeUint32(t.length);for(var i=0;i<t.length;i++)this.writeWkbHeader(2),this.writeLineString(t[i],n)},t.prototype.writeMultiPolygon=function(t,n){this.writeUint32(t.length);for(var i=0;i<t.length;i++)this.writeWkbHeader(3),this.writePolygon(t[i],n)},t.prototype.writeGeometryCollection=function(t){this.writeUint32(t.length);for(var n=0;n<t.length;n++)this.writeGeometry(t[n])},t.prototype.findMinimumLayout=function(t,n){void 0===n&&(n=Fu);var i,r;if(t instanceof Zu)return(i=t.getLayout())===(r=n)?i:i===Fu?r:r===Fu?i:Iu;if(t instanceof Lh)for(var e=t.getGeometriesArray(),o=0;o<e.length&&n!==Iu;o++)n=this.findMinimumLayout(e[o],n);return n},t.prototype.writeGeometry=function(t,n){var i,r,e=((i={})[Kr.POINT]=Bm,i[Kr.LINE_STRING]=Xm,i[Kr.POLYGON]=Vm,i[Kr.MULTI_POINT]=Wm,i[Kr.MULTI_LINE_STRING]=Ym,i[Kr.MULTI_POLYGON]=Zm,i[Kr.GEOMETRY_COLLECTION]=Hm,i),o=t.getType(),u=e[o];if(!u)throw new Error("GeometryType "+o+" is not supported");(this.os||(this.os=this.findMinimumLayout(t)),this.writeWkbHeader(u,n),t instanceof Zu)?((r={})[Kr.POINT]=this.writePoint,r[Kr.LINE_STRING]=this.writeLineString,r[Kr.POLYGON]=this.writePolygon,r[Kr.MULTI_POINT]=this.writeMultiPoint,r[Kr.MULTI_LINE_STRING]=this.writeMultiLineString,r[Kr.MULTI_POLYGON]=this.writeMultiPolygon,r)[o].call(this,t.getCoordinates(),t.getLayout()):t instanceof Lh&&this.writeGeometryCollection(t.getGeometriesArray())},t.prototype.getBuffer=function(){var t=this,n=this.ss.reduce((function(t,n){return t+n[0]}),0),i=new ArrayBuffer(n),r=new DataView(i),e=0;return this.ss.forEach((function(n){switch(n[0]){case 1:r.setUint8(e,n[1]);break;case 4:r.setUint32(e,n[1],t.ts);break;case 8:r.setFloat64(e,n[1],t.ts)}e+=n[0]})),i},t}();function nw(t){return"string"==typeof t?function(t){for(var n=new Uint8Array(t.length/2),i=0;i<t.length/2;i++)n[i]=parseInt(t.substr(2*i,2),16);return new DataView(n.buffer)}(t):ArrayBuffer.isView(t)?t instanceof DataView?t:new DataView(t.buffer,t.byteOffset,t.byteLength):t instanceof ArrayBuffer?new DataView(t):null}var iw=function(t){function n(n){var i=t.call(this)||this,r=n||{};return i.splitCollection=Boolean(r.splitCollection),i.hs=null,i.cs=!1!==r.hex,i.ls=!1!==r.littleEndian,i.vs=!1!==r.ewkb,i.os=r.geometryLayout,i.ps=r.nodataZ||0,i.ds=r.nodataM||0,i.es=r.srid,i}return qm(n,t),n.prototype.getType=function(){return this.cs?sf:of},n.prototype.readFeature=function(t,n){return new ef({geometry:this.readGeometry(t,n)})},n.prototype.readFeatures=function(t,n){var i=this.readGeometry(t,n);return(this.splitCollection&&i instanceof Lh?i.getGeometriesArray():[i]).map((function(t){return new ef({geometry:t})}))},n.prototype.readGeometry=function(t,n){var i=nw(t);if(!i)return null;var r=new Qm(i).readGeometry();this.hs=i;var e=this.getReadOptions(t,n);return this.hs=null,vf(r,!1,e)},n.prototype.readProjection=function(t){var n=this.hs||nw(t);if(n){var i=new Qm(n);return i.readWkbHeader(),i.getSrid()&&ae("EPSG:"+i.getSrid())||void 0}},n.prototype.writeFeature=function(t,n){return this.writeGeometry(t.getGeometry(),n)},n.prototype.writeFeatures=function(t,n){return this.writeGeometry(new Lh(t.map((function(t){return t.getGeometry()}))),n)},n.prototype.writeGeometry=function(t,n){var i=this.adaptOptions(n),r=new tw({layout:this.os,littleEndian:this.ls,ewkb:this.vs,nodata:{Z:this.ps,M:this.ds}}),e=Number.isInteger(this.es)?Number(this.es):null;if(!1!==this.es&&!Number.isInteger(this.es)){var o=i.dataProjection&&ae(i.dataProjection);if(o){var u=o.getCode();0===u.indexOf("EPSG:")&&(e=Number(u.substring(5)))}}r.writeGeometry(vf(t,!0,i),e);var s=r.getBuffer();return this.cs?function(t){var n=new Uint8Array(t);return Array.from(n.values()).map((function(t){return(t<16?"0":"")+Number(t).toString(16).toUpperCase()})).join("")}(s):s},n}(lf),rw=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ew={POINT:_s,LINESTRING:Mf,POLYGON:Xs,MULTIPOINT:Ef,MULTILINESTRING:Sf,MULTIPOLYGON:Af},ow="EMPTY",uw=0,sw=1,aw=2,fw=3,hw=4,cw=5,lw=6,vw={};for(var pw in Kr)vw[pw]=Kr[pw].toUpperCase();var dw=function(){function t(t){this.wkt=t,this.ys=-1}return t.prototype.ws=function(t){return t>="a"&&t<="z"||t>="A"&&t<="Z"},t.prototype.bs=function(t,n){return t>="0"&&t<="9"||"."==t&&!(void 0!==n&&n)},t.prototype.gs=function(t){return" "==t||"\t"==t||"\r"==t||"\n"==t},t.prototype.xs=function(){return this.wkt.charAt(++this.ys)},t.prototype.nextToken=function(){var t,n=this.xs(),i=this.ys,r=n;if("("==n)t=aw;else if(","==n)t=cw;else if(")"==n)t=fw;else if(this.bs(n)||"-"==n)t=hw,r=this._s();else if(this.ws(n))t=sw,r=this.Ms();else{if(this.gs(n))return this.nextToken();if(""!==n)throw new Error("Unexpected character: "+n);t=lw}return{position:i,value:r,type:t}},t.prototype._s=function(){var t,n=this.ys,i=!1,r=!1;do{"."==t?i=!0:"e"!=t&&"E"!=t||(r=!0),t=this.xs()}while(this.bs(t,i)||!r&&("e"==t||"E"==t)||r&&("-"==t||"+"==t));return parseFloat(this.wkt.substring(n,this.ys--))},t.prototype.Ms=function(){var t,n=this.ys;do{t=this.xs()}while(this.ws(t));return this.wkt.substring(n,this.ys--).toUpperCase()},t}(),yw=function(){function t(t){this.Os=t,this.Ss={position:0,type:uw},this.os=Iu}return t.prototype.js=function(){this.Ss=this.Os.nextToken()},t.prototype.isTokenType=function(t){return this.Ss.type==t},t.prototype.match=function(t){var n=this.isTokenType(t);return n&&this.js(),n},t.prototype.parse=function(){return this.js(),this.Es()},t.prototype.ks=function(){var t=Iu,n=this.Ss;if(this.isTokenType(sw)){var i=n.value;"Z"===i?t=Nu:"M"===i?t=zu:"ZM"===i&&(t=Fu),t!==Iu&&this.js()}return t},t.prototype.Ts=function(){if(this.match(aw)){var t=[];do{t.push(this.Es())}while(this.match(cw));if(this.match(fw))return t}throw new Error(this.As())},t.prototype.Cs=function(){if(this.match(aw)){var t=this.Ps();if(this.match(fw))return t}throw new Error(this.As())},t.prototype.Rs=function(){if(this.match(aw)){var t=this.Is();if(this.match(fw))return t}throw new Error(this.As())},t.prototype.Ns=function(){if(this.match(aw)){var t=this.zs();if(this.match(fw))return t}throw new Error(this.As())},t.prototype.Fs=function(){if(this.match(aw)){var t=void 0;if(t=this.Ss.type==aw?this.Ls():this.Is(),this.match(fw))return t}throw new Error(this.As())},t.prototype.Gs=function(){if(this.match(aw)){var t=this.zs();if(this.match(fw))return t}throw new Error(this.As())},t.prototype.Ds=function(){if(this.match(aw)){var t=this.Us();if(this.match(fw))return t}throw new Error(this.As())},t.prototype.Ps=function(){for(var t=[],n=this.os.length,i=0;i<n;++i){var r=this.Ss;if(!this.match(hw))break;t.push(r.value)}if(t.length==n)return t;throw new Error(this.As())},t.prototype.Is=function(){for(var t=[this.Ps()];this.match(cw);)t.push(this.Ps());return t},t.prototype.Ls=function(){for(var t=[this.Cs()];this.match(cw);)t.push(this.Cs());return t},t.prototype.zs=function(){for(var t=[this.Rs()];this.match(cw);)t.push(this.Rs());return t},t.prototype.Us=function(){for(var t=[this.Ns()];this.match(cw);)t.push(this.Ns());return t},t.prototype.qs=function(){var t=this.isTokenType(sw)&&this.Ss.value==ow;return t&&this.js(),t},t.prototype.As=function(){return"Unexpected `"+this.Ss.value+"` at position "+this.Ss.position+" in `"+this.Os.wkt+"`"},t.prototype.Es=function(){var t=this.Ss;if(this.match(sw)){var n=t.value;this.os=this.ks();var i=this.qs();if("GEOMETRYCOLLECTION"==n){if(i)return new Lh([]);var r=this.Ts();return new Lh(r)}var e=ew[n];if(!e)throw new Error("Invalid geometry type: "+n);var o=void 0;if(i)o="POINT"==n?[NaN,NaN]:[];else switch(n){case"POINT":o=this.Cs();break;case"LINESTRING":o=this.Rs();break;case"POLYGON":o=this.Ns();break;case"MULTIPOINT":o=this.Fs();break;case"MULTILINESTRING":o=this.Gs();break;case"MULTIPOLYGON":o=this.Ds()}return new e(o,this.os)}throw new Error(this.As())},t}(),mw=function(t){function n(n){var i=t.call(this)||this,r=n||{};return i.Bs=void 0!==r.splitCollection&&r.splitCollection,i}return rw(n,t),n.prototype.Xs=function(t){var n=new dw(t);return new yw(n).parse()},n.prototype.readFeatureFromText=function(t,n){var i=this.readGeometryFromText(t,n),r=new ef;return r.setGeometry(i),r},n.prototype.readFeaturesFromText=function(t,n){for(var i=[],r=this.readGeometryFromText(t,n),e=[],o=0,u=(i=this.Bs&&r.getType()==Kr.GEOMETRY_COLLECTION?r.getGeometriesArray():[r]).length;o<u;++o){var s=new ef;s.setGeometry(i[o]),e.push(s)}return e},n.prototype.readGeometryFromText=function(t,n){return vf(this.Xs(t),!1,n)},n.prototype.writeFeatureText=function(t,n){var i=t.getGeometry();return i?this.writeGeometryText(i,n):""},n.prototype.writeFeaturesText=function(t,n){if(1==t.length)return this.writeFeatureText(t[0],n);for(var i=[],r=0,e=t.length;r<e;++r)i.push(t[r].getGeometry());var o=new Lh(i);return this.writeGeometryText(o,n)},n.prototype.writeGeometryText=function(t,n){return _w(vf(t,!0,n))},n}(Rl);function ww(t){var n=t.getCoordinates();return 0===n.length?"":n.join(" ")}function bw(t){for(var n=t.getCoordinates(),i=[],r=0,e=n.length;r<e;++r)i.push(n[r].join(" "));return i.join(",")}function gw(t){for(var n=[],i=t.getLinearRings(),r=0,e=i.length;r<e;++r)n.push("("+bw(i[r])+")");return n.join(",")}var xw={Point:ww,LineString:bw,Polygon:gw,MultiPoint:function(t){for(var n=[],i=t.getPoints(),r=0,e=i.length;r<e;++r)n.push("("+ww(i[r])+")");return n.join(",")},MultiLineString:function(t){for(var n=[],i=t.getLineStrings(),r=0,e=i.length;r<e;++r)n.push("("+bw(i[r])+")");return n.join(",")},MultiPolygon:function(t){for(var n=[],i=t.getPolygons(),r=0,e=i.length;r<e;++r)n.push("("+gw(i[r])+")");return n.join(",")},GeometryCollection:function(t){for(var n=[],i=t.getGeometries(),r=0,e=i.length;r<e;++r)n.push(_w(i[r]));return n.join(",")}};function _w(t){var n=t.getType(),i=(0,xw[n])(t);if(n=n.toUpperCase(),"function"==typeof t.getFlatCoordinates){var r=function(t){var n=t.getLayout(),i="";return n!==Nu&&n!==Fu||(i+="Z"),n!==zu&&n!==Fu||(i+="M"),i}(t);r.length>0&&(n+=" "+r)}return 0===i.length?n+" "+ow:n+"("+i+")"}var Mw=mw,Ow=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Sw=[null,"http://www.opengis.net/wms"],jw=uc(Sw,{Service:tc((function(t,n){return ac({},Tw,t,n)})),Capability:tc((function(t,n){return ac({},Ew,t,n)}))}),Ew=uc(Sw,{Request:tc((function(t,n){return ac({},Fw,t,n)})),Exception:tc((function(t,n){return ac([],Rw,t,n)})),Layer:tc((function(t,n){var i=ac({},Iw,t,n);if(void 0===i.Layer)return Object.assign(i,Xw(t,n));return i}))}),kw=function(t){function n(){var n=t.call(this)||this;return n.version=void 0,n}return Ow(n,t),n.prototype.readFromNode=function(t){this.version=t.getAttribute("version").trim();var n=ac({version:this.version},jw,t,[]);return n||null},n}(ay),Tw=uc(Sw,{Name:tc(Tc),Title:tc(Tc),Abstract:tc(Tc),KeywordList:tc(Zw),OnlineResource:tc(fy),ContactInformation:tc((function(t,n){return ac({},Aw,t,n)})),Fees:tc(Tc),AccessConstraints:tc(Tc),LayerLimit:tc(Ec),MaxWidth:tc(Ec),MaxHeight:tc(Ec)}),Aw=uc(Sw,{ContactPersonPrimary:tc((function(t,n){return ac({},Cw,t,n)})),ContactPosition:tc(Tc),ContactAddress:tc((function(t,n){return ac({},Pw,t,n)})),ContactVoiceTelephone:tc(Tc),ContactFacsimileTelephone:tc(Tc),ContactElectronicMailAddress:tc(Tc)}),Cw=uc(Sw,{ContactPerson:tc(Tc),ContactOrganization:tc(Tc)}),Pw=uc(Sw,{AddressType:tc(Tc),Address:tc(Tc),City:tc(Tc),StateOrProvince:tc(Tc),PostCode:tc(Tc),Country:tc(Tc)}),Rw=uc(Sw,{Format:Jh(Tc)}),Iw=uc(Sw,{Name:tc(Tc),Title:tc(Tc),Abstract:tc(Tc),KeywordList:tc(Zw),CRS:Qh(Tc),EX_GeographicBoundingBox:tc((function(t,n){var i=ac({},zw,t,n);if(!i)return;var r=i.westBoundLongitude,e=i.southBoundLatitude,o=i.eastBoundLongitude,u=i.northBoundLatitude;if(void 0===r||void 0===e||void 0===o||void 0===u)return;return[r,e,o,u]})),BoundingBox:Qh((function(t,n){var i=[jc(t.getAttribute("minx")),jc(t.getAttribute("miny")),jc(t.getAttribute("maxx")),jc(t.getAttribute("maxy"))],r=[jc(t.getAttribute("resx")),jc(t.getAttribute("resy"))];return{crs:t.getAttribute("CRS"),extent:i,res:r}})),Dimension:Qh((function(t,n){return{name:t.getAttribute("name"),units:t.getAttribute("units"),unitSymbol:t.getAttribute("unitSymbol"),default:t.getAttribute("default"),multipleValues:Mc(t.getAttribute("multipleValues")),nearestValue:Mc(t.getAttribute("nearestValue")),current:Mc(t.getAttribute("current")),values:Tc(t)}})),Attribution:tc((function(t,n){return ac({},Nw,t,n)})),AuthorityURL:Qh((function(t,n){var i=Vw(t,n);if(i)return i.name=t.getAttribute("name"),i;return})),Identifier:Qh(Tc),MetadataURL:Qh((function(t,n){var i=Vw(t,n);if(i)return i.type=t.getAttribute("type"),i;return})),DataURL:Qh(Vw),FeatureListURL:Qh(Vw),Style:Qh((function(t,n){return ac({},Uw,t,n)})),MinScaleDenominator:tc(Sc),MaxScaleDenominator:tc(Sc),Layer:Qh(Xw)}),Nw=uc(Sw,{Title:tc(Tc),OnlineResource:tc(fy),LogoURL:tc(Yw)}),zw=uc(Sw,{westBoundLongitude:tc(Sc),eastBoundLongitude:tc(Sc),southBoundLatitude:tc(Sc),northBoundLatitude:tc(Sc)}),Fw=uc(Sw,{GetCapabilities:tc(Ww),GetMap:tc(Ww),GetFeatureInfo:tc(Ww)}),Lw=uc(Sw,{Format:Qh(Tc),DCPType:Qh((function(t,n){return ac({},Gw,t,n)}))}),Gw=uc(Sw,{HTTP:tc((function(t,n){return ac({},Dw,t,n)}))}),Dw=uc(Sw,{Get:tc(Vw),Post:tc(Vw)}),Uw=uc(Sw,{Name:tc(Tc),Title:tc(Tc),Abstract:tc(Tc),LegendURL:Qh(Yw),StyleSheetURL:tc(Vw),StyleURL:tc(Vw)}),qw=uc(Sw,{Format:tc(Tc),OnlineResource:tc(fy)}),Bw=uc(Sw,{Keyword:Jh(Tc)});function Xw(t,n){var i=n[n.length-1],r=ac({},Iw,t,n);if(r){var e=Mc(t.getAttribute("queryable"));void 0===e&&(e=i.queryable),r.queryable=void 0!==e&&e;var o=kc(t.getAttribute("cascaded"));void 0===o&&(o=i.cascaded),r.cascaded=o;var u=Mc(t.getAttribute("opaque"));void 0===u&&(u=i.opaque),r.opaque=void 0!==u&&u;var s=Mc(t.getAttribute("noSubsets"));void 0===s&&(s=i.noSubsets),r.noSubsets=void 0!==s&&s;var a=jc(t.getAttribute("fixedWidth"));a||(a=i.fixedWidth),r.fixedWidth=a;var f=jc(t.getAttribute("fixedHeight"));f||(f=i.fixedHeight),r.fixedHeight=f;["Style","CRS","AuthorityURL"].forEach((function(t){if(t in i){var n=r[t]||[];r[t]=n.concat(i[t])}}));return["EX_GeographicBoundingBox","BoundingBox","Dimension","Attribution","MinScaleDenominator","MaxScaleDenominator"].forEach((function(t){if(!(t in r)){var n=i[t];r[t]=n}})),r}}function Vw(t,n){return ac({},qw,t,n)}function Ww(t,n){return ac({},Lw,t,n)}function Yw(t,n){var i=Vw(t,n);if(i){var r=[kc(t.getAttribute("width")),kc(t.getAttribute("height"))];return i.size=r,i}}function Zw(t,n){return ac([],Bw,t,n)}var Hw=kw,Kw=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Jw=function(t){function n(n){var i=t.call(this)||this,r=n||{};return i.Hu="http://mapserver.gis.umn.edu/mapserver",i.Ku=new Gc,i.Uu=r.layers?r.layers:null,i}return Kw(n,t),n.prototype.getLayers=function(){return this.Uu},n.prototype.setLayers=function(t){this.Uu=t},n.prototype.Vs=function(t,n){t.setAttribute("namespaceURI",this.Hu);var i=t.localName,r=[];if(0===t.childNodes.length)return r;if("msGMLOutput"==i)for(var e=0,u=t.childNodes.length;e<u;e++){var s=t.childNodes[e];if(s.nodeType===Node.ELEMENT_NODE){var f=s,h=n[0],c=f.localName.replace("_layer","");if(!this.Uu||o(this.Uu,c)){var l=c+"_feature";h.featureType=l,h.featureNS=this.Hu;var v={};v[l]=Jh(this.Ku.readFeatureElement,this.Ku);var p=uc([h.featureNS,null],v);f.setAttribute("namespaceURI",this.Hu);var d=ac([],p,f,n,this.Ku);d&&a(r,d)}}}if("FeatureCollection"==i){var y=ac([],this.Ku.FEATURE_COLLECTION_PARSERS,t,[{}],this.Ku);y&&(r=y)}return r},n.prototype.readFeaturesFromNode=function(t,n){var i={};return n&&W(i,this.getReadOptions(t,n)),this.Vs(t,[i])},n}(yc),$w=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Qw=[null,"http://www.opengis.net/wmts/1.0"],tb=[null,"http://www.opengis.net/ows/1.1"],nb=uc(Qw,{Contents:tc((function(t,n){return ac({},rb,t,n)}))}),ib=function(t){function n(){var n=t.call(this)||this;return n.Ws=new Ey,n}return $w(n,t),n.prototype.readFromNode=function(t){var n=t.getAttribute("version");n&&(n=n.trim());var i=this.Ws.readFromNode(t);return i?(i.version=n,(i=ac(i,nb,t,[]))||null):null},n}(ay),rb=uc(Qw,{Layer:Qh((function(t,n){return ac({},eb,t,n)})),TileMatrixSet:Qh((function(t,n){return ac({},cb,t,n)}))}),eb=uc(Qw,{Style:Qh((function(t,n){var i=ac({},ob,t,n);if(!i)return;var r="true"===t.getAttribute("isDefault");return i.isDefault=r,i})),Format:Qh(Tc),TileMatrixSetLink:Qh((function(t,n){return ac({},ub,t,n)})),Dimension:Qh((function(t,n){return ac({},fb,t,n)})),ResourceURL:Qh((function(t,n){var i=t.getAttribute("format"),r=t.getAttribute("template"),e=t.getAttribute("resourceType"),o={};i&&(o.format=i);r&&(o.template=r);e&&(o.resourceType=e);return o}))},uc(tb,{Title:tc(Tc),Abstract:tc(Tc),WGS84BoundingBox:tc(vb),Identifier:tc(Tc)})),ob=uc(Qw,{LegendURL:Qh((function(t,n){var i={};return i.format=t.getAttribute("format"),i.href=fy(t),i}))},uc(tb,{Title:tc(Tc),Identifier:tc(Tc)})),ub=uc(Qw,{TileMatrixSet:tc(Tc),TileMatrixSetLimits:tc((function(t,n){return ac([],sb,t,n)}))}),sb=uc(Qw,{TileMatrixLimits:Jh((function(t,n){return ac({},ab,t,n)}))}),ab=uc(Qw,{TileMatrix:tc(Tc),MinTileRow:tc(Ec),MaxTileRow:tc(Ec),MinTileCol:tc(Ec),MaxTileCol:tc(Ec)}),fb=uc(Qw,{Default:tc(Tc),Value:Qh(Tc)},uc(tb,{Identifier:tc(Tc)})),hb=uc(tb,{LowerCorner:Jh(pb),UpperCorner:Jh(pb)}),cb=uc(Qw,{WellKnownScaleSet:tc(Tc),TileMatrix:Qh((function(t,n){return ac({},lb,t,n)}))},uc(tb,{SupportedCRS:tc(Tc),Identifier:tc(Tc),BoundingBox:tc(vb)})),lb=uc(Qw,{TopLeftCorner:tc(pb),ScaleDenominator:tc(Sc),TileWidth:tc(Ec),TileHeight:tc(Ec),MatrixWidth:tc(Ec),MatrixHeight:tc(Ec)},uc(tb,{Identifier:tc(Tc)}));function vb(t,n){var i=ac([],hb,t,n);if(2==i.length)return Zi(i)}function pb(t,n){var i=Tc(t).split(/\s+/);if(i&&2==i.length){var r=+i[0],e=+i[1];if(!isNaN(r)&&!isNaN(e))return[r,e]}}var db=ib,yb=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),mb="accuracy",wb="accuracyGeometry",bb="altitude",gb="altitudeAccuracy",xb="heading",_b="position",Mb="projection",Ob="speed",Sb="tracking",jb="trackingOptions",Eb=function(t){function n(n){var i=t.call(this,Q)||this;return i.code=n.code,i.message=n.message,i}return yb(n,t),n}(L),kb=function(t){function n(n){var i=t.call(this)||this;i.on,i.once,i.un;var r=n||{};return i.Ys=null,i.Kt=oe,i.Zs=void 0,i.addChangeListener(Mb,i.Vt),i.addChangeListener(Sb,i.Hs),void 0!==r.projection&&i.setProjection(r.projection),void 0!==r.trackingOptions&&i.setTrackingOptions(r.trackingOptions),i.setTracking(void 0!==r.tracking&&r.tracking),i}return yb(n,t),n.prototype.disposeInternal=function(){this.setTracking(!1),t.prototype.disposeInternal.call(this)},n.prototype.Vt=function(){var t=this.getProjection();t&&(this.Kt=me(ae("EPSG:4326"),t),this.Ys&&this.set(_b,this.Kt(this.Ys)))},n.prototype.Hs=function(){if("geolocation"in navigator){var t=this.getTracking();t&&void 0===this.Zs?this.Zs=navigator.geolocation.watchPosition(this.Ks.bind(this),this.Js.bind(this),this.getTrackingOptions()):t||void 0===this.Zs||(navigator.geolocation.clearWatch(this.Zs),this.Zs=void 0)}},n.prototype.Ks=function(t){var n=t.coords;this.set(mb,n.accuracy),this.set(bb,null===n.altitude?void 0:n.altitude),this.set(gb,null===n.altitudeAccuracy?void 0:n.altitudeAccuracy),this.set(xb,null===n.heading?void 0:k(n.heading)),this.Ys?(this.Ys[0]=n.longitude,this.Ys[1]=n.latitude):this.Ys=[n.longitude,n.latitude];var i=this.Kt(this.Ys);this.set(_b,i),this.set(Ob,null===n.speed?void 0:n.speed);var r=Vs(this.Ys,n.accuracy);r.applyTransform(this.Kt),this.set(wb,r),this.changed()},n.prototype.Js=function(t){this.dispatchEvent(new Eb(t))},n.prototype.getAccuracy=function(){return this.get(mb)},n.prototype.getAccuracyGeometry=function(){return this.get(wb)||null},n.prototype.getAltitude=function(){return this.get(bb)},n.prototype.getAltitudeAccuracy=function(){return this.get(gb)},n.prototype.getHeading=function(){return this.get(xb)},n.prototype.getPosition=function(){return this.get(_b)},n.prototype.getProjection=function(){return this.get(Mb)},n.prototype.getSpeed=function(){return this.get(Ob)},n.prototype.getTracking=function(){return this.get(Sb)},n.prototype.getTrackingOptions=function(){return this.get(jb)},n.prototype.setProjection=function(t){this.set(Mb,ae(t))},n.prototype.setTracking=function(t){this.set(Sb,t)},n.prototype.setTrackingOptions=function(t){this.set(jb,t)},n}(xt),Tb=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Ab=function(t){function n(n,i,r){var e=t.call(this)||this;if(void 0!==r&&void 0===i)e.setFlatCoordinates(r,n);else{var o=i||0;e.setCenterAndRadius(n,o,r)}return e}return Tb(n,t),n.prototype.clone=function(){var t=new n(this.flatCoordinates.slice(),void 0,this.layout);return t.applyProperties(this),t},n.prototype.closestPointXY=function(t,n,i,r){var e=this.flatCoordinates,o=t-e[0],u=n-e[1],s=o*o+u*u;if(s<r){if(0===s)for(var a=0;a<this.stride;++a)i[a]=e[a];else{var f=this.getRadius()/Math.sqrt(s);i[0]=e[0]+f*o,i[1]=e[1]+f*u;for(a=2;a<this.stride;++a)i[a]=e[a]}return i.length=this.stride,s}return r},n.prototype.containsXY=function(t,n){var i=this.flatCoordinates,r=t-i[0],e=n-i[1];return r*r+e*e<=this.$s()},n.prototype.getCenter=function(){return this.flatCoordinates.slice(0,this.stride)},n.prototype.computeExtent=function(t){var n=this.flatCoordinates,i=n[this.stride]-n[0];return rr(n[0]-i,n[1]-i,n[0]+i,n[1]+i,t)},n.prototype.getRadius=function(){return Math.sqrt(this.$s())},n.prototype.$s=function(){var t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],n=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+n*n},n.prototype.getType=function(){return Kr.CIRCLE},n.prototype.intersectsExtent=function(t){if(Er(t,this.getExtent())){var n=this.getCenter();return t[0]<=n[0]&&t[2]>=n[0]||(t[1]<=n[1]&&t[3]>=n[1]||dr(t,this.intersectsCoordinate.bind(this)))}return!1},n.prototype.setCenter=function(t){var n=this.stride,i=this.flatCoordinates[n]-this.flatCoordinates[0],r=t.slice();r[n]=r[0]+i;for(var e=1;e<n;++e)r[n+e]=t[e];this.setFlatCoordinates(this.layout,r),this.changed()},n.prototype.setCenterAndRadius=function(t,n,i){this.setLayout(i,t,0),this.flatCoordinates||(this.flatCoordinates=[]);var r=this.flatCoordinates,e=is(r,0,t,this.stride);r[e++]=r[0]+n;for(var o=1,u=this.stride;o<u;++o)r[e++]=r[o];r.length=e,this.changed()},n.prototype.getCoordinates=function(){return null},n.prototype.setCoordinates=function(t,n){},n.prototype.setRadius=function(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()},n.prototype.rotate=function(t,n){var i=this.getCenter(),r=this.getStride();this.setCenter(Gu(i,0,i.length,r,t,n,i)),this.changed()},n.prototype.translate=function(t,n){var i=this.getCenter(),r=this.getStride();this.setCenter(Uu(i,0,i.length,r,t,n,i)),this.changed()},n}(Zu);Ab.prototype.transform;var Cb=Ab;function Pb(t,n,i){for(var r,e,o,u,s,a,f=[],h=t(0),c=t(1),l=n(h),v=n(c),p=[c,h],d=[v,l],y=[1,0],m={},w=1e5;--w>0&&y.length>0;)o=y.pop(),h=p.pop(),l=d.pop(),(a=o.toString())in m||(f.push(l[0],l[1]),m[a]=!0),u=y.pop(),c=p.pop(),v=d.pop(),O((e=n(r=t(s=(o+u)/2)))[0],e[1],l[0],l[1],v[0],v[1])<i?(f.push(v[0],v[1]),m[a=u.toString()]=!0):(y.push(u,s,s,o),d.push(v,e,e,l),p.push(c,r,r,h));return f}function Rb(t,n,i,r,e){return Pb((function(r){return[t,n+(i-n)*r]}),we(ae("EPSG:4326"),r),e)}function Ib(t,n,i,r,e){return Pb((function(r){return[n+(i-n)*r,t]}),we(ae("EPSG:4326"),r),e)}function Nb(t,n,i,r,e){var o,u,s,a,f,h,c,l,v,p=i,d=i,y=0,m=0,w=i;for(o=i;o<r;o+=e){var b=n[o],g=n[o+1];void 0!==a&&(l=b-a,v=g-f,s=Math.sqrt(l*l+v*v),void 0!==h&&(m+=u,Math.acos((h*l+c*v)/(u*s))>t&&(m>y&&(y=m,p=w,d=o),m=0,w=o-e)),u=s,h=l,c=v),a=b,f=g}return(m+=s)>y?[w,o]:[p,d]}function zb(t,n,i,r,e,o,u,s,a,f,h,c){var l=t[n],v=t[n+1],p=0,d=0,y=0,m=0;function w(){p=l,d=v,l=t[n+=r],v=t[n+1],m+=y,y=Math.sqrt((l-p)*(l-p)+(v-d)*(v-d))}do{w()}while(n<i-r&&m+y<o);for(var b=0===y?0:(o-m)/y,g=A(p,l,b),x=A(d,v,b),_=n-r,M=m,O=o+s*a(f,e,h);n<i-r&&m+y<O;)w();var S,j=A(p,l,b=0===y?0:(O-m)/y),E=A(d,v,b);if(c){var k=[g,x,j,E];Gu(k,0,4,2,c,k,k),S=k[0]>k[2]}else S=g>j;var T,C=Math.PI,P=[],R=_+r===n;if(y=0,m=M,l=t[n=_],v=t[n+1],R){w(),T=Math.atan2(v-d,l-p),S&&(T+=T>0?-C:C);var I=(j+g)/2,N=(E+x)/2;return P[0]=[I,N,(O-o)/2,T,e],P}for(var z=0,F=e.length;z<F;){w();var L=Math.atan2(v-d,l-p);if(S&&(L+=L>0?-C:C),void 0!==T){var G=L-T;if(G+=G>C?-2*C:G<-C?2*C:0,Math.abs(G)>u)return null}T=L;for(var D=z,U=0;z<F;++z){var q=s*a(f,e[S?F-z-1:z],h);if(n+r<i&&m+y<o+U+q/2)break;U+=q}if(z!==D){var B=S?e.substring(F-D,F-z):e.substring(D,z);I=A(p,l,b=0===y?0:(o+U/2-m)/y),N=A(d,v,b);P.push([I,N,U/2,L,B]),o+=U}}return P}var Fb=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Lb=function(t){function n(n,i,r,e,o){var u=this,s=void 0!==o?uv:av;return(u=t.call(this,n,i,r,s)||this).ge=void 0!==o?o:null,u.Eo=e,u._e=null,u}return Fb(n,t),n.prototype.getError=function(){return this._e},n.prototype.Qs=function(t){t?(this._e=t,this.state=fv):this.state=av,this.changed()},n.prototype.load=function(){this.state==uv&&(this.state=sv,this.changed(),this.ge(this.Qs.bind(this)))},n.prototype.getImage=function(){return this.Eo},n}(vv),Gb=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();var Db=function(t){function n(n,i,r,e,o,u){var s=t.call(this,n,i,u)||this;return s.Lo=e,s.wo=r,s.key=r,s.bo=new Image,null!==e&&(s.bo.crossOrigin=e),s.xo=null,s.ta=o,s}return Gb(n,t),n.prototype.getImage=function(){return this.bo},n.prototype.setImage=function(t){this.bo=t,this.state=cu,this.Oo(),this.changed()},n.prototype.Mo=function(){var t;this.state=lu,this.Oo(),this.bo=((t=Qt(1,1)).fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas),this.changed()},n.prototype.So=function(){var t=this.bo;t.naturalWidth&&t.naturalHeight?this.state=cu:this.state=vu,this.Oo(),this.changed()},n.prototype.load=function(){this.state==lu&&(this.state=fu,this.bo=new Image,null!==this.Lo&&(this.bo.crossOrigin=this.Lo)),this.state==fu&&(this.state=hu,this.changed(),this.ta(this,this.wo),this.xo=dv(this.bo,this.So.bind(this),this.Mo.bind(this)))},n.prototype.Oo=function(){this.xo&&(this.xo(),this.xo=null)},n}(La),Ub="active",qb=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();function Bb(t,n,i){var r=t.getCenterInternal();if(r){var e=[r[0]+n[0],r[1]+n[1]];t.animateInternal({duration:void 0!==i?i:250,easing:Ru,center:t.getConstrainedCenter(e)})}}function Xb(t,n,i,r){var e=t.getZoom();if(void 0!==e){var o=t.getConstrainedZoom(e+n),u=t.getResolutionForZoom(o);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:u,anchor:i,duration:void 0!==r?r:250,easing:Cu})}}var Vb=function(t){function n(n){var i=t.call(this)||this;return i.on,i.once,i.un,n&&n.handleEvent&&(i.handleEvent=n.handleEvent),i.U=null,i.setActive(!0),i}return qb(n,t),n.prototype.getActive=function(){return this.get(Ub)},n.prototype.getMap=function(){return this.U},n.prototype.handleEvent=function(t){return!0},n.prototype.setActive=function(t){this.set(Ub,t)},n.prototype.setMap=function(t){this.U=t},n}(xt),Wb=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Yb=function(t){function n(n){var i=t.call(this)||this,r=n||{};return i.na=r.delta?r.delta:1,i.Dr=void 0!==r.duration?r.duration:250,i}return Wb(n,t),n.prototype.handleEvent=function(t){var n=!1;if(t.type==eu.DBLCLICK){var i=t.originalEvent,r=t.map,e=t.coordinate,o=i.shiftKey?-this.na:this.na;Xb(r.getView(),o,e,this.Dr),i.preventDefault(),n=!0}return!n},n}(Vb),Zb=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Hb="addfeatures",Kb=function(t){function n(n,i,r,e){var o=t.call(this,n)||this;return o.features=r,o.file=i,o.projection=e,o}return Zb(n,t),n}(L),Jb=function(t){function n(n){var i=this,r=n||{};(i=t.call(this,{handleEvent:U})||this).on,i.once,i.un,i.ia=!1,i.ra=[];for(var e=r.formatConstructors?r.formatConstructors:[],o=0,u=e.length;o<u;++o){var s=e[o];"function"==typeof s&&(s=new s),i.ra.push(s),i.ia=i.ia||s.getType()===of}return i.li=r.projection?ae(r.projection):null,i.ea=null,i.gt=r.source||null,i.target=r.target?r.target:null,i}return Zb(n,t),n.prototype.oa=function(t,n){var i,r=n.target.result,e=this.getMap(),o=this.li;o||(o=e.getView().getProjection());for(var u=this.ra,s=0,a=u.length;s<a;++s){var f=u[s],h=r;this.ia&&f.getType()!==of&&(void 0===i&&(i=(new TextDecoder).decode(r)),h=i);var c=this.ua(f,h,{featureProjection:o});if(c&&c.length>0){this.gt&&(this.gt.clear(),this.gt.addFeatures(c)),this.dispatchEvent(new Kb(Hb,t,c,o));break}}},n.prototype.sa=function(){var t=this.getMap();if(t){var n=this.target?this.target:t.getViewport();this.ea=[lt(n,ot,this.handleDrop,this),lt(n,rt,this.handleStop,this),lt(n,et,this.handleStop,this),lt(n,ot,this.handleStop,this)]}},n.prototype.setActive=function(n){!this.getActive()&&n&&this.sa(),this.getActive()&&!n&&this.aa(),t.prototype.setActive.call(this,n)},n.prototype.setMap=function(n){this.aa(),t.prototype.setMap.call(this,n),this.getActive()&&this.sa()},n.prototype.ua=function(t,n,i){try{return t.readFeatures(n,i)}catch(t){return null}},n.prototype.aa=function(){this.ea&&(this.ea.forEach(pt),this.ea=null)},n.prototype.handleDrop=function(t){for(var n=t.dataTransfer.files,i=0,r=n.length;i<r;++i){var e=n.item(i),o=new FileReader;o.addEventListener(at,this.oa.bind(this,e)),this.ia?o.readAsArrayBuffer(e):o.readAsText(e)}},n.prototype.handleStop=function(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"},n}(Vb),$b=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();function Qb(t){for(var n=t.length,i=0,r=0,e=0;e<n;e++)i+=t[e].clientX,r+=t[e].clientY;return[i/n,r/n]}var tg=function(t){function n(n){var i=this,r=n||{};return i=t.call(this,r)||this,r.handleDownEvent&&(i.handleDownEvent=r.handleDownEvent),r.handleDragEvent&&(i.handleDragEvent=r.handleDragEvent),r.handleMoveEvent&&(i.handleMoveEvent=r.handleMoveEvent),r.handleUpEvent&&(i.handleUpEvent=r.handleUpEvent),r.stopDown&&(i.stopDown=r.stopDown),i.handlingDownUpSequence=!1,i.fa={},i.targetPointers=[],i}return $b(n,t),n.prototype.getPointerCount=function(){return this.targetPointers.length},n.prototype.handleDownEvent=function(t){return!1},n.prototype.handleDragEvent=function(t){},n.prototype.handleEvent=function(t){if(!t.originalEvent)return!0;var n=!1;if(this.ha(t),this.handlingDownUpSequence){if(t.type==eu.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==eu.POINTERUP){var i=this.handleUpEvent(t);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(t.type==eu.POINTERDOWN){var r=this.handleDownEvent(t);this.handlingDownUpSequence=r,n=this.stopDown(r)}else t.type==eu.POINTERMOVE&&this.handleMoveEvent(t);return!n},n.prototype.handleMoveEvent=function(t){},n.prototype.handleUpEvent=function(t){return!1},n.prototype.stopDown=function(t){return t},n.prototype.ha=function(t){if(function(t){var n=t.type;return n===eu.POINTERDOWN||n===eu.POINTERDRAG||n===eu.POINTERUP}(t)){var n=t.originalEvent,i=n.pointerId.toString();t.type==eu.POINTERUP?delete this.fa[i]:(t.type==eu.POINTERDOWN||i in this.fa)&&(this.fa[i]=n),this.targetPointers=Z(this.fa)}},n}(Vb),ng=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ig=function(t){function n(n){var i=t.call(this)||this;return i.fu=null,i.rn=document.createElement("div"),i.rn.style.position="absolute",i.rn.style.pointerEvents="auto",i.rn.className="ol-box "+n,i.U=null,i.ca=null,i.la=null,i}return ng(n,t),n.prototype.disposeInternal=function(){this.setMap(null)},n.prototype.va=function(){var t=this.ca,n=this.la,i="px",r=this.rn.style;r.left=Math.min(t[0],n[0])+i,r.top=Math.min(t[1],n[1])+i,r.width=Math.abs(n[0]-t[0])+i,r.height=Math.abs(n[1]-t[1])+i},n.prototype.setMap=function(t){if(this.U){this.U.getOverlayContainer().removeChild(this.rn);var n=this.rn.style;n.left="inherit",n.top="inherit",n.width="inherit",n.height="inherit"}this.U=t,this.U&&this.U.getOverlayContainer().appendChild(this.rn)},n.prototype.setPixels=function(t,n){this.ca=t,this.la=n,this.createOrUpdateGeometry(),this.va()},n.prototype.createOrUpdateGeometry=function(){var t=this.ca,n=this.la,i=[t,[t[0],n[1]],n,[n[0],t[1]]].map(this.U.getCoordinateFromPixelInternal,this.U);i[4]=i[0].slice(),this.fu?this.fu.setCoordinates([i]):this.fu=new Xs([i])},n.prototype.getGeometry=function(){return this.fu},n}(D),rg=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),eg="boxstart",og="boxdrag",ug="boxend",sg="boxcancel",ag=function(t){function n(n,i,r){var e=t.call(this,n)||this;return e.coordinate=i,e.mapBrowserEvent=r,e}return rg(n,t),n}(L),fg=function(t){function n(n){var i=t.call(this)||this;i.on,i.once,i.un;var r=n||{};return i.pa=new ig(r.className||"ol-dragbox"),i.da=void 0!==r.minArea?r.minArea:64,r.onBoxEnd&&(i.onBoxEnd=r.onBoxEnd),i.ca=null,i.ya=r.condition?r.condition:Ya,i.ma=r.boxEndCondition?r.boxEndCondition:i.defaultBoxEndCondition,i}return rg(n,t),n.prototype.defaultBoxEndCondition=function(t,n,i){var r=i[0]-n[0],e=i[1]-n[1];return r*r+e*e>=this.da},n.prototype.getGeometry=function(){return this.pa.getGeometry()},n.prototype.handleDragEvent=function(t){this.pa.setPixels(this.ca,t.pixel),this.dispatchEvent(new ag(og,t.coordinate,t))},n.prototype.handleUpEvent=function(t){this.pa.setMap(null);var n=this.ma(t,this.ca,t.pixel);return n&&this.onBoxEnd(t),this.dispatchEvent(new ag(n?ug:sg,t.coordinate,t)),!1},n.prototype.handleDownEvent=function(t){return!!this.ya(t)&&(this.ca=t.pixel,this.pa.setMap(t.map),this.pa.setPixels(this.ca,this.ca),this.dispatchEvent(new ag(eg,t.coordinate,t)),!0)},n.prototype.onBoxEnd=function(t){},n}(tg),hg=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),cg=function(t){function n(n){var i=t.call(this,{stopDown:q})||this,r=n||{};i.wa=r.kinetic,i.lastCentroid=null,i.ba,i.ga=!1;var e=r.condition?r.condition:Ua(Ka,tf);return i.ya=r.onFocusOnly?Ua(Va,e):e,i.xa=!1,i}return hg(n,t),n.prototype.handleDragEvent=function(t){this.ga||(this.ga=!0,this.getMap().getView().beginInteraction());var n=this.targetPointers,i=Qb(n);if(n.length==this.ba){if(this.wa&&this.wa.update(i[0],i[1]),this.lastCentroid){var r=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],e=t.map.getView();Br(r,e.getResolution()),qr(r,e.getRotation()),e.adjustCenterInternal(r)}}else this.wa&&this.wa.begin();this.lastCentroid=i,this.ba=n.length,t.originalEvent.preventDefault()},n.prototype.handleUpEvent=function(t){var n=t.map,i=n.getView();if(0===this.targetPointers.length){if(!this.xa&&this.wa&&this.wa.end()){var r=this.wa.getDistance(),e=this.wa.getAngle(),o=i.getCenterInternal(),u=n.getPixelFromCoordinateInternal(o),s=n.getCoordinateFromPixelInternal([u[0]-r*Math.cos(e),u[1]-r*Math.sin(e)]);i.animateInternal({center:i.getConstrainedCenter(s),duration:500,easing:Cu})}return this.ga&&(this.ga=!1,i.endInteraction()),!1}return this.wa&&this.wa.begin(),this.lastCentroid=null,!0},n.prototype.handleDownEvent=function(t){if(this.targetPointers.length>0&&this.ya(t)){var n=t.map.getView();return this.lastCentroid=null,n.getAnimating()&&n.cancelAnimations(),this.wa&&this.wa.begin(),this.xa=this.targetPointers.length>1,!0}return!1},n}(tg),lg=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),vg=function(t){function n(n){var i=this,r=n||{};return(i=t.call(this,{stopDown:q})||this).ya=r.condition?r.condition:Ba,i._a=void 0,i.Dr=void 0!==r.duration?r.duration:250,i}return lg(n,t),n.prototype.handleDragEvent=function(t){if(Qa(t)){var n=t.map,i=n.getView();if(i.getConstraints().rotation!==ju){var r=n.getSize(),e=t.pixel,o=Math.atan2(r[1]/2-e[1],e[0]-r[0]/2);if(void 0!==this._a){var u=o-this._a;i.adjustRotationInternal(-u)}this._a=o}}},n.prototype.handleUpEvent=function(t){return!Qa(t)||(t.map.getView().endInteraction(this.Dr),!1)},n.prototype.handleDownEvent=function(t){return!!Qa(t)&&(!(!Ya(t)||!this.ya(t))&&(t.map.getView().beginInteraction(),this._a=void 0,!0))},n}(tg),pg=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),dg=function(t){function n(n){var i=this,r=n||{};return(i=t.call(this,r)||this).ya=r.condition?r.condition:Ja,i._a=void 0,i.Ma=void 0,i.Oa=0,i.Dr=void 0!==r.duration?r.duration:400,i}return pg(n,t),n.prototype.handleDragEvent=function(t){if(Qa(t)){var n=t.map,i=n.getSize(),r=t.pixel,e=r[0]-i[0]/2,o=i[1]/2-r[1],u=Math.atan2(o,e),s=Math.sqrt(e*e+o*o),a=n.getView();if(void 0!==this._a){var f=this._a-u;a.adjustRotationInternal(f)}this._a=u,void 0!==this.Ma&&a.adjustResolutionInternal(this.Ma/s),void 0!==this.Ma&&(this.Oa=this.Ma/s),this.Ma=s}},n.prototype.handleUpEvent=function(t){if(!Qa(t))return!0;var n=t.map.getView(),i=this.Oa>1?1:-1;return n.endInteraction(this.Dr,i),this.Oa=0,!1},n.prototype.handleDownEvent=function(t){return!!Qa(t)&&(!!this.ya(t)&&(t.map.getView().beginInteraction(),this._a=void 0,this.Ma=void 0,!0))},n}(tg),yg=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),mg=function(t){function n(n){var i=this,r=n||{},e=r.condition?r.condition:Ja;return(i=t.call(this,{condition:e,className:r.className||"ol-dragzoom",minArea:r.minArea})||this).Dr=void 0!==r.duration?r.duration:200,i.Sa=void 0!==r.out&&r.out,i}return yg(n,t),n.prototype.onBoxEnd=function(t){var n=this.getMap().getView(),i=this.getGeometry();if(this.Sa){var r=n.rotatedExtentForGeometry(i),e=n.getResolutionForExtentInternal(r),o=n.getResolution()/e;(i=i.clone()).scale(o*o)}n.fitInternal(i,{duration:this.Dr,easing:Cu})},n}(fg),wg=i(72),bg=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),gg="renderOrder",xg=function(t){function n(n){var i=this,r=n||{},e=W({},r);return delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,(i=t.call(this,e)||this).ja=void 0!==r.declutter&&r.declutter,i.Ea=void 0!==r.renderBuffer?r.renderBuffer:100,i.je=null,i.Ee=void 0,i.setStyle(r.style),i.ka=void 0!==r.updateWhileAnimating&&r.updateWhileAnimating,i.Ta=void 0!==r.updateWhileInteracting&&r.updateWhileInteracting,i}return bg(n,t),n.prototype.getDeclutter=function(){return this.ja},n.prototype.getFeatures=function(n){return t.prototype.getFeatures.call(this,n)},n.prototype.getRenderBuffer=function(){return this.Ea},n.prototype.getRenderOrder=function(){return this.get(gg)},n.prototype.getStyle=function(){return this.je},n.prototype.getStyleFunction=function(){return this.Ee},n.prototype.getUpdateWhileAnimating=function(){return this.ka},n.prototype.getUpdateWhileInteracting=function(){return this.Ta},n.prototype.renderDeclutter=function(t){t.declutterTree||(t.declutterTree=new wg(9)),this.getRenderer().renderDeclutter(t)},n.prototype.setRenderOrder=function(t){this.set(gg,t)},n.prototype.setStyle=function(t){this.je=void 0!==t?t:Rv,this.Ee=null===t?void 0:Cv(this.je),this.changed()},n}(Bn),_g={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Mg=[_g.FILL],Og=[_g.STROKE],Sg=[_g.BEGIN_PATH],jg=[_g.CLOSE_PATH],Eg=_g,kg=function(){function t(){}return t.prototype.drawCustom=function(t,n,i,r){},t.prototype.drawGeometry=function(t){},t.prototype.setStyle=function(t){},t.prototype.drawCircle=function(t,n){},t.prototype.drawFeature=function(t,n){},t.prototype.drawGeometryCollection=function(t,n){},t.prototype.drawLineString=function(t,n){},t.prototype.drawMultiLineString=function(t,n){},t.prototype.drawMultiPoint=function(t,n){},t.prototype.drawMultiPolygon=function(t,n){},t.prototype.drawPoint=function(t,n){},t.prototype.drawPolygon=function(t,n){},t.prototype.drawText=function(t,n){},t.prototype.setFillStrokeStyle=function(t,n){},t.prototype.setImageStyle=function(t,n){},t.prototype.setTextStyle=function(t,n){},t}(),Tg=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Ag=function(t){function n(n,i,r,e){var o=t.call(this)||this;return o.tolerance=n,o.maxExtent=i,o.pixelRatio=e,o.maxLineWidth=0,o.resolution=r,o.Aa=null,o.Ca=null,o.Pa=null,o.instructions=[],o.coordinates=[],o.Ra=[],o.hitDetectionInstructions=[],o.state={},o}return Tg(n,t),n.prototype.applyPixelRatio=function(t){var n=this.pixelRatio;return 1==n?t:t.map((function(t){return t*n}))},n.prototype.appendFlatPointCoordinates=function(t,n){for(var i=this.getBufferedMaxExtent(),r=this.Ra,e=this.coordinates,o=e.length,u=0,s=t.length;u<s;u+=n)r[0]=t[u],r[1]=t[u+1],$i(i,r)&&(e[o++]=r[0],e[o++]=r[1]);return o},n.prototype.appendFlatLineCoordinates=function(t,n,i,r,e,o){var u=this.coordinates,s=u.length,a=this.getBufferedMaxExtent();o&&(n+=r);var f,h,c,l=t[n],v=t[n+1],p=this.Ra,d=!0;for(f=n+r;f<i;f+=r)p[0]=t[f],p[1]=t[f+1],(c=nr(a,p))!==h?(d&&(u[s++]=l,u[s++]=v,d=!1),u[s++]=p[0],u[s++]=p[1]):c===Bi?(u[s++]=p[0],u[s++]=p[1],d=!1):d=!0,l=p[0],v=p[1],h=c;return(e&&d||f===n+r)&&(u[s++]=l,u[s++]=v),s},n.prototype.Ia=function(t,n,i,r,e){for(var o=0,u=i.length;o<u;++o){var s=i[o],a=this.appendFlatLineCoordinates(t,n,s,r,!1,!1);e.push(a),n=s}return n},n.prototype.drawCustom=function(t,n,i,r){this.beginGeometry(t,n);var e,o,u,s,a,f=t.getType(),h=t.getStride(),c=this.coordinates.length;switch(f){case Kr.MULTI_POLYGON:e=t.getOrientedFlatCoordinates(),s=[];var l=t.getEndss();a=0;for(var v=0,p=l.length;v<p;++v){var d=[];a=this.Ia(e,a,l[v],h,d),s.push(d)}this.instructions.push([Eg.CUSTOM,c,s,t,i,ds]),this.hitDetectionInstructions.push([Eg.CUSTOM,c,s,t,r||i,ds]);break;case Kr.POLYGON:case Kr.MULTI_LINE_STRING:u=[],e=f==Kr.POLYGON?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),a=this.Ia(e,0,t.getEnds(),h,u),this.instructions.push([Eg.CUSTOM,c,u,t,i,ps]),this.hitDetectionInstructions.push([Eg.CUSTOM,c,u,t,r||i,ps]);break;case Kr.LINE_STRING:case Kr.CIRCLE:e=t.getFlatCoordinates(),o=this.appendFlatLineCoordinates(e,0,e.length,h,!1,!1),this.instructions.push([Eg.CUSTOM,c,o,t,i,vs]),this.hitDetectionInstructions.push([Eg.CUSTOM,c,o,t,r||i,vs]);break;case Kr.MULTI_POINT:e=t.getFlatCoordinates(),(o=this.appendFlatPointCoordinates(e,h))>c&&(this.instructions.push([Eg.CUSTOM,c,o,t,i,vs]),this.hitDetectionInstructions.push([Eg.CUSTOM,c,o,t,r||i,vs]));break;case Kr.POINT:e=t.getFlatCoordinates(),this.coordinates.push(e[0],e[1]),o=this.coordinates.length,this.instructions.push([Eg.CUSTOM,c,o,t,i]),this.hitDetectionInstructions.push([Eg.CUSTOM,c,o,t,r||i])}this.endGeometry(n)},n.prototype.beginGeometry=function(t,n){this.Aa=[Eg.BEGIN_GEOMETRY,n,0,t],this.instructions.push(this.Aa),this.Ca=[Eg.BEGIN_GEOMETRY,n,0,t],this.hitDetectionInstructions.push(this.Ca)},n.prototype.finish=function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}},n.prototype.reverseHitDetectionInstructions=function(){var t,n=this.hitDetectionInstructions;n.reverse();var i,r,e=n.length,o=-1;for(t=0;t<e;++t)(r=(i=n[t])[0])==Eg.END_GEOMETRY?o=t:r==Eg.BEGIN_GEOMETRY&&(i[2]=t,s(this.hitDetectionInstructions,o,t),o=-1)},n.prototype.setFillStrokeStyle=function(t,n){var i=this.state;if(t){var r=t.getColor();i.fillStyle=Ft(r||ao)}else i.fillStyle=void 0;if(n){var e=n.getColor();i.strokeStyle=Ft(e||vo);var o=n.getLineCap();i.lineCap=void 0!==o?o:fo;var u=n.getLineDash();i.lineDash=u?u.slice():ho;var s=n.getLineDashOffset();i.lineDashOffset=s||0;var a=n.getLineJoin();i.lineJoin=void 0!==a?a:co;var f=n.getWidth();i.lineWidth=void 0!==f?f:1;var h=n.getMiterLimit();i.miterLimit=void 0!==h?h:lo,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.Pa=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0},n.prototype.createFill=function(t){var n=t.fillStyle,i=[Eg.SET_FILL_STYLE,n];return"string"!=typeof n&&i.push(!0),i},n.prototype.applyStroke=function(t){this.instructions.push(this.createStroke(t))},n.prototype.createStroke=function(t){return[Eg.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]},n.prototype.updateFillStyle=function(t,n){var i=t.fillStyle;"string"==typeof i&&t.currentFillStyle==i||(void 0!==i&&this.instructions.push(n.call(this,t)),t.currentFillStyle=i)},n.prototype.updateStrokeStyle=function(t,n){var i=t.strokeStyle,r=t.lineCap,e=t.lineDash,o=t.lineDashOffset,u=t.lineJoin,s=t.lineWidth,a=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=r||e!=t.currentLineDash&&!h(t.currentLineDash,e)||t.currentLineDashOffset!=o||t.currentLineJoin!=u||t.currentLineWidth!=s||t.currentMiterLimit!=a)&&(void 0!==i&&n.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=r,t.currentLineDash=e,t.currentLineDashOffset=o,t.currentLineJoin=u,t.currentLineWidth=s,t.currentMiterLimit=a)},n.prototype.endGeometry=function(t){this.Aa[2]=this.instructions.length,this.Aa=null,this.Ca[2]=this.hitDetectionInstructions.length,this.Ca=null;var n=[Eg.END_GEOMETRY,t];this.instructions.push(n),this.hitDetectionInstructions.push(n)},n.prototype.getBufferedMaxExtent=function(){if(!this.Pa&&(this.Pa=Ki(this.maxExtent),this.maxLineWidth>0)){var t=this.resolution*(this.maxLineWidth+1)/2;Hi(this.Pa,t,this.Pa)}return this.Pa},n}(kg),Cg=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Pg=function(t){function n(n,i,r,e){var o=t.call(this,n,i,r,e)||this;return o.jo=null,o.bo=null,o.Na=void 0,o.za=void 0,o.Fa=void 0,o.La=void 0,o.vo=void 0,o.Ga=void 0,o.Da=void 0,o.Mr=void 0,o.qr=void 0,o.po=void 0,o.Ho=void 0,o.mo=void 0,o.Ua=void 0,o}return Cg(n,t),n.prototype.drawPoint=function(t,n){if(this.bo){this.beginGeometry(t,n);var i=t.getFlatCoordinates(),r=t.getStride(),e=this.coordinates.length,o=this.appendFlatPointCoordinates(i,r);this.instructions.push([Eg.DRAW_IMAGE,e,o,this.bo,this.za*this.Na,this.Fa*this.Na,Math.ceil(this.La*this.Na),this.vo,this.Ga,this.Da,this.Mr,this.qr,[this.po[0]*this.pixelRatio/this.Na,this.po[1]*this.pixelRatio/this.Na],Math.ceil(this.Ho*this.Na),this.mo,this.Ua]),this.hitDetectionInstructions.push([Eg.DRAW_IMAGE,e,o,this.jo,this.za,this.Fa,this.La,this.vo,this.Ga,this.Da,this.Mr,this.qr,this.po,this.Ho,this.mo,this.Ua]),this.endGeometry(n)}},n.prototype.drawMultiPoint=function(t,n){if(this.bo){this.beginGeometry(t,n);var i=t.getFlatCoordinates(),r=t.getStride(),e=this.coordinates.length,o=this.appendFlatPointCoordinates(i,r);this.instructions.push([Eg.DRAW_IMAGE,e,o,this.bo,this.za*this.Na,this.Fa*this.Na,Math.ceil(this.La*this.Na),this.vo,this.Ga,this.Da,this.Mr,this.qr,[this.po[0]*this.pixelRatio/this.Na,this.po[1]*this.pixelRatio/this.Na],Math.ceil(this.Ho*this.Na),this.mo,this.Ua]),this.hitDetectionInstructions.push([Eg.DRAW_IMAGE,e,o,this.jo,this.za,this.Fa,this.La,this.vo,this.Ga,this.Da,this.Mr,this.qr,this.po,this.Ho,this.mo,this.Ua]),this.endGeometry(n)}},n.prototype.finish=function(){return this.reverseHitDetectionInstructions(),this.za=void 0,this.Fa=void 0,this.jo=null,this.bo=null,this.Na=void 0,this.La=void 0,this.po=void 0,this.vo=void 0,this.Ga=void 0,this.Da=void 0,this.Mr=void 0,this.qr=void 0,this.Ho=void 0,t.prototype.finish.call(this)},n.prototype.setImageStyle=function(t,n){var i=t.getAnchor(),r=t.getSize(),e=t.getHitDetectionImage(),o=t.getImage(this.pixelRatio),u=t.getOrigin();this.Na=t.getPixelRatio(this.pixelRatio),this.za=i[0],this.Fa=i[1],this.jo=e,this.bo=o,this.La=r[1],this.vo=t.getOpacity(),this.Ga=u[0]*this.Na,this.Da=u[1]*this.Na,this.Mr=t.getRotateWithView(),this.qr=t.getRotation(),this.po=t.getScaleArray(),this.Ho=r[0],this.mo=t.getDeclutterMode(),this.Ua=n},n}(Ag),Rg=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Ig=function(t){function n(n,i,r,e){return t.call(this,n,i,r,e)||this}return Rg(n,t),n.prototype.qa=function(t,n,i,r){var e=this.coordinates.length,o=this.appendFlatLineCoordinates(t,n,i,r,!1,!1),u=[Eg.MOVE_TO_LINE_TO,e,o];return this.instructions.push(u),this.hitDetectionInstructions.push(u),i},n.prototype.drawLineString=function(t,n){var i=this.state,r=i.strokeStyle,e=i.lineWidth;if(void 0!==r&&void 0!==e){this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,n),this.hitDetectionInstructions.push([Eg.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,ho,0],Sg);var o=t.getFlatCoordinates(),u=t.getStride();this.qa(o,0,o.length,u),this.hitDetectionInstructions.push(Og),this.endGeometry(n)}},n.prototype.drawMultiLineString=function(t,n){var i=this.state,r=i.strokeStyle,e=i.lineWidth;if(void 0!==r&&void 0!==e){this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(t,n),this.hitDetectionInstructions.push([Eg.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset],Sg);for(var o=t.getEnds(),u=t.getFlatCoordinates(),s=t.getStride(),a=0,f=0,h=o.length;f<h;++f)a=this.qa(u,a,o[f],s);this.hitDetectionInstructions.push(Og),this.endGeometry(n)}},n.prototype.finish=function(){var n=this.state;return null!=n.lastStroke&&n.lastStroke!=this.coordinates.length&&this.instructions.push(Og),this.reverseHitDetectionInstructions(),this.state=null,t.prototype.finish.call(this)},n.prototype.applyStroke=function(n){null!=n.lastStroke&&n.lastStroke!=this.coordinates.length&&(this.instructions.push(Og),n.lastStroke=this.coordinates.length),n.lastStroke=0,t.prototype.applyStroke.call(this,n),this.instructions.push(Sg)},n}(Ag),Ng=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),zg=function(t){function n(n,i,r,e){return t.call(this,n,i,r,e)||this}return Ng(n,t),n.prototype.Ba=function(t,n,i,r){var e=this.state,o=void 0!==e.fillStyle,u=void 0!==e.strokeStyle,s=i.length;this.instructions.push(Sg),this.hitDetectionInstructions.push(Sg);for(var a=0;a<s;++a){var f=i[a],h=this.coordinates.length,c=this.appendFlatLineCoordinates(t,n,f,r,!0,!u),l=[Eg.MOVE_TO_LINE_TO,h,c];this.instructions.push(l),this.hitDetectionInstructions.push(l),u&&(this.instructions.push(jg),this.hitDetectionInstructions.push(jg)),n=f}return o&&(this.instructions.push(Mg),this.hitDetectionInstructions.push(Mg)),u&&(this.instructions.push(Og),this.hitDetectionInstructions.push(Og)),n},n.prototype.drawCircle=function(t,n){var i=this.state,r=i.fillStyle,e=i.strokeStyle;if(void 0!==r||void 0!==e){this.Xa(),this.beginGeometry(t,n),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([Eg.SET_FILL_STYLE,ao]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([Eg.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var o=t.getFlatCoordinates(),u=t.getStride(),s=this.coordinates.length;this.appendFlatLineCoordinates(o,0,o.length,u,!1,!1);var a=[Eg.CIRCLE,s];this.instructions.push(Sg,a),this.hitDetectionInstructions.push(Sg,a),void 0!==i.fillStyle&&(this.instructions.push(Mg),this.hitDetectionInstructions.push(Mg)),void 0!==i.strokeStyle&&(this.instructions.push(Og),this.hitDetectionInstructions.push(Og)),this.endGeometry(n)}},n.prototype.drawPolygon=function(t,n){var i=this.state,r=i.fillStyle,e=i.strokeStyle;if(void 0!==r||void 0!==e){this.Xa(),this.beginGeometry(t,n),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([Eg.SET_FILL_STYLE,ao]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([Eg.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);var o=t.getEnds(),u=t.getOrientedFlatCoordinates(),s=t.getStride();this.Ba(u,0,o,s),this.endGeometry(n)}},n.prototype.drawMultiPolygon=function(t,n){var i=this.state,r=i.fillStyle,e=i.strokeStyle;if(void 0!==r||void 0!==e){this.Xa(),this.beginGeometry(t,n),void 0!==i.fillStyle&&this.hitDetectionInstructions.push([Eg.SET_FILL_STYLE,ao]),void 0!==i.strokeStyle&&this.hitDetectionInstructions.push([Eg.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,i.lineDash,i.lineDashOffset]);for(var o=t.getEndss(),u=t.getOrientedFlatCoordinates(),s=t.getStride(),a=0,f=0,h=o.length;f<h;++f)a=this.Ba(u,a,o[f],s);this.endGeometry(n)}},n.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;var n=this.tolerance;if(0!==n)for(var i=this.coordinates,r=0,e=i.length;r<e;++r)i[r]=fs(i[r],n);return t.prototype.finish.call(this)},n.prototype.Xa=function(){var t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)},n}(Ag),Fg=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Lg={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},Gg=function(t){function n(n,i,r,e){var o=t.call(this,n,i,r,e)||this;return o.Va=null,o.lu="",o.Wa=0,o.Ya=0,o.Za=void 0,o.Ha=0,o.Ka=null,o.fillStates={},o.Ja=null,o.strokeStates={},o.$a={},o.textStates={},o.Qa="",o.tf="",o.nf="",o.Ua=void 0,o}return Fg(n,t),n.prototype.finish=function(){var n=t.prototype.finish.call(this);return n.textStates=this.textStates,n.fillStates=this.fillStates,n.strokeStates=this.strokeStates,n},n.prototype.drawText=function(t,n){var i=this.Ka,r=this.Ja,e=this.$a;if(""!==this.lu&&e&&(i||r)){var o=this.coordinates,u=o.length,s=t.getType(),a=null,f=t.getStride();if(e.placement!==Lv||s!=Kr.LINE_STRING&&s!=Kr.MULTI_LINE_STRING&&s!=Kr.POLYGON&&s!=Kr.MULTI_POLYGON){var h=e.overflow?null:[];switch(s){case Kr.POINT:case Kr.MULTI_POINT:a=t.getFlatCoordinates();break;case Kr.LINE_STRING:a=t.getFlatMidpoint();break;case Kr.CIRCLE:a=t.getCenter();break;case Kr.MULTI_LINE_STRING:a=t.getFlatMidpoints(),f=2;break;case Kr.POLYGON:a=t.getFlatInteriorPoint(),e.overflow||h.push(a[2]/this.resolution),f=3;break;case Kr.MULTI_POLYGON:var c=t.getFlatInteriorPoints();a=[];for(_=0,M=c.length;_<M;_+=3)e.overflow||h.push(c[_+2]/this.resolution),a.push(c[_],c[_+1]);if(0===a.length)return;f=2}if((A=this.appendFlatPointCoordinates(a,f))===u)return;if(h&&(A-u)/2!=a.length/f){var l=u/2;h=h.filter((function(t,n){var i=o[2*(l+n)]===a[n*f]&&o[2*(l+n)+1]===a[n*f+1];return i||--l,i}))}this.if(),(e.backgroundFill||e.backgroundStroke)&&(this.setFillStrokeStyle(e.backgroundFill,e.backgroundStroke),e.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),e.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,n);var v=e.padding;if(v!=mo&&(e.scale[0]<0||e.scale[1]<0)){var p=e.padding[0],d=e.padding[1],y=e.padding[2],m=e.padding[3];e.scale[0]<0&&(d=-d,m=-m),e.scale[1]<0&&(p=-p,y=-y),v=[p,d,y,m]}var w=this.pixelRatio;this.instructions.push([Eg.DRAW_IMAGE,u,A,null,NaN,NaN,NaN,1,0,0,this.Za,this.Ha,[1,1],NaN,void 0,this.Ua,v==mo?mo:v.map((function(t){return t*w})),!!e.backgroundFill,!!e.backgroundStroke,this.lu,this.Qa,this.nf,this.tf,this.Wa,this.Ya,h]);var b=1/w;this.hitDetectionInstructions.push([Eg.DRAW_IMAGE,u,A,null,NaN,NaN,NaN,1,0,0,this.Za,this.Ha,[b,b],NaN,void 0,this.Ua,v,!!e.backgroundFill,!!e.backgroundStroke,this.lu,this.Qa,this.nf,this.tf,this.Wa,this.Ya,h]),this.endGeometry(n)}else{if(!Er(this.getBufferedMaxExtent(),t.getExtent()))return;var g=void 0;if(a=t.getFlatCoordinates(),s==Kr.LINE_STRING)g=[a.length];else if(s==Kr.MULTI_LINE_STRING)g=t.getEnds();else if(s==Kr.POLYGON)g=t.getEnds().slice(0,1);else if(s==Kr.MULTI_POLYGON){var x=t.getEndss();g=[];for(var _=0,M=x.length;_<M;++_)g.push(x[_][0])}this.beginGeometry(t,n);for(var O=e.textAlign,S=0,j=void 0,E=0,k=g.length;E<k;++E){if(null==O){var T=Nb(e.maxAngle,a,S,g[E],f);S=T[0],j=T[1]}else j=g[E];for(var _=S;_<j;_+=f)o.push(a[_],a[_+1]);var A=o.length;S=g[E],this.rf(u,A),u=A}this.endGeometry(n)}}},n.prototype.if=function(){var t=this.Ja,n=this.$a,i=this.Ka,r=this.nf;t&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));var e=this.Qa;e in this.textStates||(this.textStates[e]={font:n.font,textAlign:n.textAlign||po,justify:n.justify,textBaseline:n.textBaseline||yo,scale:n.scale});var o=this.tf;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))},n.prototype.rf=function(t,n){var i=this.Ja,r=this.$a,e=this.nf,o=this.Qa,u=this.tf;this.if();var s=this.pixelRatio,a=Lg[r.textBaseline],f=this.Ya*s,h=this.lu,c=i?i.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([Eg.DRAW_CHARS,t,n,a,r.overflow,u,r.maxAngle,s,f,e,c*s,h,o,1]),this.hitDetectionInstructions.push([Eg.DRAW_CHARS,t,n,a,r.overflow,u,r.maxAngle,1,f,e,c,h,o,1/s])},n.prototype.setTextStyle=function(t,n){var i,r,e;if(t){var o=t.getFill();o?((r=this.Ka)||(r={},this.Ka=r),r.fillStyle=Ft(o.getColor()||ao)):(r=null,this.Ka=r);var u=t.getStroke();if(u){(e=this.Ja)||(e={},this.Ja=e);var s=u.getLineDash(),a=u.getLineDashOffset(),f=u.getWidth(),h=u.getMiterLimit();e.lineCap=u.getLineCap()||fo,e.lineDash=s?s.slice():ho,e.lineDashOffset=void 0===a?0:a,e.lineJoin=u.getLineJoin()||co,e.lineWidth=void 0===f?1:f,e.miterLimit=void 0===h?lo:h,e.strokeStyle=Ft(u.getColor()||vo)}else e=null,this.Ja=e;i=this.$a;var c=t.getFont()||so;Oo(c);var l=t.getScaleArray();i.overflow=t.getOverflow(),i.font=c,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.justify=t.getJustify(),i.textBaseline=t.getTextBaseline()||yo,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||mo,i.scale=void 0===l?[1,1]:l;var v=t.getOffsetX(),p=t.getOffsetY(),y=t.getRotateWithView(),m=t.getRotation();this.lu=t.getText()||"",this.Wa=void 0===v?0:v,this.Ya=void 0===p?0:p,this.Za=void 0!==y&&y,this.Ha=void 0===m?0:m,this.nf=e?("string"==typeof e.strokeStyle?e.strokeStyle:d(e.strokeStyle))+e.lineCap+e.lineDashOffset+"|"+e.lineWidth+e.lineJoin+e.miterLimit+"["+e.lineDash.join()+"]":"",this.Qa=i.font+i.scale+(i.textAlign||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.tf=r?"string"==typeof r.fillStyle?r.fillStyle:"|"+d(r.fillStyle):""}else this.lu="";this.Ua=n},n}(Ag),Dg={Circle:zg,Default:Ag,Image:Pg,LineString:Ig,Polygon:zg,Text:Gg},Ug=function(){function t(t,n,i,r){this.ef=t,this.uf=n,this.Gi=r,this.af=i,this.ff={}}return t.prototype.finish=function(){var t={};for(var n in this.ff){t[n]=t[n]||{};var i=this.ff[n];for(var r in i){var e=i[r].finish();t[n][r]=e}}return t},t.prototype.getBuilder=function(t,n){var i=void 0!==t?t.toString():"0",r=this.ff[i];void 0===r&&(r={},this.ff[i]=r);var e=r[n];void 0===e&&(e=new(0,Dg[n])(this.ef,this.uf,this.af,this.Gi),r[n]=e);return e},t}(),qg=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Bg=function(t){function n(n){var i=t.call(this)||this;return i.ready=!0,i.hf=i.cf.bind(i),i.lf=n,i.declutterExecutorGroup=null,i}return qg(n,t),n.prototype.getFeatures=function(t){return v()},n.prototype.getData=function(t){return null},n.prototype.prepareFrame=function(t){return v()},n.prototype.renderFrame=function(t,n){return v()},n.prototype.loadedTileCallback=function(t,n,i){t[n]||(t[n]={}),t[n][i.tileCoord.toString()]=i},n.prototype.createLoadedTileFinder=function(t,n,i){return function(r,e){var o=this.loadedTileCallback.bind(this,i,r);return t.forEachLoadedTile(n,r,e,o)}.bind(this)},n.prototype.forEachFeatureAtCoordinate=function(t,n,i,r,e){},n.prototype.getDataAtPixel=function(t,n,i){return null},n.prototype.getLayer=function(){return this.lf},n.prototype.handleFontsChanged=function(){},n.prototype.cf=function(t){t.target.getState()===av&&this.renderIfReadyAndVisible()},n.prototype.loadImage=function(t){var n=t.getState();return n!=av&&n!=fv&&t.addEventListener($,this.hf),n==uv&&(t.load(),n=t.getState()),n==av},n.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t.getVisible()&&t.getSourceState()==Gn&&t.changed()},n.prototype.disposeInternal=function(){delete this.lf,t.prototype.disposeInternal.call(this)},n}(wt),Xg=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Vg=null;var Wg=function(t){function n(n){var i=t.call(this,n)||this;return i.container=null,i.renderedResolution,i.tempTransform=[1,0,0,1,0,0],i.pixelTransform=[1,0,0,1,0,0],i.inversePixelTransform=[1,0,0,1,0,0],i.context=null,i.containerReused=!1,i.vf=null,i.frameState=null,i}return Xg(n,t),n.prototype.getImageData=function(t,n,i){var r,e;Vg||((r=document.createElement("canvas")).width=1,r.height=1,Vg=r.getContext("2d")),Vg.clearRect(0,0,1,1);try{Vg.drawImage(t,n,i,1,1,0,0,1,1),e=Vg.getImageData(0,0,1,1).data}catch(t){return Vg=null,null}return e},n.prototype.getBackground=function(t){var n=this.getLayer().getBackground();return"function"==typeof n&&(n=n(t.viewState.resolution)),n||void 0},n.prototype.useContainer=function(t,n,i,r){var e,o,u=this.getLayer().getClassName();t&&t.className===u&&""===t.style.opacity&&1===i&&(!r||t&&t.style.backgroundColor&&h(Rt(t.style.backgroundColor),Rt(r)))&&((a=t.firstElementChild)instanceof HTMLCanvasElement&&(o=a.getContext("2d")));if(o&&o.canvas.style.transform===n?(this.container=t,this.context=o,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){(e=document.createElement("div")).className=u;var s=e.style;s.position="absolute",s.width="100%",s.height="100%";var a=(o=Qt()).canvas;e.appendChild(a),(s=a.style).position="absolute",s.left="0",s.transformOrigin="top left",this.container=e,this.context=o}this.containerReused||!r||this.container.style.backgroundColor||(this.container.style.backgroundColor=r)},n.prototype.clipUnrotated=function(t,n,i){var r=Or(i),e=Sr(i),o=wr(i),u=mr(i);Be(n.coordinateToPixelTransform,r),Be(n.coordinateToPixelTransform,e),Be(n.coordinateToPixelTransform,o),Be(n.coordinateToPixelTransform,u);var s=this.inversePixelTransform;Be(s,r),Be(s,e),Be(s,o),Be(s,u),t.save(),t.beginPath(),t.moveTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(e[0]),Math.round(e[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(u[0]),Math.round(u[1])),t.clip()},n.prototype.pf=function(t,n,i){var r=this.getLayer();if(r.hasListener(t)){var e=new uo(t,this.inversePixelTransform,i,n);r.dispatchEvent(e)}},n.prototype.preRender=function(t,n){this.frameState=n,this.pf(Pn,t,n)},n.prototype.postRender=function(t,n){this.pf(Rn,t,n)},n.prototype.getRenderTransform=function(t,n,i,r,e,o,u){var s=e/2,a=o/2,f=r/n,h=-f,c=-t[0]+u,l=-t[1];return Ze(this.tempTransform,s,a,f,h,-i,c,l)},n.prototype.getDataAtPixel=function(t,n,i){var r=Be(this.inversePixelTransform,t.slice()),e=this.context,o=this.getLayer().getExtent();if(o&&!$i(o,Be(n.pixelToCoordinateTransform,t.slice())))return null;var u,s=Math.round(r[0]),a=Math.round(r[1]),f=this.vf;if(!f){var h=document.createElement("canvas");h.width=1,h.height=1,f=h.getContext("2d"),this.vf=f}f.clearRect(0,0,1,1);try{f.drawImage(e.canvas,s,a,1,1,0,0,1,1),u=f.getImageData(0,0,1,1).data}catch(t){return"SecurityError"===t.name?(this.vf=null,new Uint8Array):u}return 0===u[3]?null:u},n.prototype.disposeInternal=function(){delete this.frameState,t.prototype.disposeInternal.call(this)},n}(Bg),Yg="Circle",Zg="Default",Hg="Image",Kg="LineString",Jg="Polygon",$g="Text",Qg=[1/0,1/0,-1/0,-1/0],tx=[],nx=[],ix=[],rx=[];function ex(t){return t[3].declutterBox}var ox=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function ux(t,n){return"start"!==n&&"end"!==n||ox.test(t)||(n="start"===n?"left":"right"),Lg[n]}function sx(t,n,i){return i>0&&t.push("\n",""),t.push(n,""),t}var ax=function(){function t(t,n,i,r){this.overlaps=i,this.pixelRatio=n,this.resolution=t,this.df,this.instructions=r.instructions,this.coordinates=r.coordinates,this.yf={},this.mf=[1,0,0,1,0,0],this.hitDetectionInstructions=r.hitDetectionInstructions,this.wf=null,this.bf=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.gf={},this.Va={}}return t.prototype.createLabel=function(t,n,i,r){var e=t+n+i+r;if(this.Va[e])return this.Va[e];var o=r?this.strokeStates[r]:null,u=i?this.fillStates[i]:null,s=this.textStates[n],a=this.pixelRatio,f=[s.scale[0]*a,s.scale[1]*a],h=Array.isArray(t),c=s.justify?Lg[s.justify]:ux(Array.isArray(t)?t[0]:t,s.textAlign||po),l=r&&o.lineWidth?o.lineWidth:0,v=h?t:t.split("\n").reduce(sx,[]),p=To(s,v),d=p.width,y=p.height,m=p.widths,w=p.heights,b=p.lineWidths,g=d+l,x=[],_=(g+2)*f[0],M=(y+l)*f[1],O={width:_<0?Math.floor(_):Math.ceil(_),height:M<0?Math.floor(M):Math.ceil(M),contextInstructions:x};(1==f[0]&&1==f[1]||x.push("scale",f),r)&&(x.push("strokeStyle",o.strokeStyle),x.push("lineWidth",l),x.push("lineCap",o.lineCap),x.push("lineJoin",o.lineJoin),x.push("miterLimit",o.miterLimit),(Kt?OffscreenCanvasRenderingContext2D:CanvasRenderingContext2D).prototype.setLineDash&&(x.push("setLineDash",[o.lineDash]),x.push("lineDashOffset",o.lineDashOffset)));i&&x.push("fillStyle",u.fillStyle),x.push("textBaseline","middle"),x.push("textAlign","center");for(var S,j=.5-c,E=c*g+j*l,k=[],T=[],A=0,C=0,P=0,R=0,I=0,N=v.length;I<N;I+=2){var z=v[I];if("\n"!==z){var F=v[I+1]||s.font;F!==S&&(r&&k.push("font",F),i&&T.push("font",F),S=F),A=Math.max(A,w[P]);var L=[z,E+j*m[P]+c*(m[P]-b[R]),.5*(l+A)+C];E+=m[P],r&&k.push("strokeText",L),i&&T.push("fillText",L),++P}else C+=A,A=0,E=c*g+j*l,++R}return Array.prototype.push.apply(x,k),Array.prototype.push.apply(x,T),this.Va[e]=O,O},t.prototype.xf=function(t,n,i,r,e,o,u){t.beginPath(),t.moveTo.apply(t,n),t.lineTo.apply(t,i),t.lineTo.apply(t,r),t.lineTo.apply(t,e),t.lineTo.apply(t,n),o&&(this.df=o[2],this.Jo(t)),u&&(this._f(t,u),t.stroke())},t.prototype.Mf=function(t,n,i,r,e,o,u,s,a,f,h,c,l,v,p,d){var y,m=i-(u*=c[0]),w=r-(s*=c[1]),b=e+a>t?t-a:e,g=o+f>n?n-f:o,x=v[3]+b*c[0]+v[1],_=v[0]+g*c[1]+v[2],M=m-v[3],O=w-v[0];return(p||0!==h)&&(tx[0]=M,rx[0]=M,tx[1]=O,nx[1]=O,nx[0]=M+x,ix[0]=nx[0],ix[1]=O+_,rx[1]=ix[1]),0!==h?(Be(y=Ze([1,0,0,1,0,0],i,r,1,1,h,-i,-r),tx),Be(y,nx),Be(y,ix),Be(y,rx),rr(Math.min(tx[0],nx[0],ix[0],rx[0]),Math.min(tx[1],nx[1],ix[1],rx[1]),Math.max(tx[0],nx[0],ix[0],rx[0]),Math.max(tx[1],nx[1],ix[1],rx[1]),Qg)):rr(Math.min(M,M+x),Math.min(O,O+_),Math.max(M,M+x),Math.max(O,O+_),Qg),l&&(m=Math.round(m),w=Math.round(w)),{drawImageX:m,drawImageY:w,drawImageW:b,drawImageH:g,originX:a,originY:f,declutterBox:{minX:Qg[0],minY:Qg[1],maxX:Qg[2],maxY:Qg[3],value:d},canvasTransform:y,scale:c}},t.prototype.Of=function(t,n,i,r,e,o,u){var s=!(!o&&!u),a=r.declutterBox,f=t.canvas,h=u?u[2]*r.scale[0]/2:0;return a.minX-h<=f.width/n&&a.maxX+h>=0&&a.minY-h<=f.height/n&&a.maxY+h>=0&&(s&&this.xf(t,tx,nx,ix,rx,o,u),Ao(t,r.canvasTransform,e,i,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0},t.prototype.Jo=function(t){if(this.df){var n=Be(this.mf,[0,0]),i=512*this.pixelRatio;t.save(),t.translate(n[0]%i,n[1]%i),t.rotate(this.bf)}t.fill(),this.df&&t.restore()},t.prototype._f=function(t,n){t.strokeStyle=n[1],t.lineWidth=n[2],t.lineCap=n[3],t.lineJoin=n[4],t.miterLimit=n[5],t.setLineDash&&(t.lineDashOffset=n[7],t.setLineDash(n[6]))},t.prototype.Sf=function(t,n,i,r){var e=this.textStates[n],o=this.createLabel(t,n,r,i),u=this.strokeStates[i],s=this.pixelRatio,a=ux(Array.isArray(t)?t[0]:t,e.textAlign||po),f=Lg[e.textBaseline||yo],h=u&&u.lineWidth?u.lineWidth:0;return{label:o,anchorX:a*(o.width/s-2*e.scale[0])+2*(.5-a)*h,anchorY:f*o.height/s+2*(.5-f)*h}},t.prototype.jf=function(t,n,i,r,e,o,u,s){var a;this.wf&&h(i,this.mf)?a=this.wf:(this.wf||(this.wf=[]),a=Lu(this.coordinates,0,this.coordinates.length,2,i,this.wf),qe(this.mf,i));for(var f,c,l,v,p,d,y,m,w,b,g,x,_,M,O,S,j=0,E=r.length,k=0,T=0,A=0,C=null,P=null,R=this.yf,I=this.bf,N=Math.round(1e12*Math.atan2(-i[1],i[0]))/1e12,z={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:I},F=this.instructions!=r||this.overlaps?0:200;j<E;){var L=r[j];switch(L[0]){case Eg.BEGIN_GEOMETRY:_=L[1],S=L[3],_.getGeometry()?void 0===u||Er(u,S.getExtent())?++j:j=L[2]+1:j=L[2];break;case Eg.BEGIN_PATH:T>F&&(this.Jo(t),T=0),A>F&&(t.stroke(),A=0),T||A||(t.beginPath(),v=NaN,p=NaN),++j;break;case Eg.CIRCLE:var G=a[k=L[1]],D=a[k+1],U=a[k+2]-G,q=a[k+3]-D,B=Math.sqrt(U*U+q*q);t.moveTo(G+B,D),t.arc(G,D,B,0,2*Math.PI,!0),++j;break;case Eg.CLOSE_PATH:t.closePath(),++j;break;case Eg.CUSTOM:k=L[1],f=L[2];var X=L[3],V=L[4],W=6==L.length?L[5]:void 0;z.geometry=X,z.feature=_,j in R||(R[j]=[]);var Y=R[j];W?W(a,k,f,2,Y):(Y[0]=a[k],Y[1]=a[k+1],Y.length=2),V(Y,z),++j;break;case Eg.DRAW_IMAGE:k=L[1],f=L[2],m=L[3],c=L[4],l=L[5];var Z=L[6],H=L[7],K=L[8],J=L[9],$=L[10],Q=L[11],tt=L[12],nt=L[13],it=L[14],rt=L[15];if(!m&&L.length>=20){w=L[19],b=L[20],g=L[21],x=L[22];var et=this.Sf(w,b,g,x);m=et.label,L[3]=m;var ot=L[23];c=(et.anchorX-ot)*this.pixelRatio,L[4]=c;var ut=L[24];l=(et.anchorY-ut)*this.pixelRatio,L[5]=l,Z=m.height,L[6]=Z,nt=m.width,L[13]=nt}var st=void 0;L.length>25&&(st=L[25]);var at=void 0,ft=void 0,ht=void 0;L.length>17?(at=L[16],ft=L[17],ht=L[18]):(at=mo,ft=!1,ht=!1),$&&N?Q+=I:$||N||(Q-=I);for(var ct=0;k<f;k+=2)if(!(st&&st[ct++]<nt/this.pixelRatio)){var lt=[t,n,m,Gt=this.Mf(m.width,m.height,a[k],a[k+1],nt,Z,c,l,K,J,Q,tt,e,at,ft||ht,_),H,ft?C:null,ht?P:null];if(s){if("none"===it)continue;if("obstacle"===it){s.insert(Gt.declutterBox);continue}var vt=void 0,pt=void 0;if(rt){var dt=f-k;if(!rt[dt]){rt[dt]=lt;continue}if(vt=rt[dt],delete rt[dt],pt=ex(vt),s.collides(pt))continue}if(s.collides(Gt.declutterBox))continue;vt&&(s.insert(pt),this.Of.apply(this,vt)),s.insert(Gt.declutterBox)}this.Of.apply(this,lt)}++j;break;case Eg.DRAW_CHARS:var yt=L[1],mt=L[2],wt=L[3],bt=L[4];x=L[5];var gt=L[6],xt=L[7],_t=L[8];g=L[9];var Mt=L[10];w=L[11],b=L[12];var Ot=[L[13],L[13]],St=this.textStates[b],jt=St.font,Et=[St.scale[0]*xt,St.scale[1]*xt],kt=void 0;jt in this.gf?kt=this.gf[jt]:(kt={},this.gf[jt]=kt);var Tt=xf(a,yt,mt,2),At=Math.abs(Et[0])*ko(jt,w,kt);if(bt||At<=Tt){var Ct=this.textStates[b].textAlign,Pt=zb(a,yt,mt,2,w,(Tt-At)*Lg[Ct],gt,Math.abs(Et[0]),ko,jt,kt,N?0:this.bf);t:if(Pt){var Rt=[],It=void 0,Nt=void 0,zt=void 0,Ft=void 0,Lt=void 0;if(g)for(It=0,Nt=Pt.length;It<Nt;++It){zt=(Lt=Pt[It])[4],Ft=this.createLabel(zt,b,"",g),c=Lt[2]+(Et[0]<0?-Mt:Mt),l=wt*Ft.height+2*(.5-wt)*Mt*Et[1]/Et[0]-_t;var Gt=this.Mf(Ft.width,Ft.height,Lt[0],Lt[1],Ft.width,Ft.height,c,l,0,0,Lt[3],Ot,!1,mo,!1,_);if(s&&s.collides(Gt.declutterBox))break t;Rt.push([t,n,Ft,Gt,1,null,null])}if(x)for(It=0,Nt=Pt.length;It<Nt;++It){zt=(Lt=Pt[It])[4],Ft=this.createLabel(zt,b,x,""),c=Lt[2],l=wt*Ft.height-_t;Gt=this.Mf(Ft.width,Ft.height,Lt[0],Lt[1],Ft.width,Ft.height,c,l,0,0,Lt[3],Ot,!1,mo,!1,_);if(s&&s.collides(Gt.declutterBox))break t;Rt.push([t,n,Ft,Gt,1,null,null])}s&&s.load(Rt.map(ex));for(var Dt=0,Ut=Rt.length;Dt<Ut;++Dt)this.Of.apply(this,Rt[Dt])}}++j;break;case Eg.END_GEOMETRY:if(void 0!==o){var qt=o(_=L[1],S);if(qt)return qt}++j;break;case Eg.FILL:F?T++:this.Jo(t),++j;break;case Eg.MOVE_TO_LINE_TO:for(k=L[1],f=L[2],M=a[k],y=(O=a[k+1])+.5|0,(d=M+.5|0)===v&&y===p||(t.moveTo(M,O),v=d,p=y),k+=2;k<f;k+=2)d=(M=a[k])+.5|0,y=(O=a[k+1])+.5|0,k!=f-2&&d===v&&y===p||(t.lineTo(M,O),v=d,p=y);++j;break;case Eg.SET_FILL_STYLE:C=L,this.df=L[2],T&&(this.Jo(t),T=0,A&&(t.stroke(),A=0)),t.fillStyle=L[1],++j;break;case Eg.SET_STROKE_STYLE:P=L,A&&(t.stroke(),A=0),this._f(t,L),++j;break;case Eg.STROKE:F?A++:t.stroke(),++j;break;default:++j}}T&&this.Jo(t),A&&t.stroke()},t.prototype.execute=function(t,n,i,r,e,o){this.bf=r,this.jf(t,n,i,this.instructions,e,void 0,void 0,o)},t.prototype.executeHitDetection=function(t,n,i,r,e){return this.bf=i,this.jf(t,1,n,this.hitDetectionInstructions,!0,r,e)},t}(),fx=[Jg,Yg,Kg,Hg,$g,Zg],hx=function(){function t(t,n,i,r,e,o){this.uf=t,this.Ef=r,this.Gi=i,this.af=n,this.Ea=o,this.kf={},this.Tf=null,this.Af=[1,0,0,1,0,0],this.Cf(e)}return t.prototype.clip=function(t,n){var i=this.getClipCoords(n);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()},t.prototype.Cf=function(t){for(var n in t){var i=this.kf[n];void 0===i&&(i={},this.kf[n]=i);var r=t[n];for(var e in r){var o=r[e];i[e]=new ax(this.af,this.Gi,this.Ef,o)}}},t.prototype.hasExecutors=function(t){for(var n in this.kf)for(var i=this.kf[n],r=0,e=t.length;r<e;++r)if(t[r]in i)return!0;return!1},t.prototype.forEachFeatureAtCoordinate=function(t,n,i,r,o,u){var s=2*(r=Math.round(r))+1,a=Ze(this.Af,r+.5,r+.5,1/n,-1/n,-i,-t[0],-t[1]),f=!this.Tf;f&&(this.Tf=Qt(s,s));var h,c=this.Tf;c.canvas.width!==s||c.canvas.height!==s?(c.canvas.width=s,c.canvas.height=s):f||c.clearRect(0,0,s,s),void 0!==this.Ea&&(hr(h=[1/0,1/0,-1/0,-1/0],t),Hi(h,n*(this.Ea+r),h));var l,v=lx(r);function p(t,n){for(var i=c.getImageData(0,0,s,s).data,e=0,a=v.length;e<a;e++)if(i[v[e]]>0){if(!u||l!==Hg&&l!==$g||-1!==u.indexOf(t)){var f=(v[e]-3)/4,h=r-f%s,p=r-(f/s|0),d=o(t,n,h*h+p*p);if(d)return d}c.clearRect(0,0,s,s);break}}var d,y,m,w,b,g=Object.keys(this.kf).map(Number);for(g.sort(e),d=g.length-1;d>=0;--d){var x=g[d].toString();for(m=this.kf[x],y=fx.length-1;y>=0;--y)if(void 0!==(w=m[l=fx[y]])&&(b=w.executeHitDetection(c,a,i,p,h)))return b}},t.prototype.getClipCoords=function(t){var n=this.uf;if(!n)return null;var i=n[0],r=n[1],e=n[2],o=n[3],u=[i,r,i,o,e,o,e,r];return Lu(u,0,8,2,t,u),u},t.prototype.isEmpty=function(){return H(this.kf)},t.prototype.execute=function(t,n,i,r,o,u,s){var a=Object.keys(this.kf).map(Number);a.sort(e),this.uf&&(t.save(),this.clip(t,i));var f,h,c,l,v,p,d=u||fx;for(s&&a.reverse(),f=0,h=a.length;f<h;++f){var y=a[f].toString();for(v=this.kf[y],c=0,l=d.length;c<l;++c){void 0!==(p=v[d[c]])&&p.execute(t,n,i,r,o,s)}}this.uf&&t.restore()},t}(),cx={};function lx(t){if(void 0!==cx[t])return cx[t];for(var n=2*t+1,i=t*t,r=new Array(i+1),e=0;e<=t;++e)for(var o=0;o<=t;++o){var u=e*e+o*o;if(u>i)break;var s=r[u];s||(s=[],r[u]=s),s.push(4*((t+e)*n+(t+o))+3),e>0&&s.push(4*((t-e)*n+(t+o))+3),o>0&&(s.push(4*((t+e)*n+(t-o))+3),e>0&&s.push(4*((t-e)*n+(t-o))+3))}for(var a=[],f=(e=0,r.length);e<f;++e)r[e]&&a.push.apply(a,r[e]);return cx[t]=a,a}var vx=hx,px=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),dx=function(t){function n(n,i,r,e,o,u,s){var a=t.call(this)||this;return a.Pf=n,a.Gi=i,a.Ft=r,a.Kt=e,a.bf=o,a.Rf=u,a.If=s,a.Nf=null,a.zf=null,a.Ff=null,a.Lf=null,a.Gf=null,a.bo=null,a.Df=0,a.Uf=0,a.qf=0,a.Bf=0,a.Xf=0,a.Vf=0,a.Wf=!1,a.Yf=0,a.Zf=[0,0],a.Hf=0,a.lu="",a.Wa=0,a.Ya=0,a.Za=!1,a.Ha=0,a.Kf=[0,0],a.Ka=null,a.Ja=null,a.$a=null,a.wf=[],a.Jf=[1,0,0,1,0,0],a}return px(n,t),n.prototype.$f=function(t,n,i,r){if(this.bo){var e=Lu(t,n,i,r,this.Kt,this.wf),o=this.Pf,u=this.Jf,s=o.globalAlpha;1!=this.Bf&&(o.globalAlpha=s*this.Bf);var a=this.Yf;this.Wf&&(a+=this.bf);for(var f=0,h=e.length;f<h;f+=2){var c=e[f]-this.Df,l=e[f+1]-this.Uf;if(0!==a||1!=this.Zf[0]||1!=this.Zf[1]){var v=c+this.Df,p=l+this.Uf;Ze(u,v,p,1,1,a,-v,-p),o.setTransform.apply(o,u),o.translate(v,p),o.scale(this.Zf[0],this.Zf[1]),o.drawImage(this.bo,this.Xf,this.Vf,this.Hf,this.qf,-this.Df,-this.Uf,this.Hf,this.qf),o.setTransform(1,0,0,1,0,0)}else o.drawImage(this.bo,this.Xf,this.Vf,this.Hf,this.qf,c,l,this.Hf,this.qf)}1!=this.Bf&&(o.globalAlpha=s)}},n.prototype.Qf=function(t,n,i,r){if(this.$a&&""!==this.lu){this.Ka&&this.th(this.Ka),this.Ja&&this.nh(this.Ja),this.ih(this.$a);var e=Lu(t,n,i,r,this.Kt,this.wf),o=this.Pf,u=this.Ha;for(this.Za&&(u+=this.bf);n<i;n+=r){var s=e[n]+this.Wa,a=e[n+1]+this.Ya;if(0!==u||1!=this.Kf[0]||1!=this.Kf[1]){var f=Ze(this.Jf,s,a,1,1,u,-s,-a);o.setTransform.apply(o,f),o.translate(s,a),o.scale(this.Kf[0],this.Kf[1]),this.Ja&&o.strokeText(this.lu,0,0),this.Ka&&o.fillText(this.lu,0,0),o.setTransform(1,0,0,1,0,0)}else this.Ja&&o.strokeText(this.lu,s,a),this.Ka&&o.fillText(this.lu,s,a)}}},n.prototype.rh=function(t,n,i,r,e){var o=this.Pf,u=Lu(t,n,i,r,this.Kt,this.wf);o.moveTo(u[0],u[1]);var s=u.length;e&&(s-=2);for(var a=2;a<s;a+=2)o.lineTo(u[a],u[a+1]);return e&&o.closePath(),i},n.prototype.eh=function(t,n,i,r){for(var e=0,o=i.length;e<o;++e)n=this.rh(t,n,i[e],r,!0);return n},n.prototype.drawCircle=function(t){if(Er(this.Ft,t.getExtent())){if(this.Lf||this.Gf){this.Lf&&this.th(this.Lf),this.Gf&&this.nh(this.Gf);var n=Yu(t,this.Kt,this.wf),i=n[2]-n[0],r=n[3]-n[1],e=Math.sqrt(i*i+r*r),o=this.Pf;o.beginPath(),o.arc(n[0],n[1],e,0,2*Math.PI),this.Lf&&o.fill(),this.Gf&&o.stroke()}""!==this.lu&&this.Qf(t.getCenter(),0,2,2)}},n.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},n.prototype.setTransform=function(t){this.Kt=t},n.prototype.drawGeometry=function(t){switch(t.getType()){case Kr.POINT:this.drawPoint(t);break;case Kr.LINE_STRING:this.drawLineString(t);break;case Kr.POLYGON:this.drawPolygon(t);break;case Kr.MULTI_POINT:this.drawMultiPoint(t);break;case Kr.MULTI_LINE_STRING:this.drawMultiLineString(t);break;case Kr.MULTI_POLYGON:this.drawMultiPolygon(t);break;case Kr.GEOMETRY_COLLECTION:this.drawGeometryCollection(t);break;case Kr.CIRCLE:this.drawCircle(t)}},n.prototype.drawFeature=function(t,n){var i=n.getGeometryFunction()(t);i&&Er(this.Ft,i.getExtent())&&(this.setStyle(n),this.drawGeometry(i))},n.prototype.drawGeometryCollection=function(t){for(var n=t.getGeometriesArray(),i=0,r=n.length;i<r;++i)this.drawGeometry(n[i])},n.prototype.drawPoint=function(t){this.Rf&&(t=t.simplifyTransformed(this.Rf,this.If));var n=t.getFlatCoordinates(),i=t.getStride();this.bo&&this.$f(n,0,n.length,i),""!==this.lu&&this.Qf(n,0,n.length,i)},n.prototype.drawMultiPoint=function(t){this.Rf&&(t=t.simplifyTransformed(this.Rf,this.If));var n=t.getFlatCoordinates(),i=t.getStride();this.bo&&this.$f(n,0,n.length,i),""!==this.lu&&this.Qf(n,0,n.length,i)},n.prototype.drawLineString=function(t){if(this.Rf&&(t=t.simplifyTransformed(this.Rf,this.If)),Er(this.Ft,t.getExtent())){if(this.Gf){this.nh(this.Gf);var n=this.Pf,i=t.getFlatCoordinates();n.beginPath(),this.rh(i,0,i.length,t.getStride(),!1),n.stroke()}if(""!==this.lu){var r=t.getFlatMidpoint();this.Qf(r,0,2,2)}}},n.prototype.drawMultiLineString=function(t){this.Rf&&(t=t.simplifyTransformed(this.Rf,this.If));var n=t.getExtent();if(Er(this.Ft,n)){if(this.Gf){this.nh(this.Gf);var i=this.Pf,r=t.getFlatCoordinates(),e=0,o=t.getEnds(),u=t.getStride();i.beginPath();for(var s=0,a=o.length;s<a;++s)e=this.rh(r,e,o[s],u,!1);i.stroke()}if(""!==this.lu){var f=t.getFlatMidpoints();this.Qf(f,0,f.length,2)}}},n.prototype.drawPolygon=function(t){if(this.Rf&&(t=t.simplifyTransformed(this.Rf,this.If)),Er(this.Ft,t.getExtent())){if(this.Gf||this.Lf){this.Lf&&this.th(this.Lf),this.Gf&&this.nh(this.Gf);var n=this.Pf;n.beginPath(),this.eh(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.Lf&&n.fill(),this.Gf&&n.stroke()}if(""!==this.lu){var i=t.getFlatInteriorPoint();this.Qf(i,0,2,2)}}},n.prototype.drawMultiPolygon=function(t){if(this.Rf&&(t=t.simplifyTransformed(this.Rf,this.If)),Er(this.Ft,t.getExtent())){if(this.Gf||this.Lf){this.Lf&&this.th(this.Lf),this.Gf&&this.nh(this.Gf);var n=this.Pf,i=t.getOrientedFlatCoordinates(),r=0,e=t.getEndss(),o=t.getStride();n.beginPath();for(var u=0,s=e.length;u<s;++u){var a=e[u];r=this.eh(i,r,a,o)}this.Lf&&n.fill(),this.Gf&&n.stroke()}if(""!==this.lu){var f=t.getFlatInteriorPoints();this.Qf(f,0,f.length,2)}}},n.prototype.th=function(t){var n=this.Pf,i=this.Nf;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,n.fillStyle=t.fillStyle):(n.fillStyle=t.fillStyle,this.Nf={fillStyle:t.fillStyle})},n.prototype.nh=function(t){var n=this.Pf,i=this.zf;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,n.lineCap=t.lineCap),n.setLineDash&&(h(i.lineDash,t.lineDash)||n.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,n.lineDashOffset=t.lineDashOffset)),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,n.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,n.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,n.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,n.strokeStyle=t.strokeStyle)):(n.lineCap=t.lineCap,n.setLineDash&&(n.setLineDash(t.lineDash),n.lineDashOffset=t.lineDashOffset),n.lineJoin=t.lineJoin,n.lineWidth=t.lineWidth,n.miterLimit=t.miterLimit,n.strokeStyle=t.strokeStyle,this.zf={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})},n.prototype.ih=function(t){var n=this.Pf,i=this.Ff,r=t.textAlign?t.textAlign:po;i?(i.font!=t.font&&(i.font=t.font,n.font=t.font),i.textAlign!=r&&(i.textAlign=r,n.textAlign=r),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,n.textBaseline=t.textBaseline)):(n.font=t.font,n.textAlign=r,n.textBaseline=t.textBaseline,this.Ff={font:t.font,textAlign:r,textBaseline:t.textBaseline})},n.prototype.setFillStrokeStyle=function(t,n){var i=this;if(t){var r=t.getColor();this.Lf={fillStyle:Ft(r||ao)}}else this.Lf=null;if(n){var e=n.getColor(),o=n.getLineCap(),u=n.getLineDash(),s=n.getLineDashOffset(),a=n.getLineJoin(),f=n.getWidth(),h=n.getMiterLimit(),c=u||ho;this.Gf={lineCap:void 0!==o?o:fo,lineDash:1===this.Gi?c:c.map((function(t){return t*i.Gi})),lineDashOffset:(s||0)*this.Gi,lineJoin:void 0!==a?a:co,lineWidth:(void 0!==f?f:1)*this.Gi,miterLimit:void 0!==h?h:lo,strokeStyle:Ft(e||vo)}}else this.Gf=null},n.prototype.setImageStyle=function(t){var n;if(t&&(n=t.getSize())){var i=t.getAnchor(),r=t.getOrigin();this.bo=t.getImage(this.Gi),this.Df=i[0]*this.Gi,this.Uf=i[1]*this.Gi,this.qf=n[1]*this.Gi,this.Bf=t.getOpacity(),this.Xf=r[0],this.Vf=r[1],this.Wf=t.getRotateWithView(),this.Yf=t.getRotation(),this.Zf=t.getScaleArray(),this.Hf=n[0]*this.Gi}else this.bo=null},n.prototype.setTextStyle=function(t){if(t){var n=t.getFill();if(n){var i=n.getColor();this.Ka={fillStyle:Ft(i||ao)}}else this.Ka=null;var r=t.getStroke();if(r){var e=r.getColor(),o=r.getLineCap(),u=r.getLineDash(),s=r.getLineDashOffset(),a=r.getLineJoin(),f=r.getWidth(),h=r.getMiterLimit();this.Ja={lineCap:void 0!==o?o:fo,lineDash:u||ho,lineDashOffset:s||0,lineJoin:void 0!==a?a:co,lineWidth:void 0!==f?f:1,miterLimit:void 0!==h?h:lo,strokeStyle:Ft(e||vo)}}else this.Ja=null;var c=t.getFont(),l=t.getOffsetX(),v=t.getOffsetY(),p=t.getRotateWithView(),d=t.getRotation(),y=t.getScaleArray(),m=t.getText(),w=t.getTextAlign(),b=t.getTextBaseline();this.$a={font:void 0!==c?c:so,textAlign:void 0!==w?w:po,textBaseline:void 0!==b?b:yo},this.lu=void 0!==m?Array.isArray(m)?m.reduce((function(t,n,i){return t+(i%2?" ":n)}),""):m:"",this.Wa=void 0!==l?this.Gi*l:0,this.Ya=void 0!==v?this.Gi*v:0,this.Za=void 0!==p&&p,this.Ha=void 0!==d?d:0,this.Kf=[this.Gi*y[0],this.Gi*y[1]]}else this.lu=""},n}(kg),yx=.5;function mx(t,n,i,r,o,u,s){var a=Qt(t[0]*yx,t[1]*yx);a.imageSmoothingEnabled=!1;for(var f=a.canvas,h=new dx(a,yx,o,null,s),c=i.length,l=Math.floor(16777215/c),v={},p=1;p<=c;++p){var d=i[p-1],y=d.getStyleFunction()||r;if(r){var m=y(d,u);if(m){Array.isArray(m)||(m=[m]);for(var w="#"+("000000"+(p*l).toString(16)).slice(-6),b=0,g=m.length;b<g;++b){var x=m[b],_=x.getGeometryFunction()(d);if(_&&Er(o,_.getExtent())){var M=x.clone(),O=M.getFill();O&&O.setColor(w);var S=M.getStroke();S&&(S.setColor(w),S.setLineDash(null)),M.setText(void 0);var j=x.getImage();if(j&&0!==j.getOpacity()){var E=j.getImageSize();if(!E)continue;var k=Qt(E[0],E[1],void 0,{alpha:!1}),T=k.canvas;k.fillStyle=w,k.fillRect(0,0,T.width,T.height),M.setImage(new Mv({img:T,imgSize:E,anchor:j.getAnchor(),anchorXUnits:nv,anchorYUnits:nv,offset:j.getOrigin(),opacity:1,size:j.getSize(),scale:j.getScale(),rotation:j.getRotation(),rotateWithView:j.getRotateWithView()}))}var A=M.getZIndex()||0;(R=v[A])||(R={},v[A]=R,R[Kr.POLYGON]=[],R[Kr.CIRCLE]=[],R[Kr.LINE_STRING]=[],R[Kr.POINT]=[]),R[_.getType().replace("Multi","")].push(_,M)}}}}}for(var C=Object.keys(v).map(Number).sort(e),P=(p=0,C.length);p<P;++p){var R=v[C[p]];for(var I in R){var N=R[I];for(b=0,g=N.length;b<g;b+=2){h.setStyle(N[b+1]);for(var z=0,F=n.length;z<F;++z)h.setTransform(n[z]),h.drawGeometry(N[b])}}}return a.getImageData(0,0,f.width,f.height)}function wx(t,n,i){var r=[];if(i){var e=Math.floor(Math.round(t[0])*yx),o=Math.floor(Math.round(t[1])*yx),u=4*(x(e,0,i.width-1)+x(o,0,i.height-1)*i.width),s=i.data[u],a=i.data[u+1],f=i.data[u+2]+256*(a+256*s),h=Math.floor(16777215/n.length);f&&f%h==0&&r.push(n[f/h-1])}return r}var bx={Point:function(t,n,i,r,e){var o,u=i.getImage(),s=i.getText();if(u){if(u.getImageState()!=av)return;var a=t;if(e){var f=u.getDeclutterMode();if("none"!==f)if(a=e,"obstacle"===f){var h=t.getBuilder(i.getZIndex(),Hg);h.setImageStyle(u,o),h.drawPoint(n,r)}else s&&s.getText()&&(o={})}var c=a.getBuilder(i.getZIndex(),Hg);c.setImageStyle(u,o),c.drawPoint(n,r)}if(s&&s.getText()){var l=t;e&&(l=e);var v=l.getBuilder(i.getZIndex(),$g);v.setTextStyle(s,o),v.drawText(n,r)}},LineString:function(t,n,i,r,e){var o=i.getStroke();if(o){var u=t.getBuilder(i.getZIndex(),Kg);u.setFillStrokeStyle(null,o),u.drawLineString(n,r)}var s=i.getText();if(s&&s.getText()){var a=(e||t).getBuilder(i.getZIndex(),$g);a.setTextStyle(s),a.drawText(n,r)}},Polygon:function(t,n,i,r,e){var o=i.getFill(),u=i.getStroke();if(o||u){var s=t.getBuilder(i.getZIndex(),Jg);s.setFillStrokeStyle(o,u),s.drawPolygon(n,r)}var a=i.getText();if(a&&a.getText()){var f=(e||t).getBuilder(i.getZIndex(),$g);f.setTextStyle(a),f.drawText(n,r)}},MultiPoint:function(t,n,i,r,e){var o,u=i.getImage(),s=i.getText();if(u){if(u.getImageState()!=av)return;var a=t;if(e){var f=u.getDeclutterMode();if("none"!==f)if(a=e,"obstacle"===f){var h=t.getBuilder(i.getZIndex(),Hg);h.setImageStyle(u,o),h.drawMultiPoint(n,r)}else s&&s.getText()&&(o={})}var c=a.getBuilder(i.getZIndex(),Hg);c.setImageStyle(u,o),c.drawMultiPoint(n,r)}if(s&&s.getText()){var l=t;e&&(l=e);var v=l.getBuilder(i.getZIndex(),$g);v.setTextStyle(s,o),v.drawText(n,r)}},MultiLineString:function(t,n,i,r,e){var o=i.getStroke();if(o){var u=t.getBuilder(i.getZIndex(),Kg);u.setFillStrokeStyle(null,o),u.drawMultiLineString(n,r)}var s=i.getText();if(s&&s.getText()){var a=(e||t).getBuilder(i.getZIndex(),$g);a.setTextStyle(s),a.drawText(n,r)}},MultiPolygon:function(t,n,i,r,e){var o=i.getFill(),u=i.getStroke();if(u||o){var s=t.getBuilder(i.getZIndex(),Jg);s.setFillStrokeStyle(o,u),s.drawMultiPolygon(n,r)}var a=i.getText();if(a&&a.getText()){var f=(e||t).getBuilder(i.getZIndex(),$g);f.setTextStyle(a),f.drawText(n,r)}},GeometryCollection:function(t,n,i,r,e){var o,u,s=n.getGeometriesArray();for(o=0,u=s.length;o<u;++o){(0,bx[s[o].getType()])(t,s[o],i,r,e)}},Circle:function(t,n,i,r,e){var o=i.getFill(),u=i.getStroke();if(o||u){var s=t.getBuilder(i.getZIndex(),Yg);s.setFillStrokeStyle(o,u),s.drawCircle(n,r)}var a=i.getText();if(a&&a.getText()){var f=(e||t).getBuilder(i.getZIndex(),$g);f.setTextStyle(a),f.drawText(n,r)}}};function gx(t,n){return parseInt(d(t),10)-parseInt(d(n),10)}function xx(t,n){var i=_x(t,n);return i*i}function _x(t,n){return.5*t/n}function Mx(t,n,i,r,e,o,u){var s=!1,a=i.getImage();if(a){var f=a.getImageState();f==av||f==fv?a.unlistenImageChange(e):(f==uv&&a.load(),f=a.getImageState(),a.listenImageChange(e),s=!0)}return function(t,n,i,r,e,o){var u=i.getGeometryFunction()(n);if(!u)return;var s=u.simplifyTransformed(r,e);if(i.getRenderer())Ox(t,s,i,n);else{(0,bx[s.getType()])(t,s,i,n,o)}}(t,n,i,r,o,u),s}function Ox(t,n,i,r){if(n.getType()!=Kr.GEOMETRY_COLLECTION)t.getBuilder(i.getZIndex(),Zg).drawCustom(n,r,i.getRenderer(),i.getHitDetectionRenderer());else for(var e=n.getGeometries(),o=0,u=e.length;o<u;++o)Ox(t,e[o],i,r)}var Sx=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),jx=function(t){function n(n){var i=t.call(this,n)||this;return i.oh=i.uh.bind(i),i.sh,i.ah=!1,i.fh=null,i.hh=null,i.lh=-1,i.ph=NaN,i.dh=[1/0,1/0,-1/0,-1/0],i.yh=[1/0,1/0,-1/0,-1/0],i.mh,i.wh=null,i.bh=null,i.gh=null,i.xh=null,i.replayGroupChanged=!0,i.declutterExecutorGroup=null,i.clipping=!0,i}return Sx(n,t),n.prototype.renderWorlds=function(t,n,i){var r=n.extent,e=n.viewState,o=e.center,u=e.resolution,s=e.projection,a=e.rotation,f=s.getExtent(),h=this.getLayer().getSource(),c=n.pixelRatio,l=n.viewHints,v=!(l[mu]||l[wu]),p=this.context,d=Math.round(n.size[0]*c),y=Math.round(n.size[1]*c),m=h.getWrapX()&&s.canWrapX(),w=m?jr(f):null,b=m?Math.ceil((r[2]-f[2])/w)+1:1,g=m?Math.floor((r[0]-f[0])/w):0;do{var x=this.getRenderTransform(o,u,a,c,d,y,g*w);t.execute(p,1,x,a,v,void 0,i)}while(++g<b)},n.prototype.renderDeclutter=function(t){this.declutterExecutorGroup&&this.renderWorlds(this.declutterExecutorGroup,t,t.declutterTree)},n.prototype.renderFrame=function(t,n){var i=t.pixelRatio,r=t.layerStatesArray[t.layerIndex];We(this.pixelTransform,1/i,1/i),He(this.inversePixelTransform,this.pixelTransform);var e=Je(this.pixelTransform);this.useContainer(n,e,r.opacity,this.getBackground(t));var o=this.context,u=o.canvas,s=this.xh,a=this.declutterExecutorGroup;if((!s||s.isEmpty())&&(!a||a.isEmpty()))return null;var f=Math.round(t.size[0]*i),h=Math.round(t.size[1]*i);u.width!=f||u.height!=h?(u.width=f,u.height=h,u.style.transform!==e&&(u.style.transform=e)):this.containerReused||o.clearRect(0,0,f,h),this.preRender(o,t);var c=t.viewState,l=c.projection,v=!1,p=!0;if(r.extent&&this.clipping){var d=Ee(r.extent,l);(v=(p=Er(d,t.extent))&&!Qi(d,t.extent))&&this.clipUnrotated(o,t,d)}p&&this.renderWorlds(s,t),v&&o.restore(),this.postRender(o,t);var y=wn(r.opacity),m=this.container;return y!==m.style.opacity&&(m.style.opacity=y),this.mh!==c.rotation&&(this.mh=c.rotation,this.fh=null),this.container},n.prototype.getFeatures=function(t){return new Promise(function(n){if(!this.fh&&!this.sh){var i=[this.context.canvas.width,this.context.canvas.height];Be(this.pixelTransform,i);var r=this.wh,e=this.ph,o=this.mh,u=this.bh,s=this.yh,a=this.getLayer(),f=[],h=i[0]*yx,c=i[1]*yx;f.push(this.getRenderTransform(r,e,o,yx,h,c,0).slice());var l=a.getSource(),v=u.getExtent();if(l.getWrapX()&&u.canWrapX()&&!Qi(v,s)){for(var p=s[0],d=jr(v),y=0,m=void 0;p<v[0];)m=d*--y,f.push(this.getRenderTransform(r,e,o,yx,h,c,m).slice()),p+=d;for(y=0,p=s[2];p>v[2];)m=d*++y,f.push(this.getRenderTransform(r,e,o,yx,h,c,m).slice()),p-=d}this.fh=mx(i,f,this.hh,a.getStyleFunction(),s,e,o)}n(wx(t,this.hh,this.fh))}.bind(this))},n.prototype.forEachFeatureAtCoordinate=function(t,n,i,r,e){var o=this;if(this.xh){var u,s=n.viewState.resolution,a=n.viewState.rotation,f=this.getLayer(),h={},c=function(t,n,i){var o=d(t),u=h[o];if(u){if(!0!==u&&i<u.distanceSq){if(0===i)return h[o]=!0,e.splice(e.lastIndexOf(u),1),r(t,f,n);u.geometry=n,u.distanceSq=i}}else{if(0===i)return h[o]=!0,r(t,f,n);e.push(h[o]={feature:t,layer:f,geometry:n,distanceSq:i,callback:r})}},l=[this.xh];return this.declutterExecutorGroup&&l.push(this.declutterExecutorGroup),l.some((function(r){return u=r.forEachFeatureAtCoordinate(t,s,a,i,c,r===o.declutterExecutorGroup&&n.declutterTree?n.declutterTree.all().map((function(t){return t.value})):null)})),u}},n.prototype.handleFontsChanged=function(){var t=this.getLayer();t.getVisible()&&this.xh&&t.changed()},n.prototype.uh=function(t){this.renderIfReadyAndVisible()},n.prototype.prepareFrame=function(t){var n=this.getLayer(),i=n.getSource();if(!i)return!1;var r=t.viewHints[mu],e=t.viewHints[wu],o=n.getUpdateWhileAnimating(),u=n.getUpdateWhileInteracting();if(!this.ah&&!o&&r||!u&&e)return this.sh=!0,!0;this.sh=!1;var s=t.extent,a=t.viewState,f=a.projection,c=a.resolution,l=t.pixelRatio,v=n.getRevision(),p=n.getRenderBuffer(),d=n.getRenderOrder();void 0===d&&(d=gx);var y=a.center.slice(),m=Hi(s,p*c),w=m.slice(),b=[m.slice()],g=f.getExtent();if(i.getWrapX()&&f.canWrapX()&&!Qi(g,t.extent)){var x=jr(g),_=Math.max(jr(m)/2,x);m[0]=g[0]-_,m[2]=g[2]+_,Zr(y,f);var M=Rr(b[0],f);M[0]<g[0]&&M[2]<g[2]?b.push([M[0]+x,M[1],M[2]+x,M[3]]):M[0]>g[0]&&M[2]>g[2]&&b.push([M[0]-x,M[1],M[2]-x,M[3]])}if(!this.ah&&this.ph==c&&this.lh==v&&this.gh==d&&Qi(this.yh,m))return h(this.dh,w)||(this.fh=null,this.dh=w),this.wh=y,this.replayGroupChanged=!1,!0;this.xh=null,this.ah=!1;var O,S=new Ug(_x(c,l),m,c,l);this.getLayer().getDeclutter()&&(O=new Ug(_x(c,l),m,c,l));var j,E=Me();if(E){for(var k=0,T=b.length;k<T;++k){var A=je(b[k],f);i.loadFeatures(A,ke(c,f),E)}j=me(E,f)}else for(k=0,T=b.length;k<T;++k)i.loadFeatures(b[k],c,f);var C=xx(c,l),P=function(t){var i,r=t.getStyleFunction()||n.getStyleFunction();if(r&&(i=r(t,c)),i){var e=this.renderFeature(t,C,i,S,j,O);this.ah=this.ah||e}}.bind(this),R=je(m,f),I=i.getFeaturesInExtent(R);d&&I.sort(d);for(k=0,T=I.length;k<T;++k)P(I[k]);this.hh=I;var N=S.finish(),z=new vx(m,c,l,i.getOverlaps(),N,n.getRenderBuffer());return O&&(this.declutterExecutorGroup=new vx(m,c,l,i.getOverlaps(),O.finish(),n.getRenderBuffer())),this.ph=c,this.lh=v,this.gh=d,this.dh=w,this.yh=m,this.wh=y,this.bh=f,this.xh=z,this.fh=null,this.replayGroupChanged=!0,!0},n.prototype.renderFeature=function(t,n,i,r,e,o){if(!i)return!1;var u=!1;if(Array.isArray(i))for(var s=0,a=i.length;s<a;++s)u=Mx(r,t,i[s],n,this.oh,e,o)||u;else u=Mx(r,t,i,n,this.oh,e,o);return u},n}(Wg),Ex=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),kx=function(t){function n(n){return t.call(this,n)||this}return Ex(n,t),n.prototype.createRenderer=function(){return new jx(this)},n}(xg),Tx=function(){function t(t){this._h=new wg(t),this.Mh={}}return t.prototype.insert=function(t,n){var i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:n};this._h.insert(i),this.Mh[d(n)]=i},t.prototype.load=function(t,n){for(var i=new Array(n.length),r=0,e=n.length;r<e;r++){var o=t[r],u=n[r],s={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:u};i[r]=s,this.Mh[d(u)]=s}this._h.load(i)},t.prototype.remove=function(t){var n=d(t),i=this.Mh[n];return delete this.Mh[n],null!==this._h.remove(i)},t.prototype.update=function(t,n){var i=this.Mh[d(n)];sr([i.minX,i.minY,i.maxX,i.maxY],t)||(this.remove(n),this.insert(t,n))},t.prototype.getAll=function(){return this._h.all().map((function(t){return t.value}))},t.prototype.getInExtent=function(t){var n={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this._h.search(n).map((function(t){return t.value}))},t.prototype.forEach=function(t){return this.Oh(this.getAll(),t)},t.prototype.forEachInExtent=function(t,n){return this.Oh(this.getInExtent(t),n)},t.prototype.Oh=function(t,n){for(var i,r=0,e=t.length;r<e;r++)if(i=n(t[r]))return i;return i},t.prototype.isEmpty=function(){return H(this.Mh)},t.prototype.clear=function(){this._h.clear(),this.Mh={}},t.prototype.getExtent=function(t){var n=this._h.toJSON();return rr(n.minX,n.minY,n.maxX,n.maxY,t)},t.prototype.concat=function(t){for(var n in this._h.load(t._h.all()),t.Mh)this.Mh[n]=t.Mh[n]},t}(),Ax=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();function Cx(t){return t?Array.isArray(t)?function(n){return t}:"function"==typeof t?t:function(n){return[t]}:null}var Px=function(t){function n(n){var i=t.call(this)||this;i.projection=ae(n.projection),i.Sh=Cx(n.attributions),i.jh=void 0===n.attributionsCollapsible||n.attributionsCollapsible,i.loading=!1,i.V=void 0!==n.state?n.state:Gn,i.Eh=void 0!==n.wrapX&&n.wrapX,i.kh=!!n.interpolate,i.viewResolver=null,i.viewRejector=null;var r=i;return i.Th=new Promise((function(t,n){r.viewResolver=t,r.viewRejector=n})),i}return Ax(n,t),n.prototype.getAttributions=function(){return this.Sh},n.prototype.getAttributionsCollapsible=function(){return this.jh},n.prototype.getProjection=function(){return this.projection},n.prototype.getResolutions=function(){return v()},n.prototype.getView=function(){return this.Th},n.prototype.getState=function(){return this.V},n.prototype.getWrapX=function(){return this.Eh},n.prototype.getInterpolate=function(){return this.kh},n.prototype.refresh=function(){this.changed()},n.prototype.setAttributions=function(t){this.Sh=Cx(t),this.changed()},n.prototype.setState=function(t){this.V=t,this.changed()},n}(xt),Rx="addfeature",Ix="changefeature",Nx="clear",zx="removefeature",Fx="featuresloadstart",Lx="featuresloadend",Gx="featuresloaderror";function Dx(t,n){return[[-1/0,-1/0,1/0,1/0]]}var Ux=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),qx=function(t){function n(n,i,r){var e=t.call(this,n)||this;return e.feature=i,e.features=r,e}return Ux(n,t),n}(L),Bx=function(t){function n(n){var i=this,r=n||{};(i=t.call(this,{attributions:r.attributions,interpolate:!0,projection:void 0,state:Gn,wrapX:void 0===r.wrapX||r.wrapX})||this).on,i.once,i.un,i.ge=B,i.Ah=r.format,i.Ef=void 0===r.overlaps||r.overlaps,i.Ch=r.url,void 0!==r.loader?i.ge=r.loader:void 0!==i.Ch&&(g(i.Ah,7),i.ge=cf(i.Ch,i.Ah)),i.Ph=void 0!==r.strategy?r.strategy:Dx;var e,o,u=void 0===r.useSpatialIndex||r.useSpatialIndex;return i.Rh=u?new Tx:null,i.Ih=new Tx,i.Nh=0,i.zh={},i.Fh={},i.Lh={},i.Gh={},i.Dh=null,Array.isArray(r.features)?o=r.features:r.features&&(o=(e=r.features).getArray()),u||void 0!==e||(e=new Et(o)),void 0!==o&&i.addFeaturesInternal(o),void 0!==e&&i.Uh(e),i}return Ux(n,t),n.prototype.addFeature=function(t){this.addFeatureInternal(t),this.changed()},n.prototype.addFeatureInternal=function(t){var n=d(t);if(this.qh(n,t)){this.Bh(n,t);var i=t.getGeometry();if(i){var r=i.getExtent();this.Rh&&this.Rh.insert(r,t)}else this.zh[n]=t;this.dispatchEvent(new qx(Rx,t))}else this.Dh&&this.Dh.remove(t)},n.prototype.Bh=function(t,n){this.Gh[t]=[lt(n,$,this.Xh,this),lt(n,G,this.Xh,this)]},n.prototype.qh=function(t,n){var i=!0,r=n.getId();return void 0!==r&&(r.toString()in this.Fh?i=!1:this.Fh[r.toString()]=n),i&&(g(!(t in this.Lh),30),this.Lh[t]=n),i},n.prototype.addFeatures=function(t){this.addFeaturesInternal(t),this.changed()},n.prototype.addFeaturesInternal=function(t){for(var n=[],i=[],r=[],e=0,o=t.length;e<o;e++){var u=d(a=t[e]);this.qh(u,a)&&i.push(a)}e=0;for(var s=i.length;e<s;e++){var a;u=d(a=i[e]);this.Bh(u,a);var f=a.getGeometry();if(f){var h=f.getExtent();n.push(h),r.push(a)}else this.zh[u]=a}if(this.Rh&&this.Rh.load(n,r),this.hasListener(Rx)){e=0;for(var c=i.length;e<c;e++)this.dispatchEvent(new qx(Rx,i[e]))}},n.prototype.Uh=function(t){var n=!1;this.addEventListener(Rx,(function(i){n||(n=!0,t.push(i.feature),n=!1)})),this.addEventListener(zx,(function(i){n||(n=!0,t.remove(i.feature),n=!1)})),t.addEventListener(_t,function(t){n||(n=!0,this.addFeature(t.element),n=!1)}.bind(this)),t.addEventListener(Mt,function(t){n||(n=!0,this.removeFeature(t.element),n=!1)}.bind(this)),this.Dh=t},n.prototype.clear=function(t){if(t){for(var n in this.Gh){this.Gh[n].forEach(pt)}this.Dh||(this.Gh={},this.Fh={},this.Lh={})}else if(this.Rh){var i=function(t){this.removeFeatureInternal(t)}.bind(this);for(var r in this.Rh.forEach(i),this.zh)this.removeFeatureInternal(this.zh[r])}this.Dh&&this.Dh.clear(),this.Rh&&this.Rh.clear(),this.zh={};var e=new qx(Nx);this.dispatchEvent(e),this.changed()},n.prototype.forEachFeature=function(t){if(this.Rh)return this.Rh.forEach(t);this.Dh&&this.Dh.forEach(t)},n.prototype.forEachFeatureAtCoordinateDirect=function(t,n){var i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,(function(i){return i.getGeometry().intersectsCoordinate(t)?n(i):void 0}))},n.prototype.forEachFeatureInExtent=function(t,n){if(this.Rh)return this.Rh.forEachInExtent(t,n);this.Dh&&this.Dh.forEach(n)},n.prototype.forEachFeatureIntersectingExtent=function(t,n){return this.forEachFeatureInExtent(t,(function(i){if(i.getGeometry().intersectsExtent(t)){var r=n(i);if(r)return r}}))},n.prototype.getFeaturesCollection=function(){return this.Dh},n.prototype.getFeatures=function(){var t;return this.Dh?t=this.Dh.getArray().slice(0):this.Rh&&(t=this.Rh.getAll(),H(this.zh)||a(t,Z(this.zh))),t},n.prototype.getFeaturesAtCoordinate=function(t){var n=[];return this.forEachFeatureAtCoordinateDirect(t,(function(t){n.push(t)})),n},n.prototype.getFeaturesInExtent=function(t){return this.Rh?this.Rh.getInExtent(t):this.Dh?this.Dh.getArray().slice(0):[]},n.prototype.getClosestFeatureToCoordinate=function(t,n){var i=t[0],r=t[1],e=null,o=[NaN,NaN],u=1/0,s=[-1/0,-1/0,1/0,1/0],a=n||U;return this.Rh.forEachInExtent(s,(function(t){if(a(t)){var n=t.getGeometry(),f=u;if((u=n.closestPointXY(i,r,o,u))<f){e=t;var h=Math.sqrt(u);s[0]=i-h,s[1]=r-h,s[2]=i+h,s[3]=r+h}}})),e},n.prototype.getExtent=function(t){return this.Rh.getExtent(t)},n.prototype.getFeatureById=function(t){var n=this.Fh[t.toString()];return void 0!==n?n:null},n.prototype.getFeatureByUid=function(t){var n=this.Lh[t];return void 0!==n?n:null},n.prototype.getFormat=function(){return this.Ah},n.prototype.getOverlaps=function(){return this.Ef},n.prototype.getUrl=function(){return this.Ch},n.prototype.Xh=function(t){var n=t.target,i=d(n),r=n.getGeometry();if(r){var e=r.getExtent();i in this.zh?(delete this.zh[i],this.Rh&&this.Rh.insert(e,n)):this.Rh&&this.Rh.update(e,n)}else i in this.zh||(this.Rh&&this.Rh.remove(n),this.zh[i]=n);var o=n.getId();if(void 0!==o){var u=o.toString();this.Fh[u]!==n&&(this.Vh(n),this.Fh[u]=n)}else this.Vh(n),this.Lh[i]=n;this.changed(),this.dispatchEvent(new qx(Ix,n))},n.prototype.hasFeature=function(t){var n=t.getId();return void 0!==n?n in this.Fh:d(t)in this.Lh},n.prototype.isEmpty=function(){return this.Rh?this.Rh.isEmpty()&&H(this.zh):!this.Dh||0===this.Dh.getLength()},n.prototype.loadFeatures=function(t,n,i){for(var r=this.Ih,e=this.Ph(t,n,i),o=function(t,o){var s=e[t];r.forEachInExtent(s,(function(t){return Qi(t.extent,s)}))||(++u.Nh,u.dispatchEvent(new qx(Fx)),u.ge.call(u,s,n,i,function(t){--this.Nh,this.dispatchEvent(new qx(Lx,void 0,t))}.bind(u),function(){--this.Nh,this.dispatchEvent(new qx(Gx))}.bind(u)),r.insert(s,{extent:s.slice()}))},u=this,s=0,a=e.length;s<a;++s)o(s);this.loading=!(this.ge.length<4)&&this.Nh>0},n.prototype.refresh=function(){this.clear(!0),this.Ih.clear(),t.prototype.refresh.call(this)},n.prototype.removeLoadedExtent=function(t){var n,i=this.Ih;i.forEachInExtent(t,(function(i){if(sr(i.extent,t))return n=i,!0})),n&&i.remove(n)},n.prototype.removeFeature=function(t){if(t){var n=d(t);n in this.zh?delete this.zh[n]:this.Rh&&this.Rh.remove(t),this.removeFeatureInternal(t)&&this.changed()}},n.prototype.removeFeatureInternal=function(t){var n=d(t),i=this.Gh[n];if(i){i.forEach(pt),delete this.Gh[n];var r=t.getId();return void 0!==r&&delete this.Fh[r.toString()],delete this.Lh[n],this.dispatchEvent(new qx(zx,t)),t}},n.prototype.Vh=function(t){var n=!1;for(var i in this.Fh)if(this.Fh[i]===t){delete this.Fh[i],n=!0;break}return n},n.prototype.setLoader=function(t){this.ge=t},n.prototype.setUrl=function(t){g(this.Ah,7),this.Ch=t,this.setLoader(cf(t,this.Ah))},n}(Px),Xx=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Vx="Point",Wx="LineString",Yx="Polygon",Zx="Circle",Hx="drawstart",Kx="drawend",Jx="drawabort",$x=function(t){function n(n,i){var r=t.call(this,n)||this;return r.feature=i,r}return Xx(n,t),n}(L);var Qx=function(t){function n(n){var i=this,r=n;r.stopDown||(r.stopDown=q),(i=t.call(this,r)||this).on,i.once,i.un,i.Wh=!1,i.Yh=null,i.Zh,i.Hh,i.Kh,i.Jh=!1,i.gt=n.source?n.source:null,i.$h=n.features?n.features:null,i.Qh=n.snapTolerance?n.snapTolerance:12,i.Nu=n.type,i.tc=function(t){switch(t){case Kr.POINT:case Kr.MULTI_POINT:return Vx;case Kr.LINE_STRING:case Kr.MULTI_LINE_STRING:return Wx;case Kr.POLYGON:case Kr.MULTI_POLYGON:return Yx;case Kr.CIRCLE:return Zx;default:throw new Error("Invalid type: "+t)}}(i.Nu),i.ic=!!n.stopClick,i.rc=n.minPoints?n.minPoints:i.tc===Yx?3:2,i.ec=i.tc===Zx?2:n.maxPoints?n.maxPoints:1/0,i.oc=n.finishCondition?n.finishCondition:U,i.Wu=n.geometryLayout?n.geometryLayout:Iu;var e,o=n.geometryFunction;if(!o){var u,s=i.tc;if(s===Zx)o=function(t,n,i){var r=n||new Cb([NaN,NaN]),e=Se(t[0],i),o=Xr(e,Se(t[t.length-1],i));r.setCenterAndRadius(e,Math.sqrt(o),this.Wu);var u=Me();return u&&r.transform(i,u),r};else s===Vx?u=_s:s===Wx?u=Mf:s===Yx&&(u=Xs),o=function(t,n,i){return n?s===Yx?t[0].length?n.setCoordinates([t[0].concat([t[0][0]])],this.Wu):n.setCoordinates([],this.Wu):n.setCoordinates(t,this.Wu):n=new u(t,this.Wu),n}}return i.hu=o,i.uc=void 0!==n.dragVertexDelay?n.dragVertexDelay:500,i.sc=null,i.ac=null,i.fc=null,i.hc=null,i.cc=null,i.lc=null,i.vc=n.clickTolerance?n.clickTolerance*n.clickTolerance:36,i.dc=new kx({source:new Bx({useSpatialIndex:!1,wrapX:!!n.wrapX&&n.wrapX}),style:n.style?n.style:(e=Iv(),function(t,n){return e[t.getGeometry().getType()]}),updateWhileInteracting:!0}),i.Se=n.geometryName,i.ya=n.condition?n.condition:Ka,i.yc,n.freehand?i.yc=Wa:i.yc=n.freehandCondition?n.freehandCondition:Ja,i.addChangeListener(Ub,i.mc),i}return Xx(n,t),n.prototype.setMap=function(n){t.prototype.setMap.call(this,n),this.mc()},n.prototype.getOverlay=function(){return this.dc},n.prototype.handleEvent=function(n){n.originalEvent.type===tt&&n.originalEvent.preventDefault(),this.Jh=this.tc!==Vx&&this.yc(n);var i=n.type===eu.POINTERMOVE,r=!0;!this.Jh&&this.Hh&&n.type===eu.POINTERDRAG&&(Date.now()-this.Hh>=this.uc?(this.Yh=n.pixel,this.Wh=!this.Jh,i=!0):this.Hh=void 0,this.Wh&&void 0!==this.Zh&&(clearTimeout(this.Zh),this.Zh=void 0));return this.Jh&&n.type===eu.POINTERDRAG&&null!==this.ac?(this.wc(n.coordinate),r=!1):this.Jh&&n.type===eu.POINTERDOWN?r=!1:i&&this.getPointerCount()<2?(r=n.type===eu.POINTERMOVE)&&this.Jh?(this.Ln(n),this.Wh&&n.originalEvent.preventDefault()):("mouse"===n.originalEvent.pointerType||n.type===eu.POINTERDRAG&&void 0===this.Zh)&&this.Ln(n):n.type===eu.DBLCLICK&&(r=!1),t.prototype.handleEvent.call(this,n)&&r},n.prototype.handleDownEvent=function(t){return this.Wh=!this.Jh,this.Jh?(this.Yh=t.pixel,this.sc||this.bc(t.coordinate),!0):this.ya(t)?(this.Hh=Date.now(),this.Zh=setTimeout(function(){this.Ln(new ru(eu.POINTERMOVE,t.map,t.originalEvent,!1,t.frameState))}.bind(this),this.uc),this.Yh=t.pixel,!0):(this.Hh=void 0,!1)},n.prototype.handleUpEvent=function(t){var n=!0;if(0===this.getPointerCount())if(this.Zh&&(clearTimeout(this.Zh),this.Zh=void 0),this.Ln(t),this.Wh){var i=!this.sc;i&&this.bc(t.coordinate),!i&&this.Jh?this.finishDrawing():this.Jh||i&&this.tc!==Vx||(this.gc(t.pixel)?this.oc(t)&&this.finishDrawing():this.wc(t.coordinate)),n=!1}else this.Jh&&this.abortDrawing();return!n&&this.ic&&t.preventDefault(),n},n.prototype.Ln=function(t){if(this.Kh=t.originalEvent.pointerType,this.Yh&&(!this.Jh&&this.Wh||this.Jh&&!this.Wh)){var n=this.Yh,i=t.pixel,r=n[0]-i[0],e=n[1]-i[1],o=r*r+e*e;if(this.Wh=this.Jh?o>this.vc:o<=this.vc,!this.Wh)return}this.sc?this.xc(t.coordinate):this._c(t.coordinate.slice())},n.prototype.gc=function(t){var n=!1;if(this.ac){var i=!1,r=[this.sc],e=this.tc;if(e===Vx)n=!0;else if(e===Zx)n=2===this.hc.length;else if(e===Wx)i=this.hc.length>this.rc;else if(e===Yx){var o=this.hc;i=o[0].length>this.rc,r=[o[0][0],o[0][o[0].length-2]]}if(i)for(var u=this.getMap(),s=0,a=r.length;s<a;s++){var f=r[s],h=u.getPixelFromCoordinate(f),c=t[0]-h[0],l=t[1]-h[1],v=this.Jh?1:this.Qh;if(n=Math.sqrt(c*c+l*l)<=v){this.sc=f;break}}}return n},n.prototype._c=function(t){this.fc?this.fc.getGeometry().setCoordinates(t):(this.fc=new ef(new _s(t)),this.Mc())},n.prototype.Oc=function(t){this.cc||(this.cc=new ef);var n=t.getLinearRing(0),i=this.cc.getGeometry();i?(i.setFlatCoordinates(n.getLayout(),n.getFlatCoordinates()),i.changed()):(i=new Mf(n.getFlatCoordinates(),n.getLayout()),this.cc.setGeometry(i))},n.prototype.bc=function(t){for(var n=this.getMap().getView().getProjection(),i=Wu(this.Wu);t.length<i;)t.push(0);this.sc=t,this.tc===Vx?this.hc=t.slice():this.tc===Yx?(this.hc=[[t.slice(),t.slice()]],this.lc=this.hc[0]):this.hc=[t.slice(),t.slice()],this.lc&&(this.cc=new ef(new Mf(this.lc)));var r=this.hu(this.hc,void 0,n);this.ac=new ef,this.Se&&this.ac.setGeometryName(this.Se),this.ac.setGeometry(r),this.Mc(),this.dispatchEvent(new $x(Hx,this.ac))},n.prototype.xc=function(t){for(var n,i,r=this.getMap(),e=this.ac.getGeometry(),o=r.getView().getProjection(),u=Wu(this.Wu);t.length<u;)t.push(0);(this.tc===Vx?i=this.hc:this.tc===Yx?(i=(n=this.hc[0])[n.length-1],this.gc(r.getPixelFromCoordinate(t))&&(t=this.sc.slice())):i=(n=this.hc)[n.length-1],i[0]=t[0],i[1]=t[1],this.hu(this.hc,e,o),this.fc)&&this.fc.getGeometry().setCoordinates(t);if(e.getType()===Kr.POLYGON&&this.tc!==Yx)this.Oc(e);else if(this.lc){this.cc.getGeometry().setCoordinates(this.lc)}this.Mc()},n.prototype.wc=function(t){var n,i,r=this.ac.getGeometry(),e=this.getMap().getView().getProjection(),o=this.tc;o===Wx||o===Zx?(this.sc=t.slice(),(i=this.hc).length>=this.ec&&(this.Jh?i.pop():n=!0),i.push(t.slice()),this.hu(i,r,e)):o===Yx&&((i=this.hc[0]).length>=this.ec&&(this.Jh?i.pop():n=!0),i.push(t.slice()),n&&(this.sc=i[0]),this.hu(this.hc,r,e)),this._c(t.slice()),this.Mc(),n&&this.finishDrawing()},n.prototype.removeLastPoint=function(){if(this.ac){var t,n=this.ac.getGeometry(),i=this.getMap().getView().getProjection(),r=this.tc;if(r===Wx||r===Zx){if((t=this.hc).splice(-2,1),t.length>=2){this.sc=t[t.length-2].slice();var e=this.sc.slice();t[t.length-1]=e,this._c(e)}this.hu(t,n,i),n.getType()===Kr.POLYGON&&this.cc&&this.Oc(n)}else if(r===Yx){(t=this.hc[0]).splice(-2,1);var o=this.cc.getGeometry();if(t.length>=2){e=t[t.length-2].slice();t[t.length-1]=e,this._c(e)}o.setCoordinates(t),this.hu(this.hc,n,i)}1===t.length&&this.abortDrawing(),this.Mc()}},n.prototype.finishDrawing=function(){var t=this.Sc();if(t){var n=this.hc,i=t.getGeometry(),r=this.getMap().getView().getProjection();this.tc===Wx?(n.pop(),this.hu(n,i,r)):this.tc===Yx&&(n[0].pop(),this.hu(n,i,r),n=i.getCoordinates()),this.Nu===Kr.MULTI_POINT?t.setGeometry(new Ef([n])):this.Nu===Kr.MULTI_LINE_STRING?t.setGeometry(new Sf([n])):this.Nu===Kr.MULTI_POLYGON&&t.setGeometry(new Af([n])),this.dispatchEvent(new $x(Kx,t)),this.$h&&this.$h.push(t),this.gt&&this.gt.addFeature(t)}},n.prototype.Sc=function(){this.sc=null;var t=this.ac;return this.ac=null,this.fc=null,this.cc=null,this.dc.getSource().clear(!0),t},n.prototype.abortDrawing=function(){var t=this.Sc();t&&this.dispatchEvent(new $x(Jx,t))},n.prototype.appendCoordinates=function(t){var n,i=this.tc,r=!this.ac;if(r&&this.bc(t[0]),i===Wx||i===Zx)n=this.hc;else{if(i!==Yx)return;n=this.hc&&this.hc.length?this.hc[0]:[]}r&&n.shift(),n.pop();for(var e=0;e<t.length;e++)this.wc(t[e]);var o=t[t.length-1];this.wc(o),this.xc(o)},n.prototype.extend=function(t){var n=t.getGeometry();this.ac=t,this.hc=n.getCoordinates();var i=this.hc[this.hc.length-1];this.sc=i.slice(),this.hc.push(i.slice()),this.fc=new ef(new _s(i)),this.Mc(),this.dispatchEvent(new $x(Hx,this.ac))},n.prototype.Mc=function(){var t=[];this.ac&&t.push(this.ac),this.cc&&t.push(this.cc),this.fc&&t.push(this.fc);var n=this.dc.getSource();n.clear(!0),n.addFeatures(t)},n.prototype.mc=function(){var t=this.getMap(),n=this.getActive();t&&n||this.abortDrawing(),this.dc.setMap(n?t:null)},n}(tg),t_=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),n_="extentchanged",i_=function(t){function n(n){var i=t.call(this,n_)||this;return i.extent=n,i}return t_(n,t),n}(L);function r_(){var t=Iv();return function(n,i){return t[Kr.POINT]}}function e_(t){return function(n){return Zi([t,n])}}function o_(t,n){return t[0]==n[0]?function(i){return Zi([t,[i[0],n[1]]])}:t[1]==n[1]?function(i){return Zi([t,[n[0],i[1]]])}:null}var u_=function(t){function n(n){var i,r=this,e=n||{};return(r=t.call(this,e)||this).on,r.once,r.un,r.ya=e.condition?e.condition:Wa,r.Ft=null,r.jc=null,r.Ec=void 0!==e.pixelTolerance?e.pixelTolerance:10,r.kc=!1,r.Tc=null,r.Ac=null,n||(n={}),r.Cc=new kx({source:new Bx({useSpatialIndex:!1,wrapX:!!n.wrapX}),style:n.boxStyle?n.boxStyle:(i=Iv(),function(t,n){return i[Kr.POLYGON]}),updateWhileAnimating:!0,updateWhileInteracting:!0}),r.Pc=new kx({source:new Bx({useSpatialIndex:!1,wrapX:!!n.wrapX}),style:n.pointerStyle?n.pointerStyle:r_(),updateWhileAnimating:!0,updateWhileInteracting:!0}),n.extent&&r.setExtent(n.extent),r}return t_(n,t),n.prototype.Rc=function(t,n){var i=n.getCoordinateFromPixelInternal(t),r=this.getExtentInternal();if(r){var e=function(t){return[[[t[0],t[1]],[t[0],t[3]]],[[t[0],t[3]],[t[2],t[3]]],[[t[2],t[3]],[t[2],t[1]]],[[t[2],t[1]],[t[0],t[1]]]]}(r);e.sort((function(t,n){return Wr(i,t)-Wr(i,n)}));var o=e[0],u=Lr(i,o),s=n.getPixelFromCoordinateInternal(u);if(Vr(t,s)<=this.Ec){var a=n.getPixelFromCoordinateInternal(o[0]),f=n.getPixelFromCoordinateInternal(o[1]),h=Xr(s,a),c=Xr(s,f),l=Math.sqrt(Math.min(h,c));return this.kc=l<=this.Ec,this.kc&&(u=h>c?o[1]:o[0]),u}}return null},n.prototype.Ln=function(t){var n=t.pixel,i=t.map,r=this.Rc(n,i);r||(r=i.getCoordinateFromPixelInternal(n)),this.Ic(r)},n.prototype.Nc=function(t){var n=this.Tc;return n?t?n.setGeometry(Ws(t)):n.setGeometry(void 0):(n=new ef(t?Ws(t):{}),this.Tc=n,this.Cc.getSource().addFeature(n)),n},n.prototype.Ic=function(t){var n=this.Ac;n?n.getGeometry().setCoordinates(t):(n=new ef(new _s(t)),this.Ac=n,this.Pc.getSource().addFeature(n));return n},n.prototype.handleEvent=function(n){return!n.originalEvent||!this.ya(n)||(n.type!=eu.POINTERMOVE||this.handlingDownUpSequence||this.Ln(n),t.prototype.handleEvent.call(this,n),!1)},n.prototype.handleDownEvent=function(t){var n=t.pixel,i=t.map,r=this.getExtentInternal(),e=this.Rc(n,i),o=function(t){var n=null,i=null;return t[0]==r[0]?n=r[2]:t[0]==r[2]&&(n=r[0]),t[1]==r[1]?i=r[3]:t[1]==r[3]&&(i=r[1]),null!==n&&null!==i?[n,i]:null};if(e&&r){var u=e[0]==r[0]||e[0]==r[2]?e[0]:null,s=e[1]==r[1]||e[1]==r[3]?e[1]:null;null!==u&&null!==s?this.jc=e_(o(e)):null!==u?this.jc=o_(o([u,r[1]]),o([u,r[3]])):null!==s&&(this.jc=o_(o([r[0],s]),o([r[2],s])))}else e=i.getCoordinateFromPixelInternal(n),this.setExtent([e[0],e[1],e[0],e[1]]),this.jc=e_(e);return!0},n.prototype.handleDragEvent=function(t){if(this.jc){var n=t.coordinate;this.setExtent(this.jc(n)),this.Ic(n)}},n.prototype.handleUpEvent=function(t){this.jc=null;var n=this.getExtentInternal();return n&&0!==yr(n)||this.setExtent(null),!1},n.prototype.setMap=function(n){this.Cc.setMap(n),this.Pc.setMap(n),t.prototype.setMap.call(this,n)},n.prototype.getExtent=function(){return je(this.getExtentInternal(),this.getMap().getView().getProjection())},n.prototype.getExtentInternal=function(){return this.Ft},n.prototype.setExtent=function(t){this.Ft=t||null,this.Nc(t),this.dispatchEvent(new i_(this.Ft))},n}(tg),s_=37,a_=38,f_=39,h_=40,c_=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),l_=function(t){function n(n){var i=t.call(this)||this,r=n||{};return i.zc=function(t){return Ka(t)&&$a(t)},i.ya=void 0!==r.condition?r.condition:i.zc,i.Dr=void 0!==r.duration?r.duration:100,i.Fc=void 0!==r.pixelDelta?r.pixelDelta:128,i}return c_(n,t),n.prototype.handleEvent=function(t){var n=!1;if(t.type==ut){var i=t.originalEvent,r=i.keyCode;if(this.ya(t)&&(r==h_||r==s_||r==f_||r==a_)){var e=t.map.getView(),o=e.getResolution()*this.Fc,u=0,s=0;r==h_?s=-o:r==s_?u=-o:r==f_?u=o:s=o;var a=[u,s];qr(a,e.getRotation()),Bb(e,a,this.Dr),i.preventDefault(),n=!0}}return!n},n}(Vb),v_=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),p_=function(t){function n(n){var i=t.call(this)||this,r=n||{};return i.ya=r.condition?r.condition:$a,i.na=r.delta?r.delta:1,i.Dr=void 0!==r.duration?r.duration:100,i}return v_(n,t),n.prototype.handleEvent=function(t){var n=!1;if(t.type==ut||t.type==st){var i=t.originalEvent,r=i.charCode;if(this.ya(t)&&(r=="+".charCodeAt(0)||r=="-".charCodeAt(0))){var e=t.map,o=r=="+".charCodeAt(0)?this.na:-this.na;Xb(e.getView(),o,void 0,this.Dr),i.preventDefault(),n=!0}}return!n},n}(Vb);function d_(t){return(d_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var y_=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),m_=[0,0,0,0],w_=[],b_="modifystart",g_="modifyend",x_=function(t){function n(n,i,r){var e=t.call(this,n)||this;return e.features=i,e.mapBrowserEvent=r,e}return y_(n,t),n}(L);function __(t,n){return t.index-n.index}function M_(t,n,i){var r=n.geometry;if(r.getType()===Kr.CIRCLE){var e=r;if(1===n.index){var o=Me();o&&(e=e.clone().transform(o,i));var u=Xr(e.getCenter(),Se(t,i)),s=Math.sqrt(u)-e.getRadius();return s*s}}var a=Se(t,i);return w_[0]=Se(n.segment[0],i),w_[1]=Se(n.segment[1],i),Wr(a,w_)}function O_(t,n,i){var r=n.geometry;if(r.getType()===Kr.CIRCLE&&1===n.index){var e=r,o=Me();return o&&(e=e.clone().transform(o,i)),Oe(e.getClosestPoint(Se(t,i)),i)}var u=Se(t,i);return w_[0]=Se(n.segment[0],i),w_[1]=Se(n.segment[1],i),Oe(Lr(u,w_),i)}var S_=function(t){function n(n){var i,r,e=t.call(this,n)||this;if(e.on,e.once,e.un,e.Lc=e.Xh.bind(e),e.ya=n.condition?n.condition:tf,e.Gc=function(t){return qa(t)&&Ha(t)},e.Dc=n.deleteCondition?n.deleteCondition:e.Gc,e.Uc=n.insertVertexCondition?n.insertVertexCondition:Wa,e.Ac=null,e.qc=null,e.Bc=[0,0],e.Xc=!1,e.Vc=null,e.Wc=new Tx,e.Ec=void 0!==n.pixelTolerance?n.pixelTolerance:10,e.kc=!1,e.Yc=!1,e.Zc=[],e.dc=new kx({source:new Bx({useSpatialIndex:!1,wrapX:!!n.wrapX}),style:n.style?n.style:(i=Iv(),function(t,n){return i[Kr.POINT]}),updateWhileAnimating:!0,updateWhileInteracting:!0}),e.Hc={Point:e.Kc.bind(e),LineString:e.Jc.bind(e),LinearRing:e.Jc.bind(e),Polygon:e.$c.bind(e),MultiPoint:e.Qc.bind(e),MultiLineString:e.tl.bind(e),MultiPolygon:e.nl.bind(e),Circle:e.il.bind(e),GeometryCollection:e.rl.bind(e)},e.gt=null,e.el=null,n.features?r=n.features:n.source&&(e.gt=n.source,r=new Et(e.gt.getFeatures()),e.gt.addEventListener(Rx,e.ul.bind(e)),e.gt.addEventListener(zx,e.sl.bind(e))),!r)throw new Error("The modify interaction requires features, a source or a layer");return n.hitDetection&&(e.el=n.hitDetection),e.$h=r,e.$h.forEach(e.al.bind(e)),e.$h.addEventListener(_t,e.fl.bind(e)),e.$h.addEventListener(Mt,e.hl.bind(e)),e.cl=null,e.na=[0,0],e.ll=void 0===n.snapToPointer?!e.el:n.snapToPointer,e}return y_(n,t),n.prototype.al=function(t){var n=t.getGeometry();if(n){var i=this.Hc[n.getType()];i&&i(t,n)}var r=this.getMap();r&&r.isRendered()&&this.getActive()&&this.vl(this.Bc,r),t.addEventListener($,this.Lc)},n.prototype.pl=function(t,n){if(!this.Vc){this.Vc=new Et;for(var i=this.Vc.getArray(),r=0,e=n.length;r<e;++r)for(var o=n[r],u=0,s=o.length;u<s;++u){var a=o[u].feature;a&&-1===i.indexOf(a)&&this.Vc.push(a)}0===this.Vc.getLength()?this.Vc=null:this.dispatchEvent(new x_(b_,this.Vc,t))}},n.prototype.dl=function(t){this.yl(t),this.Ac&&0===this.$h.getLength()&&(this.dc.getSource().removeFeature(this.Ac),this.Ac=null),t.removeEventListener($,this.Lc)},n.prototype.yl=function(t){var n=this.Wc,i=[];n.forEach((function(n){t===n.feature&&i.push(n)}));for(var r=i.length-1;r>=0;--r){for(var e=i[r],o=this.Zc.length-1;o>=0;--o)this.Zc[o][0]===e&&this.Zc.splice(o,1);n.remove(e)}},n.prototype.setActive=function(n){this.Ac&&!n&&(this.dc.getSource().removeFeature(this.Ac),this.Ac=null),t.prototype.setActive.call(this,n)},n.prototype.setMap=function(n){this.dc.setMap(n),t.prototype.setMap.call(this,n)},n.prototype.getOverlay=function(){return this.dc},n.prototype.ul=function(t){t.feature&&this.$h.push(t.feature)},n.prototype.sl=function(t){t.feature&&this.$h.remove(t.feature)},n.prototype.fl=function(t){this.al(t.element)},n.prototype.Xh=function(t){if(!this.Yc){var n=t.target;this.dl(n),this.al(n)}},n.prototype.hl=function(t){var n=t.element;this.dl(n)},n.prototype.Kc=function(t,n){var i=n.getCoordinates(),r={feature:t,geometry:n,segment:[i,i]};this.Wc.insert(n.getExtent(),r)},n.prototype.Qc=function(t,n){for(var i=n.getCoordinates(),r=0,e=i.length;r<e;++r){var o=i[r],u={feature:t,geometry:n,depth:[r],index:r,segment:[o,o]};this.Wc.insert(n.getExtent(),u)}},n.prototype.Jc=function(t,n){for(var i=n.getCoordinates(),r=0,e=i.length-1;r<e;++r){var o=i.slice(r,r+2),u={feature:t,geometry:n,index:r,segment:o};this.Wc.insert(Zi(o),u)}},n.prototype.tl=function(t,n){for(var i=n.getCoordinates(),r=0,e=i.length;r<e;++r)for(var o=i[r],u=0,s=o.length-1;u<s;++u){var a=o.slice(u,u+2),f={feature:t,geometry:n,depth:[r],index:u,segment:a};this.Wc.insert(Zi(a),f)}},n.prototype.$c=function(t,n){for(var i=n.getCoordinates(),r=0,e=i.length;r<e;++r)for(var o=i[r],u=0,s=o.length-1;u<s;++u){var a=o.slice(u,u+2),f={feature:t,geometry:n,depth:[r],index:u,segment:a};this.Wc.insert(Zi(a),f)}},n.prototype.nl=function(t,n){for(var i=n.getCoordinates(),r=0,e=i.length;r<e;++r)for(var o=i[r],u=0,s=o.length;u<s;++u)for(var a=o[u],f=0,h=a.length-1;f<h;++f){var c=a.slice(f,f+2),l={feature:t,geometry:n,depth:[u,r],index:f,segment:c};this.Wc.insert(Zi(c),l)}},n.prototype.il=function(t,n){var i=n.getCenter(),r={feature:t,geometry:n,index:0,segment:[i,i]},e={feature:t,geometry:n,index:1,segment:[i,i]},o=[r,e];r.featureSegments=o,e.featureSegments=o,this.Wc.insert(or(i),r);var u=n,s=Me();if(s&&this.getMap()){var a=this.getMap().getView().getProjection();u=Ys(u=u.clone().transform(s,a)).transform(a,s)}this.Wc.insert(u.getExtent(),e)},n.prototype.rl=function(t,n){for(var i=n.getGeometriesArray(),r=0;r<i.length;++r){var e=i[r];(0,this.Hc[e.getType()])(t,e)}},n.prototype.ml=function(t,n,i){var r=this.Ac;r?r.getGeometry().setCoordinates(t):(r=new ef(new _s(t)),this.Ac=r,this.dc.getSource().addFeature(r));return r.set("features",n),r.set("geometries",i),r},n.prototype.handleEvent=function(n){return!n.originalEvent||(this.cl=n,n.map.getView().getInteracting()||n.type!=eu.POINTERMOVE||this.handlingDownUpSequence||this.Ln(n),this.Ac&&this.Dc(n)&&(i=!(n.type!=eu.SINGLECLICK||!this.Xc)||this.removePoint()),n.type==eu.SINGLECLICK&&(this.Xc=!1),t.prototype.handleEvent.call(this,n)&&!i);var i},n.prototype.handleDragEvent=function(t){this.Xc=!1,this.pl(t,this.Zc);for(var n=[t.coordinate[0]+this.na[0],t.coordinate[1]+this.na[1]],i=[],r=[],e=0,o=this.Zc.length;e<o;++e){var u=this.Zc[e],s=u[0],a=s.feature;-1===i.indexOf(a)&&i.push(a);var f=s.geometry;-1===r.indexOf(f)&&r.push(f);for(var h=s.depth,c=void 0,l=s.segment,v=u[1];n.length<f.getStride();)n.push(l[v][n.length]);switch(f.getType()){case Kr.POINT:c=n,l[0]=n,l[1]=n;break;case Kr.MULTI_POINT:(c=f.getCoordinates())[s.index]=n,l[0]=n,l[1]=n;break;case Kr.LINE_STRING:(c=f.getCoordinates())[s.index+v]=n,l[v]=n;break;case Kr.MULTI_LINE_STRING:case Kr.POLYGON:(c=f.getCoordinates())[h[0]][s.index+v]=n,l[v]=n;break;case Kr.MULTI_POLYGON:(c=f.getCoordinates())[h[1]][h[0]][s.index+v]=n,l[v]=n;break;case Kr.CIRCLE:if(l[0]=n,l[1]=n,0===s.index)this.Yc=!0,f.setCenter(n),this.Yc=!1;else{this.Yc=!0;var p=t.map.getView().getProjection(),d=Vr(Se(f.getCenter(),p),Se(n,p)),y=Me();if(y){var m=f.clone().transform(y,p);m.setRadius(d),d=m.transform(p,y).getRadius()}f.setRadius(d),this.Yc=!1}}c&&this.wl(f,c)}this.ml(n,i,r)},n.prototype.handleDownEvent=function(t){if(!this.ya(t))return!1;var n=t.coordinate;this.vl(t.pixel,t.map,n),this.Zc.length=0,this.Vc=null;var i=this.Ac;if(i){var r=t.map.getView().getProjection(),e=[],o=i.getGeometry().getCoordinates(),u=Zi([o]),s=this.Wc.getInExtent(u),a={};s.sort(__);for(var f=0,h=s.length;f<h;++f){var c=s[f],l=c.segment,v=d(c.geometry),p=c.depth;if(p&&(v+="-"+p.join("-")),a[v]||(a[v]=new Array(2)),c.geometry.getType()!==Kr.CIRCLE||1!==c.index)if(!Ur(l[0],o)||a[v][0])if(!Ur(l[1],o)||a[v][1])d(l)in this.qc&&!a[v][0]&&!a[v][1]&&this.Uc(t)&&e.push(c);else{if((c.geometry.getType()===Kr.LINE_STRING||c.geometry.getType()===Kr.MULTI_LINE_STRING)&&a[v][0]&&0===a[v][0].index)continue;this.Zc.push([c,1]),a[v][1]=c}else this.Zc.push([c,0]),a[v][0]=c;else Ur(O_(n,c,r),o)&&!a[v][0]&&(this.Zc.push([c,0]),a[v][0]=c)}e.length&&this.pl(t,[e]);for(var y=e.length-1;y>=0;--y)this.bl(e[y],o)}return!!this.Ac},n.prototype.handleUpEvent=function(t){for(var n=this.Zc.length-1;n>=0;--n){var i=this.Zc[n][0],r=i.geometry;if(r.getType()===Kr.CIRCLE){var e=r.getCenter(),o=i.featureSegments[0],u=i.featureSegments[1];o.segment[0]=e,o.segment[1]=e,u.segment[0]=e,u.segment[1]=e,this.Wc.update(or(e),o);var s=r,a=Me();if(a){var f=t.map.getView().getProjection();s=Ys(s=s.clone().transform(a,f)).transform(f,a)}this.Wc.update(s.getExtent(),u)}else this.Wc.update(Zi(i.segment),i)}return this.Vc&&(this.dispatchEvent(new x_(g_,this.Vc,t)),this.Vc=null),!1},n.prototype.Ln=function(t){this.Bc=t.pixel,this.vl(t.pixel,t.map,t.coordinate)},n.prototype.vl=function(t,n,i){var r,e,u=this,s=i||n.getCoordinateFromPixel(t),a=n.getView().getProjection();if(this.el){var f="object"===d_(this.el)?function(t){return t===u.el}:void 0;n.forEachFeatureAtPixel(t,(function(t,n,i){if((i=i||t.getGeometry()).getType()===Kr.POINT&&o(u.$h.getArray(),t)){e=i;var s=i.getFlatCoordinates().slice(0,2);r=[{feature:t,geometry:i,segment:[s,s]}]}return!0}),{layerFilter:f})}if(!r){var h=je(Hi(Ee(or(s,m_),a),n.getView().getResolution()*this.Ec,m_),a);r=this.Wc.getInExtent(h)}if(r&&r.length>0){var c=r.sort((function(t,n){return M_(s,t,a)-M_(s,n,a)}))[0],l=c.segment,v=O_(s,c,a),p=n.getPixelFromCoordinate(v),y=Vr(t,p);if(e||y<=this.Ec){var m={};if(m[d(l)]=!0,this.ll||(this.na[0]=v[0]-s[0],this.na[1]=v[1]-s[1]),c.geometry.getType()===Kr.CIRCLE&&1===c.index)this.kc=!0,this.ml(v,[c.feature],[c.geometry]);else{var w=n.getPixelFromCoordinate(l[0]),b=n.getPixelFromCoordinate(l[1]),g=Xr(p,w),x=Xr(p,b);y=Math.sqrt(Math.min(g,x)),this.kc=y<=this.Ec,this.kc&&(v=g>x?l[1]:l[0]),this.ml(v,[c.feature],[c.geometry]);var _={};_[d(c.geometry)]=!0;for(var M=1,O=r.length;M<O;++M){var S=r[M].segment;if(!(Ur(l[0],S[0])&&Ur(l[1],S[1])||Ur(l[0],S[1])&&Ur(l[1],S[0])))break;var j=d(r[M].geometry);j in _||(_[j]=!0,m[d(S)]=!0)}}return void(this.qc=m)}}this.Ac&&(this.dc.getSource().removeFeature(this.Ac),this.Ac=null)},n.prototype.bl=function(t,n){for(var i,r=t.segment,e=t.feature,o=t.geometry,u=t.depth,s=t.index;n.length<o.getStride();)n.push(0);switch(o.getType()){case Kr.MULTI_LINE_STRING:case Kr.POLYGON:(i=o.getCoordinates())[u[0]].splice(s+1,0,n);break;case Kr.MULTI_POLYGON:(i=o.getCoordinates())[u[1]][u[0]].splice(s+1,0,n);break;case Kr.LINE_STRING:(i=o.getCoordinates()).splice(s+1,0,n);break;default:return}this.wl(o,i);var a=this.Wc;a.remove(t),this.gl(o,s,u,1);var f={segment:[r[0],n],feature:e,geometry:o,depth:u,index:s};a.insert(Zi(f.segment),f),this.Zc.push([f,1]);var h={segment:[n,r[1]],feature:e,geometry:o,depth:u,index:s+1};a.insert(Zi(h.segment),h),this.Zc.push([h,0]),this.Xc=!0},n.prototype.removePoint=function(){if(this.cl&&this.cl.type!=eu.POINTERDRAG){var t=this.cl;this.pl(t,this.Zc);var n=this.xl();return this.Vc&&this.dispatchEvent(new x_(g_,this.Vc,t)),this.Vc=null,n}return!1},n.prototype.xl=function(){var t,n,i,r,e,o,u,s,a,f,h,c=this.Zc,l={},v=!1;for(e=c.length-1;e>=0;--e)h=d((f=(i=c[e])[0]).feature),f.depth&&(h+="-"+f.depth.join("-")),h in l||(l[h]={}),0===i[1]?(l[h].right=f,l[h].index=f.index):1==i[1]&&(l[h].left=f,l[h].index=f.index+1);for(h in l){switch(a=l[h].right,u=l[h].left,(s=(o=l[h].index)-1)<0&&(s=0),t=n=(r=(f=void 0!==u?u:a).geometry).getCoordinates(),v=!1,r.getType()){case Kr.MULTI_LINE_STRING:n[f.depth[0]].length>2&&(n[f.depth[0]].splice(o,1),v=!0);break;case Kr.LINE_STRING:n.length>2&&(n.splice(o,1),v=!0);break;case Kr.MULTI_POLYGON:t=t[f.depth[1]];case Kr.POLYGON:(t=t[f.depth[0]]).length>4&&(o==t.length-1&&(o=0),t.splice(o,1),v=!0,0===o&&(t.pop(),t.push(t[0]),s=t.length-1))}if(v){this.wl(r,n);var p=[];if(void 0!==u&&(this.Wc.remove(u),p.push(u.segment[0])),void 0!==a&&(this.Wc.remove(a),p.push(a.segment[1])),void 0!==u&&void 0!==a){var y={depth:f.depth,feature:f.feature,geometry:f.geometry,index:s,segment:p};this.Wc.insert(Zi(y.segment),y)}this.gl(r,o,f.depth,-1),this.Ac&&(this.dc.getSource().removeFeature(this.Ac),this.Ac=null),c.length=0}}return v},n.prototype.wl=function(t,n){this.Yc=!0,t.setCoordinates(n),this.Yc=!1},n.prototype.gl=function(t,n,i,r){this.Wc.forEachInExtent(t.getExtent(),(function(e){e.geometry===t&&(void 0===i||void 0===e.depth||h(e.depth,i))&&e.index>n&&(e.index+=r)}))},n}(tg),j_=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),E_="trackpad",k_="wheel",T_=function(t){function n(n){var i=this,r=n||{};(i=t.call(this,r)||this)._l=0,i.Ml=0,i.ii=void 0!==r.maxDelta?r.maxDelta:1,i.Dr=void 0!==r.duration?r.duration:250,i.Ol=void 0!==r.timeout?r.timeout:80,i.Sl=void 0===r.useAnchor||r.useAnchor,i.jl=void 0!==r.constrainResolution&&r.constrainResolution;var e=r.condition?r.condition:Wa;return i.ya=r.onFocusOnly?Ua(Va,e):e,i.El=null,i.kl=void 0,i.Tl,i.tc=void 0,i.Al=400,i.Cl,i.Pl=300,i}return j_(n,t),n.prototype.Rl=function(){this.Cl=void 0,this.getMap().getView().endInteraction(void 0,this.Ml?this.Ml>0?1:-1:0,this.El)},n.prototype.handleEvent=function(t){if(!this.ya(t))return!0;if(t.type!==ct)return!0;var n,i=t.map,r=t.originalEvent;if(r.preventDefault(),this.Sl&&(this.El=t.coordinate),t.type==ct&&(n=r.deltaY,Xt&&r.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(n/=Ht),r.deltaMode===WheelEvent.DOM_DELTA_LINE&&(n*=40)),0===n)return!1;this.Ml=n;var e=Date.now();void 0===this.kl&&(this.kl=e),(!this.tc||e-this.kl>this.Al)&&(this.tc=Math.abs(n)<4?E_:k_);var o=i.getView();if(this.tc===E_&&!o.getConstrainResolution()&&!this.jl)return this.Cl?clearTimeout(this.Cl):(o.getAnimating()&&o.cancelAnimations(),o.beginInteraction()),this.Cl=setTimeout(this.Rl.bind(this),this.Ol),o.adjustZoom(-n/this.Pl,this.El),this.kl=e,!1;this._l+=n;var u=Math.max(this.Ol-(e-this.kl),0);return clearTimeout(this.Tl),this.Tl=setTimeout(this.Il.bind(this,i),u),!1},n.prototype.Il=function(t){var n=t.getView();n.getAnimating()&&n.cancelAnimations();var i=-x(this._l,-this.ii*this.Pl,this.ii*this.Pl)/this.Pl;(n.getConstrainResolution()||this.jl)&&(i=i?i>0?1:-1:0),Xb(n,i,this.El,this.Dr),this.tc=void 0,this._l=0,this.El=null,this.kl=void 0,this.Tl=void 0},n.prototype.setMouseAnchor=function(t){this.Sl=t,t||(this.El=null)},n}(Vb),A_=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),C_=function(t){function n(n){var i=this,r=n||{},e=r;return e.stopDown||(e.stopDown=q),(i=t.call(this,e)||this).Ro=null,i._a=void 0,i.Nl=!1,i.zl=0,i.Fl=void 0!==r.threshold?r.threshold:.3,i.Dr=void 0!==r.duration?r.duration:250,i}return A_(n,t),n.prototype.handleDragEvent=function(t){var n=0,i=this.targetPointers[0],r=this.targetPointers[1],e=Math.atan2(r.clientY-i.clientY,r.clientX-i.clientX);if(void 0!==this._a){var o=e-this._a;this.zl+=o,!this.Nl&&Math.abs(this.zl)>this.Fl&&(this.Nl=!0),n=o}this._a=e;var u=t.map,s=u.getView();if(s.getConstraints().rotation!==ju){var a=u.getViewport().getBoundingClientRect(),f=Qb(this.targetPointers);f[0]-=a.left,f[1]-=a.top,this.Ro=u.getCoordinateFromPixelInternal(f),this.Nl&&(u.render(),s.adjustRotationInternal(n,this.Ro))}},n.prototype.handleUpEvent=function(t){return!(this.targetPointers.length<2)||(t.map.getView().endInteraction(this.Dr),!1)},n.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var n=t.map;return this.Ro=null,this._a=void 0,this.Nl=!1,this.zl=0,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}return!1},n}(tg),P_=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),R_=function(t){function n(n){var i=this,r=n||{},e=r;return e.stopDown||(e.stopDown=q),(i=t.call(this,e)||this).Ro=null,i.Dr=void 0!==r.duration?r.duration:400,i.Ll=void 0,i.Oa=1,i}return P_(n,t),n.prototype.handleDragEvent=function(t){var n=1,i=this.targetPointers[0],r=this.targetPointers[1],e=i.clientX-r.clientX,o=i.clientY-r.clientY,u=Math.sqrt(e*e+o*o);void 0!==this.Ll&&(n=this.Ll/u),this.Ll=u;var s=t.map,a=s.getView();1!=n&&(this.Oa=n);var f=s.getViewport().getBoundingClientRect(),h=Qb(this.targetPointers);h[0]-=f.left,h[1]-=f.top,this.Ro=s.getCoordinateFromPixelInternal(h),s.render(),a.adjustResolutionInternal(n,this.Ro)},n.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var n=t.map.getView(),i=this.Oa>1?1:-1;return n.endInteraction(this.Dr,i),!1}return!0},n.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var n=t.map;return this.Ro=null,this.Ll=void 0,this.Oa=1,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}return!1},n}(tg),I_=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),N_="select",z_=function(t){function n(n,i,r,e){var o=t.call(this,n)||this;return o.selected=i,o.deselected=r,o.mapBrowserEvent=e,o}return I_(n,t),n}(L),F_={};var L_=function(t){function n(n){var i=t.call(this)||this;i.on,i.once,i.un;var r,e,u=n||{};if(i.Gl=i.al.bind(i),i.Dl=i.dl.bind(i),i.ya=u.condition?u.condition:Ha,i.Ul=u.addCondition?u.addCondition:Za,i.ql=u.removeCondition?u.removeCondition:Za,i.Bl=u.toggleCondition?u.toggleCondition:Ja,i.Xl=!!u.multi&&u.multi,i.Vl=u.filter?u.filter:U,i.Wl=u.hitTolerance?u.hitTolerance:0,i.je=void 0!==u.style?u.style:(a((r=Iv())[Kr.POLYGON],r[Kr.LINE_STRING]),a(r[Kr.GEOMETRY_COLLECTION],r[Kr.LINE_STRING]),function(t){return t.getGeometry()?r[t.getGeometry().getType()]:null}),i.$h=u.features||new Et,u.layers)if("function"==typeof u.layers)e=u.layers;else{var s=u.layers;e=function(t){return o(s,t)}}else e=U;return i.Yl=e,i.Zl={},i}return I_(n,t),n.prototype.Hl=function(t,n){this.Zl[d(t)]=n},n.prototype.getFeatures=function(){return this.$h},n.prototype.getHitTolerance=function(){return this.Wl},n.prototype.getLayer=function(t){return this.Zl[d(t)]},n.prototype.setHitTolerance=function(t){this.Wl=t},n.prototype.setMap=function(n){this.getMap()&&this.je&&this.$h.forEach(this.Kl.bind(this)),t.prototype.setMap.call(this,n),n?(this.$h.addEventListener(_t,this.Gl),this.$h.addEventListener(Mt,this.Dl),this.je&&this.$h.forEach(this.Jl.bind(this))):(this.$h.removeEventListener(_t,this.Gl),this.$h.removeEventListener(Mt,this.Dl))},n.prototype.al=function(t){var n=t.element;if(this.je&&this.Jl(n),!this.getLayer(n)){var i=this.getMap().getAllLayers().find((function(t){if(t instanceof kx&&t.getSource()&&t.getSource().hasFeature(n))return t}));i&&this.Hl(n,i)}},n.prototype.dl=function(t){var n=t.element;this.je&&this.Kl(n)},n.prototype.getStyle=function(){return this.je},n.prototype.Jl=function(t){var n=d(t);n in F_||(F_[n]=t.getStyle()),t.setStyle(this.je)},n.prototype.Kl=function(t){for(var i=this.getMap().getInteractions().getArray(),r=i.length-1;r>=0;--r){var e=i[r];if(e!==this&&e instanceof n&&e.getStyle()&&-1!==e.getFeatures().getArray().lastIndexOf(t))return void t.setStyle(e.getStyle())}var o=d(t);t.setStyle(F_[o]),delete F_[o]},n.prototype.$l=function(t){delete this.Zl[d(t)]},n.prototype.handleEvent=function(t){if(!this.ya(t))return!0;var n=this.Ul(t),i=this.ql(t),r=this.Bl(t),e=!n&&!i&&!r,u=t.map,s=this.getFeatures(),a=[],f=[];if(e){Y(this.Zl),u.forEachFeatureAtPixel(t.pixel,function(t,n){if(this.Vl(t,n))return this.Hl(t,n),f.push(t),!this.Xl}.bind(this),{layerFilter:this.Yl,hitTolerance:this.Wl});for(var h=s.getLength()-1;h>=0;--h){var c=s.item(h),l=f.indexOf(c);l>-1?f.splice(l,1):(s.remove(c),a.push(c))}0!==f.length&&s.extend(f)}else{u.forEachFeatureAtPixel(t.pixel,function(t,e){if(this.Vl(t,e))return!n&&!r||o(s.getArray(),t)?(i||r)&&o(s.getArray(),t)&&(a.push(t),this.$l(t)):(this.Hl(t,e),f.push(t)),!this.Xl}.bind(this),{layerFilter:this.Yl,hitTolerance:this.Wl});for(var v=a.length-1;v>=0;--v)s.remove(a[v]);s.extend(f)}return(f.length>0||a.length>0)&&this.dispatchEvent(new z_(N_,f,a,t)),!0},n}(Vb),G_=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();function D_(t){return t.feature?t.feature:t.element?t.element:void 0}var U_=[],q_=function(t){function n(n){var i=this,r=n||{},e=r;return e.handleDownEvent||(e.handleDownEvent=U),e.stopDown||(e.stopDown=q),(i=t.call(this,e)||this).gt=r.source?r.source:null,i.Ql=void 0===r.vertex||r.vertex,i.tv=void 0===r.edge||r.edge,i.$h=r.features?r.features:null,i.nv=[],i.iv={},i.rv={},i.ev={},i.Ec=void 0!==r.pixelTolerance?r.pixelTolerance:10,i.Wc=new Tx,i.ov={Point:i.uv.bind(i),LineString:i.sv.bind(i),LinearRing:i.sv.bind(i),Polygon:i.av.bind(i),MultiPoint:i.fv.bind(i),MultiLineString:i.hv.bind(i),MultiPolygon:i.cv.bind(i),GeometryCollection:i.lv.bind(i),Circle:i.vv.bind(i)},i}return G_(n,t),n.prototype.addFeature=function(t,n){var i=void 0===n||n,r=d(t),e=t.getGeometry();if(e){var o=this.ov[e.getType()];if(o){this.rv[r]=e.getExtent([1/0,1/0,-1/0,-1/0]);var u=[];if(o(u,e),1===u.length)this.Wc.insert(Zi(u[0]),{feature:t,segment:u[0]});else if(u.length>1){var s=u.map((function(t){return Zi(t)})),a=u.map((function(n){return{feature:t,segment:n}}));this.Wc.load(s,a)}}}i&&(this.iv[r]=lt(t,$,this.Xh,this))},n.prototype.pv=function(t){this.addFeature(t)},n.prototype.dv=function(t){this.removeFeature(t)},n.prototype.yv=function(){var t;return this.$h?t=this.$h:this.gt&&(t=this.gt.getFeatures()),t},n.prototype.handleEvent=function(n){var i=this.snapTo(n.pixel,n.coordinate,n.map);return i&&(n.coordinate=i.vertex.slice(0,2),n.pixel=i.vertexPixel),t.prototype.handleEvent.call(this,n)},n.prototype.fl=function(t){var n=D_(t);this.addFeature(n)},n.prototype.hl=function(t){var n=D_(t);this.removeFeature(n)},n.prototype.Xh=function(t){var n=t.target;if(this.handlingDownUpSequence){var i=d(n);i in this.ev||(this.ev[i]=n)}else this.mv(n)},n.prototype.handleUpEvent=function(t){var n=Z(this.ev);return n.length&&(n.forEach(this.mv.bind(this)),this.ev={}),!1},n.prototype.removeFeature=function(t,n){var i=void 0===n||n,r=d(t),e=this.rv[r];if(e){var o=this.Wc,u=[];o.forEachInExtent(e,(function(n){t===n.feature&&u.push(n)}));for(var s=u.length-1;s>=0;--s)o.remove(u[s])}i&&(pt(this.iv[r]),delete this.iv[r])},n.prototype.setMap=function(n){var i=this.getMap(),r=this.nv,e=this.yv();i&&(r.forEach(pt),r.length=0,e.forEach(this.dv.bind(this))),t.prototype.setMap.call(this,n),n&&(this.$h?r.push(lt(this.$h,_t,this.fl,this),lt(this.$h,Mt,this.hl,this)):this.gt&&r.push(lt(this.gt,Rx,this.fl,this),lt(this.gt,zx,this.hl,this)),e.forEach(this.pv.bind(this)))},n.prototype.snapTo=function(t,n,i){var r=Zi([i.getCoordinateFromPixel([t[0]-this.Ec,t[1]+this.Ec]),i.getCoordinateFromPixel([t[0]+this.Ec,t[1]-this.Ec])]),e=this.Wc.getInExtent(r),o=e.length;if(0===o)return null;var u,s=i.getView().getProjection(),a=Se(n,s),f=1/0,h=this.Ec*this.Ec,c=function(){if(u){var n=i.getPixelFromCoordinate(u);if(Xr(t,n)<=h)return{vertex:u,vertexPixel:[Math.round(n[0]),Math.round(n[1])]}}return null};if(this.Ql){for(var l=0;l<o;++l){(v=e[l]).feature.getGeometry().getType()!==Kr.CIRCLE&&v.segment.forEach((function(t){var n=Se(t,s),i=Xr(a,n);i<f&&(u=t,f=i)}))}if(x=c())return x}if(this.tv){for(l=0;l<o;++l){var v,p=null;if((v=e[l]).feature.getGeometry().getType()===Kr.CIRCLE){var d=v.feature.getGeometry(),y=Me();y&&(d=d.clone().transform(y,s)),p=Oe(Fr(a,d),s)}else{var m=v.segment,w=m[0],b=m[1];b&&(U_[0]=Se(w,s),U_[1]=Se(b,s),p=Lr(a,U_))}if(p){var g=Xr(a,p);g<f&&(u=p,f=g)}}var x;if(x=c())return x}return null},n.prototype.mv=function(t){this.removeFeature(t,!1),this.addFeature(t,!1)},n.prototype.vv=function(t,n){var i=this.getMap().getView().getProjection(),r=n,e=Me();e&&(r=r.clone().transform(e,i));var o=Ys(r);e&&o.transform(i,e);for(var u=o.getCoordinates()[0],s=0,a=u.length-1;s<a;++s)t.push(u.slice(s,s+2))},n.prototype.lv=function(t,n){for(var i=n.getGeometriesArray(),r=0;r<i.length;++r){var e=this.ov[i[r].getType()];e&&e(t,i[r])}},n.prototype.sv=function(t,n){for(var i=n.getCoordinates(),r=0,e=i.length-1;r<e;++r)t.push(i.slice(r,r+2))},n.prototype.hv=function(t,n){for(var i=n.getCoordinates(),r=0,e=i.length;r<e;++r)for(var o=i[r],u=0,s=o.length-1;u<s;++u)t.push(o.slice(u,u+2))},n.prototype.fv=function(t,n){n.getCoordinates().forEach((function(n){t.push([n])}))},n.prototype.cv=function(t,n){for(var i=n.getCoordinates(),r=0,e=i.length;r<e;++r)for(var o=i[r],u=0,s=o.length;u<s;++u)for(var a=o[u],f=0,h=a.length-1;f<h;++f)t.push(a.slice(f,f+2))},n.prototype.uv=function(t,n){t.push([n.getCoordinates()])},n.prototype.av=function(t,n){for(var i=n.getCoordinates(),r=0,e=i.length;r<e;++r)for(var o=i[r],u=0,s=o.length-1;u<s;++u)t.push(o.slice(u,u+2))},n}(tg),B_=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),X_="translatestart",V_="translating",W_="translateend",Y_=function(t){function n(n,i,r,e,o){var u=t.call(this,n)||this;return u.features=i,u.coordinate=r,u.startCoordinate=e,u.mapBrowserEvent=o,u}return B_(n,t),n}(L),Z_=function(t){function n(n){var i,r=this,e=n||{};if((r=t.call(this,e)||this).on,r.once,r.un,r.wv=null,r.bv=null,r.$h=void 0!==e.features?e.features:null,e.layers&&!r.$h)if("function"==typeof e.layers)i=e.layers;else{var u=e.layers;i=function(t){return o(u,t)}}else i=U;return r.Yl=i,r.Vl=e.filter&&!r.$h?e.filter:U,r.Wl=e.hitTolerance?e.hitTolerance:0,r.ya=e.condition?e.condition:Wa,r.gv=null,r.addChangeListener(Ub,r.xv),r}return B_(n,t),n.prototype.handleDownEvent=function(t){if(!t.originalEvent||!this.ya(t))return!1;if(this.gv=this._v(t.pixel,t.map),!this.wv&&this.gv){this.bv=t.coordinate,this.wv=t.coordinate,this.handleMoveEvent(t);var n=this.$h||new Et([this.gv]);return this.dispatchEvent(new Y_(X_,n,t.coordinate,this.bv,t)),!0}return!1},n.prototype.handleUpEvent=function(t){if(this.wv){this.wv=null,this.handleMoveEvent(t);var n=this.$h||new Et([this.gv]);return this.dispatchEvent(new Y_(W_,n,t.coordinate,this.bv,t)),this.bv=null,!0}return!1},n.prototype.handleDragEvent=function(t){if(this.wv){var n=t.coordinate,i=n[0]-this.wv[0],r=n[1]-this.wv[1],e=this.$h||new Et([this.gv]);e.forEach((function(t){var n=t.getGeometry();n.translate(i,r),t.setGeometry(n)})),this.wv=n,this.dispatchEvent(new Y_(V_,e,n,this.bv,t))}},n.prototype.handleMoveEvent=function(t){var n=t.map.getViewport();this._v(t.pixel,t.map)?(n.classList.remove(this.wv?"ol-grab":"ol-grabbing"),n.classList.add(this.wv?"ol-grabbing":"ol-grab")):n.classList.remove("ol-grab","ol-grabbing")},n.prototype._v=function(t,n){return n.forEachFeatureAtPixel(t,function(t,n){if(this.Vl(t,n)&&(!this.$h||o(this.$h.getArray(),t)))return t}.bind(this),{layerFilter:this.Yl,hitTolerance:this.Wl})},n.prototype.getHitTolerance=function(){return this.Wl},n.prototype.setHitTolerance=function(t){this.Wl=t},n.prototype.setMap=function(n){var i=this.getMap();t.prototype.setMap.call(this,n),this.mc(i)},n.prototype.xv=function(){this.mc(null)},n.prototype.mc=function(t){var n=this.getMap(),i=this.getActive();n&&i||(n=n||t)&&n.getViewport().classList.remove("ol-grab","ol-grabbing")},n}(tg),H_=function(){function t(t,n,i){this.Mv=t,this.Ov=n,this.Sv=i,this.$o=[],this.nu=0,this.jv=0}return t.prototype.begin=function(){this.$o.length=0,this.nu=0,this.jv=0},t.prototype.update=function(t,n){this.$o.push(t,n,Date.now())},t.prototype.end=function(){if(this.$o.length<6)return!1;var t=Date.now()-this.Sv,n=this.$o.length-3;if(this.$o[n+2]<t)return!1;for(var i=n-3;i>0&&this.$o[i+2]>t;)i-=3;var r=this.$o[n+2]-this.$o[i+2];if(r<1e3/60)return!1;var e=this.$o[n]-this.$o[i],o=this.$o[n+1]-this.$o[i+1];return this.nu=Math.atan2(o,e),this.jv=Math.sqrt(e*e+o*o)/r,this.jv>this.Ov},t.prototype.getDistance=function(){return(this.Ov-this.jv)/this.Mv},t.prototype.getAngle=function(){return this.nu},t}();function K_(t){var n=t||{},i=new Et,r=new H_(-.005,.05,100);return(void 0===n.altShiftDragRotate||n.altShiftDragRotate)&&i.push(new vg),(void 0===n.doubleClickZoom||n.doubleClickZoom)&&i.push(new Yb({delta:n.zoomDelta,duration:n.zoomDuration})),(void 0===n.dragPan||n.dragPan)&&i.push(new cg({onFocusOnly:n.onFocusOnly,kinetic:r})),(void 0===n.pinchRotate||n.pinchRotate)&&i.push(new C_),(void 0===n.pinchZoom||n.pinchZoom)&&i.push(new R_({duration:n.zoomDuration})),(void 0===n.keyboard||n.keyboard)&&(i.push(new l_),i.push(new p_({delta:n.zoomDelta,duration:n.zoomDuration}))),(void 0===n.mouseWheelZoom||n.mouseWheelZoom)&&i.push(new T_({onFocusOnly:n.onFocusOnly,duration:n.zoomDuration})),(void 0===n.shiftDragZoom||n.shiftDragZoom)&&i.push(new mg({duration:n.zoomDuration})),i}var J_=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),$_=function(t){function n(n){var i=n||{};return t.call(this,i)||this}return J_(n,t),n}(Bn),Q_="preload",tM="useInterimTilesOnError",nM=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),iM=function(t){function n(n){var i=this,r=n||{},e=W({},r);return delete e.preload,delete e.useInterimTilesOnError,(i=t.call(this,e)||this).on,i.once,i.un,i.setPreload(void 0!==r.preload?r.preload:0),i.setUseInterimTilesOnError(void 0===r.useInterimTilesOnError||r.useInterimTilesOnError),i}return nM(n,t),n.prototype.getPreload=function(){return this.get(Q_)},n.prototype.setPreload=function(t){this.set(Q_,t)},n.prototype.getUseInterimTilesOnError=function(){return this.get(tM)},n.prototype.setUseInterimTilesOnError=function(t){this.set(tM,t)},n.prototype.getData=function(n){return t.prototype.getData.call(this,n)},n}(Bn);function rM(t){if(!(t.context instanceof CanvasRenderingContext2D))throw new Error("Only works for render events from Canvas 2D layers");var n,i=t.inversePixelTransform[0],r=t.frameState,e=De(t.inversePixelTransform.slice(),r.coordinateToPixelTransform),o=xx(r.viewState.resolution,i),u=Me();return u&&(n=me(u,r.viewState.projection)),new dx(t.context,i,r.extent,e,r.viewState.rotation,o,n)}var eM,oM=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),uM=new Ov({color:"rgba(0,0,0,0.2)"}),sM=[90,45,30,20,10,5,2,1,.5,.2,.1,.05,.01,.005,.002,.001],aM=function(t){function n(n){var i=this,r=n||{},e=W({updateWhileAnimating:!0,updateWhileInteracting:!0,renderBuffer:0},r);return delete e.maxLines,delete e.strokeStyle,delete e.targetSize,delete e.showLabels,delete e.lonLabelFormatter,delete e.latLabelFormatter,delete e.lonLabelPosition,delete e.latLabelPosition,delete e.lonLabelStyle,delete e.latLabelStyle,delete e.intervals,(i=t.call(this,e)||this).li=null,i.Ev=1/0,i.kv=1/0,i.Tv=-1/0,i.Av=-1/0,i.Cv=1/0,i.Pv=1/0,i.Rv=-1/0,i.Iv=-1/0,i.Nv=void 0!==r.targetSize?r.targetSize:100,i.zv=void 0!==r.maxLines?r.maxLines:100,i.Fv=[],i.Lv=[],i.Gv=void 0!==r.strokeStyle?r.strokeStyle:uM,i.Dv=void 0,i.Uv=void 0,i.qv=null,i.Bv=null,i.Xv=null,i.Vv=null,i.Wv=null,i.Yv=null,i.Zv=null,r.showLabels&&(i.Hv=null==r.lonLabelFormatter?Gr.bind(i,"EW"):r.lonLabelFormatter,i.Kv=null==r.latLabelFormatter?Gr.bind(i,"NS"):r.latLabelFormatter,i.Jv=null==r.lonLabelPosition?0:r.lonLabelPosition,i.$v=null==r.latLabelPosition?1:r.latLabelPosition,i.Qv=new zv({text:void 0!==r.lonLabelStyle?r.lonLabelStyle.clone():new Gv({font:"12px Calibri,sans-serif",textBaseline:"bottom",fill:new Ql({color:"rgba(0,0,0,1)"}),stroke:new Ov({color:"rgba(255,255,255,1)",width:3})})}),i.tp=function(t){var n=t.get("graticule_label");return this.Qv.getText().setText(n),this.Qv}.bind(i),i.np=new zv({text:void 0!==r.latLabelStyle?r.latLabelStyle.clone():new Gv({font:"12px Calibri,sans-serif",textAlign:"right",fill:new Ql({color:"rgba(0,0,0,1)"}),stroke:new Ov({color:"rgba(255,255,255,1)",width:3})})}),i.ip=function(t){var n=t.get("graticule_label");return this.np.getText().setText(n),this.np}.bind(i),i.Yv=[],i.Zv=[],i.addEventListener(Rn,i.rp.bind(i))),i.ep=void 0!==r.intervals?r.intervals:sM,i.setSource(new Bx({loader:i.loaderFunction.bind(i),strategy:i.strategyFunction.bind(i),features:new Et,overlaps:!1,useSpatialIndex:!1,wrapX:r.wrapX})),i.op=[],i.up=new zv({stroke:i.Gv}),i.sp=null,i.dh=null,i.ph=null,i.setRenderOrder(null),i}return oM(n,t),n.prototype.strategyFunction=function(t,n){var i=t.slice();return this.li&&this.getSource().getWrapX()&&Rr(i,this.li),this.sp&&(ar(this.sp,i,n)?i=this.sp.slice():this.getSource().removeLoadedExtent(this.sp)),[i]},n.prototype.loaderFunction=function(t,n,i){this.sp=t;var r=this.getSource(),e=Mr(this.getExtent()||[-1/0,-1/0,1/0,1/0],t);if(!(this.dh&&sr(this.dh,e)&&this.ph===n||(this.dh=e,this.ph=n,kr(e)))){var o=br(e),u=n*n/4;(!this.li||!ye(this.li,i))&&this.ap(i),this.fp(e,o,n,u);var s,a=this.Fv.length+this.Lv.length;for(this.Yv&&(a+=this.Fv.length),this.Zv&&(a+=this.Lv.length);a>this.op.length;)s=new ef,this.op.push(s);var f=r.getFeaturesCollection();f.clear();var h,c,l=0;for(h=0,c=this.Fv.length;h<c;++h)(s=this.op[l++]).setGeometry(this.Fv[h]),s.setStyle(this.up),f.push(s);for(h=0,c=this.Lv.length;h<c;++h)(s=this.op[l++]).setGeometry(this.Lv[h]),s.setStyle(this.up),f.push(s)}},n.prototype.hp=function(t,n,i,r,e,o){var u=this.cp(t,n,i,r,o);if(Er(u.getExtent(),e)){if(this.Yv){var s=this.Hv(t);o in this.Yv?this.Yv[o].text=s:this.Yv[o]={geom:new _s([]),text:s}}this.Fv[o++]=u}return o},n.prototype.lp=function(t,n,i,r,e,o){var u=this.vp(t,n,i,r,o);if(Er(u.getExtent(),e)){if(this.Zv){var s=this.Kv(t);o in this.Zv?this.Zv[o].text=s:this.Zv[o]={geom:new _s([]),text:s}}this.Lv[o++]=u}return o},n.prototype.rp=function(t){var n=t.frameState.viewState.rotation,i=t.frameState.viewState.resolution,r=t.frameState.size,e=t.frameState.extent,o=br(e),u=e;if(n){var s=r[0]*i,a=r[1]*i;u=[o[0]-s/2,o[1]-a/2,o[0]+s/2,o[1]+a/2]}var f=0,h=0,c=this.$v<.5,l=this.li.getExtent(),v=jr(l);this.getSource().getWrapX()&&this.li.canWrapX()&&!Qi(l,e)&&(f=Math.floor((e[0]-l[0])/v),h=Math.ceil((e[2]-l[2])/v),c=c!==Math.abs(n)>Math.PI/2);for(var p=rM(t),d=f;d<=h;++d){var y=this.Fv.length+this.Lv.length,m=void 0,w=void 0,b=void 0,g=void 0;if(this.Yv)for(w=0,b=this.Yv.length;w<b;++w){var x=this.Fv[w];if(n||0!==d)(_=x.clone()).translate(d*v,0),_.rotate(-n,o),(g=this.pp(_,u,w)).rotate(n,o);else g=this.pp(x,e,w);(m=this.op[y++]).setGeometry(g),m.set("graticule_label",this.Yv[w].text),p.drawFeature(m,this.tp(m))}if(this.Zv&&(d===f&&c||d===h&&!c))for(w=0,b=this.Lv.length;w<b;++w){var _;x=this.Lv[w];if(n||0!==d)(_=x.clone()).translate(d*v,0),_.rotate(-n,o),(g=this.dp(_,u,w)).rotate(n,o);else g=this.dp(x,e,w);(m=this.op[y++]).setGeometry(g),m.set("graticule_label",this.Zv[w].text),p.drawFeature(m,this.ip(m))}}},n.prototype.fp=function(t,n,i,r){var e=this.yp(i);if(-1==e)return this.Fv.length=0,this.Lv.length=0,this.Yv&&(this.Yv.length=0),void(this.Zv&&(this.Zv.length=0));var o=!1,u=this.li.getExtent(),s=jr(u);this.getSource().getWrapX()&&this.li.canWrapX()&&!Qi(u,t)&&(jr(t)>=s?(t[0]=u[0],t[2]=u[2]):o=!0);var a=[x(n[0],this.Rv,this.Cv),x(n[1],this.Iv,this.Pv)],f=this.Uv(a);isNaN(f[1])&&(f[1]=Math.abs(this.Ev)>=Math.abs(this.Tv)?this.Ev:this.Tv);var h,c,l,v,p=x(f[0],this.Av,this.kv),d=x(f[1],this.Tv,this.Ev),y=this.zv,m=t;o||(m=[x(t[0],this.Rv,this.Cv),x(t[1],this.Iv,this.Pv),x(t[2],this.Rv,this.Cv),x(t[3],this.Iv,this.Pv)]);var w=Pr(m,this.Uv,void 0,8),b=w[3],g=w[2],_=w[1],M=w[0];if(o||($i(m,this.Bv)&&(M=this.Av,_=this.Tv),$i(m,this.Xv)&&(g=this.kv,_=this.Tv),$i(m,this.Vv)&&(M=this.Av,b=this.Ev),$i(m,this.Wv)&&(g=this.kv,b=this.Ev),b=x(b,d,this.Ev),g=x(g,p,this.kv),_=x(_,this.Tv,d),M=x(M,this.Av,p)),v=x(p=Math.floor(p/e)*e,this.Av,this.kv),c=this.hp(v,_,b,r,t,0),h=0,o)for(;(v-=e)>=M&&h++<y;)c=this.hp(v,_,b,r,t,c);else for(;v!=this.Av&&h++<y;)v=Math.max(v-e,this.Av),c=this.hp(v,_,b,r,t,c);if(v=x(p,this.Av,this.kv),h=0,o)for(;(v+=e)<=g&&h++<y;)c=this.hp(v,_,b,r,t,c);else for(;v!=this.kv&&h++<y;)v=Math.min(v+e,this.kv),c=this.hp(v,_,b,r,t,c);for(this.Fv.length=c,this.Yv&&(this.Yv.length=c),l=x(d=Math.floor(d/e)*e,this.Tv,this.Ev),c=this.lp(l,M,g,r,t,0),h=0;l!=this.Tv&&h++<y;)l=Math.max(l-e,this.Tv),c=this.lp(l,M,g,r,t,c);for(l=x(d,this.Tv,this.Ev),h=0;l!=this.Ev&&h++<y;)l=Math.min(l+e,this.Ev),c=this.lp(l,M,g,r,t,c);this.Lv.length=c,this.Zv&&(this.Zv.length=c)},n.prototype.yp=function(t){for(var n=this.qv[0],i=this.qv[1],r=-1,e=Math.pow(this.Nv*t,2),o=[],u=[],s=0,a=this.ep.length;s<a;++s){var f=x(this.ep[s]/2,0,90),h=x(i,-90+f,90-f);if(o[0]=n-f,o[1]=h-f,u[0]=n+f,u[1]=h+f,this.Dv(o,o),this.Dv(u,u),Math.pow(u[0]-o[0],2)+Math.pow(u[1]-o[1],2)<=e)break;r=this.ep[s]}return r},n.prototype.cp=function(t,n,i,r,e){var o=Rb(t,n,i,this.li,r),u=this.Fv[e];return u?(u.setFlatCoordinates(Iu,o),u.changed()):(u=new Mf(o,Iu),this.Fv[e]=u),u},n.prototype.pp=function(t,n,i){var r=t.getFlatCoordinates(),e=1,o=r.length-1;r[e]>r[o]&&(e=o,o=1);var u=Math.max(n[1],r[e]),s=Math.min(n[3],r[o]),a=x(n[1]+Math.abs(n[1]-n[3])*this.Jv,u,s),f=[r[e-1]+(r[o-1]-r[e-1])*(a-r[e])/(r[o]-r[e]),a],h=this.Yv[i].geom;return h.setCoordinates(f),h},n.prototype.getMeridians=function(){return this.Fv},n.prototype.vp=function(t,n,i,r,e){var o=Ib(t,n,i,this.li,r),u=this.Lv[e];return u?(u.setFlatCoordinates(Iu,o),u.changed()):u=new Mf(o,Iu),u},n.prototype.dp=function(t,n,i){var r=t.getFlatCoordinates(),e=0,o=r.length-2;r[e]>r[o]&&(e=o,o=0);var u=Math.max(n[0],r[e]),s=Math.min(n[2],r[o]),a=x(n[0]+Math.abs(n[0]-n[2])*this.$v,u,s),f=[a,r[e+1]+(r[o+1]-r[e+1])*(a-r[e])/(r[o]-r[e])],h=this.Zv[i].geom;return h.setCoordinates(f),h},n.prototype.getParallels=function(){return this.Lv},n.prototype.ap=function(t){var n=ae("EPSG:4326"),i=t.getWorldExtent();this.Ev=i[3],this.kv=i[2],this.Tv=i[1],this.Av=i[0];var r=we(t,n);if(this.Av<this.kv)this.Uv=r;else{var e=this.Av+this.kv/2;this.kv+=360,this.Uv=function(t,n,i){for(var o=i||2,u=r(t,n,o),s=0,a=u.length;s<a;s+=o)u[s]<e&&(u[s]+=360);return u}}this.Dv=we(n,t);var o=Pr([this.Av,this.Tv,this.kv,this.Ev],this.Dv,void 0,8);this.Rv=o[0],this.Cv=o[2],this.Iv=o[1],this.Pv=o[3],this.Bv=this.Dv([this.Av,this.Tv]),this.Xv=this.Dv([this.kv,this.Tv]),this.Vv=this.Dv([this.Av,this.Ev]),this.Wv=this.Dv([this.kv,this.Ev]),this.qv=this.Uv(br(t.getExtent())),isNaN(this.qv[1])&&(this.qv[1]=Math.abs(this.Ev)>=Math.abs(this.Tv)?this.Ev:this.Tv),this.li=t},n}(kx),fM=34962,hM=34963,cM=35044,lM=35048,vM=5126,pM=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function dM(t,n){for(var i=W({preserveDrawingBuffer:!0,antialias:!Wt},n),r=pM.length,e=0;e<r;++e)try{var o=t.getContext(pM[e],i);if(o)return o}catch(t){}return null}var yM=cM;function mM(t){switch(t){case fM:return Float32Array;case hM:return Uint32Array;default:return Float32Array}}var wM=function(){function t(t,n){this.array=null,this.type=t,g(t===fM||t===hM,62),this.usage=void 0!==n?n:yM}return t.prototype.ofSize=function(t){this.array=new(mM(this.type))(t)},t.prototype.fromArray=function(t){var n=mM(this.type);this.array=n.from?n.from(t):new n(t)},t.prototype.fromArrayBuffer=function(t){this.array=new(mM(this.type))(t)},t.prototype.getType=function(){return this.type},t.prototype.getArray=function(){return this.array},t.prototype.getUsage=function(){return this.usage},t.prototype.getSize=function(){return this.array?this.array.length:0},t}(),bM="webglcontextlost",gM="webglcontextrestored",xM=function(){function t(t){this.mp=t.webGlContext;var n=this.mp;this.wp=t.scaleRatio||1,this.bp=n.createTexture(),this.gp=null,this.xp=n.createFramebuffer();var i=n.createShader(n.VERTEX_SHADER);n.shaderSource(i,t.vertexShader||"\n  precision mediump float;\n  \n  attribute vec2 a_position;\n  varying vec2 v_texCoord;\n  varying vec2 v_screenCoord;\n  \n  uniform vec2 u_screenSize;\n   \n  void main() {\n    v_texCoord = a_position * 0.5 + 0.5;\n    v_screenCoord = v_texCoord * u_screenSize;\n    gl_Position = vec4(a_position, 0.0, 1.0);\n  }\n"),n.compileShader(i);var r=n.createShader(n.FRAGMENT_SHADER);n.shaderSource(r,t.fragmentShader||"\n  precision mediump float;\n   \n  uniform sampler2D u_image;\n  uniform float u_opacity;\n   \n  varying vec2 v_texCoord;\n   \n  void main() {\n    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;\n  }\n"),n.compileShader(r),this._p=n.createProgram(),n.attachShader(this._p,i),n.attachShader(this._p,r),n.linkProgram(this._p),this.Mp=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,this.Mp),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,-1,1,1,-1,1]),n.STATIC_DRAW),this.Op=n.getAttribLocation(this._p,"a_position"),this.Sp=n.getUniformLocation(this._p,"u_screenSize"),this.jp=n.getUniformLocation(this._p,"u_opacity"),this.Ep=n.getUniformLocation(this._p,"u_image"),this.kp=[],t.uniforms&&Object.keys(t.uniforms).forEach(function(i){this.kp.push({value:t.uniforms[i],location:n.getUniformLocation(this._p,i)})}.bind(this))}return t.prototype.getGL=function(){return this.mp},t.prototype.init=function(t){var n=this.getGL(),i=[n.drawingBufferWidth*this.wp,n.drawingBufferHeight*this.wp];if(n.bindFramebuffer(n.FRAMEBUFFER,this.getFrameBuffer()),n.viewport(0,0,i[0],i[1]),!this.gp||this.gp[0]!==i[0]||this.gp[1]!==i[1]){this.gp=i;var r=n.RGBA,e=n.RGBA,o=n.UNSIGNED_BYTE;n.bindTexture(n.TEXTURE_2D,this.bp),n.texImage2D(n.TEXTURE_2D,0,r,i[0],i[1],0,e,o,null),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,this.bp,0)}},t.prototype.apply=function(t,n,i,r){var e=this.getGL(),o=t.size;if(e.bindFramebuffer(e.FRAMEBUFFER,n?n.getFrameBuffer():null),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this.bp),!n){var u=d(e.canvas);if(!t.renderTargets[u]){var s=e.getContextAttributes();s&&s.preserveDrawingBuffer&&(e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT)),t.renderTargets[u]=!0}}e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),e.viewport(0,0,e.drawingBufferWidth,e.drawingBufferHeight),e.bindBuffer(e.ARRAY_BUFFER,this.Mp),e.useProgram(this._p),e.enableVertexAttribArray(this.Op),e.vertexAttribPointer(this.Op,2,e.FLOAT,!1,0,0),e.uniform2f(this.Sp,o[0],o[1]),e.uniform1i(this.Ep,0);var a=t.layerStatesArray[t.layerIndex].opacity;e.uniform1f(this.jp,a),this.applyUniforms(t),i&&i(e,t),e.drawArrays(e.TRIANGLES,0,6),r&&r(e,t)},t.prototype.getFrameBuffer=function(){return this.xp},t.prototype.applyUniforms=function(t){var n,i=this.getGL(),r=1;this.kp.forEach((function(e){if((n="function"==typeof e.value?e.value(t):e.value)instanceof HTMLCanvasElement||n instanceof ImageData)e.texture||(e.texture=i.createTexture()),i.activeTexture(i["TEXTURE".concat(r)]),i.bindTexture(i.TEXTURE_2D,e.texture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),n instanceof ImageData?i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,n.width,n.height,0,i.UNSIGNED_BYTE,new Uint8Array(n.data)):i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,n),i.uniform1i(e.location,r++);else if(Array.isArray(n))switch(n.length){case 2:return void i.uniform2f(e.location,n[0],n[1]);case 3:return void i.uniform3f(e.location,n[0],n[1],n[2]);case 4:return void i.uniform4f(e.location,n[0],n[1],n[2],n[3]);default:return}else"number"==typeof n&&i.uniform1f(e.location,n)}))},t}();function _M(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function MM(t,n){return t[0]=n[0],t[1]=n[1],t[4]=n[2],t[5]=n[3],t[12]=n[4],t[13]=n[5],t}var OM=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),SM="u_projectionMatrix",jM="u_offsetScaleMatrix",EM="u_offsetRotateMatrix",kM="u_time",TM="u_zoom",AM="u_resolution",CM={UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,UNSIGNED_INT:5125,FLOAT:vM},PM={};function RM(t){return"shared/"+t}var IM=0;function NM(t){for(var n=0,i=0;i<t.length;i++){var r=t[i];n+=r.size*zM(r.type)}return n}function zM(t){switch(t){case CM.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case CM.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case CM.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case CM.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}var FM=function(t){function n(n){var i,r=t.call(this)||this,e=n||{};r.Tp=r.handleWebGLContextLost.bind(r),r.Ap=r.handleWebGLContextRestored.bind(r),r.Cp=e.canvasCacheKey?RM(e.canvasCacheKey):(i="unique/"+IM,IM+=1,i),r.Eo=function(t){var n=PM[t];if(!n){var i=document.createElement("canvas");i.style.position="absolute",i.style.left="0",n={users:0,canvas:i},PM[t]=n}return n.users+=1,n.canvas}(r.Cp),r.mp=dM(r.Eo),r.Pp={},r.Rp={},r.Ip=null,r.Eo.addEventListener(bM,r.Tp),r.Eo.addEventListener(gM,r.Ap),r.Np=[1,0,0,1,0,0],r.zp=[1,0,0,1,0,0],r.Fp=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r.Lp={},r.Gp={},r.kp=[],e.uniforms&&r.setUniforms(e.uniforms);var o=r.getGL();return r.Dp=e.postProcesses?e.postProcesses.map((function(t){return new xM({webGlContext:o,scaleRatio:t.scaleRatio,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,uniforms:t.uniforms})})):[new xM({webGlContext:o})],r.Up=null,r.kl=Date.now(),r}return OM(n,t),n.prototype.setUniforms=function(t){for(var n in this.kp=[],t)this.kp.push({name:n,value:t[n]});this.Lp={}},n.prototype.canvasCacheKeyMatches=function(t){return this.Cp===RM(t)},n.prototype.getExtension=function(t){if(t in this.Rp)return this.Rp[t];var n=this.mp.getExtension(t);return this.Rp[t]=n,n},n.prototype.bindBuffer=function(t){var n=this.getGL(),i=d(t),r=this.Pp[i];r||(r={buffer:t,webGlBuffer:n.createBuffer()},this.Pp[i]=r);n.bindBuffer(t.getType(),r.webGlBuffer)},n.prototype.flushBufferData=function(t){var n=this.getGL();this.bindBuffer(t),n.bufferData(t.getType(),t.getArray(),t.getUsage())},n.prototype.deleteBuffer=function(t){var n=this.getGL(),i=d(t),r=this.Pp[i];r&&!n.isContextLost()&&n.deleteBuffer(r.webGlBuffer),delete this.Pp[i]},n.prototype.disposeInternal=function(){this.Eo.removeEventListener(bM,this.Tp),this.Eo.removeEventListener(gM,this.Ap),function(t){var n=PM[t];if(n&&(n.users-=1,!(n.users>0))){var i=dM(n.canvas).getExtension("WEBGL_lose_context");i&&i.loseContext(),delete PM[t]}}(this.Cp),delete this.mp,delete this.Eo},n.prototype.prepareDraw=function(t,n){var i=this.getGL(),r=this.getCanvas(),e=t.size,o=t.pixelRatio;r.width=e[0]*o,r.height=e[1]*o,r.style.width=e[0]+"px",r.style.height=e[1]+"px",i.useProgram(this.Ip);for(var u=this.Dp.length-1;u>=0;u--)this.Dp[u].init(t);i.bindTexture(i.TEXTURE_2D,null),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),i.enable(i.BLEND),i.blendFunc(i.ONE,n?i.ZERO:i.ONE_MINUS_SRC_ALPHA),i.useProgram(this.Ip),this.applyFrameState(t),this.applyUniforms(t)},n.prototype.prepareDrawToRenderTarget=function(t,n,i){var r=this.getGL(),e=n.getSize();r.bindFramebuffer(r.FRAMEBUFFER,n.getFramebuffer()),r.viewport(0,0,e[0],e[1]),r.bindTexture(r.TEXTURE_2D,n.getTexture()),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.enable(r.BLEND),r.blendFunc(r.ONE,i?r.ZERO:r.ONE_MINUS_SRC_ALPHA),r.useProgram(this.Ip),this.applyFrameState(t),this.applyUniforms(t)},n.prototype.drawElements=function(t,n){var i=this.getGL();this.getExtension("OES_element_index_uint");var r=i.UNSIGNED_INT,e=n-t,o=4*t;i.drawElements(i.TRIANGLES,e,r,o)},n.prototype.finalizeDraw=function(t,n,i){for(var r=0,e=this.Dp.length;r<e;r++)r===e-1?this.Dp[r].apply(t,null,n,i):this.Dp[r].apply(t,this.Dp[r+1])},n.prototype.getCanvas=function(){return this.Eo},n.prototype.getGL=function(){return this.mp},n.prototype.applyFrameState=function(t){var n=t.size,i=t.viewState.rotation,r=Ge(this.zp);Ve(r,2/n[0],2/n[1]);var e=Ge(this.Np);0!==i&&Xe(e,-i),this.setUniformMatrixValue(jM,MM(this.Fp,r)),this.setUniformMatrixValue(EM,MM(this.Fp,e)),this.setUniformFloatValue(kM,.001*(Date.now()-this.kl)),this.setUniformFloatValue(TM,t.viewState.zoom),this.setUniformFloatValue(AM,t.viewState.resolution)},n.prototype.applyUniforms=function(t){var n,i=this.getGL(),r=0;this.kp.forEach(function(e){if((n="function"==typeof e.value?e.value(t):e.value)instanceof HTMLCanvasElement||n instanceof HTMLImageElement||n instanceof ImageData)e.texture||(e.prevValue=void 0,e.texture=i.createTexture()),i.activeTexture(i["TEXTURE".concat(r)]),i.bindTexture(i.TEXTURE_2D,e.texture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),(!(n instanceof HTMLImageElement)||n.complete)&&e.prevValue!==n&&(e.prevValue=n,i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,n)),i.uniform1i(this.getUniformLocation(e.name),r++);else if(Array.isArray(n)&&6===n.length)this.setUniformMatrixValue(e.name,MM(this.Fp,n));else if(Array.isArray(n)&&n.length<=4)switch(n.length){case 2:return void i.uniform2f(this.getUniformLocation(e.name),n[0],n[1]);case 3:return void i.uniform3f(this.getUniformLocation(e.name),n[0],n[1],n[2]);case 4:return void i.uniform4f(this.getUniformLocation(e.name),n[0],n[1],n[2],n[3]);default:return}else"number"==typeof n&&i.uniform1f(this.getUniformLocation(e.name),n)}.bind(this))},n.prototype.useProgram=function(t){return t!=this.Ip&&(this.getGL().useProgram(t),this.Ip=t,this.Lp={},this.Gp={},!0)},n.prototype.compileShader=function(t,n){var i=this.getGL(),r=i.createShader(n);return i.shaderSource(r,t),i.compileShader(r),r},n.prototype.getProgram=function(t,n){var i=this.getGL(),r=this.compileShader(t,i.FRAGMENT_SHADER),e=this.compileShader(n,i.VERTEX_SHADER),o=i.createProgram();if(i.attachShader(o,r),i.attachShader(o,e),i.linkProgram(o),!i.getShaderParameter(r,i.COMPILE_STATUS)){var u="Fragment shader compliation failed: ".concat(i.getShaderInfoLog(r));throw new Error(u)}if(i.deleteShader(r),!i.getShaderParameter(e,i.COMPILE_STATUS)){u="Vertex shader compilation failed: ".concat(i.getShaderInfoLog(e));throw new Error(u)}if(i.deleteShader(e),!i.getProgramParameter(o,i.LINK_STATUS)){u="GL program linking failed: ".concat(i.getShaderInfoLog(e));throw new Error(u)}return o},n.prototype.getUniformLocation=function(t){return void 0===this.Lp[t]&&(this.Lp[t]=this.getGL().getUniformLocation(this.Ip,t)),this.Lp[t]},n.prototype.getAttributeLocation=function(t){return void 0===this.Gp[t]&&(this.Gp[t]=this.getGL().getAttribLocation(this.Ip,t)),this.Gp[t]},n.prototype.makeProjectionTransform=function(t,n){var i=t.size,r=t.viewState.rotation,e=t.viewState.resolution,o=t.viewState.center;return Ge(n),Ze(n,0,0,2/(e*i[0]),2/(e*i[1]),-r,-o[0],-o[1]),n},n.prototype.setUniformFloatValue=function(t,n){this.getGL().uniform1f(this.getUniformLocation(t),n)},n.prototype.setUniformFloatVec4=function(t,n){this.getGL().uniform4fv(this.getUniformLocation(t),n)},n.prototype.setUniformMatrixValue=function(t,n){this.getGL().uniformMatrix4fv(this.getUniformLocation(t),!1,n)},n.prototype.qp=function(t,n,i,r,e){var o=this.getAttributeLocation(t);o<0||(this.getGL().enableVertexAttribArray(o),this.getGL().vertexAttribPointer(o,n,i,!1,r,e))},n.prototype.enableAttributes=function(t){for(var n=NM(t),i=0,r=0;r<t.length;r++){var e=t[r];this.qp(e.name,e.size,e.type||vM,n,i),i+=e.size*zM(e.type)}},n.prototype.handleWebGLContextLost=function(){Y(this.Pp),this.Ip=null},n.prototype.handleWebGLContextRestored=function(){},n.prototype.createTexture=function(t,n,i){var r=this.getGL(),e=i||r.createTexture(),o=r.RGBA,u=r.RGBA,s=r.UNSIGNED_BYTE;return r.bindTexture(r.TEXTURE_2D,e),n?r.texImage2D(r.TEXTURE_2D,0,o,u,s,n):r.texImage2D(r.TEXTURE_2D,0,o,t[0],t[1],0,u,s,null),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),e},n}(D),LM=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),GM="GENERATE_BUFFERS",DM=function(t){function n(n,i){var r=t.call(this,n)||this,e=i||{};return r.Bp=[1,0,0,1,0,0],r.vf=null,r.Xp=e.postProcesses,r.kp=e.uniforms,r.helper,n.addChangeListener(kn,r.removeHelper.bind(r)),r.dispatchPreComposeEvent=r.dispatchPreComposeEvent.bind(r),r.dispatchPostComposeEvent=r.dispatchPostComposeEvent.bind(r),r}return LM(n,t),n.prototype.dispatchPreComposeEvent=function(t,n){var i=this.getLayer();if(i.hasListener(In)){var r=new uo(In,void 0,n,t);i.dispatchEvent(r)}},n.prototype.dispatchPostComposeEvent=function(t,n){var i=this.getLayer();if(i.hasListener(Nn)){var r=new uo(Nn,void 0,n,t);i.dispatchEvent(r)}},n.prototype.reset=function(t){this.kp=t.uniforms,this.helper&&this.helper.setUniforms(this.kp)},n.prototype.removeHelper=function(){this.helper&&(this.helper.dispose(),delete this.helper)},n.prototype.prepareFrame=function(t){if(this.getLayer().getRenderSource()){for(var i=!0,r=-1,e=void 0,o=0,u=t.layerStatesArray.length;o<u;o++){var s=t.layerStatesArray[o].layer,a=s.getRenderer();if(a instanceof n){var f=s.getClassName();if((i||f!==e)&&(r+=1,i=!1),e=f,a===this)break}else i=!0}var h="map/"+t.mapId+"/group/"+r;this.helper&&this.helper.canvasCacheKeyMatches(h)||(this.removeHelper(),this.helper=new FM({postProcesses:this.Xp,uniforms:this.kp,canvasCacheKey:h}),e&&(this.helper.getCanvas().className=e),this.afterHelperCreated())}return this.prepareFrameInternal(t)},n.prototype.afterHelperCreated=function(){},n.prototype.prepareFrameInternal=function(t){return!0},n.prototype.disposeInternal=function(){this.removeHelper(),t.prototype.disposeInternal.call(this)},n.prototype.pf=function(t,n,i){var r=this.getLayer();if(r.hasListener(t)){Ze(this.Bp,0,0,i.pixelRatio,-i.pixelRatio,0,0,-i.size[1]);var e=new uo(t,this.Bp,i,n);r.dispatchEvent(e)}},n.prototype.preRender=function(t,n){this.pf(Pn,t,n)},n.prototype.postRender=function(t,n){this.pf(Rn,t,n)},n.prototype.getDataAtPixel=function(t,n,i){var r=Be([n.pixelRatio,0,0,n.pixelRatio,0,0],t.slice()),e=this.helper.getGL();if(!e)return null;var o=this.getLayer().getExtent();if(o&&!$i(o,Be(n.pixelToCoordinateTransform,t.slice())))return null;var u=e.getContextAttributes();if(!u||!u.preserveDrawingBuffer)return new Uint8Array;var s,a=Math.round(r[0]),f=Math.round(r[1]),h=this.vf;if(!h){var c=document.createElement("canvas");c.width=1,c.height=1,h=c.getContext("2d"),this.vf=h}h.clearRect(0,0,1,1);try{h.drawImage(e.canvas,a,f,1,1,0,0,1,1),s=h.getImageData(0,0,1,1).data}catch(t){return s}return 0===s[3]?null:s},n}(Bg),UM=[],qM={vertexPosition:0,indexPosition:0};function BM(t,n,i,r,e){t[n+0]=i,t[n+1]=r,t[n+2]=e}function XM(t,n){var i=n||[],r=256,e=255;return i[0]=Math.floor(t/r/r/r)/e,i[1]=Math.floor(t/r/r)%r/e,i[2]=Math.floor(t/r)%r/e,i[3]=t%r/e,i}function VM(t){var n=0,i=256,r=255;return n+=Math.round(t[0]*i*i*i*r),n+=Math.round(t[1]*i*i*r),n+=Math.round(t[2]*i*r),n+=Math.round(t[3]*r)}var WM=DM,YM=new Uint8Array(4),ZM=function(){function t(t,n){this.Vp=t;var i=t.getGL();this.Wp=i.createTexture(),this.Yp=i.createFramebuffer(),this.Me=n||[1,1],this.xe=new Uint8Array(0),this.Zp=!0,this.Hp()}return t.prototype.setSize=function(t){h(t,this.Me)||(this.Me[0]=t[0],this.Me[1]=t[1],this.Hp())},t.prototype.getSize=function(){return this.Me},t.prototype.clearCachedData=function(){this.Zp=!0},t.prototype.readAll=function(){if(this.Zp){var t=this.Me,n=this.Vp.getGL();n.bindFramebuffer(n.FRAMEBUFFER,this.Yp),n.readPixels(0,0,t[0],t[1],n.RGBA,n.UNSIGNED_BYTE,this.xe),this.Zp=!1}return this.xe},t.prototype.readPixel=function(t,n){if(t<0||n<0||t>this.Me[0]||n>=this.Me[1])return YM[0]=0,YM[1]=0,YM[2]=0,YM[3]=0,YM;this.readAll();var i=Math.floor(t)+(this.Me[1]-Math.floor(n)-1)*this.Me[0];return YM[0]=this.xe[4*i],YM[1]=this.xe[4*i+1],YM[2]=this.xe[4*i+2],YM[3]=this.xe[4*i+3],YM},t.prototype.getTexture=function(){return this.Wp},t.prototype.getFramebuffer=function(){return this.Yp},t.prototype.Hp=function(){var t=this.Me,n=this.Vp.getGL();this.Wp=this.Vp.createTexture(t,null,this.Wp),n.bindFramebuffer(n.FRAMEBUFFER,this.Yp),n.viewport(0,0,t[0],t[1]),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,this.Wp,0),this.xe=new Uint8Array(t[0]*t[1]*4)},t}();var HM=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),KM=function(t){function n(n,i){var r=this,e=i.uniforms||{},o=[1,0,0,1,0,0];e[SM]=o,(r=t.call(this,n,{uniforms:e,postProcesses:i.postProcesses})||this).ready=!1,r.Kp=-1,r.Jp=new wM(fM,lM),r.$p=new wM(fM,lM),r.Qp=new wM(hM,lM),r.td=i.vertexShader,r.rd=i.fragmentShader,r.ed,r.od=!(!i.hitFragmentShader||!i.hitVertexShader),r.ud=i.hitVertexShader,r.sd=i.hitFragmentShader,r.ad;var u=i.attributes?i.attributes.map((function(t){return{name:"a_"+t.name,size:1,type:CM.FLOAT}})):[];r.attributes=[{name:"a_position",size:2,type:CM.FLOAT},{name:"a_index",size:1,type:CM.FLOAT}].concat(u),r.hitDetectionAttributes=[{name:"a_position",size:2,type:CM.FLOAT},{name:"a_index",size:1,type:CM.FLOAT},{name:"a_hitColor",size:4,type:CM.FLOAT},{name:"a_featureUid",size:1,type:CM.FLOAT}].concat(u),r.customAttributes=i.attributes?i.attributes:[],r.Zi=[1/0,1/0,-1/0,-1/0],r.fd=o,r.hd=[1,0,0,1,0,0],r.ld=[1,0,0,1,0,0],r.vd=new Float32Array(0),r.dd=new Float32Array(0),r.yd,r.md=0,r.wd=function(){var t='function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o(e,t)}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn\'t been initialised - super() hasn\'t been called");return e}(e)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=i(e);if(t){var o=i(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return s(this,n)}}var u="change",f=function(){function t(){e(this,t),this.disposed=!1}return n(t,[{key:"dispose",value:function(){this.disposed||(this.disposed=!0,this.disposeInternal())}},{key:"disposeInternal",value:function(){}}]),t}(),l=function(){function t(n){e(this,t),this.propagationStopped,this.defaultPrevented,this.type=n,this.target=null}return n(t,[{key:"preventDefault",value:function(){this.defaultPrevented=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}}]),t}();function c(){}var v="function"==typeof Object.assign?Object.assign:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),r=1,i=arguments.length;r<i;++r){var o=arguments[r];if(null!=o)for(var s in o)o.hasOwnProperty(s)&&(n[s]=o[s])}return n};function h(e){for(var t in e)delete e[t]}var p=function(t){r(o,f);var i=a(o);function o(t){var n;return e(this,o),(n=i.call(this)).eventTarget_=t,n.pendingRemovals_=null,n.dispatching_=null,n.listeners_=null,n}return n(o,[{key:"addEventListener",value:function(e,t){if(e&&t){var n=this.listeners_||(this.listeners_={}),r=n[e]||(n[e]=[]);-1===r.indexOf(t)&&r.push(t)}}},{key:"dispatchEvent",value:function(e){var t="string"==typeof e,n=t?e:e.type,r=this.listeners_&&this.listeners_[n];if(r){var i=t?new l(e):e;i.target||(i.target=this.eventTarget_||this);var o,s=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});n in s||(s[n]=0,a[n]=0),++s[n];for(var u=0,f=r.length;u<f;++u)if(!1===(o="handleEvent"in r[u]?r[u].handleEvent(i):r[u].call(this,i))||i.propagationStopped){o=!1;break}if(0==--s[n]){var v=a[n];for(delete a[n];v--;)this.removeEventListener(n,c);delete s[n]}return o}}},{key:"disposeInternal",value:function(){this.listeners_&&h(this.listeners_)}},{key:"getListeners",value:function(e){return this.listeners_&&this.listeners_[e]||void 0}},{key:"hasListener",value:function(e){return!!this.listeners_&&(e?e in this.listeners_:Object.keys(this.listeners_).length>0)}},{key:"removeEventListener",value:function(e,t){var n=this.listeners_&&this.listeners_[e];if(n){var r=n.indexOf(t);-1!==r&&(this.pendingRemovals_&&e in this.pendingRemovals_?(n[r]=c,++this.pendingRemovals_[e]):(n.splice(r,1),0===n.length&&delete this.listeners_[e]))}}}]),o}();function d(e,t,n,r,i){if(r&&r!==e&&(n=n.bind(r)),i){var o=n;n=function(){e.removeEventListener(t,n),o.apply(this,arguments)}}var s={target:e,type:t,listener:n};return e.addEventListener(t,n),s}function y(e,t,n,r){return d(e,t,n,r,!0)}function g(e){e&&e.target&&(e.target.removeEventListener(e.type,e.listener),h(e))}var _=function(t){r(o,p);var i=a(o);function o(){var t;return e(this,o),(t=i.call(this)).on=t.onInternal,t.once=t.onceInternal,t.un=t.unInternal,t.revision_=0,t}return n(o,[{key:"changed",value:function(){++this.revision_,this.dispatchEvent(u)}},{key:"getRevision",value:function(){return this.revision_}},{key:"onInternal",value:function(e,t){if(Array.isArray(e)){for(var n=e.length,r=new Array(n),i=0;i<n;++i)r[i]=d(this,e[i],t);return r}return d(this,e,t)}},{key:"onceInternal",value:function(e,t){var n;if(Array.isArray(e)){var r=e.length;n=new Array(r);for(var i=0;i<r;++i)n[i]=y(this,e[i],t)}else n=y(this,e,t);return t.ol_key=n,n}},{key:"unInternal",value:function(e,t){var n=t.ol_key;if(n)!function(e){if(Array.isArray(e))for(var t=0,n=e.length;t<n;++t)g(e[t]);else g(e)}(n);else if(Array.isArray(e))for(var r=0,i=e.length;r<i;++r)this.removeEventListener(e[r],t);else this.removeEventListener(e,t)}}]),o}();_.prototype.on,_.prototype.once,_.prototype.un;var b="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"";b.indexOf("firefox"),-1!==b.indexOf("safari")&&-1==b.indexOf("chrom")&&(b.indexOf("version/15.4")>=0||b.match(/cpu (os|iphone os) 15_4 like mac os x/)),-1!==b.indexOf("webkit")&&b.indexOf("edge"),b.indexOf("macintosh"),"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&(self,WorkerGlobalScope),function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("_",null,t),window.removeEventListener("_",null,t)}catch(e){}}(),new Array(6);var O="GENERATE_BUFFERS",w=[],k={vertexPosition:0,indexPosition:0};function m(e,t,n,r,i){e[t+0]=n,e[t+1]=r,e[t+2]=i}function E(e,t,n,r,i,o){var s=3+i,a=e[t+0],u=e[t+1],f=w;f.length=i;for(var l=0;l<f.length;l++)f[l]=e[t+2+l];var c=o?o.vertexPosition:0,v=o?o.indexPosition:0,h=c/s;return m(n,c,a,u,0),f.length&&n.set(f,c+3),m(n,c+=s,a,u,1),f.length&&n.set(f,c+3),m(n,c+=s,a,u,2),f.length&&n.set(f,c+3),m(n,c+=s,a,u,3),f.length&&n.set(f,c+3),c+=s,r[v++]=h,r[v++]=h+1,r[v++]=h+3,r[v++]=h+1,r[v++]=h+2,r[v++]=h+3,k.vertexPosition=c,k.indexPosition=v,k}var x=self;x.onmessage=function(e){var t=e.data;if(t.type===O){for(var n,r=t.customAttributesCount,i=2+r,o=new Float32Array(t.renderInstructions),s=o.length/i,a=4*s*(r+3),u=new Uint32Array(6*s),f=new Float32Array(a),l=0;l<o.length;l+=i)n=E(o,l,f,u,r,n);var c=v({vertexBuffer:f.buffer,indexBuffer:u.buffer,renderInstructions:o.buffer},t);x.postMessage(c,[f.buffer,u.buffer,o.buffer])}};';return new Worker("undefined"==typeof Blob?"data:application/javascript;base64,"+Buffer.from(t,"binary").toString("base64"):URL.createObjectURL(new Blob([t],{type:"application/javascript"})))}(),r.wd.addEventListener("message",function(t){var n=t.data;if(n.type===GM){var i=n.projectionTransform;n.hitDetection?(this.$p.fromArrayBuffer(n.vertexBuffer),this.helper.flushBufferData(this.$p)):(this.Jp.fromArrayBuffer(n.vertexBuffer),this.helper.flushBufferData(this.Jp)),this.Qp.fromArrayBuffer(n.indexBuffer),this.helper.flushBufferData(this.Qp),this.hd=i,He(this.ld,this.hd),n.hitDetection?this.dd=new Float32Array(t.data.renderInstructions):(this.vd=new Float32Array(t.data.renderInstructions),n.generateBuffersRun===this.md&&(this.ready=!0)),this.getLayer().changed()}}.bind(r)),r.bd={},r.gd=0;var s=r.getLayer().getSource();return r.xd=[lt(s,Rx,r._d,r),lt(s,Ix,r.Md,r),lt(s,zx,r.Od,r),lt(s,Nx,r.Sd,r)],s.forEachFeature(function(t){this.bd[d(t)]={feature:t,properties:t.getProperties(),geometry:t.getGeometry()},this.gd++}.bind(r)),r}return HM(n,t),n.prototype.afterHelperCreated=function(){this.ed=this.helper.getProgram(this.rd,this.td),this.od&&(this.ad=this.helper.getProgram(this.sd,this.ud),this.yd=new ZM(this.helper))},n.prototype._d=function(t){var n=t.feature;this.bd[d(n)]={feature:n,properties:n.getProperties(),geometry:n.getGeometry()},this.gd++},n.prototype.Md=function(t){var n=t.feature;this.bd[d(n)]={feature:n,properties:n.getProperties(),geometry:n.getGeometry()}},n.prototype.Od=function(t){var n=t.feature;delete this.bd[d(n)],this.gd--},n.prototype.Sd=function(){this.bd={},this.gd=0},n.prototype.renderFrame=function(t){var n=this.helper.getGL();this.preRender(n,t);var i=t.viewState.projection,r=this.getLayer().getSource().getWrapX()&&i.canWrapX(),e=i.getExtent(),o=t.extent,u=r?jr(e):null,s=r?Math.ceil((o[2]-e[2])/u)+1:1,a=r?Math.floor((o[0]-e[0])/u):0,f=a,h=this.Qp.getSize();do{this.helper.makeProjectionTransform(t,this.fd),Ye(this.fd,f*u,0),De(this.fd,this.ld),this.helper.applyUniforms(t),this.helper.drawElements(0,h)}while(++f<s);this.helper.finalizeDraw(t,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);var c=this.helper.getCanvas();return this.od&&(this.renderHitDetection(t,a,s,u),this.yd.clearCachedData()),this.postRender(n,t),c},n.prototype.prepareFrameInternal=function(t){var n=this.getLayer(),i=n.getSource(),r=t.viewState,e=!t.viewHints[mu]&&!t.viewHints[wu],o=!sr(this.Zi,t.extent),u=this.Kp<i.getRevision();if(u&&(this.Kp=i.getRevision()),e&&(o||u)){var s=r.projection,a=r.resolution,f=n instanceof xg?n.getRenderBuffer():0,h=Hi(t.extent,f*a);i.loadFeatures(h,a,s),this.jd(t),this.Zi=t.extent.slice()}return this.helper.useProgram(this.ed),this.helper.prepareDraw(t),this.helper.bindBuffer(this.Jp),this.helper.bindBuffer(this.Qp),this.helper.enableAttributes(this.attributes),!0},n.prototype.jd=function(t){var n=[1,0,0,1,0,0];this.helper.makeProjectionTransform(t,n);var i,r,e=(2+this.customAttributes.length)*this.gd;if(this.vd&&this.vd.length===e||(this.vd=new Float32Array(e)),this.od){var o=(7+this.customAttributes.length)*this.gd;this.dd&&this.dd.length===o||(this.dd=new Float32Array(o))}var u,s=[],a=[],f=0,h=0;for(var c in this.bd)if((r=(i=this.bd[c]).geometry)&&r.getType()===Kr.POINT){s[0]=r.getFlatCoordinates()[0],s[1]=r.getFlatCoordinates()[1],Be(n,s),u=XM(h+6,a),this.vd[f++]=s[0],this.vd[f++]=s[1],this.od&&(this.dd[h++]=s[0],this.dd[h++]=s[1],this.dd[h++]=u[0],this.dd[h++]=u[1],this.dd[h++]=u[2],this.dd[h++]=u[3],this.dd[h++]=Number(c));for(var l=void 0,v=0;v<this.customAttributes.length;v++)l=this.customAttributes[v].callback(i.feature,i.properties),this.vd[f++]=l,this.od&&(this.dd[h++]=l)}var p={type:GM,renderInstructions:this.vd.buffer,customAttributesCount:this.customAttributes.length};if(p.projectionTransform=n,p.generateBuffersRun=++this.md,this.ready=!1,this.wd.postMessage(p,[this.vd.buffer]),this.vd=null,this.od){var d={type:GM,renderInstructions:this.dd.buffer,customAttributesCount:5+this.customAttributes.length};d.projectionTransform=n,d.hitDetection=!0,this.wd.postMessage(d,[this.dd.buffer]),this.dd=null}},n.prototype.forEachFeatureAtCoordinate=function(t,n,i,r,e){if(g(this.od,66),this.dd){var o=Be(n.coordinateToPixelTransform,t.slice()),u=this.yd.readPixel(o[0]/2,o[1]/2),s=VM([u[0]/255,u[1]/255,u[2]/255,u[3]/255]),a=this.dd[s],f=Math.floor(a).toString(),h=this.getLayer().getSource().getFeatureByUid(f);return h?r(h,this.getLayer(),null):void 0}},n.prototype.renderHitDetection=function(t,n,i,r){if(this.$p.getSize()){var e=n;this.yd.setSize([Math.floor(t.size[0]/2),Math.floor(t.size[1]/2)]),this.helper.useProgram(this.ad),this.helper.prepareDrawToRenderTarget(t,this.yd,!0),this.helper.bindBuffer(this.$p),this.helper.bindBuffer(this.Qp),this.helper.enableAttributes(this.hitDetectionAttributes);do{this.helper.makeProjectionTransform(t,this.fd),Ye(this.fd,e*r,0),De(this.fd,this.ld),this.helper.applyUniforms(t);var o=this.Qp.getSize();this.helper.drawElements(0,o)}while(++e<i)}},n.prototype.disposeInternal=function(){this.wd.terminate(),this.lf=null,this.xd.forEach((function(t){pt(t)})),this.xd=null,t.prototype.disposeInternal.call(this)},n}(WM),JM=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),$M="blur",QM="gradient",tO="radius",nO=["#00f","#0ff","#0f0","#ff0","#f00"];var iO,rO=function(t){function n(n){var i=this,r=n||{},e=W({},r);delete e.gradient,delete e.radius,delete e.blur,delete e.weight,(i=t.call(this,e)||this).Ed=null,i.addChangeListener(QM,i.kd),i.setGradient(r.gradient?r.gradient:nO),i.setBlur(void 0!==r.blur?r.blur:15),i.setRadius(void 0!==r.radius?r.radius:8);var o=r.weight?r.weight:"weight";return i.Td="string"==typeof o?function(t){return t.get(o)}:o,i.setRenderOrder(null),i}return JM(n,t),n.prototype.getBlur=function(){return this.get($M)},n.prototype.getGradient=function(){return this.get(QM)},n.prototype.getRadius=function(){return this.get(tO)},n.prototype.kd=function(){this.Ed=function(t){for(var n=1,i=256,r=Qt(n,i),e=r.createLinearGradient(0,0,n,i),o=1/(t.length-1),u=0,s=t.length;u<s;++u)e.addColorStop(u*o,t[u]);return r.fillStyle=e,r.fillRect(0,0,n,i),r.canvas}(this.getGradient())},n.prototype.setBlur=function(t){this.set($M,t)},n.prototype.setGradient=function(t){this.set(QM,t)},n.prototype.setRadius=function(t){this.set(tO,t)},n.prototype.createRenderer=function(){return new KM(this,{className:this.getClassName(),attributes:[{name:"weight",callback:function(t){var n=this.Td(t);return void 0!==n?x(n,0,1):1}.bind(this)}],vertexShader:"\n        precision mediump float;\n        uniform mat4 u_projectionMatrix;\n        uniform mat4 u_offsetScaleMatrix;\n        uniform float u_size;\n        attribute vec2 a_position;\n        attribute float a_index;\n        attribute float a_weight;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n\n        void main(void) {\n          mat4 offsetMatrix = u_offsetScaleMatrix;\n          float offsetX = a_index == 0.0 || a_index == 3.0 ? -u_size / 2.0 : u_size / 2.0;\n          float offsetY = a_index == 0.0 || a_index == 1.0 ? -u_size / 2.0 : u_size / 2.0;\n          vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);\n          gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n          float u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;\n          float v = a_index == 0.0 || a_index == 1.0 ? 0.0 : 1.0;\n          v_texCoord = vec2(u, v);\n          v_weight = a_weight;\n        }",fragmentShader:"\n        precision mediump float;\n        uniform float u_blurSlope;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n\n        void main(void) {\n          vec2 texCoord = v_texCoord * 2.0 - vec2(1.0, 1.0);\n          float sqRadius = texCoord.x * texCoord.x + texCoord.y * texCoord.y;\n          float value = (1.0 - sqrt(sqRadius)) * u_blurSlope;\n          float alpha = smoothstep(0.0, 1.0, value) * v_weight;\n          gl_FragColor = vec4(alpha, alpha, alpha, alpha);\n        }",hitVertexShader:"\n        precision mediump float;\n        uniform mat4 u_projectionMatrix;\n        uniform mat4 u_offsetScaleMatrix;\n        uniform float u_size;\n        attribute vec2 a_position;\n        attribute float a_index;\n        attribute float a_weight;\n        attribute vec4 a_hitColor;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n        varying vec4 v_hitColor;\n\n        void main(void) {\n          mat4 offsetMatrix = u_offsetScaleMatrix;\n          float offsetX = a_index == 0.0 || a_index == 3.0 ? -u_size / 2.0 : u_size / 2.0;\n          float offsetY = a_index == 0.0 || a_index == 1.0 ? -u_size / 2.0 : u_size / 2.0;\n          vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);\n          gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n          float u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;\n          float v = a_index == 0.0 || a_index == 1.0 ? 0.0 : 1.0;\n          v_texCoord = vec2(u, v);\n          v_hitColor = a_hitColor;\n          v_weight = a_weight;\n        }",hitFragmentShader:"\n        precision mediump float;\n        uniform float u_blurSlope;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n        varying vec4 v_hitColor;\n\n        void main(void) {\n          vec2 texCoord = v_texCoord * 2.0 - vec2(1.0, 1.0);\n          float sqRadius = texCoord.x * texCoord.x + texCoord.y * texCoord.y;\n          float value = (1.0 - sqrt(sqRadius)) * u_blurSlope;\n          float alpha = smoothstep(0.0, 1.0, value) * v_weight;\n          if (alpha < 0.05) {\n            discard;\n          }\n\n          gl_FragColor = v_hitColor;\n        }",uniforms:{u_size:function(){return 2*(this.get(tO)+this.get($M))}.bind(this),u_blurSlope:function(){return this.get(tO)/Math.max(1,this.get($M))}.bind(this)},postProcesses:[{fragmentShader:"\n            precision mediump float;\n\n            uniform sampler2D u_image;\n            uniform sampler2D u_gradientTexture;\n            uniform float u_opacity;\n\n            varying vec2 v_texCoord;\n\n            void main() {\n              vec4 color = texture2D(u_image, v_texCoord);\n              gl_FragColor.a = color.a * u_opacity;\n              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;\n              gl_FragColor.rgb *= gl_FragColor.a;\n            }",uniforms:{u_gradientTexture:function(){return this.Ed}.bind(this),u_opacity:function(){return this.getOpacity()}.bind(this)}}]})},n.prototype.renderDeclutter=function(){},n}(xg),eO=!0,oO={imageSmoothingEnabled:!1,msImageSmoothingEnabled:!1},uO={imageSmoothingEnabled:!0,msImageSmoothingEnabled:!0},sO=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),aO=function(t){function n(n){var i=t.call(this,n)||this;return i.bo=null,i}return sO(n,t),n.prototype.getImage=function(){return this.bo?this.bo.getImage():null},n.prototype.prepareFrame=function(t){var n=t.layerStatesArray[t.layerIndex],i=t.pixelRatio,r=t.viewState,e=r.resolution,o=this.getLayer().getSource(),u=t.viewHints,s=t.extent;if(void 0!==n.extent&&(s=Mr(s,Ee(n.extent,r.projection))),!u[mu]&&!u[wu]&&!kr(s))if(o){var a=r.projection,f=o.getImage(s,e,i,a);f&&(this.loadImage(f)?this.bo=f:f.getState()===hv&&(this.bo=null))}else this.bo=null;return!!this.bo},n.prototype.getData=function(t){var n=this.frameState;if(!n)return null;var i=this.getLayer(),r=Be(n.pixelToCoordinateTransform,t.slice()),e=i.getExtent();if(e&&!$i(e,r))return null;var o=this.bo.getExtent(),u=this.bo.getImage(),s=jr(o),a=Math.floor(u.width*((r[0]-o[0])/s));if(a<0||a>=u.width)return null;var f=_r(o),h=Math.floor(u.height*((o[3]-r[1])/f));return h<0||h>=u.height?null:this.getImageData(u,a,h)},n.prototype.renderFrame=function(t,n){var i=this.bo,r=i.getExtent(),e=i.getResolution(),o=i.getPixelRatio(),u=t.layerStatesArray[t.layerIndex],s=t.pixelRatio,a=t.viewState,f=a.center,h=a.resolution,c=t.size,l=s*e/(h*o),v=Math.round(c[0]*s),p=Math.round(c[1]*s),d=a.rotation;if(d){var y=Math.round(Math.sqrt(v*v+p*p));v=y,p=y}Ze(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/s,1/s,d,-v/2,-p/2),He(this.inversePixelTransform,this.pixelTransform);var m=Je(this.pixelTransform);this.useContainer(n,m,u.opacity,this.getBackground(t));var w=this.context,b=w.canvas;b.width!=v||b.height!=p?(b.width=v,b.height=p):this.containerReused||w.clearRect(0,0,v,p);var g=!1,x=!0;if(u.extent){var _=Ee(u.extent,a.projection);(g=(x=Er(_,t.extent))&&!Qi(_,t.extent))&&this.clipUnrotated(w,t,_)}var M=i.getImage(),O=Ze(this.tempTransform,v/2,p/2,l,l,0,o*(r[0]-f[0])/e,o*(f[1]-r[3])/e);this.renderedResolution=e*s/o;var S=M.width*O[0],j=M.height*O[3];if(this.getLayer().getSource().getInterpolate()||W(w,oO),this.preRender(w,t),x&&S>=.5&&j>=.5){var E=O[4],k=O[5],T=u.opacity,A=void 0;1!==T&&(A=w.globalAlpha,w.globalAlpha=T),w.drawImage(M,0,0,+M.width,+M.height,Math.round(E),Math.round(k),Math.round(S),Math.round(j)),1!==T&&(w.globalAlpha=A)}return this.postRender(w,t),g&&w.restore(),W(w,uO),m!==b.style.transform&&(b.style.transform=m),this.container},n}(Wg),fO=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),hO=function(t){function n(n){return t.call(this,n)||this}return fO(n,t),n.prototype.createRenderer=function(){return new aO(this)},n.prototype.getData=function(n){return t.prototype.getData.call(this,n)},n}($_),cO=function(){function t(t,n,i,r,e,o){this.Ad=t,this.Cd=n;var u={},s=we(this.Cd,this.Ad);this.Pd=function(t){var n=t[0]+"/"+t[1];return u[n]||(u[n]=s(t)),u[n]},this.Rd=r,this.Id=e*e,this.Nd=[],this.zd=!1,this.Fd=this.Ad.canWrapX()&&!!r&&!!this.Ad.getExtent()&&jr(r)==jr(this.Ad.getExtent()),this.Ld=this.Ad.getExtent()?jr(this.Ad.getExtent()):null,this.Gd=this.Cd.getExtent()?jr(this.Cd.getExtent()):null;var a=Or(i),f=Sr(i),h=wr(i),c=mr(i),l=this.Pd(a),v=this.Pd(f),p=this.Pd(h),d=this.Pd(c),y=10+(o?Math.max(0,Math.ceil(M(yr(i)/(o*o*256*256)))):0);if(this.Dd(a,f,h,c,l,v,p,d,y),this.zd){var m=1/0;this.Nd.forEach((function(t,n,i){m=Math.min(m,t.source[0][0],t.source[1][0],t.source[2][0])})),this.Nd.forEach(function(t){if(Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-m>this.Ld/2){var n=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]];n[0][0]-m>this.Ld/2&&(n[0][0]-=this.Ld),n[1][0]-m>this.Ld/2&&(n[1][0]-=this.Ld),n[2][0]-m>this.Ld/2&&(n[2][0]-=this.Ld);var i=Math.min(n[0][0],n[1][0],n[2][0]);Math.max(n[0][0],n[1][0],n[2][0])-i<this.Ld/2&&(t.source=n)}}.bind(this))}u={}}return t.prototype.Ud=function(t,n,i,r,e,o){this.Nd.push({source:[r,e,o],target:[t,n,i]})},t.prototype.Dd=function(t,n,i,r,e,o,u,s,a){var f=Zi([e,o,u,s]),h=this.Ld?jr(f)/this.Ld:null,c=this.Ld,l=this.Ad.canWrapX()&&h>.5&&h<1,v=!1;if(a>0){if(this.Cd.isGlobal()&&this.Gd)v=jr(Zi([t,n,i,r]))/this.Gd>.25||v;!l&&this.Ad.isGlobal()&&h&&(v=h>.25||v)}if(!(!v&&this.Rd&&isFinite(f[0])&&isFinite(f[1])&&isFinite(f[2])&&isFinite(f[3]))||Er(f,this.Rd)){var p=0;if(!(v||isFinite(e[0])&&isFinite(e[1])&&isFinite(o[0])&&isFinite(o[1])&&isFinite(u[0])&&isFinite(u[1])&&isFinite(s[0])&&isFinite(s[1])))if(a>0)v=!0;else if(1!=(p=(isFinite(e[0])&&isFinite(e[1])?0:8)+(isFinite(o[0])&&isFinite(o[1])?0:4)+(isFinite(u[0])&&isFinite(u[1])?0:2)+(isFinite(s[0])&&isFinite(s[1])?0:1))&&2!=p&&4!=p&&8!=p)return;if(a>0){if(!v){var d=[(t[0]+i[0])/2,(t[1]+i[1])/2],y=this.Pd(d),m=void 0;if(l)m=(T(e[0],c)+T(u[0],c))/2-T(y[0],c);else m=(e[0]+u[0])/2-y[0];var w=(e[1]+u[1])/2-y[1];v=m*m+w*w>this.Id}if(v){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){var b=[(n[0]+i[0])/2,(n[1]+i[1])/2],g=this.Pd(b),x=[(r[0]+t[0])/2,(r[1]+t[1])/2],_=this.Pd(x);this.Dd(t,n,b,x,e,o,g,_,a-1),this.Dd(x,b,i,r,_,g,u,s,a-1)}else{var M=[(t[0]+n[0])/2,(t[1]+n[1])/2],O=this.Pd(M),S=[(i[0]+r[0])/2,(i[1]+r[1])/2],j=this.Pd(S);this.Dd(t,M,S,r,e,O,j,s,a-1),this.Dd(M,n,i,S,O,o,u,j,a-1)}return}}if(l){if(!this.Fd)return;this.zd=!0}0==(11&p)&&this.Ud(t,i,r,e,u,s),0==(14&p)&&this.Ud(t,i,n,e,u,o),p&&(0==(13&p)&&this.Ud(n,r,t,o,s,e),0==(7&p)&&this.Ud(n,r,i,o,s,u))}},t.prototype.calculateSourceExtent=function(){var t=[1/0,1/0,-1/0,-1/0];return this.Nd.forEach((function(n,i,r){var e=n.source;hr(t,e[0]),hr(t,e[1]),hr(t,e[2])})),t},t.prototype.getTriangles=function(){return this.Nd},t}();function lO(t,n,i,r,e){t.beginPath(),t.moveTo(0,0),t.lineTo(n,i),t.lineTo(r,e),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(n,r)+1,Math.max(i,e)),t.restore()}function vO(t,n){return Math.abs(t[4*n]-210)>2||Math.abs(t[4*n+3]-191.25)>2}function pO(t,n,i,r){var e=be(i,n,t),o=fe(n,r,i),u=n.getMetersPerUnit();void 0!==u&&(o*=u);var s=t.getMetersPerUnit();void 0!==s&&(o/=s);var a=t.getExtent();if(!a||$i(a,e)){var f=fe(t,o,e)/o;isFinite(f)&&f>0&&(o/=f)}return o}function dO(t,n,i,r){var e=br(i),o=pO(t,n,e,r);return(!isFinite(o)||o<=0)&&dr(i,(function(i){return o=pO(t,n,i,r),isFinite(o)&&o>0})),o}function yO(t,n,i,r,e,o,u,s,a,f,h,c){var l=Qt(Math.round(i*t),Math.round(i*n));if(c||W(l,oO),0===a.length)return l.canvas;function v(t){return Math.round(t*i)/i}l.scale(i,i),l.globalCompositeOperation="lighter";var p=[1/0,1/0,-1/0,-1/0];a.forEach((function(t,n,i){fr(p,t.extent)}));var d=jr(p),y=_r(p),m=Qt(Math.round(i*d/r),Math.round(i*y/r));c||W(m,oO);var w=i/r;a.forEach((function(t,n,i){var r=t.extent[0]-p[0],e=-(t.extent[3]-p[3]),o=jr(t.extent),u=_r(t.extent);t.image.width>0&&t.image.height>0&&m.drawImage(t.image,f,f,t.image.width-2*f,t.image.height-2*f,r*w,e*w,o*w,u*w)}));var b=Or(u);return s.getTriangles().forEach((function(t,n,e){var u=t.source,s=t.target,a=u[0][0],f=u[0][1],h=u[1][0],d=u[1][1],y=u[2][0],w=u[2][1],g=v((s[0][0]-b[0])/o),x=v(-(s[0][1]-b[1])/o),_=v((s[1][0]-b[0])/o),M=v(-(s[1][1]-b[1])/o),O=v((s[2][0]-b[0])/o),S=v(-(s[2][1]-b[1])/o),E=a,k=f;a=0,f=0;var T=j([[h-=E,d-=k,0,0,_-g],[y-=E,w-=k,0,0,O-g],[0,0,h,d,M-x],[0,0,y,w,S-x]]);if(T){if(l.save(),l.beginPath(),function(){if(void 0===iO){var t=document.createElement("canvas").getContext("2d");t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",lO(t,4,5,4,0),lO(t,4,5,0,5);var n=t.getImageData(0,0,3,3).data;iO=vO(n,0)||vO(n,4)||vO(n,8)}return iO}()||!c){l.moveTo(_,M);for(var A=g-_,C=x-M,P=0;P<4;P++)l.lineTo(_+v((P+1)*A/4),M+v(P*C/3)),3!=P&&l.lineTo(_+v((P+1)*A/4),M+v((P+1)*C/3));l.lineTo(O,S)}else l.moveTo(_,M),l.lineTo(g,x),l.lineTo(O,S);l.clip(),l.transform(T[0],T[2],T[1],T[3],g,x),l.translate(p[0]-E,p[3]-k),l.scale(r/i,-r/i),l.drawImage(m.canvas,0,0),l.restore()}})),h&&(l.save(),l.globalCompositeOperation="source-over",l.strokeStyle="black",l.lineWidth=1,s.getTriangles().forEach((function(t,n,i){var r=t.target,e=(r[0][0]-b[0])/o,u=-(r[0][1]-b[1])/o,s=(r[1][0]-b[0])/o,a=-(r[1][1]-b[1])/o,f=(r[2][0]-b[0])/o,h=-(r[2][1]-b[1])/o;l.beginPath(),l.moveTo(s,a),l.lineTo(e,u),l.lineTo(f,h),l.closePath(),l.stroke()})),l.restore()),l.canvas}var mO=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),wO=function(t){function n(n,i,r,e,o,u,s,a,f,h,c,l){var v=t.call(this,o,fu,{interpolate:!!l})||this;v.qd=void 0!==c&&c,v.Gi=s,v.Bd=a,v.Eo=null,v.Xd=i,v.Vd=e,v.Wd=u||o,v.Yd=[],v.Zd=null,v.Hd=0;var p=e.getTileCoordExtent(v.Wd),d=v.Vd.getExtent(),y=v.Xd.getExtent(),m=d?Mr(p,d):p;if(0===yr(m))return v.state=vu,v;var w=n.getExtent();w&&(y=y?Mr(y,w):w);var b=e.getResolution(v.Wd[0]),g=dO(n,r,m,b);if(!isFinite(g)||g<=0)return v.state=vu,v;var _=void 0!==h?h:.5;if(v.Kd=new cO(n,r,m,y,g*_,b),0===v.Kd.getTriangles().length)return v.state=vu,v;v.Hd=i.getZForResolution(g);var M=v.Kd.calculateSourceExtent();if(y&&(n.canWrapX()?(M[1]=x(M[1],y[1],y[3]),M[3]=x(M[3],y[1],y[3])):M=Mr(M,y)),yr(M)){for(var O=i.getTileRangeForExtentAndZ(M,v.Hd),S=O.minX;S<=O.maxX;S++)for(var j=O.minY;j<=O.maxY;j++){var E=f(v.Hd,S,j,s);E&&v.Yd.push(E)}0===v.Yd.length&&(v.state=vu)}else v.state=vu;return v}return mO(n,t),n.prototype.getImage=function(){return this.Eo},n.prototype.Jd=function(){var t=[];if(this.Yd.forEach(function(n,i,r){n&&n.getState()==cu&&t.push({extent:this.Xd.getTileCoordExtent(n.tileCoord),image:n.getImage()})}.bind(this)),this.Yd.length=0,0===t.length)this.state=lu;else{var n=this.Wd[0],i=this.Vd.getTileSize(n),r="number"==typeof i?i:i[0],e="number"==typeof i?i:i[1],o=this.Vd.getResolution(n),u=this.Xd.getResolution(this.Hd),s=this.Vd.getTileCoordExtent(this.Wd);this.Eo=yO(r,e,this.Gi,u,this.Xd.getExtent(),o,s,this.Kd,t,this.Bd,this.qd,this.interpolate),this.state=cu}this.changed()},n.prototype.load=function(){if(this.state==fu){this.state=hu,this.changed();var t=0;this.Zd=[],this.Yd.forEach(function(n,i,r){var e=n.getState();if(e==fu||e==hu){t++;var o=lt(n,$,(function(i){var r=n.getState();r!=cu&&r!=lu&&r!=vu||(pt(o),0===--t&&(this.$d(),this.Jd()))}),this);this.Zd.push(o)}}.bind(this)),0===t?setTimeout(this.Jd.bind(this),0):this.Yd.forEach((function(t,n,i){t.getState()==fu&&t.load()}))}},n.prototype.$d=function(){this.Zd.forEach(pt),this.Zd=null},n}(La),bO=function(){function t(t,n,i,r){this.minX=t,this.maxX=n,this.minY=i,this.maxY=r}return t.prototype.contains=function(t){return this.containsXY(t[1],t[2])},t.prototype.containsTileRange=function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY},t.prototype.containsXY=function(t,n){return this.minX<=t&&t<=this.maxX&&this.minY<=n&&n<=this.maxY},t.prototype.equals=function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY},t.prototype.extend=function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)},t.prototype.getHeight=function(){return this.maxY-this.minY+1},t.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},t.prototype.getWidth=function(){return this.maxX-this.minX+1},t.prototype.intersects=function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY},t}();function gO(t,n,i,r,e){return void 0!==e?(e.minX=t,e.maxX=n,e.minY=i,e.maxY=r,e):new bO(t,n,i,r)}var xO=bO,_O=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),MO=function(t){function n(n){var i=t.call(this,n)||this;return i.extentChanged=!0,i.dh=null,i.renderedPixelRatio,i.renderedProjection=null,i.renderedRevision,i.renderedTiles=[],i.Qd=!1,i.tmpExtent=[1/0,1/0,-1/0,-1/0],i.ty=new xO(0,0,0,0),i}return _O(n,t),n.prototype.isDrawableTile=function(t){var n=this.getLayer(),i=t.getState(),r=n.getUseInterimTilesOnError();return i==cu||i==vu||i==lu&&!r},n.prototype.getTile=function(t,n,i,r){var e=r.pixelRatio,o=r.viewState.projection,u=this.getLayer(),s=u.getSource().getTile(t,n,i,e,o);return s.getState()==lu&&(u.getUseInterimTilesOnError()?u.getPreload()>0&&(this.Qd=!0):s.setState(cu)),this.isDrawableTile(s)||(s=s.getInterimTile()),s},n.prototype.getData=function(t){var n=this.frameState;if(!n)return null;var i=this.getLayer(),r=Be(n.pixelToCoordinateTransform,t.slice()),e=i.getExtent();if(e&&!$i(e,r))return null;for(var o=n.pixelRatio,u=n.viewState.projection,s=n.viewState,a=i.getRenderSource(),f=a.getTileGridForProjection(s.projection),h=a.getTilePixelRatio(n.pixelRatio),c=f.getZForResolution(s.resolution);c>=f.getMinZoom();--c){var l=f.getTileCoordForCoordAndZ(r,c),v=a.getTile(c,l[1],l[2],o,u);if(!(v instanceof Db||v instanceof wO))return null;if(v.getState()===cu){var p=f.getOrigin(c),d=ua(f.getTileSize(c)),y=f.getResolution(c),m=Math.floor(h*((r[0]-p[0])/y-l[1]*d[0])),w=Math.floor(h*((p[1]-r[1])/y-l[2]*d[1])),b=Math.round(h*a.getGutterForProjection(s.projection));return this.getImageData(v.getImage(),m+b,w+b)}}return null},n.prototype.loadedTileCallback=function(n,i,r){return!!this.isDrawableTile(r)&&t.prototype.loadedTileCallback.call(this,n,i,r)},n.prototype.prepareFrame=function(t){return!!this.getLayer().getSource()},n.prototype.renderFrame=function(t,n){var i=t.layerStatesArray[t.layerIndex],r=t.viewState,o=r.projection,u=r.resolution,s=r.center,a=r.rotation,f=t.pixelRatio,h=this.getLayer(),c=h.getSource(),l=c.getRevision(),v=c.getTileGridForProjection(o),p=v.getZForResolution(u,c.zDirection),y=v.getResolution(p),m=t.extent,w=i.extent&&Ee(i.extent,o);w&&(m=Mr(m,Ee(i.extent,o)));var b=c.getTilePixelRatio(f),g=Math.round(t.size[0]*b),x=Math.round(t.size[1]*b);if(a){var _=Math.round(Math.sqrt(g*g+x*x));g=_,x=_}var M=y*g/2/b,O=y*x/2/b,S=[s[0]-M,s[1]-O,s[0]+M,s[1]+O],j=v.getTileRangeForExtentAndZ(m,p),E={};E[p]={};var k=this.createLoadedTileFinder(c,o,E),T=this.tmpExtent,A=this.ty;this.Qd=!1;for(var C=j.minX;C<=j.maxX;++C)for(var P=j.minY;P<=j.maxY;++P){var R=this.getTile(p,C,P,t);if(this.isDrawableTile(R)){var I=d(this);if(R.getState()==cu){E[p][R.tileCoord.toString()]=R;var N=R.inTransition(I);this.Qd||!N&&-1!==this.renderedTiles.indexOf(R)||(this.Qd=!0)}if(1===R.getAlpha(I,t.time))continue}var z=v.getTileCoordChildTileRange(R.tileCoord,A,T),F=!1;z&&(F=k(p+1,z)),F||v.forEachTileCoordParentTileRange(R.tileCoord,k,A,T)}var L=y/u;Ze(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/b,1/b,a,-g/2,-x/2);var G=Je(this.pixelTransform);this.useContainer(n,G,i.opacity,this.getBackground(t));var D=this.context,U=D.canvas;He(this.inversePixelTransform,this.pixelTransform),Ze(this.tempTransform,g/2,x/2,L,L,0,-g/2,-x/2),U.width!=g||U.height!=x?(U.width=g,U.height=x):this.containerReused||D.clearRect(0,0,g,x),w&&this.clipUnrotated(D,t,w),c.getInterpolate()||W(D,oO),this.preRender(D,t),this.renderedTiles.length=0;var q,B,X,V=Object.keys(E).map(Number);V.sort(e),1!==i.opacity||this.containerReused&&!c.getOpaque(t.viewState.projection)?(q=[],B=[]):V=V.reverse();for(var Y=V.length-1;Y>=0;--Y){var Z=V[Y],H=c.getTilePixelSize(Z,f,o),K=v.getResolution(Z)/y,J=H[0]*K*L,$=H[1]*K*L,Q=v.getTileCoordForCoordAndZ(Or(S),Z),tt=v.getTileCoordExtent(Q),nt=Be(this.tempTransform,[b*(tt[0]-S[0])/y,b*(S[3]-tt[3])/y]),it=b*c.getGutterForProjection(o),rt=E[Z];for(var et in rt){var ot=(R=rt[et]).tileCoord,ut=Q[1]-ot[1],st=Math.round(nt[0]-(ut-1)*J),at=Q[2]-ot[2],ft=Math.round(nt[1]-(at-1)*$),ht=st-(C=Math.round(nt[0]-ut*J)),ct=ft-(P=Math.round(nt[1]-at*$)),lt=p===Z,vt=!1;if(!(N=lt&&1!==R.getAlpha(d(this),t.time)))if(q){X=[C,P,C+ht,P,C+ht,P+ct,C,P+ct];for(var pt=0,dt=q.length;pt<dt;++pt)if(p!==Z&&Z<B[pt]){var yt=q[pt];Er([C,P,C+ht,P+ct],[yt[0],yt[3],yt[4],yt[7]])&&(vt||(D.save(),vt=!0),D.beginPath(),D.moveTo(X[0],X[1]),D.lineTo(X[2],X[3]),D.lineTo(X[4],X[5]),D.lineTo(X[6],X[7]),D.moveTo(yt[6],yt[7]),D.lineTo(yt[4],yt[5]),D.lineTo(yt[2],yt[3]),D.lineTo(yt[0],yt[1]),D.clip())}q.push(X),B.push(Z)}else D.clearRect(C,P,ht,ct);this.drawTileImage(R,t,C,P,ht,ct,it,lt),q&&!N?(vt&&D.restore(),this.renderedTiles.unshift(R)):this.renderedTiles.push(R),this.updateUsedTiles(t.usedTiles,c,R)}}this.renderedRevision=l,this.renderedResolution=y,this.extentChanged=!this.dh||!sr(this.dh,S),this.dh=S,this.renderedPixelRatio=f,this.renderedProjection=o,this.manageTilePyramid(t,c,v,f,o,m,p,h.getPreload()),this.scheduleExpireCache(t,c),this.postRender(D,t),i.extent&&D.restore(),W(D,uO),G!==U.style.transform&&(U.style.transform=G);var mt=wn(i.opacity),wt=this.container;return mt!==wt.style.opacity&&(wt.style.opacity=mt),this.container},n.prototype.drawTileImage=function(t,n,i,r,e,o,u,s){var a=this.getTileImage(t);if(a){var f=d(this),h=s?t.getAlpha(f,n.time):1,c=h!==this.context.globalAlpha;c&&(this.context.save(),this.context.globalAlpha=h),this.context.drawImage(a,u,u,a.width-2*u,a.height-2*u,i,r,e,o),c&&this.context.restore(),1!==h?n.animate=!0:s&&t.endTransition(f)}},n.prototype.getImage=function(){var t=this.context;return t?t.canvas:null},n.prototype.getTileImage=function(t){return t.getImage()},n.prototype.scheduleExpireCache=function(t,n){if(n.canExpireCache()){var i=function(t,n,i){var r=d(t);r in i.usedTiles&&t.expireCache(i.viewState.projection,i.usedTiles[r])}.bind(null,n);t.postRenderFunctions.push(i)}},n.prototype.updateUsedTiles=function(t,n,i){var r=d(n);r in t||(t[r]={}),t[r][i.getKey()]=!0},n.prototype.manageTilePyramid=function(t,n,i,r,e,o,u,s,a){var f=d(n);f in t.wantedTiles||(t.wantedTiles[f]={});var h,c,l,v,p,y,m=t.wantedTiles[f],w=t.tileQueue,b=0;for(y=i.getMinZoom();y<=u;++y)for(c=i.getTileRangeForExtentAndZ(o,y,c),l=i.getResolution(y),v=c.minX;v<=c.maxX;++v)for(p=c.minY;p<=c.maxY;++p)u-y<=s?(++b,(h=n.getTile(y,v,p,r,e)).getState()==fu&&(m[h.getKey()]=!0,w.isKeyQueued(h.getKey())||w.enqueue([h,f,i.getTileCoordCenter(h.tileCoord),l])),void 0!==a&&a(h)):n.useTile(y,v,p,e);n.updateCacheSize(b,e)},n}(Wg),OO="image",SO="hybrid",jO="vector",EO=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),kO={image:[Jg,Yg,Kg,Hg,$g],hybrid:[Jg,Kg],vector:[]},TO={hybrid:[Hg,$g,Zg],vector:[Jg,Yg,Kg,Hg,$g,Zg]},AO=function(t){function n(n){var i=t.call(this,n)||this;return i.oh=i.uh.bind(i),i.ah=!1,i.ny,i.iy=null,i.mh,i.ey=[1,0,0,1,0,0],i}return EO(n,t),n.prototype.prepareTile=function(t,n,i){var r,e=t.getState();return e!==cu&&e!==lu||(this.oy(t,n,i),this.uy(t)&&(r=!0)),r},n.prototype.getTile=function(n,i,r,e){var o=e.pixelRatio,u=e.viewState,s=u.resolution,a=u.projection,f=this.getLayer(),h=f.getSource().getTile(n,i,r,o,a),c=e.viewHints,l=!(c[mu]||c[wu]);return!l&&h.wantedResolution||(h.wantedResolution=s),this.prepareTile(h,o,a)&&(l||Date.now()-e.time<8)&&f.getRenderMode()!==jO&&this.sy(h,e),t.prototype.getTile.call(this,n,i,r,e)},n.prototype.isDrawableTile=function(n){var i=this.getLayer();return t.prototype.isDrawableTile.call(this,n)&&(i.getRenderMode()===jO?d(i)in n.executorGroups:n.hasContext(i))},n.prototype.getTileImage=function(t){return t.getImage(this.getLayer())},n.prototype.prepareFrame=function(n){var i=this.getLayer().getRevision();return this.ny!=i&&(this.renderedTiles.length=0),this.ny=i,t.prototype.prepareFrame.call(this,n)},n.prototype.oy=function(t,n,i){var r=this.getLayer(),e=r.getRevision(),o=r.getRenderOrder()||null,u=t.wantedResolution,s=t.getReplayState(r);if(s.dirty||s.renderedResolution!==u||s.renderedRevision!=e||s.renderedRenderOrder!=o){var a=r.getSource(),f=r.getDeclutter(),h=a.getTileGrid(),c=a.getTileGridForProjection(i).getTileCoordExtent(t.wrappedTileCoord),l=a.getSourceTiles(n,i,t),v=d(r);delete t.hitDetectionImageData[v],t.executorGroups[v]=[],f&&(t.declutterExecutorGroups[v]=[]);for(var p=function(i,e){var p=l[i];if(p.getState()!=cu)return"continue";var d=p.tileCoord,m=h.getTileCoordExtent(d),w=Mr(c,m),b=Hi(w,r.getRenderBuffer()*u,y.tmpExtent),g=sr(m,w)?null:b;s.dirty=!1;var x=new Ug(0,b,u,n),_=f?new Ug(0,w,u,n):void 0,M=xx(u,n),O=function(t){var n,i=t.getStyleFunction()||r.getStyleFunction();if(i&&(n=i(t,u)),n){var e=this.renderFeature(t,M,n,x,_);this.ah=this.ah||e,s.dirty=s.dirty||e}},S=p.getFeatures();o&&o!==s.renderedRenderOrder&&S.sort(o);for(var j=0,E=S.length;j<E;++j){var k=S[j];g&&!Er(g,k.getGeometry().getExtent())||O.call(y,k)}var T=x.finish(),A=r.getRenderMode()!==jO&&f&&1===l.length?null:w,C=new vx(A,u,n,a.getOverlaps(),T,r.getRenderBuffer());if(t.executorGroups[v].push(C),_){var P=new vx(null,u,n,a.getOverlaps(),_.finish(),r.getRenderBuffer());t.declutterExecutorGroups[v].push(P)}},y=this,m=0,w=l.length;m<w;++m)p(m);s.renderedRevision=e,s.renderedRenderOrder=o,s.renderedResolution=u}},n.prototype.forEachFeatureAtCoordinate=function(t,n,i,r,e){var o=n.viewState.resolution,u=n.viewState.rotation;i=null==i?0:i;var s=this.getLayer(),a=s.getSource().getTileGridForProjection(n.viewState.projection),f=Zi([t]);Hi(f,o*i,f);for(var h,c={},l=function(t,n,i){var o=t.getId();void 0===o&&(o=d(t));var u=c[o];if(u){if(!0!==u&&i<u.distanceSq){if(0===i)return c[o]=!0,e.splice(e.lastIndexOf(u),1),r(t,s,n);u.geometry=n,u.distanceSq=i}}else{if(0===i)return c[o]=!0,r(t,s,n);e.push(c[o]={feature:t,layer:s,geometry:n,distanceSq:i,callback:r})}},v=this.renderedTiles,p=function(r,e){var c=v[r];if(!Er(a.getTileCoordExtent(c.wrappedTileCoord),f))return"continue";var p=d(s),y=[c.executorGroups[p]],m=c.declutterExecutorGroups[p];m&&y.push(m),y.some((function(r){for(var e=r===m?n.declutterTree.all().map((function(t){return t.value})):null,s=0,a=r.length;s<a;++s){var f=r[s];if(h=f.forEachFeatureAtCoordinate(t,o,u,i,l,e))return!0}}))},y=0,m=v.length;!h&&y<m;++y)p(y);return h},n.prototype.getFeatures=function(t){return new Promise(function(n,i){for(var r,e=this.getLayer(),o=d(e),u=e.getSource(),s=this.renderedProjection,a=s.getExtent(),f=this.renderedResolution,h=u.getTileGridForProjection(s),c=Be(this.iy,t.slice()),l=h.getTileCoordForCoordAndResolution(c,f),v=0,p=this.renderedTiles.length;v<p;++v)if(l.toString()===this.renderedTiles[v].tileCoord.toString()){if((r=this.renderedTiles[v]).getState()===cu){var y=h.getTileCoordExtent(r.tileCoord);u.getWrapX()&&s.canWrapX()&&!Qi(a,y)&&Zr(c,s);break}r=void 0}if(!r||r.loadingSourceTiles>0)n([]);else{var m=Or(h.getTileCoordExtent(r.wrappedTileCoord)),w=[(c[0]-m[0])/f,(m[1]-c[1])/f],b=r.getSourceTiles().reduce((function(t,n){return t.concat(n.getFeatures())}),[]),g=r.hitDetectionImageData[o];if(!g&&!this.sh){var x=ua(h.getTileSize(h.getZForResolution(f))),_=this.mh;g=mx(x,[this.getRenderTransform(h.getTileCoordCenter(r.wrappedTileCoord),f,0,yx,x[0]*yx,x[1]*yx,0)],b,e.getStyleFunction(),h.getTileCoordExtent(r.wrappedTileCoord),r.getReplayState(e).renderedResolution,_),r.hitDetectionImageData[o]=g}n(wx(w,b,g))}}.bind(this))},n.prototype.handleFontsChanged=function(){var t=this.getLayer();t.getVisible()&&void 0!==this.ny&&t.changed()},n.prototype.uh=function(t){this.renderIfReadyAndVisible()},n.prototype.renderDeclutter=function(t){var n=this.context,i=n.globalAlpha;n.globalAlpha=this.getLayer().getOpacity();for(var r=t.viewHints,e=!(r[mu]||r[wu]),o=this.renderedTiles,u=0,s=o.length;u<s;++u){var a=o[u],f=a.declutterExecutorGroups[d(this.getLayer())];if(f)for(var h=f.length-1;h>=0;--h)f[h].execute(this.context,1,this.getTileRenderTransform(a,t),t.viewState.rotation,e,void 0,t.declutterTree)}n.globalAlpha=i},n.prototype.getTileRenderTransform=function(t,n){var i=n.pixelRatio,r=n.viewState,e=r.center,o=r.resolution,u=r.rotation,s=n.size,a=Math.round(s[0]*i),f=Math.round(s[1]*i),h=this.getLayer().getSource().getTileGridForProjection(n.viewState.projection),c=t.tileCoord,l=h.getTileCoordExtent(t.wrappedTileCoord),v=h.getTileCoordExtent(c,this.tmpExtent)[0]-l[0];return De(Ve(this.inversePixelTransform.slice(),1/i,1/i),this.getRenderTransform(e,o,u,i,a,f,v))},n.prototype.renderFrame=function(n,i){var r=n.viewHints,e=!(r[mu]||r[wu]);t.prototype.renderFrame.call(this,n,i),this.iy=n.pixelToCoordinateTransform.slice(),this.mh=n.viewState.rotation;var o=this.getLayer(),u=o.getRenderMode(),s=this.context,a=s.globalAlpha;s.globalAlpha=o.getOpacity();for(var f=TO[u],h=n.viewState,c=h.rotation,l=o.getSource(),v=l.getTileGridForProjection(h.projection).getZForResolution(h.resolution,l.zDirection),p=this.renderedTiles,y=[],m=[],w=p.length-1;w>=0;--w){var b=p[w],g=b.executorGroups[d(o)].filter((function(t){return t.hasExecutors(f)}));if(0!==g.length){var x=this.getTileRenderTransform(b,n),_=b.tileCoord[0],M=!1,O=g[0].getClipCoords(x);if(O){for(var S=0,j=y.length;S<j;++S)if(v!==_&&_<m[S]){var E=y[S];Er([O[0],O[3],O[4],O[7]],[E[0],E[3],E[4],E[7]])&&(M||(s.save(),M=!0),s.beginPath(),s.moveTo(O[0],O[1]),s.lineTo(O[2],O[3]),s.lineTo(O[4],O[5]),s.lineTo(O[6],O[7]),s.moveTo(E[6],E[7]),s.lineTo(E[4],E[5]),s.lineTo(E[2],E[3]),s.lineTo(E[0],E[1]),s.clip())}y.push(O),m.push(_)}for(var k=0,T=g.length;k<T;++k){g[k].execute(s,1,x,c,e,f)}M&&s.restore()}}return s.globalAlpha=a,this.container},n.prototype.renderFeature=function(t,n,i,r,e){if(!i)return!1;var o=!1;if(Array.isArray(i))for(var u=0,s=i.length;u<s;++u)o=Mx(r,t,i[u],n,this.oh,void 0,e)||o;else o=Mx(r,t,i,n,this.oh,void 0,e);return o},n.prototype.uy=function(t){var n=this.getLayer();if(n.getRenderMode()===jO)return!1;var i=t.getReplayState(n),r=n.getRevision(),e=t.wantedResolution;return i.renderedTileResolution!==e||i.renderedTileRevision!==r},n.prototype.sy=function(t,n){var i=this.getLayer(),r=t.getReplayState(i),e=i.getRevision(),o=t.executorGroups[d(i)];r.renderedTileRevision=e;var u=t.wrappedTileCoord,s=u[0],a=i.getSource(),f=n.pixelRatio,h=n.viewState.projection,c=a.getTileGridForProjection(h),l=c.getResolution(t.tileCoord[0]),v=n.pixelRatio/t.wantedResolution*l,p=c.getResolution(s),y=t.getContext(i);f=Math.round(Math.max(f,v/f));var m=a.getTilePixelSize(s,f,h);y.canvas.width=m[0],y.canvas.height=m[1];var w=f/v;if(1!==w){var b=Ge(this.ey);Ve(b,w,w),y.setTransform.apply(y,b)}var g=c.getTileCoordExtent(u,this.tmpExtent),x=v/p,_=Ge(this.ey);Ve(_,x,-x),Ye(_,-g[0],-g[3]);for(var M=0,O=o.length;M<O;++M){o[M].execute(y,w,_,0,!0,kO[i.getRenderMode()])}r.renderedTileResolution=t.wantedResolution},n}(MO),CO=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),PO=function(t){function n(n){var i=this,r=n||{},e=W({},r);delete e.preload,delete e.useInterimTilesOnError,(i=t.call(this,e)||this).on,i.once,i.un,r.renderMode===OO&&(console.warn('renderMode: "image" is deprecated. Option ignored.'),r.renderMode=void 0);var o=r.renderMode||SO;return g(o==SO||o==jO,28),i.hy=o,i.setPreload(r.preload?r.preload:0),i.setUseInterimTilesOnError(void 0===r.useInterimTilesOnError||r.useInterimTilesOnError),i.getBackground,i.setBackground,i}return CO(n,t),n.prototype.createRenderer=function(){return new AO(this)},n.prototype.getFeatures=function(n){return t.prototype.getFeatures.call(this,n)},n.prototype.getRenderMode=function(){return this.hy},n.prototype.getPreload=function(){return this.get(Q_)},n.prototype.getUseInterimTilesOnError=function(){return this.get(tM)},n.prototype.setPreload=function(t){this.set(Q_,t)},n.prototype.setUseInterimTilesOnError=function(t){this.set(tM,t)},n}(xg),RO=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),IO=function(t){function n(n,i,r,e,o,u){var s=t.call(this,n,i,u)||this;return s.extent=null,s.Ah=e,s.$h=null,s.ge,s.projection=null,s.resolution,s.ta=o,s.Ch=r,s.key=r,s}return RO(n,t),n.prototype.getFormat=function(){return this.Ah},n.prototype.getFeatures=function(){return this.$h},n.prototype.load=function(){this.state==fu&&(this.setState(hu),this.ta(this,this.Ch),this.ge&&this.ge(this.extent,this.resolution,this.projection))},n.prototype.onLoad=function(t,n){this.setFeatures(t)},n.prototype.onError=function(){this.setState(lu)},n.prototype.setFeatures=function(t){this.$h=t,this.setState(cu)},n.prototype.setLoader=function(t){this.ge=t},n}(La),NO=function(){function t(t){this.highWaterMark=void 0!==t?t:2048,this.ly=0,this.vy={},this.py=null,this.yy=null}return t.prototype.canExpireCache=function(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark},t.prototype.expireCache=function(t){for(;this.canExpireCache();)this.pop()},t.prototype.clear=function(){this.ly=0,this.vy={},this.py=null,this.yy=null},t.prototype.containsKey=function(t){return this.vy.hasOwnProperty(t)},t.prototype.forEach=function(t){for(var n=this.py;n;)t(n.my,n.wy,this),n=n.newer},t.prototype.get=function(t,n){var i=this.vy[t];return g(void 0!==i,15),i===this.yy||(i===this.py?(this.py=this.py.newer,this.py.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.yy,this.yy.newer=i,this.yy=i),i.my},t.prototype.remove=function(t){var n=this.vy[t];return g(void 0!==n,15),n===this.yy?(this.yy=n.older,this.yy&&(this.yy.newer=null)):n===this.py?(this.py=n.newer,this.py&&(this.py.older=null)):(n.newer.older=n.older,n.older.newer=n.newer),delete this.vy[t],--this.ly,n.my},t.prototype.getCount=function(){return this.ly},t.prototype.getKeys=function(){var t,n=new Array(this.ly),i=0;for(t=this.yy;t;t=t.older)n[i++]=t.wy;return n},t.prototype.getValues=function(){var t,n=new Array(this.ly),i=0;for(t=this.yy;t;t=t.older)n[i++]=t.my;return n},t.prototype.peekLast=function(){return this.py.my},t.prototype.peekLastKey=function(){return this.py.wy},t.prototype.peekFirstKey=function(){return this.yy.wy},t.prototype.pop=function(){var t=this.py;return delete this.vy[t.wy],t.newer&&(t.newer.older=null),this.py=t.newer,this.py||(this.yy=null),--this.ly,t.my},t.prototype.replace=function(t,n){this.get(t),this.vy[t].my=n},t.prototype.set=function(t,n){g(!(t in this.vy),16);var i={wy:t,newer:null,older:this.yy,my:n};this.yy?this.yy.newer=i:this.py=i,this.yy=i,this.vy[t]=i,++this.ly},t.prototype.setSize=function(t){this.highWaterMark=t},t}();function zO(t,n,i,r){return void 0!==r?(r[0]=t,r[1]=n,r[2]=i,r):[t,n,i]}function FO(t,n,i){return t+"/"+n+"/"+i}function LO(t){return FO(t[0],t[1],t[2])}function GO(t){var n=t.substring(t.lastIndexOf("/")+1,t.length).split(",").map(Number);return FO(n[0],n[1],n[2])}function DO(t){return t.split("/").map(Number)}function UO(t){return(t[1]<<t[0])+t[2]}function qO(t,n){var i=t[0],r=t[1],e=t[2];if(n.getMinZoom()>i||i>n.getMaxZoom())return!1;var o=n.getFullTileRange(i);return!o||o.containsXY(r,e)}var BO=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),XO=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return BO(n,t),n.prototype.expireCache=function(t){for(;this.canExpireCache();){if(this.peekLast().getKey()in t)break;this.pop().release()}},n.prototype.pruneExceptNewestZ=function(){if(0!==this.getCount()){var t=DO(this.peekFirstKey())[0];this.forEach(function(n){n.tileCoord[0]!==t&&(this.remove(LO(n.tileCoord)),n.release())}.bind(this))}},n}(NO),VO="tileloadstart",WO="tileloadend",YO="tileloaderror",ZO=[0,0,0],HO=function(){function t(t){var n;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.ji=t.resolutions,g(l(this.ji,(function(t,n){return n-t}),!0),17),!t.origins)for(var i=0,r=this.ji.length-1;i<r;++i)if(n){if(this.ji[i]/this.ji[i+1]!==n){n=void 0;break}}else n=this.ji[i]/this.ji[i+1];this.Si=n,this.maxZoom=this.ji.length-1,this.Bo=void 0!==t.origin?t.origin:null,this.gy=null,void 0!==t.origins&&(this.gy=t.origins,g(this.gy.length==this.ji.length,20));var e=t.extent;void 0===e||this.Bo||this.gy||(this.Bo=Or(e)),g(!this.Bo&&this.gy||this.Bo&&!this.gy,18),this.xy=null,void 0!==t.tileSizes&&(this.xy=t.tileSizes,g(this.xy.length==this.ji.length,19)),this._y=void 0!==t.tileSize?t.tileSize:this.xy?null:gu,g(!this._y&&this.xy||this._y&&!this.xy,22),this.Ft=void 0!==e?e:null,this.My=null,this.Oy=[0,0],this.Sy=[0,0,0,0],void 0!==t.sizes?this.My=t.sizes.map((function(t,n){var i=new xO(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1));if(e){var r=this.getTileRangeForExtentAndZ(e,n);i.minX=Math.max(r.minX,i.minX),i.maxX=Math.min(r.maxX,i.maxX),i.minY=Math.max(r.minY,i.minY),i.maxY=Math.min(r.maxY,i.maxY)}return i}),this):e&&this.jy(e)}return t.prototype.forEachTileCoord=function(t,n,i){for(var r=this.getTileRangeForExtentAndZ(t,n),e=r.minX,o=r.maxX;e<=o;++e)for(var u=r.minY,s=r.maxY;u<=s;++u)i([n,e,u])},t.prototype.forEachTileCoordParentTileRange=function(t,n,i,r){var e,o,u=null,s=t[0]-1;for(2===this.Si?(e=t[1],o=t[2]):u=this.getTileCoordExtent(t,r);s>=this.minZoom;){if(n(s,2===this.Si?gO(e=Math.floor(e/2),e,o=Math.floor(o/2),o,i):this.getTileRangeForExtentAndZ(u,s,i)))return!0;--s}return!1},t.prototype.getExtent=function(){return this.Ft},t.prototype.getMaxZoom=function(){return this.maxZoom},t.prototype.getMinZoom=function(){return this.minZoom},t.prototype.getOrigin=function(t){return this.Bo?this.Bo:this.gy[t]},t.prototype.getResolution=function(t){return this.ji[t]},t.prototype.getResolutions=function(){return this.ji},t.prototype.getTileCoordChildTileRange=function(t,n,i){if(t[0]<this.maxZoom){if(2===this.Si){var r=2*t[1],e=2*t[2];return gO(r,r+1,e,e+1,n)}var o=this.getTileCoordExtent(t,i||this.Sy);return this.getTileRangeForExtentAndZ(o,t[0]+1,n)}return null},t.prototype.getTileRangeForTileCoordAndZ=function(t,n,i){if(n>this.maxZoom||n<this.minZoom)return null;var r=t[0],e=t[1],o=t[2];if(n===r)return gO(e,o,e,o,i);if(this.Si){var u=Math.pow(this.Si,n-r),s=Math.floor(e*u),a=Math.floor(o*u);return n<r?gO(s,s,a,a,i):gO(s,Math.floor(u*(e+1))-1,a,Math.floor(u*(o+1))-1,i)}var f=this.getTileCoordExtent(t,this.Sy);return this.getTileRangeForExtentAndZ(f,n,i)},t.prototype.getTileRangeExtent=function(t,n,i){var r=this.getOrigin(t),e=this.getResolution(t),o=ua(this.getTileSize(t),this.Oy),u=r[0]+n.minX*o[0]*e,s=r[0]+(n.maxX+1)*o[0]*e;return rr(u,r[1]+n.minY*o[1]*e,s,r[1]+(n.maxY+1)*o[1]*e,i)},t.prototype.getTileRangeForExtentAndZ=function(t,n,i){var r=ZO;this.Ey(t[0],t[3],n,!1,r);var e=r[1],o=r[2];return this.Ey(t[2],t[1],n,!0,r),gO(e,r[1],o,r[2],i)},t.prototype.getTileCoordCenter=function(t){var n=this.getOrigin(t[0]),i=this.getResolution(t[0]),r=ua(this.getTileSize(t[0]),this.Oy);return[n[0]+(t[1]+.5)*r[0]*i,n[1]-(t[2]+.5)*r[1]*i]},t.prototype.getTileCoordExtent=function(t,n){var i=this.getOrigin(t[0]),r=this.getResolution(t[0]),e=ua(this.getTileSize(t[0]),this.Oy),o=i[0]+t[1]*e[0]*r,u=i[1]-(t[2]+1)*e[1]*r;return rr(o,u,o+e[0]*r,u+e[1]*r,n)},t.prototype.getTileCoordForCoordAndResolution=function(t,n,i){return this.ky(t[0],t[1],n,!1,i)},t.prototype.ky=function(t,n,i,r,e){var o=this.getZForResolution(i),u=i/this.getResolution(o),s=this.getOrigin(o),a=ua(this.getTileSize(o),this.Oy),f=u*(t-s[0])/i/a[0],h=u*(s[1]-n)/i/a[1];return r?(f=I(f,5)-1,h=I(h,5)-1):(f=R(f,5),h=R(h,5)),zO(o,f,h,e)},t.prototype.Ey=function(t,n,i,r,e){var o=this.getOrigin(i),u=this.getResolution(i),s=ua(this.getTileSize(i),this.Oy),a=(t-o[0])/u/s[0],f=(o[1]-n)/u/s[1];return r?(a=I(a,5)-1,f=I(f,5)-1):(a=R(a,5),f=R(f,5)),zO(i,a,f,e)},t.prototype.getTileCoordForCoordAndZ=function(t,n,i){return this.Ey(t[0],t[1],n,!1,i)},t.prototype.getTileCoordResolution=function(t){return this.ji[t[0]]},t.prototype.getTileSize=function(t){return this._y?this._y:this.xy[t]},t.prototype.getFullTileRange=function(t){return this.My?this.My[t]:this.Ft?this.getTileRangeForExtentAndZ(this.Ft,t):null},t.prototype.getZForResolution=function(t,n){return x(u(this.ji,t,n||0),this.minZoom,this.maxZoom)},t.prototype.jy=function(t){for(var n=this.ji.length,i=new Array(n),r=this.minZoom;r<n;++r)i[r]=this.getTileRangeForExtentAndZ(t,r);this.My=i},t}();function KO(t){var n=t.getDefaultTileGrid();return n||(n=nS(t),t.setDefaultTileGrid(n)),n}function JO(t,n,i){var r=n[0],e=t.getTileCoordCenter(n),o=iS(i);if($i(o,e))return n;var u=jr(o),s=Math.ceil((o[0]-e[0])/u);return e[0]+=u*s,t.getTileCoordForCoordAndZ(e,r)}function $O(t,n,i,r){var e=void 0!==r?r:Di,o=tS(t,n,i);return new HO({extent:t,origin:gr(t,e),resolutions:o,tileSize:i})}function QO(t){var n=t||{},i=n.extent||ae("EPSG:3857").getExtent(),r={extent:i,minZoom:n.minZoom,tileSize:n.tileSize,resolutions:tS(i,n.maxZoom,n.tileSize,n.maxResolution)};return new HO(r)}function tS(t,n,i,r){for(var e=void 0!==n?n:42,o=_r(t),u=jr(t),s=ua(void 0!==i?i:gu),a=r>0?r:Math.max(u/s[0],o/s[1]),f=e+1,h=new Array(f),c=0;c<f;++c)h[c]=a/Math.pow(2,c);return h}function nS(t,n,i,r){return $O(iS(t),n,i,r)}function iS(t){var n=(t=ae(t)).getExtent();if(!n){var i=180*ci[li.DEGREES]/t.getMetersPerUnit();n=rr(-i,-i,i,i)}return n}var rS=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),eS=function(t){function n(n){var i=t.call(this,{attributions:n.attributions,attributionsCollapsible:n.attributionsCollapsible,projection:n.projection,state:n.state,wrapX:n.wrapX,interpolate:n.interpolate})||this;i.on,i.once,i.un,i.Ty=void 0!==n.opaque&&n.opaque,i.Ay=void 0!==n.tilePixelRatio?n.tilePixelRatio:1,i.tileGrid=void 0!==n.tileGrid?n.tileGrid:null;return i.tileGrid&&ua(i.tileGrid.getTileSize(i.tileGrid.getMinZoom()),[256,256]),i.tileCache=new XO(n.cacheSize||0),i.tmpSize=[0,0],i.wy=n.key||"",i.tileOptions={transition:n.transition,interpolate:n.interpolate},i.zDirection=n.zDirection?n.zDirection:0,i}return rS(n,t),n.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},n.prototype.expireCache=function(t,n){var i=this.getTileCacheForProjection(t);i&&i.expireCache(n)},n.prototype.forEachLoadedTile=function(t,n,i,r){var e=this.getTileCacheForProjection(t);if(!e)return!1;for(var o,u,s,a=!0,f=i.minX;f<=i.maxX;++f)for(var h=i.minY;h<=i.maxY;++h)u=FO(n,f,h),s=!1,e.containsKey(u)&&(s=(o=e.get(u)).getState()===cu)&&(s=!1!==r(o)),s||(a=!1);return a},n.prototype.getGutterForProjection=function(t){return 0},n.prototype.getKey=function(){return this.wy},n.prototype.setKey=function(t){this.wy!==t&&(this.wy=t,this.changed())},n.prototype.getOpaque=function(t){return this.Ty},n.prototype.getResolutions=function(){return this.tileGrid?this.tileGrid.getResolutions():null},n.prototype.getTile=function(t,n,i,r,e){return v()},n.prototype.getTileGrid=function(){return this.tileGrid},n.prototype.getTileGridForProjection=function(t){return this.tileGrid?this.tileGrid:KO(t)},n.prototype.getTileCacheForProjection=function(t){var n=this.getProjection();return g(null===n||ye(n,t),68),this.tileCache},n.prototype.getTilePixelRatio=function(t){return this.Ay},n.prototype.getTilePixelSize=function(t,n,i){var r=this.getTileGridForProjection(i),e=this.getTilePixelRatio(n),o=ua(r.getTileSize(t),this.tmpSize);return 1==e?o:oa(o,e,this.tmpSize)},n.prototype.getTileCoordForTileUrlFunction=function(t,n){var i=void 0!==n?n:this.getProjection(),r=this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(t=JO(r,t,i)),qO(t,r)?t:null},n.prototype.clear=function(){this.tileCache.clear()},n.prototype.refresh=function(){this.clear(),t.prototype.refresh.call(this)},n.prototype.updateCacheSize=function(t,n){var i=this.getTileCacheForProjection(n);t>i.highWaterMark&&(i.highWaterMark=t)},n.prototype.useTile=function(t,n,i,r){},n}(Px),oS=function(t){function n(n,i){var r=t.call(this,n)||this;return r.tile=i,r}return rS(n,t),n}(L),uS=eS;function sS(t,n){var i=/\{z\}/g,r=/\{x\}/g,e=/\{y\}/g,o=/\{-y\}/g;return function(u,s,a){return u?t.replace(i,u[0].toString()).replace(r,u[1].toString()).replace(e,u[2].toString()).replace(o,(function(){var t=u[0],i=n.getFullTileRange(t);return g(i,55),(i.getHeight()-u[2]-1).toString()})):void 0}}function aS(t,n){for(var i=t.length,r=new Array(i),e=0;e<i;++e)r[e]=sS(t[e],n);return fS(r)}function fS(t){return 1===t.length?t[0]:function(n,i,r){if(n){var e=T(UO(n),t.length);return t[e](n,i,r)}}}function hS(t,n,i){}function cS(t){var n=[],i=/\{([a-z])-([a-z])\}/.exec(t);if(i){var r=i[1].charCodeAt(0),e=i[2].charCodeAt(0),o=void 0;for(o=r;o<=e;++o)n.push(t.replace(i[0],String.fromCharCode(o)));return n}if(i=/\{(\d+)-(\d+)\}/.exec(t)){for(var u=parseInt(i[2],10),s=parseInt(i[1],10);s<=u;s++)n.push(t.replace(i[0],s.toString()));return n}return n.push(t),n}var lS=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),vS=function(t){function n(i){var r=t.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,opaque:i.opaque,projection:i.projection,state:i.state,tileGrid:i.tileGrid,tilePixelRatio:i.tilePixelRatio,wrapX:i.wrapX,transition:i.transition,interpolate:i.interpolate,key:i.key,attributionsCollapsible:i.attributionsCollapsible,zDirection:i.zDirection})||this;return r.Cy=r.tileUrlFunction===n.prototype.tileUrlFunction,r.tileLoadFunction=i.tileLoadFunction,i.tileUrlFunction&&(r.tileUrlFunction=i.tileUrlFunction),r.urls=null,i.urls?r.setUrls(i.urls):i.url&&r.setUrl(i.url),r.Py={},r}return lS(n,t),n.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},n.prototype.getTileUrlFunction=function(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction},n.prototype.getUrls=function(){return this.urls},n.prototype.handleTileChange=function(t){var n,i=t.target,r=d(i),e=i.getState();e==hu?(this.Py[r]=!0,n=VO):r in this.Py&&(delete this.Py[r],n=e==lu?YO:e==cu?WO:void 0),null!=n&&this.dispatchEvent(new oS(n,i))},n.prototype.setTileLoadFunction=function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()},n.prototype.setTileUrlFunction=function(t,n){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==n?this.setKey(n):this.changed()},n.prototype.setUrl=function(t){var n=cS(t);this.urls=n,this.setUrls(n)},n.prototype.setUrls=function(t){this.urls=t;var n=t.join("\n");this.Cy?this.setTileUrlFunction(aS(t,this.tileGrid),n):this.setKey(n)},n.prototype.tileUrlFunction=function(t,n,i){},n.prototype.useTile=function(t,n,i){var r=FO(t,n,i);this.tileCache.containsKey(r)&&this.tileCache.get(r)},n}(uS),pS=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),dS=[],yS=function(t){function n(n,i,r,e){var o=t.call(this,n,i,{transition:0})||this;return o.Pf={},o.executorGroups={},o.declutterExecutorGroups={},o.loadingSourceTiles=0,o.hitDetectionImageData={},o.Ry={},o.sourceTiles=[],o.errorTileKeys={},o.wantedResolution,o.getSourceTiles=e.bind(void 0,o),o.wrappedTileCoord=r,o}return pS(n,t),n.prototype.getContext=function(t){var n=d(t);return n in this.Pf||(this.Pf[n]=Qt(1,1,dS)),this.Pf[n]},n.prototype.hasContext=function(t){return d(t)in this.Pf},n.prototype.getImage=function(t){return this.hasContext(t)?this.getContext(t).canvas:null},n.prototype.getReplayState=function(t){var n=d(t);return n in this.Ry||(this.Ry[n]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedTileZ:-1}),this.Ry[n]},n.prototype.load=function(){this.getSourceTiles()},n.prototype.release=function(){for(var n in this.Pf)dS.push(this.Pf[n].canvas),delete this.Pf[n];t.prototype.release.call(this)},n}(La),mS=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),wS=function(t){function n(n){var i=this,r=n.projection||"EPSG:3857",e=n.extent||iS(r),o=n.tileGrid||QO({extent:e,maxResolution:n.maxResolution,maxZoom:void 0!==n.maxZoom?n.maxZoom:22,minZoom:n.minZoom,tileSize:n.tileSize||512});return(i=t.call(this,{attributions:n.attributions,attributionsCollapsible:n.attributionsCollapsible,cacheSize:n.cacheSize,interpolate:!0,opaque:!1,projection:r,state:n.state,tileGrid:o,tileLoadFunction:n.tileLoadFunction?n.tileLoadFunction:bS,tileUrlFunction:n.tileUrlFunction,url:n.url,urls:n.urls,wrapX:void 0===n.wrapX||n.wrapX,transition:n.transition,zDirection:void 0===n.zDirection?1:n.zDirection})||this).Ah=n.format?n.format:null,i.sourceTileCache=new XO(i.tileCache.highWaterMark),i.Ef=null==n.overlaps||n.overlaps,i.tileClass=n.tileClass?n.tileClass:IO,i.Iy={},i}return mS(n,t),n.prototype.getFeaturesInExtent=function(t){var n=[],i=this.tileCache;if(0===i.getCount())return n;var r=DO(i.peekFirstKey())[0],e=this.tileGrid;return i.forEach((function(i){if(i.tileCoord[0]===r&&i.getState()===cu)for(var o=i.getSourceTiles(),u=0,s=o.length;u<s;++u){var a=o[u],f=a.tileCoord;if(Er(t,e.getTileCoordExtent(f))){var h=a.getFeatures();if(h)for(var c=0,l=h.length;c<l;++c){var v=h[c],p=v.getGeometry();Er(t,p.getExtent())&&n.push(v)}}}})),n},n.prototype.getOverlaps=function(){return this.Ef},n.prototype.clear=function(){this.tileCache.clear(),this.sourceTileCache.clear()},n.prototype.expireCache=function(n,i){var r=this.getTileCacheForProjection(n),e=Object.keys(i).reduce((function(t,n){var i=GO(n);if(r.containsKey(i))for(var e=r.get(i).sourceTiles,o=0,u=e.length;o<u;++o)t[e[o].getKey()]=!0;return t}),{});t.prototype.expireCache.call(this,n,i),this.sourceTileCache.expireCache(e)},n.prototype.getSourceTiles=function(t,n,i){var r=this;if(i.getState()===fu){i.setState(hu);var e=i.wrappedTileCoord,o=this.getTileGridForProjection(n),u=o.getTileCoordExtent(e),s=e[0],a=o.getResolution(s);Hi(u,-a,u);var f=this.tileGrid,h=f.getExtent();h&&Mr(u,h,u);var c=f.getZForResolution(a,1);f.forEachTileCoord(u,c,(function(e){var o=r.tileUrlFunction(e,t,n),u=r.sourceTileCache.containsKey(o)?r.sourceTileCache.get(o):new r.tileClass(e,o?fu:vu,o,r.Ah,r.tileLoadFunction);i.sourceTiles.push(u);var s=u.getState();if(s<cu){u.addEventListener($,(function t(n){r.handleTileChange(n);var e=u.getState();if(e===cu||e===lu){var o=u.getKey();o in i.errorTileKeys?u.getState()===cu&&delete i.errorTileKeys[o]:i.loadingSourceTiles--,e===lu?i.errorTileKeys[o]=!0:u.removeEventListener($,t),0===i.loadingSourceTiles&&i.setState(H(i.errorTileKeys)?cu:lu)}})),i.loadingSourceTiles++}s===fu&&(u.extent=f.getTileCoordExtent(e),u.projection=n,u.resolution=f.getResolution(e[0]),r.sourceTileCache.set(o,u),u.load())})),i.loadingSourceTiles||i.setState(i.sourceTiles.some((function(t){return t.getState()===lu}))?lu:cu)}return i.sourceTiles},n.prototype.getTile=function(t,n,i,r,e){var o,u=FO(t,n,i),s=this.getKey();if(this.tileCache.containsKey(u)&&(o=this.tileCache.get(u)).key===s)return o;var a=[t,n,i],f=this.getTileCoordForTileUrlFunction(a,e),h=this.getTileGrid().getExtent(),c=this.getTileGridForProjection(e);if(f&&h){var l=c.getTileCoordExtent(f);Hi(l,-c.getResolution(t),l),Er(h,l)||(f=null)}var v=!0;if(null!==f){var p=this.tileGrid,d=c.getResolution(t),y=p.getZForResolution(d,1),m=c.getTileCoordExtent(f);Hi(m,-d,m),p.forEachTileCoord(m,y,function(t){v=v&&!this.tileUrlFunction(t,r,e)}.bind(this))}var w=new yS(a,v?vu:fu,f,this.getSourceTiles.bind(this,r,e));return w.key=s,o?(w.interimTile=o,w.refreshInterimChain(),this.tileCache.replace(u,w)):this.tileCache.set(u,w),w},n.prototype.getTileGridForProjection=function(t){var n=t.getCode(),i=this.Iy[n];if(!i){var r=this.tileGrid;i=nS(t,void 0,r?r.getTileSize(r.getMinZoom()):void 0),this.Iy[n]=i}return i},n.prototype.getTilePixelRatio=function(t){return t},n.prototype.getTilePixelSize=function(t,n,i){var r=ua(this.getTileGridForProjection(i).getTileSize(t),this.tmpSize);return[Math.round(r[0]*n),Math.round(r[1]*n)]},n.prototype.updateCacheSize=function(n,i){t.prototype.updateCacheSize.call(this,2*n,i),this.sourceTileCache.highWaterMark=this.getTileCacheForProjection(i).highWaterMark},n}(vS);function bS(t,n){t.setLoader((function(i,r,e){hf(n,t.getFormat(),i,r,e,t.onLoad.bind(t),t.onError.bind(t))}))}var gS=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();function xS(t,n){t.getImage().src=n}var _S=function(t){function n(n){var i=this,r=void 0===n.imageSmoothing||n.imageSmoothing;return void 0!==n.interpolate&&(r=n.interpolate),(i=t.call(this,{attributions:n.attributions,cacheSize:n.cacheSize,opaque:n.opaque,projection:n.projection,state:n.state,tileGrid:n.tileGrid,tileLoadFunction:n.tileLoadFunction?n.tileLoadFunction:xS,tilePixelRatio:n.tilePixelRatio,tileUrlFunction:n.tileUrlFunction,url:n.url,urls:n.urls,wrapX:n.wrapX,transition:n.transition,interpolate:r,key:n.key,attributionsCollapsible:n.attributionsCollapsible,zDirection:n.zDirection})||this).crossOrigin=void 0!==n.crossOrigin?n.crossOrigin:null,i.tileClass=void 0!==n.tileClass?n.tileClass:Db,i.tileCacheForProjection={},i.tileGridForProjection={},i.Ny=n.reprojectionErrorThreshold,i.zy=!1,i.ar,i}return gS(n,t),n.prototype.canExpireCache=function(){if(this.tileCache.canExpireCache())return!0;for(var t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1},n.prototype.expireCache=function(t,n){var i=this.getTileCacheForProjection(t);for(var r in this.tileCache.expireCache(this.tileCache==i?n:{}),this.tileCacheForProjection){var e=this.tileCacheForProjection[r];e.expireCache(e==i?n:{})}},n.prototype.getGutterForProjection=function(t){return this.getProjection()&&t&&!ye(this.getProjection(),t)?0:this.getGutter()},n.prototype.getGutter=function(){return 0},n.prototype.getKey=function(){var n=t.prototype.getKey.call(this);return this.getInterpolate()||(n+=":disable-interpolation"),n},n.prototype.getOpaque=function(n){return!(this.getProjection()&&n&&!ye(this.getProjection(),n))&&t.prototype.getOpaque.call(this,n)},n.prototype.getTileGridForProjection=function(t){var n=this.getProjection();if(!this.tileGrid||n&&!ye(n,t)){var i=d(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=KO(t)),this.tileGridForProjection[i]}return this.tileGrid},n.prototype.getTileCacheForProjection=function(t){var n=this.getProjection();if(!n||ye(n,t))return this.tileCache;var i=d(t);return i in this.tileCacheForProjection||(this.tileCacheForProjection[i]=new XO(this.tileCache.highWaterMark)),this.tileCacheForProjection[i]},n.prototype.Fy=function(t,n,i,r,e,o){var u=[t,n,i],s=this.getTileCoordForTileUrlFunction(u,e),a=s?this.tileUrlFunction(s,r,e):void 0,f=new this.tileClass(u,void 0!==a?fu:vu,void 0!==a?a:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return f.key=o,f.addEventListener($,this.handleTileChange.bind(this)),f},n.prototype.getTile=function(t,n,i,r,e){var o=this.getProjection();if(o&&e&&!ye(o,e)){var u=this.getTileCacheForProjection(e),s=[t,n,i],a=void 0,f=LO(s);u.containsKey(f)&&(a=u.get(f));var h=this.getKey();if(a&&a.key==h)return a;var c=this.getTileGridForProjection(o),l=this.getTileGridForProjection(e),v=this.getTileCoordForTileUrlFunction(s,e),p=new wO(o,c,e,l,s,v,this.getTilePixelRatio(r),this.getGutter(),function(t,n,i,r){return this.getTileInternal(t,n,i,r,o)}.bind(this),this.Ny,this.zy,this.getInterpolate());return p.key=h,a?(p.interimTile=a,p.refreshInterimChain(),u.replace(f,p)):u.set(f,p),p}return this.getTileInternal(t,n,i,r,o||e)},n.prototype.getTileInternal=function(t,n,i,r,e){var o=null,u=FO(t,n,i),s=this.getKey();if(this.tileCache.containsKey(u)){if((o=this.tileCache.get(u)).key!=s){var a=o;o=this.Fy(t,n,i,r,e,s),a.getState()==fu?o.interimTile=a.interimTile:o.interimTile=a,o.refreshInterimChain(),this.tileCache.replace(u,o)}}else o=this.Fy(t,n,i,r,e,s),this.tileCache.set(u,o);return o},n.prototype.setRenderReprojectionEdges=function(t){if(this.zy!=t){for(var n in this.zy=t,this.tileCacheForProjection)this.tileCacheForProjection[n].clear();this.changed()}},n.prototype.setTileGridForProjection=function(t,n){var i=ae(t);if(i){var r=d(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=n)}},n.prototype.getTileImage=function(t,n){var i=n||{},r=i.pixelRatio||1,e=ae(i.projection)||this.getProjection()||ae("EPSG:3857"),o=this;return o.ar||(o.ar=new du((function(){return 1}),B)),new Promise((function(n,i){var u=o.getState(),s=function(){if(u===Gn){var i=o.getTile(t[0],t[1],t[2],r,e);if(i){var s=i.getState();if(s===cu)n(i.getImage());else if(s===vu)n(void 0);else{var a=lt(i,$,(function(){var t=i.getState();t!==hu&&(pt(a),o.ar.loadMoreTiles(16,16),n(t===cu?i.getImage():void 0))}));s===lu&&(i.state=fu);var f=i.getKey();o.ar.isKeyQueued(f)||(o.ar.enqueue([i]),o.ar.loadMoreTiles(16,16))}return}}n(void 0)};if(u!==Ln)s();else var a=lt(o,$,(function(){(u=o.getState())!==Ln&&(pt(a),s())}))}))},n}(vS),MS=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();function OS(t,n,i,r){var e=document.createElement("script"),o="olc_"+d(n);function u(){delete window[o],e.parentNode.removeChild(e)}e.async=!0,e.src=t+(-1==t.indexOf("?")?"?":"&")+(r||"callback")+"="+o;var s=setTimeout((function(){u(),i&&i()}),1e4);window[o]=function(t){clearTimeout(s),u(),n(t)},document.head.appendChild(e)}var SS,jS=function(t){function n(n){var i=this,r="Unexpected response status: "+n.status;return(i=t.call(this,r)||this).name="ResponseError",i.response=n,i}return MS(n,t),n}(Error),ES=function(t){function n(n){var i=t.call(this,"Failed to issue request")||this;return i.name="ClientError",i.client=n,i}return MS(n,t),n}(Error);function kS(t){return new Promise((function(n,i){var r=new XMLHttpRequest;r.addEventListener("load",(function(t){var r=t.target;if(!r.status||r.status>=200&&r.status<300){var e=void 0;try{e=JSON.parse(r.responseText)}catch(t){var o="Error parsing response text as JSON: "+t.message;return void i(new Error(o))}n(e)}else i(new jS(r))})),r.addEventListener("error",(function(t){i(new ES(t.target))})),r.open("GET",t),r.setRequestHeader("Accept","application/json"),r.send()}))}function TS(t,n){return n.indexOf("://")>=0?n:new URL(n,t).href}var AS=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),CS=function(t){function n(n){var i=this,r=void 0===n.imageSmoothing||n.imageSmoothing;if(void 0!==n.interpolate&&(r=n.interpolate),(i=t.call(this,{attributions:n.attributions,cacheSize:n.cacheSize,crossOrigin:n.crossOrigin,interpolate:r,projection:ae("EPSG:3857"),reprojectionErrorThreshold:n.reprojectionErrorThreshold,state:Ln,tileLoadFunction:n.tileLoadFunction,wrapX:void 0===n.wrapX||n.wrapX,transition:n.transition,zDirection:n.zDirection})||this).Ly=null,i._y=n.tileSize,n.url)if(n.jsonp)OS(n.url,i.handleTileJSONResponse.bind(i),i.handleTileJSONError.bind(i));else{var e=new XMLHttpRequest;e.addEventListener("load",i.Gy.bind(i)),e.addEventListener("error",i.Dy.bind(i)),e.open("GET",n.url),e.send()}else n.tileJSON?i.handleTileJSONResponse(n.tileJSON):g(!1,51);return i}return AS(n,t),n.prototype.Gy=function(t){var n=t.target;if(!n.status||n.status>=200&&n.status<300){var i=void 0;try{i=JSON.parse(n.responseText)}catch(t){return void this.handleTileJSONError()}this.handleTileJSONResponse(i)}else this.handleTileJSONError()},n.prototype.Dy=function(t){this.handleTileJSONError()},n.prototype.getTileJSON=function(){return this.Ly},n.prototype.handleTileJSONResponse=function(t){var n,i=ae("EPSG:4326"),r=this.getProjection();if(void 0!==t.bounds){var e=me(i,r);n=Pr(t.bounds,e)}var o=iS(r),u=t.minzoom||0,s=QO({extent:o,maxZoom:t.maxzoom||22,minZoom:u,tileSize:this._y});if(this.tileGrid=s,this.tileUrlFunction=aS(t.tiles,s),void 0!==t.attribution&&!this.getAttributions()){var a=void 0!==n?n:o;this.setAttributions((function(n){return Er(a,n.extent)?[t.attribution]:null}))}this.Ly=t,this.setState(Gn)},n.prototype.handleTileJSONError=function(){this.setState(Dn)},n}(_S);function PS(t){return(PS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var RS,IS={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function NS(t){return(t=Math.round(t))<0?0:t>255?255:t}function zS(t){return t<0?0:t>1?1:t}function FS(t){return"%"===t[t.length-1]?NS(parseFloat(t)/100*255):NS(parseInt(t))}function LS(t){return"%"===t[t.length-1]?zS(parseFloat(t)/100):zS(parseFloat(t))}function GS(t,n,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?t+(n-t)*i*6:2*i<1?n:3*i<2?t+(n-t)*(2/3-i)*6:t}try{RS={}.parseCSSColor=function(t){var n,i=t.replace(/ /g,"").toLowerCase();if(i in IS)return IS[i].slice();if("#"===i[0])return 4===i.length?(n=parseInt(i.substr(1),16))>=0&&n<=4095?[(3840&n)>>4|(3840&n)>>8,240&n|(240&n)>>4,15&n|(15&n)<<4,1]:null:7===i.length&&(n=parseInt(i.substr(1),16))>=0&&n<=16777215?[(16711680&n)>>16,(65280&n)>>8,255&n,1]:null;var r=i.indexOf("("),e=i.indexOf(")");if(-1!==r&&e+1===i.length){var o=i.substr(0,r),u=i.substr(r+1,e-(r+1)).split(","),s=1;switch(o){case"rgba":if(4!==u.length)return null;s=LS(u.pop());case"rgb":return 3!==u.length?null:[FS(u[0]),FS(u[1]),FS(u[2]),s];case"hsla":if(4!==u.length)return null;s=LS(u.pop());case"hsl":if(3!==u.length)return null;var a=(parseFloat(u[0])%360+360)%360/360,f=LS(u[1]),h=LS(u[2]),c=h<=.5?h*(f+1):h+f-h*f,l=2*h-c;return[NS(255*GS(l,c,a+1/3)),NS(255*GS(l,c,a)),NS(255*GS(l,c,a-1/3)),s];default:return null}}return null}}catch(tC){}var DS=function(t,n,i,r){void 0===r&&(r=1),this.r=t,this.g=n,this.b=i,this.a=r};function US(t){return"object"===PS(t)?["literal",t]:t}function qS(t,n){var i=t.stops;if(!i)return function(t,n){var i=["get",t.property];if(void 0===t.default)return"string"===n.type?["string",i]:i;if("enum"===n.type)return["match",i,Object.keys(n.values),i,t.default];var r=["color"===n.type?"to-color":n.type,i,US(t.default)];return"array"===n.type&&r.splice(1,0,n.value,n.length||null),r}(t,n);var r=i&&"object"===PS(i[0][0]),e=r||void 0!==t.property,o=r||!e;return i=i.map((function(t){return!e&&n.tokens&&"string"==typeof t[1]?[t[0],HS(t[1])]:[t[0],US(t[1])]})),r?function(t,n,i){for(var r={},e={},o=[],u=0;u<i.length;u++){var s=i[u],a=s[0].zoom;void 0===r[a]&&(r[a]={zoom:a,type:t.type,property:t.property,default:t.default},e[a]=[],o.push(a)),e[a].push([s[0].value,s[1]])}if("exponential"===ZS({},n)){for(var f=[BS(t),["linear"],["zoom"]],h=0,c=o;h<c.length;h+=1){var l=c[h];YS(f,l,VS(r[l],n,e[l]),!1)}return f}for(var v=["step",["zoom"]],p=0,d=o;p<d.length;p+=1){var y=d[p];YS(v,y,VS(r[y],n,e[y]),!0)}return WS(v),v}(t,n,i):o?function(t,n,i,r){void 0===r&&(r=["zoom"]);var e,o=ZS(t,n),u=!1;if("interval"===o)e=["step",r],u=!0;else{if("exponential"!==o)throw new Error('Unknown zoom function type "'+o+'"');var s=void 0!==t.base?t.base:1;e=[BS(t),1===s?["linear"]:["exponential",s],r]}for(var a=0,f=i;a<f.length;a+=1){var h=f[a];YS(e,h[0],h[1],u)}return WS(e),e}(t,n,i):VS(t,n,i)}function BS(t){switch(t.colorSpace){case"hcl":return"interpolate-hcl";case"lab":return"interpolate-lab";default:return"interpolate"}}function XS(t,n){var i,r,e=US((i=t.default,r=n.default,void 0!==i?i:void 0!==r?r:void 0));return void 0===e&&"resolvedImage"===n.type?"":e}function VS(t,n,i){var r=ZS(t,n),e=["get",t.property];if("categorical"===r&&"boolean"==typeof i[0][0]){for(var o=["case"],u=0,s=i;u<s.length;u+=1){var a=s[u];o.push(["==",e,a[0]],a[1])}return o.push(XS(t,n)),o}if("categorical"===r){for(var f=["match",e],h=0,c=i;h<c.length;h+=1){var l=c[h];YS(f,l[0],l[1],!1)}return f.push(XS(t,n)),f}if("interval"===r){for(var v=["step",["number",e]],p=0,d=i;p<d.length;p+=1){var y=d[p];YS(v,y[0],y[1],!0)}return WS(v),void 0===t.default?v:["case",["==",["typeof",e],"number"],v,US(t.default)]}if("exponential"===r){for(var m=void 0!==t.base?t.base:1,w=[BS(t),1===m?["linear"]:["exponential",m],["number",e]],b=0,g=i;b<g.length;b+=1){var x=g[b];YS(w,x[0],x[1],!1)}return void 0===t.default?w:["case",["==",["typeof",e],"number"],w,US(t.default)]}throw new Error("Unknown property function type "+r)}function WS(t){"step"===t[0]&&3===t.length&&(t.push(0),t.push(t[3]))}function YS(t,n,i,r){t.length>3&&n===t[t.length-2]||(r&&2===t.length||t.push(n),t.push(i))}function ZS(t,n){return t.type?t.type:n.expression.interpolated?"exponential":"interval"}function HS(t){for(var n=["concat"],i=/{([^{}]+)}/g,r=0,e=i.exec(t);null!==e;e=i.exec(t)){var o=t.slice(r,i.lastIndex-e[0].length);r=i.lastIndex,o.length>0&&n.push(o),n.push(["get",e[1]])}if(1===n.length)return t;if(r<t.length)n.push(t.slice(r));else if(2===n.length)return["to-string",n[1]];return n}DS.parse=function(t){if(t){if(t instanceof DS)return t;if("string"==typeof t){var n=RS(t);if(n)return new DS(n[0]/255*n[3],n[1]/255*n[3],n[2]/255*n[3],n[3])}}},DS.prototype.toString=function(){var t=this.toArray(),n=t[0],i=t[1],r=t[2],e=t[3];return"rgba("+Math.round(n)+","+Math.round(i)+","+Math.round(r)+","+e+")"},DS.prototype.toArray=function(){var t=this,n=t.r,i=t.g,r=t.b,e=t.a;return 0===e?[0,0,0,0]:[255*n/e,255*i/e,255*r/e,e]},DS.black=new DS(0,0,0,1),DS.white=new DS(1,1,1,1),DS.transparent=new DS(0,0,0,0),DS.red=new DS(1,0,0,1),DS.blue=new DS(0,0,1,1);var KS=function(t){function n(n,i){t.call(this,i),this.message=i,this.key=n}return t&&(n.__proto__=t),n.prototype=Object.create(t&&t.prototype),n.prototype.constructor=n,n}(Error),JS=function(t,n){void 0===n&&(n=[]),this.parent=t,this.bindings={};for(var i=0,r=n;i<r.length;i+=1){var e=r[i],o=e[0],u=e[1];this.bindings[o]=u}};JS.prototype.concat=function(t){return new JS(this,t)},JS.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},JS.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var $S={kind:"null"},QS={kind:"number"},tj={kind:"string"},nj={kind:"boolean"},ij={kind:"color"},rj={kind:"object"},ej={kind:"value"},oj={kind:"collator"},uj={kind:"formatted"},sj={kind:"resolvedImage"};function aj(t,n){return{kind:"array",itemType:t,N:n}}function fj(t){if("array"===t.kind){var n=fj(t.itemType);return"number"==typeof t.N?"array<"+n+", "+t.N+">":"value"===t.itemType.kind?"array":"array<"+n+">"}return t.kind}var hj=[$S,QS,tj,nj,ij,uj,rj,aj(ej),sj];function cj(t,n){if("error"===n.kind)return null;if("array"===t.kind){if("array"===n.kind&&(0===n.N&&"value"===n.itemType.kind||!cj(t.itemType,n.itemType))&&("number"!=typeof t.N||t.N===n.N))return null}else{if(t.kind===n.kind)return null;if("value"===t.kind)for(var i=0,r=hj;i<r.length;i+=1){if(!cj(r[i],n))return null}}return"Expected "+fj(t)+" but found "+fj(n)+" instead."}function lj(t,n){return n.some((function(n){return n.kind===t.kind}))}function vj(t,n){return n.some((function(n){return"null"===n?null===t:"array"===n?Array.isArray(t):"object"===n?t&&!Array.isArray(t)&&"object"===PS(t):n===PS(t)}))}var pj=function(t,n,i){this.sensitivity=t?n?"variant":"case":n?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};pj.prototype.compare=function(t,n){return this.collator.compare(t,n)},pj.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var dj=function(t,n,i,r,e){this.text=t.normalize?t.normalize():t,this.image=n,this.scale=i,this.fontStack=r,this.textColor=e},yj=function(t){this.sections=t};yj.fromString=function(t){return new yj([new dj(t,null,null,null,null)])},yj.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some((function(t){return 0!==t.text.length||t.image&&0!==t.image.name.length}))},yj.factory=function(t){return t instanceof yj?t:yj.fromString(t)},yj.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map((function(t){return t.text})).join("")},yj.prototype.serialize=function(){for(var t=["format"],n=0,i=this.sections;n<i.length;n+=1){var r=i[n];if(r.image)t.push(["image",r.image.name]);else{t.push(r.text);var e={};r.fontStack&&(e["text-font"]=["literal",r.fontStack.split(",")]),r.scale&&(e["font-scale"]=r.scale),r.textColor&&(e["text-color"]=["rgba"].concat(r.textColor.toArray())),t.push(e)}}return t};var mj=function(t){this.name=t.name,this.available=t.available};function wj(t,n,i,r){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof n&&n>=0&&n<=255&&"number"==typeof i&&i>=0&&i<=255?void 0===r||"number"==typeof r&&r>=0&&r<=1?null:"Invalid rgba value ["+[t,n,i,r].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof r?[t,n,i,r]:[t,n,i]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function bj(t){if(null===t)return!0;if("string"==typeof t)return!0;if("boolean"==typeof t)return!0;if("number"==typeof t)return!0;if(t instanceof DS)return!0;if(t instanceof pj)return!0;if(t instanceof yj)return!0;if(t instanceof mj)return!0;if(Array.isArray(t)){for(var n=0,i=t;n<i.length;n+=1){if(!bj(i[n]))return!1}return!0}if("object"===PS(t)){for(var r in t)if(!bj(t[r]))return!1;return!0}return!1}function gj(t){if(null===t)return $S;if("string"==typeof t)return tj;if("boolean"==typeof t)return nj;if("number"==typeof t)return QS;if(t instanceof DS)return ij;if(t instanceof pj)return oj;if(t instanceof yj)return uj;if(t instanceof mj)return sj;if(Array.isArray(t)){for(var n,i=t.length,r=0,e=t;r<e.length;r+=1){var o=gj(e[r]);if(n){if(n===o)continue;n=ej;break}n=o}return aj(n||ej,i)}return rj}function xj(t){var n=PS(t);return null===t?"":"string"===n||"number"===n||"boolean"===n?String(t):t instanceof DS||t instanceof yj||t instanceof mj?t.toString():JSON.stringify(t)}mj.prototype.toString=function(){return this.name},mj.fromString=function(t){return t?new mj({name:t,available:!1}):null},mj.prototype.serialize=function(){return["image",this.name]};var _j=function(t,n){this.type=t,this.value=n};_j.parse=function(t,n){if(2!==t.length)return n.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!bj(t[1]))return n.error("invalid value");var i=t[1],r=gj(i),e=n.expectedType;return"array"!==r.kind||0!==r.N||!e||"array"!==e.kind||"number"==typeof e.N&&0!==e.N||(r=e),new _j(r,i)},_j.prototype.evaluate=function(){return this.value},_j.prototype.eachChild=function(){},_j.prototype.outputDefined=function(){return!0},_j.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof DS?["rgba"].concat(this.value.toArray()):this.value instanceof yj?this.value.serialize():this.value};var Mj=function(t){this.name="ExpressionEvaluationError",this.message=t};Mj.prototype.toJSON=function(){return this.message};var Oj={string:tj,number:QS,boolean:nj,object:rj},Sj=function(t,n){this.type=t,this.args=n};Sj.parse=function(t,n){if(t.length<2)return n.error("Expected at least one argument.");var i,r=1,e=t[0];if("array"===e){var o,u;if(t.length>2){var s=t[1];if("string"!=typeof s||!(s in Oj)||"object"===s)return n.error('The item type argument of "array" must be one of string, number, boolean',1);o=Oj[s],r++}else o=ej;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return n.error('The length argument to "array" must be a positive integer literal',2);u=t[2],r++}i=aj(o,u)}else i=Oj[e];for(var a=[];r<t.length;r++){var f=n.parse(t[r],r,ej);if(!f)return null;a.push(f)}return new Sj(i,a)},Sj.prototype.evaluate=function(t){for(var n=0;n<this.args.length;n++){var i=this.args[n].evaluate(t);if(!cj(this.type,gj(i)))return i;if(n===this.args.length-1)throw new Mj("Expected value to be of type "+fj(this.type)+", but found "+fj(gj(i))+" instead.")}return null},Sj.prototype.eachChild=function(t){this.args.forEach(t)},Sj.prototype.outputDefined=function(){return this.args.every((function(t){return t.outputDefined()}))},Sj.prototype.serialize=function(){var t=this.type,n=[t.kind];if("array"===t.kind){var i=t.itemType;if("string"===i.kind||"number"===i.kind||"boolean"===i.kind){n.push(i.kind);var r=t.N;("number"==typeof r||this.args.length>1)&&n.push(r)}}return n.concat(this.args.map((function(t){return t.serialize()})))};var jj=function(t){this.type=uj,this.sections=t};jj.parse=function(t,n){if(t.length<2)return n.error("Expected at least one argument.");var i=t[1];if(!Array.isArray(i)&&"object"===PS(i))return n.error("First argument must be an image or text section.");for(var r=[],e=!1,o=1;o<=t.length-1;++o){var u=t[o];if(e&&"object"===PS(u)&&!Array.isArray(u)){e=!1;var s=null;if(u["font-scale"]&&!(s=n.parse(u["font-scale"],1,QS)))return null;var a=null;if(u["text-font"]&&!(a=n.parse(u["text-font"],1,aj(tj))))return null;var f=null;if(u["text-color"]&&!(f=n.parse(u["text-color"],1,ij)))return null;var h=r[r.length-1];h.scale=s,h.font=a,h.textColor=f}else{var c=n.parse(t[o],1,ej);if(!c)return null;var l=c.type.kind;if("string"!==l&&"value"!==l&&"null"!==l&&"resolvedImage"!==l)return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");e=!0,r.push({content:c,scale:null,font:null,textColor:null})}}return new jj(r)},jj.prototype.evaluate=function(t){return new yj(this.sections.map((function(n){var i=n.content.evaluate(t);return gj(i)===sj?new dj("",i,null,null,null):new dj(xj(i),null,n.scale?n.scale.evaluate(t):null,n.font?n.font.evaluate(t).join(","):null,n.textColor?n.textColor.evaluate(t):null)})))},jj.prototype.eachChild=function(t){for(var n=0,i=this.sections;n<i.length;n+=1){var r=i[n];t(r.content),r.scale&&t(r.scale),r.font&&t(r.font),r.textColor&&t(r.textColor)}},jj.prototype.outputDefined=function(){return!1},jj.prototype.serialize=function(){for(var t=["format"],n=0,i=this.sections;n<i.length;n+=1){var r=i[n];t.push(r.content.serialize());var e={};r.scale&&(e["font-scale"]=r.scale.serialize()),r.font&&(e["text-font"]=r.font.serialize()),r.textColor&&(e["text-color"]=r.textColor.serialize()),t.push(e)}return t};var Ej=function(t){this.type=sj,this.input=t};Ej.parse=function(t,n){if(2!==t.length)return n.error("Expected two arguments.");var i=n.parse(t[1],1,tj);return i?new Ej(i):n.error("No image name provided.")},Ej.prototype.evaluate=function(t){var n=this.input.evaluate(t),i=mj.fromString(n);return i&&t.availableImages&&(i.available=t.availableImages.indexOf(n)>-1),i},Ej.prototype.eachChild=function(t){t(this.input)},Ej.prototype.outputDefined=function(){return!1},Ej.prototype.serialize=function(){return["image",this.input.serialize()]};var kj={"to-boolean":nj,"to-color":ij,"to-number":QS,"to-string":tj},Tj=function(t,n){this.type=t,this.args=n};Tj.parse=function(t,n){if(t.length<2)return n.error("Expected at least one argument.");var i=t[0];if(("to-boolean"===i||"to-string"===i)&&2!==t.length)return n.error("Expected one argument.");for(var r=kj[i],e=[],o=1;o<t.length;o++){var u=n.parse(t[o],o,ej);if(!u)return null;e.push(u)}return new Tj(r,e)},Tj.prototype.evaluate=function(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){for(var n,i,r=0,e=this.args;r<e.length;r+=1){if(i=null,(n=e[r].evaluate(t))instanceof DS)return n;if("string"==typeof n){var o=t.parseColor(n);if(o)return o}else if(Array.isArray(n)&&!(i=n.length<3||n.length>4?"Invalid rbga value "+JSON.stringify(n)+": expected an array containing either three or four numeric values.":wj(n[0],n[1],n[2],n[3])))return new DS(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new Mj(i||"Could not parse color from value '"+("string"==typeof n?n:String(JSON.stringify(n)))+"'")}if("number"===this.type.kind){for(var u=null,s=0,a=this.args;s<a.length;s+=1){if(null===(u=a[s].evaluate(t)))return 0;var f=Number(u);if(!isNaN(f))return f}throw new Mj("Could not convert "+JSON.stringify(u)+" to number.")}return"formatted"===this.type.kind?yj.fromString(xj(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?mj.fromString(xj(this.args[0].evaluate(t))):xj(this.args[0].evaluate(t))},Tj.prototype.eachChild=function(t){this.args.forEach(t)},Tj.prototype.outputDefined=function(){return this.args.every((function(t){return t.outputDefined()}))},Tj.prototype.serialize=function(){if("formatted"===this.type.kind)return new jj([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Ej(this.args[0]).serialize();var t=["to-"+this.type.kind];return this.eachChild((function(n){t.push(n.serialize())})),t};var Aj=["Unknown","Point","LineString","Polygon"],Cj=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null};Cj.prototype.id=function(){return this.feature&&"id"in this.feature&&this.feature.id?this.feature.id:null},Cj.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?Aj[this.feature.type]:this.feature.type:null},Cj.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Cj.prototype.canonicalID=function(){return this.canonical},Cj.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Cj.prototype.distanceFromCenter=function(){if(this.featureTileCoord&&this.featureDistanceData){var t=this.featureDistanceData.center,n=this.featureDistanceData.scale,i=this.featureTileCoord,r=i.x,e=i.y,o=r*n-t[0],u=e*n-t[1];return this.featureDistanceData.bearing[0]*o+this.featureDistanceData.bearing[1]*u}return 0},Cj.prototype.parseColor=function(t){var n=this._parseColorCache[t];return n||(n=this._parseColorCache[t]=DS.parse(t)),n};var Pj=function(t,n,i,r){this.name=t,this.type=n,this._evaluate=i,this.args=r};Pj.prototype.evaluate=function(t){return this._evaluate(t,this.args)},Pj.prototype.eachChild=function(t){this.args.forEach(t)},Pj.prototype.outputDefined=function(){return!1},Pj.prototype.serialize=function(){return[this.name].concat(this.args.map((function(t){return t.serialize()})))},Pj.parse=function(t,n){var i,r=t[0],e=Pj.definitions[r];if(!e)return n.error('Unknown expression "'+r+'". If you wanted a literal array, use ["literal", [...]].',0);for(var o=Array.isArray(e)?e[0]:e.type,u=Array.isArray(e)?[[e[1],e[2]]]:e.overloads,s=u.filter((function(n){var i=n[0];return!Array.isArray(i)||i.length===t.length-1})),a=null,f=0,h=s;f<h.length;f+=1){var c=h[f],l=c[0],v=c[1];a=new iE(n.registry,n.path,null,n.scope);for(var p=[],d=!1,y=1;y<t.length;y++){var m=t[y],w=Array.isArray(l)?l[y-1]:l.type,b=a.parse(m,1+p.length,w);if(!b){d=!0;break}p.push(b)}if(!d)if(Array.isArray(l)&&l.length!==p.length)a.error("Expected "+l.length+" arguments, but found "+p.length+" instead.");else{for(var g=0;g<p.length;g++){var x=Array.isArray(l)?l[g]:l.type,_=p[g];a.concat(g+1).checkSubtype(x,_.type)}if(0===a.errors.length)return new Pj(r,o,v,p)}}if(1===s.length)(i=n.errors).push.apply(i,a.errors);else{for(var M=(s.length?s:u).map((function(t){var n,i=t[0];return n=i,Array.isArray(n)?"("+n.map(fj).join(", ")+")":"("+fj(n.type)+"...)"})).join(" | "),O=[],S=1;S<t.length;S++){var j=n.parse(t[S],1+O.length);if(!j)return null;O.push(fj(j.type))}n.error("Expected arguments of type "+M+", but found ("+O.join(", ")+") instead.")}return null},Pj.register=function(t,n){for(var i in Pj.definitions=n,n)t[i]=Pj};var Rj=function(t,n,i){this.type=oj,this.locale=i,this.caseSensitive=t,this.diacriticSensitive=n};Rj.parse=function(t,n){if(2!==t.length)return n.error("Expected one argument.");var i=t[1];if("object"!==PS(i)||Array.isArray(i))return n.error("Collator options argument must be an object.");var r=n.parse(void 0!==i["case-sensitive"]&&i["case-sensitive"],1,nj);if(!r)return null;var e=n.parse(void 0!==i["diacritic-sensitive"]&&i["diacritic-sensitive"],1,nj);if(!e)return null;var o=null;return i.locale&&!(o=n.parse(i.locale,1,tj))?null:new Rj(r,e,o)},Rj.prototype.evaluate=function(t){return new pj(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},Rj.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},Rj.prototype.outputDefined=function(){return!1},Rj.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};var Ij=8192;function Nj(t,n){t[0]=Math.min(t[0],n[0]),t[1]=Math.min(t[1],n[1]),t[2]=Math.max(t[2],n[0]),t[3]=Math.max(t[3],n[1])}function zj(t,n){return!(t[0]<=n[0])&&(!(t[2]>=n[2])&&(!(t[1]<=n[1])&&!(t[3]>=n[3])))}function Fj(t,n){var i,r=(180+t[0])/360,e=(i=t[1],(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360),o=Math.pow(2,n.z);return[Math.round(r*o*Ij),Math.round(e*o*Ij)]}function Lj(t,n,i){var r=t[0]-n[0],e=t[1]-n[1],o=t[0]-i[0],u=t[1]-i[1];return r*u-o*e==0&&r*o<=0&&e*u<=0}function Gj(t,n,i){return n[1]>t[1]!=i[1]>t[1]&&t[0]<(i[0]-n[0])*(t[1]-n[1])/(i[1]-n[1])+n[0]}function Dj(t,n){for(var i=!1,r=0,e=n.length;r<e;r++)for(var o=n[r],u=0,s=o.length;u<s-1;u++){if(Lj(t,o[u],o[u+1]))return!1;Gj(t,o[u],o[u+1])&&(i=!i)}return i}function Uj(t,n){for(var i=0;i<n.length;i++)if(Dj(t,n[i]))return!0;return!1}function qj(t,n,i,r){var e=t[0]-i[0],o=t[1]-i[1],u=n[0]-i[0],s=n[1]-i[1],a=r[0]-i[0],f=r[1]-i[1],h=e*f-a*o,c=u*f-a*s;return h>0&&c<0||h<0&&c>0}function Bj(t,n,i){for(var r=0,e=i;r<e.length;r+=1)for(var o=e[r],u=0;u<o.length-1;++u)if(s=t,a=n,f=o[u],h=o[u+1],c=void 0,l=void 0,v=void 0,p=void 0,v=[a[0]-s[0],a[1]-s[1]],p=[h[0]-f[0],h[1]-f[1]],0!=(c=p)[0]*(l=v)[1]-c[1]*l[0]&&qj(s,a,f,h)&&qj(f,h,s,a))return!0;var s,a,f,h,c,l,v,p;return!1}function Xj(t,n){for(var i=0;i<t.length;++i)if(!Dj(t[i],n))return!1;for(var r=0;r<t.length-1;++r)if(Bj(t[r],t[r+1],n))return!1;return!0}function Vj(t,n){for(var i=0;i<n.length;i++)if(Xj(t,n[i]))return!0;return!1}function Wj(t,n,i){for(var r=[],e=0;e<t.length;e++){for(var o=[],u=0;u<t[e].length;u++){var s=Fj(t[e][u],i);Nj(n,s),o.push(s)}r.push(o)}return r}function Yj(t,n,i){for(var r=[],e=0;e<t.length;e++){var o=Wj(t[e],n,i);r.push(o)}return r}function Zj(t,n,i,r){if(t[0]<i[0]||t[0]>i[2]){var e=.5*r,o=t[0]-i[0]>e?-r:i[0]-t[0]>e?r:0;0===o&&(o=t[0]-i[2]>e?-r:i[2]-t[0]>e?r:0),t[0]+=o}Nj(n,t)}function Hj(t,n,i,r){var e=Math.pow(2,r.z)*Ij,o=[r.x*Ij,r.y*Ij],u=[];if(!t)return u;for(var s=0,a=t;s<a.length;s+=1)for(var f=0,h=a[s];f<h.length;f+=1){var c=h[f],l=[c.x+o[0],c.y+o[1]];Zj(l,n,i,e),u.push(l)}return u}function Kj(t,n,i,r){var e=Math.pow(2,r.z)*Ij,o=[r.x*Ij,r.y*Ij],u=[];if(!t)return u;for(var s=0,a=t;s<a.length;s+=1){for(var f=[],h=0,c=a[s];h<c.length;h+=1){var l=c[h],v=[l.x+o[0],l.y+o[1]];Nj(n,v),f.push(v)}u.push(f)}if(n[2]-n[0]<=e/2){!function(t){t[0]=t[1]=1/0,t[2]=t[3]=-1/0}(n);for(var p=0,d=u;p<d.length;p+=1)for(var y=0,m=d[p];y<m.length;y+=1){Zj(m[y],n,i,e)}}return u}var Jj=function(t,n){this.type=nj,this.geojson=t,this.geometries=n};function $j(t){if(t instanceof Pj){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}if(t instanceof Jj)return!1;var n=!0;return t.eachChild((function(t){n&&!$j(t)&&(n=!1)})),n}function Qj(t){if(t instanceof Pj&&"feature-state"===t.name)return!1;var n=!0;return t.eachChild((function(t){n&&!Qj(t)&&(n=!1)})),n}function tE(t,n){if(t instanceof Pj&&n.indexOf(t.name)>=0)return!1;var i=!0;return t.eachChild((function(t){i&&!tE(t,n)&&(i=!1)})),i}Jj.parse=function(t,n){if(2!==t.length)return n.error("'within' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(bj(t[1])){var i=t[1];if("FeatureCollection"===i.type)for(var r=0;r<i.features.length;++r){var e=i.features[r].geometry.type;if("Polygon"===e||"MultiPolygon"===e)return new Jj(i,i.features[r].geometry)}else if("Feature"===i.type){var o=i.geometry.type;if("Polygon"===o||"MultiPolygon"===o)return new Jj(i,i.geometry)}else if("Polygon"===i.type||"MultiPolygon"===i.type)return new Jj(i,i)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Jj.prototype.evaluate=function(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(t,n){var i=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],e=t.canonicalID();if(!e)return!1;if("Polygon"===n.type){var o=Wj(n.coordinates,r,e),u=Hj(t.geometry(),i,r,e);if(!zj(i,r))return!1;for(var s=0,a=u;s<a.length;s+=1)if(!Dj(a[s],o))return!1}if("MultiPolygon"===n.type){var f=Yj(n.coordinates,r,e),h=Hj(t.geometry(),i,r,e);if(!zj(i,r))return!1;for(var c=0,l=h;c<l.length;c+=1)if(!Uj(l[c],f))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(t,n){var i=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],e=t.canonicalID();if(!e)return!1;if("Polygon"===n.type){var o=Wj(n.coordinates,r,e),u=Kj(t.geometry(),i,r,e);if(!zj(i,r))return!1;for(var s=0,a=u;s<a.length;s+=1)if(!Xj(a[s],o))return!1}if("MultiPolygon"===n.type){var f=Yj(n.coordinates,r,e),h=Kj(t.geometry(),i,r,e);if(!zj(i,r))return!1;for(var c=0,l=h;c<l.length;c+=1)if(!Vj(l[c],f))return!1}return!0}(t,this.geometries)}return!1},Jj.prototype.eachChild=function(){},Jj.prototype.outputDefined=function(){return!0},Jj.prototype.serialize=function(){return["within",this.geojson]};var nE=function(t,n){this.type=n.type,this.name=t,this.boundExpression=n};nE.parse=function(t,n){if(2!==t.length||"string"!=typeof t[1])return n.error("'var' expression requires exactly one string literal argument.");var i=t[1];return n.scope.has(i)?new nE(i,n.scope.get(i)):n.error('Unknown variable "'+i+'". Make sure "'+i+'" has been bound in an enclosing "let" expression before using it.',1)},nE.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},nE.prototype.eachChild=function(){},nE.prototype.outputDefined=function(){return!1},nE.prototype.serialize=function(){return["var",this.name]};var iE=function(t,n,i,r,e){void 0===n&&(n=[]),void 0===r&&(r=new JS),void 0===e&&(e=[]),this.registry=t,this.path=n,this.key=n.map((function(t){return"["+t+"]"})).join(""),this.scope=r,this.errors=e,this.expectedType=i};function rE(t){if(t instanceof nE)return rE(t.boundExpression);if(t instanceof Pj&&"error"===t.name)return!1;if(t instanceof Rj)return!1;if(t instanceof Jj)return!1;var n=t instanceof Tj||t instanceof Sj,i=!0;return t.eachChild((function(t){i=n?i&&rE(t):i&&t instanceof _j})),!!i&&($j(t)&&tE(t,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"]))}function eE(t,n){for(var i,r,e=t.length-1,o=0,u=e,s=0;o<=u;)if(i=t[s=Math.floor((o+u)/2)],r=t[s+1],i<=n){if(s===e||n<r)return s;o=s+1}else{if(!(i>n))throw new Mj("Input is not a number.");u=s-1}return 0}iE.prototype.parse=function(t,n,i,r,e){return void 0===e&&(e={}),n?this.concat(n,i,r)._parse(t,e):this._parse(t,e)},iE.prototype._parse=function(t,n){function i(t,n,i){return"assert"===i?new Sj(n,[t]):"coerce"===i?new Tj(n,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var r=t[0];if("string"!=typeof r)return this.error("Expression name must be a string, but found "+PS(r)+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var e=this.registry[r];if(e){var o=e.parse(t,this);if(!o)return null;if(this.expectedType){var u=this.expectedType,s=o.type;if("string"!==u.kind&&"number"!==u.kind&&"boolean"!==u.kind&&"object"!==u.kind&&"array"!==u.kind||"value"!==s.kind)if("color"!==u.kind&&"formatted"!==u.kind&&"resolvedImage"!==u.kind||"value"!==s.kind&&"string"!==s.kind){if(this.checkSubtype(u,s))return null}else o=i(o,u,n.typeAnnotation||"coerce");else o=i(o,u,n.typeAnnotation||"assert")}if(!(o instanceof _j)&&"resolvedImage"!==o.type.kind&&rE(o)){var a=new Cj;try{o=new _j(o.type,o.evaluate(a))}catch(t){return this.error(t.message),null}}return o}return this.error('Unknown expression "'+r+'". If you wanted a literal array, use ["literal", [...]].',0)}return void 0===t?this.error("'undefined' value invalid. Use null instead."):"object"===PS(t)?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+PS(t)+" instead.")},iE.prototype.concat=function(t,n,i){var r="number"==typeof t?this.path.concat(t):this.path,e=i?this.scope.concat(i):this.scope;return new iE(this.registry,r,n||null,e,this.errors)},iE.prototype.error=function(t){for(var n=[],i=arguments.length-1;i-- >0;)n[i]=arguments[i+1];var r=""+this.key+n.map((function(t){return"["+t+"]"})).join("");this.errors.push(new KS(r,t))},iE.prototype.checkSubtype=function(t,n){var i=cj(t,n);return i&&this.error(i),i};var oE=function(t,n,i){this.type=t,this.input=n,this.labels=[],this.outputs=[];for(var r=0,e=i;r<e.length;r+=1){var o=e[r],u=o[0],s=o[1];this.labels.push(u),this.outputs.push(s)}};oE.parse=function(t,n){if(t.length-1<4)return n.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");var i=n.parse(t[1],1,QS);if(!i)return null;var r=[],e=null;n.expectedType&&"value"!==n.expectedType.kind&&(e=n.expectedType);for(var o=1;o<t.length;o+=2){var u=1===o?-1/0:t[o],s=t[o+1],a=o,f=o+1;if("number"!=typeof u)return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',a);if(r.length&&r[r.length-1][0]>=u)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',a);var h=n.parse(s,f,e);if(!h)return null;e=e||h.type,r.push([u,h])}return new oE(e,i,r)},oE.prototype.evaluate=function(t){var n=this.labels,i=this.outputs;if(1===n.length)return i[0].evaluate(t);var r=this.input.evaluate(t);if(r<=n[0])return i[0].evaluate(t);var e=n.length;return r>=n[e-1]?i[e-1].evaluate(t):i[eE(n,r)].evaluate(t)},oE.prototype.eachChild=function(t){t(this.input);for(var n=0,i=this.outputs;n<i.length;n+=1){t(i[n])}},oE.prototype.outputDefined=function(){return this.outputs.every((function(t){return t.outputDefined()}))},oE.prototype.serialize=function(){for(var t=["step",this.input.serialize()],n=0;n<this.labels.length;n++)n>0&&t.push(this.labels[n]),t.push(this.outputs[n].serialize());return t};var uE=sE;function sE(t,n,i,r){this.cx=3*t,this.bx=3*(i-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(r-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=r,this.p2x=i,this.p2y=r}function aE(t,n,i){return t*(1-i)+n*i}sE.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sE.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},sE.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},sE.prototype.solveCurveX=function(t,n){var i,r,e,o,u;for(void 0===n&&(n=1e-6),e=t,u=0;u<8;u++){if(o=this.sampleCurveX(e)-t,Math.abs(o)<n)return e;var s=this.sampleCurveDerivativeX(e);if(Math.abs(s)<1e-6)break;e-=o/s}if((e=t)<(i=0))return i;if(e>(r=1))return r;for(;i<r;){if(o=this.sampleCurveX(e),Math.abs(o-t)<n)return e;t>o?i=e:r=e,e=.5*(r-i)+i}return e},sE.prototype.solve=function(t,n){return this.sampleCurveY(this.solveCurveX(t,n))};var fE=Object.freeze({__proto__:null,number:aE,color:function(t,n,i){return new DS(aE(t.r,n.r,i),aE(t.g,n.g,i),aE(t.b,n.b,i),aE(t.a,n.a,i))},array:function(t,n,i){return t.map((function(t,r){return aE(t,n[r],i)}))}}),hE=.95047,cE=1.08883,lE=4/29,vE=6/29,pE=3*vE*vE,dE=Math.PI/180,yE=180/Math.PI;function mE(t){return t>.008856451679035631?Math.pow(t,1/3):t/pE+lE}function wE(t){return t>vE?t*t*t:pE*(t-lE)}function bE(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function gE(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function xE(t){var n=gE(t.r),i=gE(t.g),r=gE(t.b),e=mE((.4124564*n+.3575761*i+.1804375*r)/hE),o=mE((.2126729*n+.7151522*i+.072175*r)/1);return{l:116*o-16,a:500*(e-o),b:200*(o-mE((.0193339*n+.119192*i+.9503041*r)/cE)),alpha:t.a}}function _E(t){var n=(t.l+16)/116,i=isNaN(t.a)?n:n+t.a/500,r=isNaN(t.b)?n:n-t.b/200;return n=1*wE(n),i=hE*wE(i),r=cE*wE(r),new DS(bE(3.2404542*i-1.5371385*n-.4985314*r),bE(-.969266*i+1.8760108*n+.041556*r),bE(.0556434*i-.2040259*n+1.0572252*r),t.alpha)}function ME(t,n,i){var r=n-t;return t+i*(r>180||r<-180?r-360*Math.round(r/360):r)}var OE={forward:xE,reverse:_E,interpolate:function(t,n,i){return{l:aE(t.l,n.l,i),a:aE(t.a,n.a,i),b:aE(t.b,n.b,i),alpha:aE(t.alpha,n.alpha,i)}}},SE={forward:function(t){var n=xE(t),i=n.l,r=n.a,e=n.b,o=Math.atan2(e,r)*yE;return{h:o<0?o+360:o,c:Math.sqrt(r*r+e*e),l:i,alpha:t.a}},reverse:function(t){var n=t.h*dE,i=t.c;return _E({l:t.l,a:Math.cos(n)*i,b:Math.sin(n)*i,alpha:t.alpha})},interpolate:function(t,n,i){return{h:ME(t.h,n.h,i),c:aE(t.c,n.c,i),l:aE(t.l,n.l,i),alpha:aE(t.alpha,n.alpha,i)}}},jE=function(t,n,i,r,e){this.type=t,this.operator=n,this.interpolation=i,this.input=r,this.labels=[],this.outputs=[];for(var o=0,u=e;o<u.length;o+=1){var s=u[o],a=s[0],f=s[1];this.labels.push(a),this.outputs.push(f)}};function EE(t,n,i,r){var e=r-i,o=t-i;return 0===e?0:1===n?o/e:(Math.pow(n,o)-1)/(Math.pow(n,e)-1)}jE.interpolationFactor=function(t,n,i,r){var e=0;if("exponential"===t.name)e=EE(n,t.base,i,r);else if("linear"===t.name)e=EE(n,1,i,r);else if("cubic-bezier"===t.name){var o=t.controlPoints;e=new uE(o[0],o[1],o[2],o[3]).solve(EE(n,1,i,r))}return e},jE.parse=function(t,n){var i=t[0],r=t[1],e=t[2],o=t.slice(3);if(!Array.isArray(r)||0===r.length)return n.error("Expected an interpolation type expression.",1);if("linear"===r[0])r={name:"linear"};else if("exponential"===r[0]){var u=r[1];if("number"!=typeof u)return n.error("Exponential interpolation requires a numeric base.",1,1);r={name:"exponential",base:u}}else{if("cubic-bezier"!==r[0])return n.error("Unknown interpolation type "+String(r[0]),1,0);var s=r.slice(1);if(4!==s.length||s.some((function(t){return"number"!=typeof t||t<0||t>1})))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);r={name:"cubic-bezier",controlPoints:s}}if(t.length-1<4)return n.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(!(e=n.parse(e,2,QS)))return null;var a=[],f=null;"interpolate-hcl"===i||"interpolate-lab"===i?f=ij:n.expectedType&&"value"!==n.expectedType.kind&&(f=n.expectedType);for(var h=0;h<o.length;h+=2){var c=o[h],l=o[h+1],v=h+3,p=h+4;if("number"!=typeof c)return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',v);if(a.length&&a[a.length-1][0]>=c)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',v);var d=n.parse(l,p,f);if(!d)return null;f=f||d.type,a.push([c,d])}return"number"===f.kind||"color"===f.kind||"array"===f.kind&&"number"===f.itemType.kind&&"number"==typeof f.N?new jE(f,i,r,e,a):n.error("Type "+fj(f)+" is not interpolatable.")},jE.prototype.evaluate=function(t){var n=this.labels,i=this.outputs;if(1===n.length)return i[0].evaluate(t);var r=this.input.evaluate(t);if(r<=n[0])return i[0].evaluate(t);var e=n.length;if(r>=n[e-1])return i[e-1].evaluate(t);var o=eE(n,r),u=n[o],s=n[o+1],a=jE.interpolationFactor(this.interpolation,r,u,s),f=i[o].evaluate(t),h=i[o+1].evaluate(t);return"interpolate"===this.operator?fE[this.type.kind.toLowerCase()](f,h,a):"interpolate-hcl"===this.operator?SE.reverse(SE.interpolate(SE.forward(f),SE.forward(h),a)):OE.reverse(OE.interpolate(OE.forward(f),OE.forward(h),a))},jE.prototype.eachChild=function(t){t(this.input);for(var n=0,i=this.outputs;n<i.length;n+=1){t(i[n])}},jE.prototype.outputDefined=function(){return this.outputs.every((function(t){return t.outputDefined()}))},jE.prototype.serialize=function(){var t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var n=[this.operator,t,this.input.serialize()],i=0;i<this.labels.length;i++)n.push(this.labels[i],this.outputs[i].serialize());return n};var kE=function(t,n){this.type=t,this.args=n};kE.parse=function(t,n){if(t.length<2)return n.error("Expectected at least one argument.");var i=null,r=n.expectedType;r&&"value"!==r.kind&&(i=r);for(var e=[],o=0,u=t.slice(1);o<u.length;o+=1){var s=u[o],a=n.parse(s,1+e.length,i,void 0,{typeAnnotation:"omit"});if(!a)return null;i=i||a.type,e.push(a)}var f=r&&e.some((function(t){return cj(r,t.type)}));return new kE(f?ej:i,e)},kE.prototype.evaluate=function(t){for(var n,i=null,r=0,e=0,o=this.args;e<o.length;e+=1){if(r++,(i=o[e].evaluate(t))&&i instanceof mj&&!i.available&&(n||(n=i),i=null,r===this.args.length))return n;if(null!==i)break}return i},kE.prototype.eachChild=function(t){this.args.forEach(t)},kE.prototype.outputDefined=function(){return this.args.every((function(t){return t.outputDefined()}))},kE.prototype.serialize=function(){var t=["coalesce"];return this.eachChild((function(n){t.push(n.serialize())})),t};var TE=function(t,n){this.type=n.type,this.bindings=[].concat(t),this.result=n};TE.prototype.evaluate=function(t){return this.result.evaluate(t)},TE.prototype.eachChild=function(t){for(var n=0,i=this.bindings;n<i.length;n+=1){t(i[n][1])}t(this.result)},TE.parse=function(t,n){if(t.length<4)return n.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var i=[],r=1;r<t.length-1;r+=2){var e=t[r];if("string"!=typeof e)return n.error("Expected string, but found "+PS(e)+" instead.",r);if(/[^a-zA-Z0-9_]/.test(e))return n.error("Variable names must contain only alphanumeric characters or '_'.",r);var o=n.parse(t[r+1],r+1);if(!o)return null;i.push([e,o])}var u=n.parse(t[t.length-1],t.length-1,n.expectedType,i);return u?new TE(i,u):null},TE.prototype.outputDefined=function(){return this.result.outputDefined()},TE.prototype.serialize=function(){for(var t=["let"],n=0,i=this.bindings;n<i.length;n+=1){var r=i[n],e=r[0],o=r[1];t.push(e,o.serialize())}return t.push(this.result.serialize()),t};var AE=function(t,n,i){this.type=t,this.index=n,this.input=i};AE.parse=function(t,n){if(3!==t.length)return n.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var i=n.parse(t[1],1,QS),r=n.parse(t[2],2,aj(n.expectedType||ej));if(!i||!r)return null;var e=r.type;return new AE(e.itemType,i,r)},AE.prototype.evaluate=function(t){var n=this.index.evaluate(t),i=this.input.evaluate(t);if(n<0)throw new Mj("Array index out of bounds: "+n+" < 0.");if(n>=i.length)throw new Mj("Array index out of bounds: "+n+" > "+(i.length-1)+".");if(n!==Math.floor(n))throw new Mj("Array index must be an integer, but found "+n+" instead.");return i[n]},AE.prototype.eachChild=function(t){t(this.index),t(this.input)},AE.prototype.outputDefined=function(){return!1},AE.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var CE=function(t,n){this.type=nj,this.needle=t,this.haystack=n};CE.parse=function(t,n){if(3!==t.length)return n.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var i=n.parse(t[1],1,ej),r=n.parse(t[2],2,ej);return i&&r?lj(i.type,[nj,tj,QS,$S,ej])?new CE(i,r):n.error("Expected first argument to be of type boolean, string, number or null, but found "+fj(i.type)+" instead"):null},CE.prototype.evaluate=function(t){var n=this.needle.evaluate(t),i=this.haystack.evaluate(t);if(null==i)return!1;if(!vj(n,["boolean","string","number","null"]))throw new Mj("Expected first argument to be of type boolean, string, number or null, but found "+fj(gj(n))+" instead.");if(!vj(i,["string","array"]))throw new Mj("Expected second argument to be of type array or string, but found "+fj(gj(i))+" instead.");return i.indexOf(n)>=0},CE.prototype.eachChild=function(t){t(this.needle),t(this.haystack)},CE.prototype.outputDefined=function(){return!0},CE.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var PE=function(t,n,i){this.type=QS,this.needle=t,this.haystack=n,this.fromIndex=i};PE.parse=function(t,n){if(t.length<=2||t.length>=5)return n.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var i=n.parse(t[1],1,ej),r=n.parse(t[2],2,ej);if(!i||!r)return null;if(!lj(i.type,[nj,tj,QS,$S,ej]))return n.error("Expected first argument to be of type boolean, string, number or null, but found "+fj(i.type)+" instead");if(4===t.length){var e=n.parse(t[3],3,QS);return e?new PE(i,r,e):null}return new PE(i,r)},PE.prototype.evaluate=function(t){var n=this.needle.evaluate(t),i=this.haystack.evaluate(t);if(!vj(n,["boolean","string","number","null"]))throw new Mj("Expected first argument to be of type boolean, string, number or null, but found "+fj(gj(n))+" instead.");if(!vj(i,["string","array"]))throw new Mj("Expected second argument to be of type array or string, but found "+fj(gj(i))+" instead.");if(this.fromIndex){var r=this.fromIndex.evaluate(t);return i.indexOf(n,r)}return i.indexOf(n)},PE.prototype.eachChild=function(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)},PE.prototype.outputDefined=function(){return!1},PE.prototype.serialize=function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var RE=function(t,n,i,r,e,o){this.inputType=t,this.type=n,this.input=i,this.cases=r,this.outputs=e,this.otherwise=o};RE.parse=function(t,n){if(t.length<5)return n.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return n.error("Expected an even number of arguments.");var i,r;n.expectedType&&"value"!==n.expectedType.kind&&(r=n.expectedType);for(var e={},o=[],u=2;u<t.length-1;u+=2){var s=t[u],a=t[u+1];Array.isArray(s)||(s=[s]);var f=n.concat(u);if(0===s.length)return f.error("Expected at least one branch label.");for(var h=0,c=s;h<c.length;h+=1){var l=c[h];if("number"!=typeof l&&"string"!=typeof l)return f.error("Branch labels must be numbers or strings.");if("number"==typeof l&&Math.abs(l)>Number.MAX_SAFE_INTEGER)return f.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof l&&Math.floor(l)!==l)return f.error("Numeric branch labels must be integer values.");if(i){if(f.checkSubtype(i,gj(l)))return null}else i=gj(l);if(void 0!==e[String(l)])return f.error("Branch labels must be unique.");e[String(l)]=o.length}var v=n.parse(a,u,r);if(!v)return null;r=r||v.type,o.push(v)}var p=n.parse(t[1],1,ej);if(!p)return null;var d=n.parse(t[t.length-1],t.length-1,r);return d?"value"!==p.type.kind&&n.concat(1).checkSubtype(i,p.type)?null:new RE(i,r,p,e,o,d):null},RE.prototype.evaluate=function(t){var n=this.input.evaluate(t);return(gj(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(t)},RE.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},RE.prototype.outputDefined=function(){return this.outputs.every((function(t){return t.outputDefined()}))&&this.otherwise.outputDefined()},RE.prototype.serialize=function(){for(var t=this,n=["match",this.input.serialize()],i=[],r={},e=0,o=Object.keys(this.cases).sort();e<o.length;e+=1){var u=o[e];void 0===(c=r[this.cases[u]])?(r[this.cases[u]]=i.length,i.push([this.cases[u],[u]])):i[c][1].push(u)}for(var s=function(n){return"number"===t.inputType.kind?Number(n):n},a=0,f=i;a<f.length;a+=1){var h=f[a],c=h[0],l=h[1];1===l.length?n.push(s(l[0])):n.push(l.map(s)),n.push(this.outputs[outputIndex$1].serialize())}return n.push(this.otherwise.serialize()),n};var IE=function(t,n,i){this.type=t,this.branches=n,this.otherwise=i};IE.parse=function(t,n){if(t.length<4)return n.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return n.error("Expected an odd number of arguments.");var i;n.expectedType&&"value"!==n.expectedType.kind&&(i=n.expectedType);for(var r=[],e=1;e<t.length-1;e+=2){var o=n.parse(t[e],e,nj);if(!o)return null;var u=n.parse(t[e+1],e+1,i);if(!u)return null;r.push([o,u]),i=i||u.type}var s=n.parse(t[t.length-1],t.length-1,i);return s?new IE(i,r,s):null},IE.prototype.evaluate=function(t){for(var n=0,i=this.branches;n<i.length;n+=1){var r=i[n],e=r[0],o=r[1];if(e.evaluate(t))return o.evaluate(t)}return this.otherwise.evaluate(t)},IE.prototype.eachChild=function(t){for(var n=0,i=this.branches;n<i.length;n+=1){var r=i[n],e=r[0],o=r[1];t(e),t(o)}t(this.otherwise)},IE.prototype.outputDefined=function(){return this.branches.every((function(t){return t[0],t[1].outputDefined()}))&&this.otherwise.outputDefined()},IE.prototype.serialize=function(){var t=["case"];return this.eachChild((function(n){t.push(n.serialize())})),t};var NE=function(t,n,i,r){this.type=t,this.input=n,this.beginIndex=i,this.endIndex=r};function zE(t,n){return"=="===t||"!="===t?"boolean"===n.kind||"string"===n.kind||"number"===n.kind||"null"===n.kind||"value"===n.kind:"string"===n.kind||"number"===n.kind||"value"===n.kind}function FE(t,n,i,r){return 0===r.compare(n,i)}function LE(t,n,i){var r="=="!==t&&"!="!==t;return function(){function e(t,n,i){this.type=nj,this.lhs=t,this.rhs=n,this.collator=i,this.hasUntypedArgument="value"===t.type.kind||"value"===n.type.kind}return e.parse=function(t,n){if(3!==t.length&&4!==t.length)return n.error("Expected two or three arguments.");var i=t[0],o=n.parse(t[1],1,ej);if(!o)return null;if(!zE(i,o.type))return n.concat(1).error('"'+i+"\" comparisons are not supported for type '"+fj(o.type)+"'.");var u=n.parse(t[2],2,ej);if(!u)return null;if(!zE(i,u.type))return n.concat(2).error('"'+i+"\" comparisons are not supported for type '"+fj(u.type)+"'.");if(o.type.kind!==u.type.kind&&"value"!==o.type.kind&&"value"!==u.type.kind)return n.error("Cannot compare types '"+fj(o.type)+"' and '"+fj(u.type)+"'.");r&&("value"===o.type.kind&&"value"!==u.type.kind?o=new Sj(u.type,[o]):"value"!==o.type.kind&&"value"===u.type.kind&&(u=new Sj(o.type,[u])));var s=null;if(4===t.length){if("string"!==o.type.kind&&"string"!==u.type.kind&&"value"!==o.type.kind&&"value"!==u.type.kind)return n.error("Cannot use collator to compare non-string types.");if(!(s=n.parse(t[3],3,oj)))return null}return new e(o,u,s)},e.prototype.evaluate=function(e){var o=this.lhs.evaluate(e),u=this.rhs.evaluate(e);if(r&&this.hasUntypedArgument){var s=gj(o),a=gj(u);if(s.kind!==a.kind||"string"!==s.kind&&"number"!==s.kind)throw new Mj('Expected arguments for "'+t+'" to be (string, string) or (number, number), but found ('+s.kind+", "+a.kind+") instead.")}if(this.collator&&!r&&this.hasUntypedArgument){var f=gj(o),h=gj(u);if("string"!==f.kind||"string"!==h.kind)return n(e,o,u)}return this.collator?i(e,o,u,this.collator.evaluate(e)):n(e,o,u)},e.prototype.eachChild=function(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)},e.prototype.outputDefined=function(){return!0},e.prototype.serialize=function(){var n=[t];return this.eachChild((function(t){n.push(t.serialize())})),n},e}()}NE.parse=function(t,n){if(t.length<=2||t.length>=5)return n.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var i=n.parse(t[1],1,ej),r=n.parse(t[2],2,QS);if(!i||!r)return null;if(!lj(i.type,[aj(ej),tj,ej]))return n.error("Expected first argument to be of type array or string, but found "+fj(i.type)+" instead");if(4===t.length){var e=n.parse(t[3],3,QS);return e?new NE(i.type,i,r,e):null}return new NE(i.type,i,r)},NE.prototype.evaluate=function(t){var n=this.input.evaluate(t),i=this.beginIndex.evaluate(t);if(!vj(n,["string","array"]))throw new Mj("Expected first argument to be of type array or string, but found "+fj(gj(n))+" instead.");if(this.endIndex){var r=this.endIndex.evaluate(t);return n.slice(i,r)}return n.slice(i)},NE.prototype.eachChild=function(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)},NE.prototype.outputDefined=function(){return!1},NE.prototype.serialize=function(){if(null!=this.endIndex&&void 0!==this.endIndex){var t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var GE=LE("==",(function(t,n,i){return n===i}),FE),DE=LE("!=",(function(t,n,i){return n!==i}),(function(t,n,i,r){return!FE(0,n,i,r)})),UE=LE("<",(function(t,n,i){return n<i}),(function(t,n,i,r){return r.compare(n,i)<0})),qE=LE(">",(function(t,n,i){return n>i}),(function(t,n,i,r){return r.compare(n,i)>0})),BE=LE("<=",(function(t,n,i){return n<=i}),(function(t,n,i,r){return r.compare(n,i)<=0})),XE=LE(">=",(function(t,n,i){return n>=i}),(function(t,n,i,r){return r.compare(n,i)>=0})),VE=function(t,n,i,r,e){this.type=tj,this.number=t,this.locale=n,this.currency=i,this.minFractionDigits=r,this.maxFractionDigits=e};VE.parse=function(t,n){if(3!==t.length)return n.error("Expected two arguments.");var i=n.parse(t[1],1,QS);if(!i)return null;var r=t[2];if("object"!==PS(r)||Array.isArray(r))return n.error("NumberFormat options argument must be an object.");var e=null;if(r.locale&&!(e=n.parse(r.locale,1,tj)))return null;var o=null;if(r.currency&&!(o=n.parse(r.currency,1,tj)))return null;var u=null;if(r["min-fraction-digits"]&&!(u=n.parse(r["min-fraction-digits"],1,QS)))return null;var s=null;return r["max-fraction-digits"]&&!(s=n.parse(r["max-fraction-digits"],1,QS))?null:new VE(i,e,o,u,s)},VE.prototype.evaluate=function(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))},VE.prototype.eachChild=function(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)},VE.prototype.outputDefined=function(){return!1},VE.prototype.serialize=function(){var t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]};var WE=function(t){this.type=QS,this.input=t};WE.parse=function(t,n){if(2!==t.length)return n.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var i=n.parse(t[1],1);return i?"array"!==i.type.kind&&"string"!==i.type.kind&&"value"!==i.type.kind?n.error("Expected argument of type string or array, but found "+fj(i.type)+" instead."):new WE(i):null},WE.prototype.evaluate=function(t){var n=this.input.evaluate(t);if("string"==typeof n)return n.length;if(Array.isArray(n))return n.length;throw new Mj("Expected value to be of type string or array, but found "+fj(gj(n))+" instead.")},WE.prototype.eachChild=function(t){t(this.input)},WE.prototype.outputDefined=function(){return!1},WE.prototype.serialize=function(){var t=["length"];return this.eachChild((function(n){t.push(n.serialize())})),t};var YE={"==":GE,"!=":DE,">":qE,"<":UE,">=":XE,"<=":BE,array:Sj,at:AE,boolean:Sj,case:IE,coalesce:kE,collator:Rj,format:jj,image:Ej,in:CE,"index-of":PE,interpolate:jE,"interpolate-hcl":jE,"interpolate-lab":jE,length:WE,let:TE,literal:_j,match:RE,number:Sj,"number-format":VE,object:Sj,slice:NE,step:oE,string:Sj,"to-boolean":Tj,"to-color":Tj,"to-number":Tj,"to-string":Tj,var:nE,within:Jj};function ZE(t,n){var i=n[0],r=n[1],e=n[2],o=n[3];i=i.evaluate(t),r=r.evaluate(t),e=e.evaluate(t);var u=o?o.evaluate(t):1,s=wj(i,r,e,u);if(s)throw new Mj(s);return new DS(i/255*u,r/255*u,e/255*u,u)}function HE(t,n){return t in n}function KE(t,n){var i=n[t];return void 0===i?null:i}function JE(t){return{type:t}}function $E(t){return{result:"success",value:t}}function QE(t){return{result:"error",value:t}}function tk(t){return"object"===PS(t)&&null!==t&&!Array.isArray(t)}Pj.register(YE,{error:[{kind:"error"},[tj],function(t,n){var i=n[0];throw new Mj(i.evaluate(t))}],typeof:[tj,[ej],function(t,n){return fj(gj(n[0].evaluate(t)))}],"to-rgba":[aj(QS,4),[ij],function(t,n){return n[0].evaluate(t).toArray()}],rgb:[ij,[QS,QS,QS],ZE],rgba:[ij,[QS,QS,QS,QS],ZE],has:{type:nj,overloads:[[[tj],function(t,n){return HE(n[0].evaluate(t),t.properties())}],[[tj,rj],function(t,n){var i=n[0],r=n[1];return HE(i.evaluate(t),r.evaluate(t))}]]},get:{type:ej,overloads:[[[tj],function(t,n){return KE(n[0].evaluate(t),t.properties())}],[[tj,rj],function(t,n){var i=n[0],r=n[1];return KE(i.evaluate(t),r.evaluate(t))}]]},"feature-state":[ej,[tj],function(t,n){return KE(n[0].evaluate(t),t.featureState||{})}],properties:[rj,[],function(t){return t.properties()}],"geometry-type":[tj,[],function(t){return t.geometryType()}],id:[ej,[],function(t){return t.id()}],zoom:[QS,[],function(t){return t.globals.zoom}],pitch:[QS,[],function(t){return t.globals.pitch||0}],"distance-from-center":[QS,[],function(t){return t.distanceFromCenter()}],"heatmap-density":[QS,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[QS,[],function(t){return t.globals.lineProgress||0}],"sky-radial-progress":[QS,[],function(t){return t.globals.skyRadialProgress||0}],accumulated:[ej,[],function(t){return void 0===t.globals.accumulated?null:t.globals.accumulated}],"+":[QS,JE(QS),function(t,n){for(var i=0,r=0,e=n;r<e.length;r+=1){i+=e[r].evaluate(t)}return i}],"*":[QS,JE(QS),function(t,n){for(var i=1,r=0,e=n;r<e.length;r+=1){i*=e[r].evaluate(t)}return i}],"-":{type:QS,overloads:[[[QS,QS],function(t,n){var i=n[0],r=n[1];return i.evaluate(t)-r.evaluate(t)}],[[QS],function(t,n){return-n[0].evaluate(t)}]]},"/":[QS,[QS,QS],function(t,n){var i=n[0],r=n[1];return i.evaluate(t)/r.evaluate(t)}],"%":[QS,[QS,QS],function(t,n){var i=n[0],r=n[1];return i.evaluate(t)%r.evaluate(t)}],ln2:[QS,[],function(){return Math.LN2}],pi:[QS,[],function(){return Math.PI}],e:[QS,[],function(){return Math.E}],"^":[QS,[QS,QS],function(t,n){var i=n[0],r=n[1];return Math.pow(i.evaluate(t),r.evaluate(t))}],sqrt:[QS,[QS],function(t,n){var i=n[0];return Math.sqrt(i.evaluate(t))}],log10:[QS,[QS],function(t,n){var i=n[0];return Math.log(i.evaluate(t))/Math.LN10}],ln:[QS,[QS],function(t,n){var i=n[0];return Math.log(i.evaluate(t))}],log2:[QS,[QS],function(t,n){var i=n[0];return Math.log(i.evaluate(t))/Math.LN2}],sin:[QS,[QS],function(t,n){var i=n[0];return Math.sin(i.evaluate(t))}],cos:[QS,[QS],function(t,n){var i=n[0];return Math.cos(i.evaluate(t))}],tan:[QS,[QS],function(t,n){var i=n[0];return Math.tan(i.evaluate(t))}],asin:[QS,[QS],function(t,n){var i=n[0];return Math.asin(i.evaluate(t))}],acos:[QS,[QS],function(t,n){var i=n[0];return Math.acos(i.evaluate(t))}],atan:[QS,[QS],function(t,n){var i=n[0];return Math.atan(i.evaluate(t))}],min:[QS,JE(QS),function(t,n){return Math.min.apply(Math,n.map((function(n){return n.evaluate(t)})))}],max:[QS,JE(QS),function(t,n){return Math.max.apply(Math,n.map((function(n){return n.evaluate(t)})))}],abs:[QS,[QS],function(t,n){var i=n[0];return Math.abs(i.evaluate(t))}],round:[QS,[QS],function(t,n){var i=n[0].evaluate(t);return i<0?-Math.round(-i):Math.round(i)}],floor:[QS,[QS],function(t,n){var i=n[0];return Math.floor(i.evaluate(t))}],ceil:[QS,[QS],function(t,n){var i=n[0];return Math.ceil(i.evaluate(t))}],"filter-==":[nj,[tj,ej],function(t,n){var i=n[0],r=n[1];return t.properties()[i.value]===r.value}],"filter-id-==":[nj,[ej],function(t,n){var i=n[0];return t.id()===i.value}],"filter-type-==":[nj,[tj],function(t,n){var i=n[0];return t.geometryType()===i.value}],"filter-<":[nj,[tj,ej],function(t,n){var i=n[0],r=n[1],e=t.properties()[i.value],o=r.value;return PS(e)===PS(o)&&e<o}],"filter-id-<":[nj,[ej],function(t,n){var i=n[0],r=t.id(),e=i.value;return PS(r)===PS(e)&&r<e}],"filter->":[nj,[tj,ej],function(t,n){var i=n[0],r=n[1],e=t.properties()[i.value],o=r.value;return PS(e)===PS(o)&&e>o}],"filter-id->":[nj,[ej],function(t,n){var i=n[0],r=t.id(),e=i.value;return PS(r)===PS(e)&&r>e}],"filter-<=":[nj,[tj,ej],function(t,n){var i=n[0],r=n[1],e=t.properties()[i.value],o=r.value;return PS(e)===PS(o)&&e<=o}],"filter-id-<=":[nj,[ej],function(t,n){var i=n[0],r=t.id(),e=i.value;return PS(r)===PS(e)&&r<=e}],"filter->=":[nj,[tj,ej],function(t,n){var i=n[0],r=n[1],e=t.properties()[i.value],o=r.value;return PS(e)===PS(o)&&e>=o}],"filter-id->=":[nj,[ej],function(t,n){var i=n[0],r=t.id(),e=i.value;return PS(r)===PS(e)&&r>=e}],"filter-has":[nj,[ej],function(t,n){return n[0].value in t.properties()}],"filter-has-id":[nj,[],function(t){return null!==t.id()&&void 0!==t.id()}],"filter-type-in":[nj,[aj(tj)],function(t,n){return n[0].value.indexOf(t.geometryType())>=0}],"filter-id-in":[nj,[aj(ej)],function(t,n){return n[0].value.indexOf(t.id())>=0}],"filter-in-small":[nj,[tj,aj(ej)],function(t,n){var i=n[0];return n[1].value.indexOf(t.properties()[i.value])>=0}],"filter-in-large":[nj,[tj,aj(ej)],function(t,n){var i=n[0],r=n[1];return function(t,n,i,r){for(;i<=r;){var e=i+r>>1;if(n[e]===t)return!0;n[e]>t?r=e-1:i=e+1}return!1}(t.properties()[i.value],r.value,0,r.value.length-1)}],all:{type:nj,overloads:[[[nj,nj],function(t,n){var i=n[0],r=n[1];return i.evaluate(t)&&r.evaluate(t)}],[JE(nj),function(t,n){for(var i=0,r=n;i<r.length;i+=1){if(!r[i].evaluate(t))return!1}return!0}]]},any:{type:nj,overloads:[[[nj,nj],function(t,n){var i=n[0],r=n[1];return i.evaluate(t)||r.evaluate(t)}],[JE(nj),function(t,n){for(var i=0,r=n;i<r.length;i+=1){if(r[i].evaluate(t))return!0}return!1}]]},"!":[nj,[nj],function(t,n){return!n[0].evaluate(t)}],"is-supported-script":[nj,[tj],function(t,n){var i=n[0],r=t.globals&&t.globals.isSupportedScript;return!r||r(i.evaluate(t))}],upcase:[tj,[tj],function(t,n){return n[0].evaluate(t).toUpperCase()}],downcase:[tj,[tj],function(t,n){return n[0].evaluate(t).toLowerCase()}],concat:[tj,JE(ej),function(t,n){return n.map((function(n){return xj(n.evaluate(t))})).join("")}],"resolved-locale":[tj,[oj],function(t,n){return n[0].evaluate(t).resolvedLocale()}]});var nk=function(t,n){this.expression=t,this._warningHistory={},this._evaluator=new Cj,this._defaultValue=n?function(t){return"color"===t.type&&tk(t.default)?new DS(0,0,0,0):"color"===t.type?DS.parse(t.default)||null:void 0===t.default?null:t.default}(n):null,this._enumValues=n&&"enum"===n.type?n.values:null};function ik(t,n){var i=new iE(YE,[],n?function(t){var n={color:ij,string:tj,number:QS,enum:tj,boolean:nj,formatted:uj,resolvedImage:sj};if("array"===t.type)return aj(n[t.value]||ej,t.length);return n[t.type]}(n):void 0),r=i.parse(t,void 0,void 0,void 0,n&&"string"===n.type?{typeAnnotation:"coerce"}:void 0);return r?$E(new nk(r,n)):QE(i.errors)}nk.prototype.evaluateWithoutErrorHandling=function(t,n,i,r,e,o,u,s){return this._evaluator.globals=t,this._evaluator.feature=n,this._evaluator.featureState=i,this._evaluator.canonical=r||null,this._evaluator.availableImages=e||null,this._evaluator.formattedSection=o,this._evaluator.featureTileCoord=u||null,this._evaluator.featureDistanceData=s||null,this.expression.evaluate(this._evaluator)},nk.prototype.evaluate=function(t,n,i,r,e,o,u,s){this._evaluator.globals=t,this._evaluator.feature=n||null,this._evaluator.featureState=i||null,this._evaluator.canonical=r||null,this._evaluator.availableImages=e||null,this._evaluator.formattedSection=o||null,this._evaluator.featureTileCoord=u||null,this._evaluator.featureDistanceData=s||null;try{var a=this.expression.evaluate(this._evaluator);if(null==a||"number"==typeof a&&a!=a)return this._defaultValue;if(this._enumValues&&!(a in this._enumValues))throw new Mj("Expected value to be one of "+Object.keys(this._enumValues).map((function(t){return JSON.stringify(t)})).join(", ")+", but found "+JSON.stringify(a)+" instead.");return a}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}};var rk=function(t,n){this.kind=t,this._styleExpression=n,this.isStateDependent="constant"!==t&&!Qj(n.expression)};rk.prototype.evaluateWithoutErrorHandling=function(t,n,i,r,e,o){return this._styleExpression.evaluateWithoutErrorHandling(t,n,i,r,e,o)},rk.prototype.evaluate=function(t,n,i,r,e,o){return this._styleExpression.evaluate(t,n,i,r,e,o)};var ek=function(t,n,i,r){this.kind=t,this.zoomStops=i,this._styleExpression=n,this.isStateDependent="camera"!==t&&!Qj(n.expression),this.interpolationType=r};function ok(t,n){if("error"===(t=ik(t,n)).result)return t;var i=t.value.expression,r=$j(i);if(!r&&!function(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}(n))return QE([new KS("","data expressions not supported")]);var e=tE(i,["zoom","pitch","distance-from-center"]);if(!e&&!function(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}(n))return QE([new KS("","zoom expressions not supported")]);var o=uk(i);if(!o&&!e)return QE([new KS("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(o instanceof KS)return QE([o]);if(o instanceof jE&&!function(t){return!!t.expression&&t.expression.interpolated}(n))return QE([new KS("",'"interpolate" expressions cannot be used with this property')]);if(!o)return $E(new rk(r?"constant":"source",t.value));var u=o instanceof jE?o.interpolation:void 0;return $E(new ek(r?"camera":"composite",t.value,o.labels,u))}function uk(t){var n=null;if(t instanceof TE)n=uk(t.result);else if(t instanceof kE)for(var i=0,r=t.args;i<r.length;i+=1){var e=r[i];if(n=uk(e))break}else(t instanceof oE||t instanceof jE)&&t.input instanceof Pj&&"zoom"===t.input.name&&(n=t);return n instanceof KS||t.eachChild((function(t){var i=uk(t);i instanceof KS?n=i:!n&&i?n=new KS("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&i&&n!==i&&(n=new KS("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),n}function sk(t){if(Array.isArray(t))return t.map(sk);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){var n={};for(var i in t)n[i]=sk(t[i]);return n}return function(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}(t)}ek.prototype.evaluateWithoutErrorHandling=function(t,n,i,r,e,o){return this._styleExpression.evaluateWithoutErrorHandling(t,n,i,r,e,o)},ek.prototype.evaluate=function(t,n,i,r,e,o){return this._styleExpression.evaluate(t,n,i,r,e,o)},ek.prototype.interpolationFactor=function(t,n,i){return this.interpolationType?jE.interpolationFactor(this.interpolationType,t,n,i):0};var ak={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},fog:{type:"fog"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},projection:{type:"projection"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{},sky:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_sky:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_symbol:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature","pitch","distance-from-center"]}},filter_fill:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_line:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_circle:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},"filter_fill-extrusion":{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_heatmap:{type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Camera"},pitch:{group:"Camera"},"distance-from-center":{group:"Camera"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},"sky-radial-progress":{group:"sky"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},fog:{range:{type:"array",default:[.5,10],minimum:-20,maximum:20,length:2,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:.1,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},projection:{name:{type:"enum",values:{albers:{},equalEarth:{},equirectangular:{},lambertConformalConic:{},mercator:{},naturalEarth:{},winkelTripel:{}},default:"mercator",required:!0},center:{type:"array",length:2,value:"number","property-type":"data-constant",transition:!1,requires:[{name:["albers","lambertConformalConic"]}]},parallels:{type:"array",length:2,value:"number","property-type":"data-constant",transition:!1,requires:[{name:["albers","lambertConformalConic"]}]}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number","property-type":"data-constant",default:1,minimum:0,maximum:1e3,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_sky:{"sky-type":{type:"enum",values:{gradient:{},atmosphere:{}},default:"atmosphere",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{type:"array",value:"number",length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,requires:[{"sky-type":"atmosphere"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{type:"number",requires:[{"sky-type":"atmosphere"}],default:10,minimum:0,maximum:100,transition:!1,"property-type":"data-constant"},"sky-gradient-center":{type:"array",requires:[{"sky-type":"gradient"}],value:"number",default:[0,0],length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{type:"number",requires:[{"sky-type":"gradient"}],default:90,minimum:0,maximum:180,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient":{type:"color",default:["interpolate",["linear"],["sky-radial-progress"],.8,"#87ceeb",1,"white"],transition:!1,requires:[{"sky-type":"gradient"}],expression:{interpolated:!0,parameters:["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};function fk(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(var n=0,i=t.slice(1);n<i.length;n+=1){var r=i[n];if(!fk(r)&&"boolean"!=typeof r)return!1}return!0;default:return!0}}function hk(t,n){if(void 0===n&&(n="fill"),null==t)return{filter:function(){return!0},needGeometry:!1,needFeature:!1};fk(t)||(t=mk(t));var i=t,r=!0;try{r=function(t){if(!vk(t))return t;var n=sk(t);return lk(n),n=ck(n)}(i)}catch(t){console.warn("Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n"+JSON.stringify(i,null,2)+"\n        ")}var e=ak["filter_"+n],o=ik(r,e),u=null;if("error"===o.result)throw new Error(o.value.map((function(t){return t.key+": "+t.message})).join(", "));u=function(t,n,i){return o.value.evaluate(t,n,{},i)};var s=null,a=null;if(r!==i){var f=ik(i,e);if("error"===f.result)throw new Error(f.value.map((function(t){return t.key+": "+t.message})).join(", "));s=function(t,n,i,r,e){return f.value.evaluate(t,n,{},i,void 0,void 0,r,e)},a=!$j(f.value.expression)}return{filter:u=u,dynamicFilter:s||void 0,needGeometry:yk(r),needFeature:!!a}}function ck(t){if(!Array.isArray(t))return t;var n=function(t){if(pk.has(t[0]))for(var n=1;n<t.length;n++){if(vk(t[n]))return!0}return t}(t);return!0===n?n:n.map((function(t){return ck(t)}))}function lk(t){var n=!1,i=[];if("case"===t[0]){for(var r=1;r<t.length-1;r+=2)n=n||vk(t[r]),i.push(t[r+1]);i.push(t[t.length-1])}else if("match"===t[0]){n=n||vk(t[1]);for(var e=2;e<t.length-1;e+=2)i.push(t[e+1]);i.push(t[t.length-1])}else if("step"===t[0]){n=n||vk(t[1]);for(var o=1;o<t.length-1;o+=2)i.push(t[o+1])}n&&(t.length=0,t.push.apply(t,["any"].concat(i)));for(var u=1;u<t.length;u++)lk(t[u])}function vk(t){if(!Array.isArray(t))return!1;if("pitch"===(n=t[0])||"distance-from-center"===n)return!0;for(var n,i=1;i<t.length;i++){if(vk(t[i]))return!0}return!1}var pk=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function dk(t,n){return t<n?-1:t>n?1:0}function yk(t){if(!Array.isArray(t))return!1;if("within"===t[0])return!0;for(var n=1;n<t.length;n++)if(yk(t[n]))return!0;return!1}function mk(t){if(!t)return!0;var n,i=t[0];return t.length<=1?"any"!==i:"=="===i?wk(t[1],t[2],"=="):"!="===i?xk(wk(t[1],t[2],"==")):"<"===i||">"===i||"<="===i||">="===i?wk(t[1],t[2],i):"any"===i?(n=t.slice(1),["any"].concat(n.map(mk))):"all"===i?["all"].concat(t.slice(1).map(mk)):"none"===i?["all"].concat(t.slice(1).map(mk).map(xk)):"in"===i?bk(t[1],t.slice(2)):"!in"===i?xk(bk(t[1],t.slice(2))):"has"===i?gk(t[1]):"!has"===i?xk(gk(t[1])):"within"!==i||t}function wk(t,n,i){switch(t){case"$type":return["filter-type-"+i,n];case"$id":return["filter-id-"+i,n];default:return["filter-"+i,t,n]}}function bk(t,n){if(0===n.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some((function(t){return PS(t)!==PS(n[0])}))?["filter-in-large",t,["literal",n.sort(dk)]]:["filter-in-small",t,["literal",n]]}}function gk(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function xk(t){return["!",t]}var _k=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Mk(t,n){var i={};for(var r in t)"ref"!==r&&(i[r]=t[r]);return _k.forEach((function(t){t in n&&(i[t]=n[t])})),i}var Ok={thin:100,hairline:100,"ultra-light":100,"extra-light":100,light:200,book:300,regular:400,normal:400,plain:400,roman:400,standard:400,medium:500,"semi-bold":600,"demi-bold":600,bold:700,heavy:800,black:800,"extra-bold":800,"ultra-black":900,"extra-black":900,"ultra-bold":900,"heavy-black":900,fat:900,poster:900},Sk=" ",jk=/(italic|oblique)$/i,Ek={},kk=function(t,n,i){var r=Ek[t];if(!r){Array.isArray(t)||(t=[t]);for(var e=400,o="normal",u=[],s=0,a=t.length;s<a;++s){var f=t[s].split(" "),h=f[f.length-1].toLowerCase();for(var c in"normal"==h||"italic"==h||"oblique"==h?(o=h,f.pop(),h=f[f.length-1].toLowerCase()):jk.test(h)&&(h=h.replace(jk,""),o=f[f.length-1].replace(h,"")),Ok){var l=f.length>1?f[f.length-2].toLowerCase():"";if(h==c||h==c.replace("-","")||l+"-"+h==c){e=Ok[c],f.pop(),l&&c.startsWith(l)&&f.pop();break}}"number"==typeof h&&(e=h);var v=f.join(Sk).replace("Klokantech Noto Sans","Noto Sans");-1!==v.indexOf(Sk)&&(v='"'+v+'"'),u.push(v)}r=Ek[t]=[o,e,u]}return r[0]+Sk+r[1]+Sk+n+"px"+(i?"/"+i:"")+Sk+r[2]},Tk="https://api.mapbox.com";function Ak(t){var n="mapbox://";return 0!==t.indexOf(n)?"":t.slice(n.length)}function Ck(t,n){var i=Ak(t);if(!i)return decodeURI(new URL(t,location.href).href);var r="styles/";if(0!==i.indexOf(r))throw new Error("unexpected style url: "+t);var e=i.slice(r.length);return Tk+"/styles/v1/"+e+"?&access_token="+n}function Pk(t,n,i,r){var e=new URL(t,r),o=Ak(t);return o?"https://{a-d}.tiles.mapbox.com/v4/"+o+"/{z}/{x}/{y}.vector.pbf?access_token="+n:n?(e.searchParams.set(i,n),decodeURI(e.href)):decodeURI(e.href)}function Rk(t){return t*Math.PI/180}var Ik=function(){for(var t=[],n=78271.51696402048;t.length<=24;n/=2)t.push(n);return t}();function Nk(t,n){if("undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas)return new OffscreenCanvas(t,n);var i=document.createElement("canvas");return i.width=t,i.height=n,i}var zk={};function Fk(t,n,i){if(void 0===i&&(i={}),n in zk)return zk[n];var r=i.transformRequest&&i.transformRequest(n,t)||new Request(n);r.headers.get("Accept")||r.headers.set("Accept","application/json");var e=fetch(r).then((function(t){return delete zk[n],t.ok?t.json():Promise.reject(new Error("Error fetching source "+n))})).catch((function(t){return delete zk[n],Promise.reject(new Error("Error fetching source "+n))}));return zk[n]=e,e}function Lk(t,n){if("string"!=typeof t)return Promise.resolve(t);if(!t.trim().startsWith("{"))return Fk("Style",t=Ck(t,n.accessToken),n);try{var i=JSON.parse(t);return Promise.resolve(i)}catch(t){return Promise.reject(t)}}var Gk={};function Dk(t,n,i){void 0===i&&(i={});var r=[n,JSON.stringify(t)].toString(),e=Gk[r];if(!e||i.transformRequest){var o=t.url;if(o){var u=Pk(o,i.accessToken,i.accessTokenParam||"access_token",n||location.href);e=o.startsWith("mapbox://")?Promise.resolve(W({},t,{url:void 0,tiles:u})):Fk("Source",u,i).then((function(t){for(var n=0,r=t.tiles.length;n<r;++n){var e=Pk(t.tiles[n],i.accessToken,i.accessTokenParam||"access_token",u||location.href);if(i.transformRequest){var o=i.transformRequest(e,"Tiles");o instanceof Request&&(e=decodeURI(o.url))}t.tiles[n]=e}return Promise.resolve(t)}))}else t=W({},t,{tiles:t.tiles.map((function(t){return Pk(t,i.accessToken,i.accessTokenParam||"access_token",n||location.href)}))}),e=Promise.resolve(W({},t));i.transformRequest||(Gk[r]=e)}return e}var Uk,qk=Array(256).join(" ");function Bk(t,n){if(n>=.05){for(var i="",r=t.split("\n"),e=qk.slice(0,Math.round(n/.1)),o=0,u=r.length;o<u;++o)o>0&&(i+="\n"),i+=r[o].split("").join(e);return i}return t}function Xk(){return Uk||(Uk=Nk(1,1).getContext("2d")),Uk}function Vk(t,n){return Xk().measureText(t).width+(t.length-1)*n}var Wk={};function Yk(t,n,i,r){if(-1!==t.indexOf("\n")){for(var e=t.split("\n"),o=[],u=0,s=e.length;u<s;++u)o.push(Yk(e[u],n,i,r));return o.join("\n")}var a=i+","+n+","+t+","+r,f=Wk[a];if(!f){var h=t.split(" ");if(h.length>1){var c=Xk();c.font=n;for(var l=c.measureText("M").width*i,v="",p=[],d=0,y=h.length;d<y;++d){var m=h[d],w=v+(v?" ":"")+m;Vk(w,r)<=l?v=w:(v&&p.push(v),v=m)}v&&p.push(v);for(var b=0,g=p.length;b<g&&g>1;++b){var x=p[b];if(Vk(x,r)<.35*l){var _=b>0?Vk(p[b-1],r):1/0,M=b<g-1?Vk(p[b+1],r):1/0;p.splice(b,1),g-=1,_<M?(p[b-1]+=" "+x,b-=1):p[b]=x+" "+p[b]}}for(var O=0,S=p.length-1;O<S;++O){var j=p[O],E=p[O+1];if(Vk(j,r)>.7*l&&Vk(E,r)<.6*l){var k=j.split(" "),T=k.pop();Vk(T,r)<.2*l&&(p[O]=k.join(" "),p[O+1]=T+" "+E),S-=1}}f=p.join("\n")}else f=t;f=Bk(f,r),Wk[a]=f}return f}var Zk,Hk=/font-family: ?([^;]*);/,Kk=/("|')/g;function Jk(t){if(!Zk){Zk={};for(var n=document.styleSheets,i=0,r=n.length;i<r;++i){var e=n[i];try{var o=e.rules||e.cssRules;if(o)for(var u=0,s=o.length;u<s;++u){var a=o[u];if(5==a.type){var f=a.cssText.match(Hk);Zk[f[1].replace(Kk,"")]=!0}}}catch(t){}}}return t in Zk}var $k={};function Qk(t){var n=t.toString();if(n in $k)return $k[n];for(var i=[],r=0,e=t.length;r<e;++r){t[r]=t[r].replace("Arial Unicode MS","Arial");var o=t[r],u=kk(o,1);Oo(u);var s=u.split(" ");i.push([s.slice(3).join(" ").replace(/"/g,""),s[1],s[0]])}for(var a=0,f=i.length;a<f;++a){var h=i[a],c=h[0];if(!Jk(c)&&100!==wo.get(h[2]+"\n"+h[1]+" \n"+c)){var l="https://fonts.googleapis.com/css?family="+c.replace(/ /g,"+")+":"+h[1]+h[2];if(!document.querySelector('link[href="'+l+'"]')){var v=document.createElement("link");v.href=l,v.rel="stylesheet",document.head.appendChild(v)}}}return $k[n]=t,t}var tT,nT,iT={Point:1,MultiPoint:1,LineString:2,MultiLineString:2,Polygon:3,MultiPolygon:3},rT={center:[.5,.5],left:[0,.5],right:[1,.5],top:[.5,0],bottom:[.5,1],"top-left":[0,0],"top-right":[1,0],"bottom-left":[0,1],"bottom-right":[1,1]},eT={},oT={zoom:0};function uT(t,n,i,r,e,o,u){var s=t.id;o||(o={},console.warn("No functionCache provided to getValue()")),o[s]||(o[s]={});var a,f=o[s];if(!f[i]){var h=(t[n]||eT)[i],c=ak[n+"_"+t.type][i];void 0===h&&(h=c.default);var l=(a=h,Array.isArray(a)&&a.length>0&&"string"==typeof a[0]&&a[0]in YE);if(!l&&tk(h)&&(h=qS(h,c),l=!0),l){var v=function(t,n){var i=ok(t,n);if("error"===i.result)throw new Error(i.value.map((function(t){return t.key+": "+t.message})).join(", "));return i.value}(h,c);f[i]=v.evaluate.bind(v)}else"color"==c.type&&(h=DS.parse(h)),f[i]=function(){return h}}return oT.zoom=r,f[i](oT,e,u)}function sT(t,n,i,r,e){return e||console.warn("No filterCache provided to evaluateFilter()"),t in e||(e[t]=hk(n).filter),oT.zoom=r,e[t](oT,i)}var aT=!1;function fT(t,n){if(t){if(!aT&&(0===t.a||0===n))return;var i=t.a;return n=void 0===n?1:n,0===i?"transparent":"rgba("+Math.round(255*t.r/i)+","+Math.round(255*t.g/i)+","+Math.round(255*t.b/i)+","+i*n+")"}return t}var hT=/^([^]*)\{(.*)\}([^]*)$/;function cT(t,n){var i;do{if(i=t.match(hT)){var r=n[i[2]]||"";t=i[1]+r+i[3]}}while(i);return t}var lT=!1;function vT(t,n,i,r,e,o,u){if(void 0===r&&(r=Ik),void 0===e&&(e=void 0),void 0===o&&(o=void 0),void 0===u&&(u=void 0),"string"==typeof n&&(n=JSON.parse(n)),8!=n.version)throw new Error("glStyle version 8 required.");var s,a;if(o)if("undefined"!=typeof Image){var f=new Image;f.crossOrigin="anonymous",f.onload=function(){s=f,a=[f.width,f.height],t.changed(),f.onload=null},f.src=o}else if("undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope){var h=self;h.postMessage({action:"loadImage",src:o}),h.addEventListener("message",(function(t){"imageLoaded"===t.data.action&&t.data.src===o&&(s=t.data.image,a=[s.width,s.height])}))}for(var c,l=function(t){t=t.slice();for(var n=Object.create(null),i=0;i<t.length;i++)n[t[i].id]=t[i];for(var r=0;r<t.length;r++)"ref"in t[r]&&(t[r]=Mk(t[r],n[t[r].ref]));return t}(n.layers),v={},p=[],d={},y={},m={},w={},b=0,g=l.length;b<g;++b){var x=l[b],_=x.id;if("string"==typeof i&&x.source==i||-1!==i.indexOf(_)){var M=x["source-layer"];if(c){if(x.source!==c)throw new Error('Layer "'+_+'" does not use source "'+c)}else{c=x.source;var O=n.sources[c];if(!O)throw new Error('Source "'+c+'" is not defined');var S=O.type;if("vector"!==S&&"geojson"!==S)throw new Error('Source "'+c+'" is not of type "vector" or "geojson", but "'+S+'"')}var j=v[M];j||(j=[],v[M]=j),j.push({layer:x,index:b}),p.push(_)}}var E=new Ov,k=new Ql,T=[],A=function(n,i){var o=n.getProperties(),f=v[o.layer];if(f){var h=r.indexOf(i);-1==h&&(h=function(t,n){for(var i=0,r=n.length;i<r;++i)if(n[i]<t&&i+1<r){var e=n[i]/n[i+1];return i+Math.log(n[i]/t)/Math.log(e)}return r-1}(i,r));for(var c,l=iT[n.getGeometry().getType()],p={properties:o,type:l},b=t.get("mapbox-featurestate")[n.getId()],g=-1,x=0,_=f.length;x<_;++x){var M=f[x],O=M.layer,S=O.id,j=O.layout||eT,A=O.paint||eT;if(!("none"===j.visibility||"minzoom"in O&&h<O.minzoom||"maxzoom"in O&&h>=O.maxzoom)){var C=O.filter;if(!C||sT(S,C,p,h,w)){c=O;var P=void 0,R=void 0,I=void 0,N=void 0,z=void 0,F=void 0,L=M.index;if(3==l&&("fill"==O.type||"fill-extrusion"==O.type))if(R=uT(O,"paint",O.type+"-opacity",h,p,m,b),O.type+"-pattern"in A){var G=uT(O,"paint",O.type+"-pattern",h,p,m,b);if(G){var D="string"==typeof G?cT(G,o):G.toString();if(s&&e&&e[D]){++g,(F=T[g])&&F.getFill()&&!F.getStroke()&&!F.getText()||(F=new zv({fill:new Ql}),T[g]=F),I=F.getFill(),F.setZIndex(L);var U=D+"."+R,q=y[U];if(!q){var B=e[D],X=Nk(B.width,B.height),V=X.getContext("2d");V.globalAlpha=R,V.drawImage(s,B.x,B.y,B.width,B.height,0,0,B.width,B.height),q=V.createPattern(X,"repeat"),y[U]=q}I.setColor(q)}}}else P=fT(uT(O,"paint",O.type+"-color",h,p,m,b),R),O.type+"-outline-color"in A&&(z=fT(uT(O,"paint",O.type+"-outline-color",h,p,m,b),R)),z||(z=P),(P||z)&&(++g,(!(F=T[g])||P&&!F.getFill()||!P&&F.getFill()||z&&!F.getStroke()||!z&&F.getStroke()||F.getText())&&(F=new zv({fill:P?new Ql:void 0,stroke:z?new Ov:void 0}),T[g]=F),P&&(I=F.getFill()).setColor(P),z&&((N=F.getStroke()).setColor(z),N.setWidth(.5)),F.setZIndex(L));if(1!=l&&"line"==O.type){P=!("line-pattern"in A)&&"line-color"in A?fT(uT(O,"paint","line-color",h,p,m,b),uT(O,"paint","line-opacity",h,p,m,b)):void 0;var W=uT(O,"paint","line-width",h,p,m,b);P&&W>0&&(++g,(F=T[g])&&F.getStroke()&&!F.getFill()&&!F.getText()||(F=new zv({stroke:new Ov}),T[g]=F),(N=F.getStroke()).setLineCap(uT(O,"layout","line-cap",h,p,m,b)),N.setLineJoin(uT(O,"layout","line-join",h,p,m,b)),N.setMiterLimit(uT(O,"layout","line-miter-limit",h,p,m,b)),N.setColor(P),N.setWidth(W),N.setLineDash(A["line-dasharray"]?uT(O,"paint","line-dasharray",h,p,m,b).map((function(t){return t*W})):null),F.setZIndex(L))}var Y=!1,Z=null,H=0,K=void 0,J=void 0,$=void 0;if((1==l||2==l)&&"icon-image"in j){var Q=uT(O,"layout","icon-image",h,p,m,b);if(Q){K="string"==typeof Q?cT(Q,o):Q.toString();var tt=void 0;if(s&&e&&e[K]){var nt=uT(O,"layout","icon-rotation-alignment",h,p,m,b);if(2==l){var it=n.getGeometry();if(it.getFlatMidpoint||it.getFlatMidpoints){var rt=it.getExtent();if(Math.sqrt(Math.max(Math.pow((rt[2]-rt[0])/i,2),Math.pow((rt[3]-rt[1])/i,2)))>150){var et="MultiLineString"===it.getType()?it.getFlatMidpoints():it.getFlatMidpoint();if(nT||(nT=new Yd("Point",tT=[NaN,NaN],[],{},null)),tt=nT,tT[0]=et[0],tT[1]=et[1],"line"===uT(O,"layout","symbol-placement",h,p,m,b)&&"map"===nt)for(var ot=it.getStride(),ut=it.getFlatCoordinates(),st=0,at=ut.length-ot;st<at;st+=ot){var ft=ut[st],ht=ut[st+1],ct=ut[st+ot],lt=ut[st+ot+1],vt=Math.min(ft,ct),pt=Math.min(ht,lt),dt=Math.max(ft,ct),yt=Math.max(ht,lt);if(et[0]>=vt&&et[0]<=dt&&et[1]>=pt&&et[1]<=yt){H=Math.atan2(ht-lt,ct-ft);break}}}}}if(2!==l||tt){var mt=uT(O,"layout","icon-size",h,p,m,b),wt=void 0!==A["icon-color"]?uT(O,"paint","icon-color",h,p,m,b):null;if(!wt||0!==wt.a){var bt=K+"."+mt;if(null!==wt&&(bt+="."+wt),!(J=d[bt])){var gt=e[K];J=new Mv({color:wt?[255*wt.r,255*wt.g,255*wt.b,wt.a]:void 0,img:s,imgSize:a,size:[gt.width,gt.height],offset:[gt.x,gt.y],rotateWithView:"map"===nt,scale:mt/gt.pixelRatio,displacement:"icon-offset"in j?uT(O,"layout","icon-offset",h,p,m,b).map((function(t){return-t*gt.pixelRatio})):void 0}),d[bt]=J}}J&&(++g,(F=T[g])&&F.getImage()&&!F.getFill()&&!F.getStroke()||(F=new zv,T[g]=F),F.setGeometry(tt),J.setRotation(H+Rk(uT(O,"layout","icon-rotate",h,p,m,b))),J.setOpacity(uT(O,"paint","icon-opacity",h,p,m,b)),J.setAnchor(rT[uT(O,"layout","icon-anchor",h,p,m,b)]),F.setImage(J),Z=F.getText(),F.setText(void 0),F.setZIndex(L),Y=!0,$=!1)}else $=!0}}}if(1==l&&"circle"===O.type){++g,(F=T[g])&&F.getImage()&&!F.getFill()&&!F.getStroke()||(F=new zv,T[g]=F);var xt="circle-radius"in A?uT(O,"paint","circle-radius",h,p,m,b):5,_t=fT(uT(O,"paint","circle-stroke-color",h,p,m,b),uT(O,"paint","circle-stroke-opacity",h,p,m,b)),Mt=fT(uT(O,"paint","circle-color",h,p,m,b),uT(O,"paint","circle-opacity",h,p,m,b)),Ot=uT(O,"paint","circle-stroke-width",h,p,m,b),St=xt+"."+_t+"."+Mt+"."+Ot;(J=d[St])||(J=new kv({radius:xt,stroke:_t&&Ot>0?new Ov({width:Ot,color:_t}):void 0,fill:Mt?new Ql({color:Mt}):void 0}),d[St]=J),F.setImage(J),Z=F.getText(),F.setText(void 0),F.setGeometry(void 0),F.setZIndex(L),Y=!0}var jt=void 0,Et=void 0,kt=void 0,Tt=void 0,At=void 0,Ct=void 0;if("text-field"in j){Tt=Math.round(uT(O,"layout","text-size",h,p,m,b));var Pt=uT(O,"layout","text-font",h,p,m,b);kt=uT(O,"layout","text-line-height",h,p,m,b),(Et=kk(u?u(Pt):Pt,Tt,kt)).includes("sans-serif")||(Et+=",sans-serif"),At=uT(O,"layout","text-letter-spacing",h,p,m,b),Ct=uT(O,"layout","text-max-width",h,p,m,b);var Rt=uT(O,"layout","text-field",h,p,m,b);jt="object"===PS(Rt)&&Rt.sections?1===Rt.sections.length?Rt.toString():Rt.sections.reduce((function(t,n,i){var r=n.fontStack?n.fontStack.split(","):Pt,e=kk(u?u(r):r,Tt*(n.scale||1),kt),o=n.text;if("\n"===o)return t.push("\n",""),t;if(2!=l){for(var s=0,a=(o=Yk(o,e,Ct,At).split("\n")).length;s<a;++s)s>0&&t.push("\n",""),t.push(o[s],e);return t}t.push(Bk(o,At),e)}),[]):cT(Rt,o).trim(),R=uT(O,"paint","text-opacity",h,p,m,b)}if(jt&&R&&!$){Y||(++g,(F=T[g])&&F.getText()&&!F.getFill()&&!F.getStroke()||(F=new zv,T[g]=F),F.setImage(void 0),F.setGeometry(void 0)),F.getText()||F.setText(Z||new Gv({padding:[2,2,2,2]})),Z=F.getText();var It=j["text-transform"];"uppercase"==It?jt=Array.isArray(jt)?jt.map((function(t,n){return n%2?t:t.toUpperCase()})):jt.toUpperCase():"lowercase"==It&&(jt=Array.isArray(jt)?jt.map((function(t,n){return n%2?t:t.toLowerCase()})):jt.toLowerCase());var Nt=Array.isArray(jt)?jt:2==l?Bk(jt,At):Yk(jt,Et,Ct,At);Z.setText(Nt),Z.setFont(Et),Z.setRotation(Rk(uT(O,"layout","text-rotate",h,p,m,b)));var zt=uT(O,"layout","text-anchor",h,p,m,b),Ft=Y||1==l?"point":uT(O,"layout","symbol-placement",h,p,m,b);Z.setPlacement(Ft),Z.setOverflow("point"===Ft);var Lt=uT(O,"paint","text-halo-width",h,p,m,b),Gt=uT(O,"layout","text-offset",h,p,m,b),Dt=uT(O,"paint","text-translate",h,p,m,b),Ut=0,qt=0;if("point"==Ft){var Bt="center";-1!==zt.indexOf("left")?(Bt="left",qt=Lt):-1!==zt.indexOf("right")&&(Bt="right",qt=-Lt),Z.setTextAlign(Bt);var Xt=uT(O,"layout","text-rotation-alignment",h,p,m,b);Z.setRotateWithView("map"==Xt)}else Z.setMaxAngle(Rk(uT(O,"layout","text-max-angle",h,p,m,b))*jt.length/Nt.length),Z.setTextAlign(),Z.setRotateWithView(!1);var Vt="middle";0==zt.indexOf("bottom")?(Vt="bottom",Ut=-Lt-.5*(kt-1)*Tt):0==zt.indexOf("top")&&(Vt="top",Ut=Lt+.5*(kt-1)*Tt),Z.setTextBaseline(Vt),Z.setOffsetX(Gt[0]*Tt+qt+Dt[0]),Z.setOffsetY(Gt[1]*Tt+Ut+Dt[1]),k.setColor(fT(uT(O,"paint","text-color",h,p,m,b),R)),Z.setFill(k);var Wt=fT(uT(O,"paint","text-halo-color",h,p,m,b),R);if(Wt){E.setColor(Wt),Lt*=2;var Yt=.5*Tt;E.setWidth(Lt<=Yt?Lt:Yt),Z.setStroke(E)}else Z.setStroke(void 0);var Zt=uT(O,"layout","text-padding",h,p,m,b),Ht=Z.getPadding();Zt!==Ht[0]&&(Ht[0]=Zt,Ht[1]=Zt,Ht[2]=Zt,Ht[3]=Zt),F.setZIndex(L)}}}}return g>-1?(T.length=g+1,lT&&("function"==typeof n.set?n.set("mapbox-layer",c):n.getProperties()["mapbox-layer"]=c),T):void 0}};return t.setStyle(A),t.set("mapbox-source",c),t.set("mapbox-layers",p),t.set("mapbox-featurestate",{}),A}function pT(t,n){n.accessToken||(n=W({},n),new URL(t).searchParams.forEach((function(t,i){n.accessToken=t,n.accessTokenParam=i})));return n}function dT(t,n,i,r,e){var o,u,s;return void 0===i&&(i=""),void 0===r&&(r={}),void 0===e&&(e=void 0),"string"==typeof r?(o=r,s={}):(o=r.styleUrl,s=r),e||(e=s.resolutions),o||"string"!=typeof n||n.trim().startsWith("{")||(o=n),o&&(o=o.startsWith("data:")?location.href:Ck(o,s.accessToken),s=pT(o,s)),new Promise((function(r,a){Lk(n,s).then((function(n){if(8!=n.version)return a(new Error("glStyle version 8 required."));if(!(t instanceof kx||t instanceof PO))return a(new Error("Can only apply to VectorLayer or VectorTileLayer"));var f,h,c,l=t instanceof PO?"vector":"geojson";if(i?u=Array.isArray(i)?n.layers.find((function(t){return t.id===i[0]})).source:i:(u=Object.keys(n.sources).find((function(t){return n.sources[t].type===l})),i=u),!u)return a(new Error("No "+l+" source found in the glStyle."));function v(){if(t instanceof PO)return gT(n.sources[u],o,s).then((function(n){var i=t.getSource();if(i?n!==i&&(i.setTileUrlFunction(n.getTileUrlFunction()),i.Ah||(i.Ah=n.Ah),i.getAttributions()||i.setAttributions(n.getAttributions()),i.getTileLoadFunction()===bS&&i.setTileLoadFunction(n.getTileLoadFunction()),ye(i.getProjection(),n.getProjection())&&(i.tileGrid=n.getTileGrid())):t.setSource(n),!isFinite(t.getMaxResolution())&&!isFinite(t.getMinZoom())){var r=t.getSource().getTileGrid();t.setMaxResolution(r.getResolution(r.getMinZoom()))}}));var i=_T(n.sources[u],o,s),r=t.getSource();return r?i!==r&&(r.getAttributions()||r.setAttributions(i.getAttributions()),r.Ah||(r.Ah=i.getFormat()),r.Ch=i.getUrl()):t.setSource(i),Promise.resolve()}function p(){c||n.sprite&&!f?c?(t.setStyle(c),v().then(r).catch(a)):a(new Error("Something went wrong trying to apply style.")):(c=vT(t,n,i,e,f,h,Qk),t.getStyle()?v().then(r).catch(a):a(new Error("Nothing to show for source ["+u+"]")))}if(n.sprite){var d=new URL(function(t,n,i){var r=Ak(t);if(!r)return decodeURI(new URL(t,i).href);var e="sprites/";if(0!==r.indexOf(e))throw new Error("unexpected sprites url: "+t);var o=r.slice(e.length);return Tk+"/styles/v1/"+o+"/sprite?access_token="+n}(n.sprite,s.accessToken,o||location.href)),y=.5==(window.devicePixelRatio>=1.5?.5:1)?"@2x":"",m=d.origin+d.pathname+y+".json"+d.search;new Promise((function(t,n){Fk("Sprite",m,s).then(t).catch((function(i){Fk("Sprite",m=d.origin+d.pathname+".json"+d.search,s).then(t).catch(n)}))})).then((function(t){void 0===t&&a(new Error("No sprites found.")),f=t,h=d.origin+d.pathname+y+".png"+d.search,p()})).catch((function(t){a(new Error("Sprites cannot be loaded: "+m+": "+t.message))}))}else p()})).catch(a)}))}var yT={};function mT(t,n){var i={id:n.id,type:n.type},r={};function e(e){var o=n.layout||{},u=n.paint||{};i.paint=u;var s,a,f="function"==typeof t.getSource?t.getSource().getTileGrid().getZForResolution(e):t.getView().getZoom(),h="function"==typeof t.getTargetElement?t.getTargetElement():void 0;if(void 0!==u["background-color"]&&(s=uT(i,"paint","background-color",f,yT,r),h&&(h.style.background=DS.parse(s).toString())),void 0!==u["background-opacity"]&&(a=uT(i,"paint","background-opacity",f,yT,r),h&&(h.style.opacity=a)),"none"!=o.visibility)return fT(s,a);h&&(h.style.backgroundColor="",h.style.opacity="")}if("function"==typeof t.getTargetElement)t.getTargetElement()&&e(),t.on(["change:resolution","change:target"],e);else{if("function"!=typeof t.setBackground)throw new Error("Unable to apply background.");t.setBackground(e)}}function wT(t,n){n.layers.some((function(n){if("background"===n.type)return mT(t,n),!0}))}function bT(t){var n=t.bounds;if(n){var i=de([n[0],n[1]]),r=de([n[2],n[3]]);return[i[0],i[1],r[0],r[1]]}}function gT(t,n,i){return new Promise((function(r,e){Dk(t,n,i).then((function(t){var n=new CS({tileJSON:t}),i=n.getTileJSON(),e=n.getTileGrid(),o=bT(i),u=i.minzoom||0,s=i.maxzoom||22,a=n.get("ol-source");if(void 0===a){var f={attributions:n.getAttributions(),format:new Qd,tileGrid:new HO({origin:e.getOrigin(0),extent:o||e.getExtent(),minZoom:u,resolutions:Ik.slice(0,s+1),tileSize:512})};Array.isArray(i.tiles)?f.urls=i.tiles:f.url=i.tiles,t.olSourceOptions&&Object.assign(f,t.olSourceOptions),a=new wS(f),n.set("ol-source",a)}r(a)})).catch(e)}))}var xT=new qh;function _T(t,n,i){var r=t.data,e={};if("string"==typeof r){var o=Pk(r,i.accessToken,i.accessTokenParam||"access_token",n||location.href);if(i.transformRequest){var u=i.transformRequest(o,"GeoJSON");u instanceof Request&&(o=encodeURI(u.url))}e.url=o}else e.features=xT.readFeatures(r,{featureProjection:Me()||"EPSG:3857"});return new Bx(W({attributions:t.attribution,format:xT},e))}var MT=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),OT=function(t){function n(n){var i=t.call(this,Q)||this;return i.error=n,i}return MT(n,t),n}(L),ST=function(t){function n(n){var i=this,r=!("declutter"in n)||n.declutter,e=new wS({state:Ln,format:new Qd});i=t.call(this,{source:e,background:n.background,declutter:r,className:n.className,opacity:n.opacity,visible:n.visible,zIndex:n.zIndex,minResolution:n.minResolution,maxResolution:n.maxResolution,minZoom:n.minZoom,maxZoom:n.maxZoom,renderOrder:n.renderOrder,renderBuffer:n.renderBuffer,renderMode:n.renderMode,map:n.map,updateWhileAnimating:n.updateWhileAnimating,updateWhileInteracting:n.updateWhileInteracting,preload:n.preload,useInterimTilesOnError:n.useInterimTilesOnError,properties:n.properties})||this,n.accessToken&&(i.accessToken=n.accessToken);var o=n.styleUrl;return dT(i,o,n.layers||n.source,{accessToken:i.accessToken}).then((function(){e.setState(Gn)})).catch((function(t){i.dispatchEvent(new OT(t)),i.getSource().setState(Dn)})),void 0===i.getBackground()&&function(t,n,i){void 0===i&&(i={}),"object"===PS(n)?(wT(t,n),Promise.resolve()):Lk(n,i).then((function(n){wT(t,n)}))}(i,n.styleUrl,{accessToken:i.accessToken}),i}return MT(n,t),n}(PO),jT=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ET=function(t){function n(n){return t.call(this,n)||this}return jT(n,t),n.prototype.createRenderer=function(){return new MO(this)},n}(iM),kT=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),TT=function(t){function n(n){var i=t.call(this,n)||this;return i.Uy=new jx(n),i.qy=n.getImageRatio(),i.By=[1,0,0,1,0,0],i.iy=null,i}return kT(n,t),n.prototype.disposeInternal=function(){this.Uy.dispose(),t.prototype.disposeInternal.call(this)},n.prototype.getFeatures=function(t){if(!this.Uy)return new Promise((function(t){return t([])}));var n=Be(this.By,Be(this.iy,t.slice()));return this.Uy.getFeatures(n)},n.prototype.handleFontsChanged=function(){this.Uy.handleFontsChanged()},n.prototype.prepareFrame=function(t){var n=t.pixelRatio,i=t.viewState,r=i.resolution,e=t.viewHints,o=this.Uy,u=t.extent;1!==this.qy&&Ar(u=u.slice(0),this.qy);var s=jr(u)/r,a=_r(u)/r;if(!e[mu]&&!e[wu]&&!kr(u)){o.useContainer(null,null,1);var f=o.context,h=W({},t,{declutterTree:new wg(9),extent:u,size:[s,a],viewState:W({},t.viewState,{rotation:0})}),c=!0,l=new Lb(u,r,n,f.canvas,(function(t){o.prepareFrame(h)&&o.replayGroupChanged&&(o.clipping=!1,o.renderFrame(h,null)&&(o.renderDeclutter(h),c=!1),t())}));l.addEventListener($,function(){if(l.getState()===av){this.bo=c?null:l;var t=l.getResolution(),r=l.getPixelRatio(),e=t*n/r;this.renderedResolution=e,this.By=Ze(this.By,s/2,a/2,1/e,-1/e,0,-i.center[0],-i.center[1])}}.bind(this)),l.load()}return this.bo&&(this.iy=t.pixelToCoordinateTransform.slice()),!!this.bo},n.prototype.preRender=function(){},n.prototype.postRender=function(){},n.prototype.renderDeclutter=function(){},n.prototype.forEachFeatureAtCoordinate=function(n,i,r,e,o){return this.Uy?this.Uy.forEachFeatureAtCoordinate(n,i,r,e,o):t.prototype.forEachFeatureAtCoordinate.call(this,n,i,r,e,o)},n}(aO),AT=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),CT=function(t){function n(n){var i=this,r=n||{},e=W({},r);return delete e.imageRatio,(i=t.call(this,e)||this).Xy=void 0!==r.imageRatio?r.imageRatio:1,i}return AT(n,t),n.prototype.getImageRatio=function(){return this.Xy},n.prototype.createRenderer=function(){return new TT(this)},n}(xg),PT=function(){function t(t,n){this.name=t,this.data=n,this.Wp=null}return t.prototype.getTexture=function(t){if(!this.Wp){var n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.data.length/4,1,0,t.RGBA,t.UNSIGNED_BYTE,this.data),this.Wp=n}return this.Wp},t}(),RT=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();function IT(t,n,i){var r=i?t.LINEAR:t.NEAREST;t.bindTexture(t.TEXTURE_2D,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,r)}function NT(t,n,i,r,e,o){var u,s,a=t.getGL();i instanceof Float32Array?(u=a.FLOAT,t.getExtension("OES_texture_float"),s=null!==t.getExtension("OES_texture_float_linear")):(u=a.UNSIGNED_BYTE,s=!0);IT(a,n,o&&s);var f,h=i.byteLength/r[1],c=1;switch(h%8==0?c=8:h%4==0?c=4:h%2==0&&(c=2),e){case 1:f=a.LUMINANCE;break;case 2:f=a.LUMINANCE_ALPHA;break;case 3:f=a.RGB;break;case 4:f=a.RGBA;break;default:throw new Error("Unsupported number of bands: ".concat(e))}var l=a.getParameter(a.UNPACK_ALIGNMENT);a.pixelStorei(a.UNPACK_ALIGNMENT,c),a.texImage2D(a.TEXTURE_2D,0,f,r[0],r[1],0,f,u,i),a.pixelStorei(a.UNPACK_ALIGNMENT,l)}var zT=null;var FT=function(t){function n(n){var i=t.call(this)||this;i.tile,i.textures=[],i.hr=i.hr.bind(i),i.Vy=ua(n.grid.getTileSize(n.tile.tileCoord[0])),i.Bd=n.gutter||0,i.bandCount=NaN,i.Vp=n.helper;var r=new wM(fM,cM);return r.fromArray([0,1,1,1,1,0,0,0]),i.Vp.flushBufferData(r),i.coords=r,i.setTile(n.tile),i}return RT(n,t),n.prototype.setTile=function(t){if(t!==this.tile)if(this.tile&&this.tile.removeEventListener($,this.hr),this.tile=t,this.textures.length=0,this.loaded=t.getState()===cu,this.loaded)this.Wy();else{if(t instanceof Db){var n=t.getImage();n instanceof Image&&!n.crossOrigin&&(n.crossOrigin="anonymous")}t.addEventListener($,this.hr)}},n.prototype.Wy=function(){var t=this.Vp,n=t.getGL(),i=this.tile;if(i instanceof Db||i instanceof wO){var r=n.createTexture();return this.textures.push(r),this.bandCount=4,void function(t,n,i,r){IT(t,n,r),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,i)}(n,r,i.getImage(),i.interpolate)}var e=i.getSize(),o=[e[0]+2*this.Bd,e[1]+2*this.Bd],u=i.getData(),s=u instanceof Float32Array,a=o[0]*o[1],f=s?Float32Array:Uint8Array,h=f.BYTES_PER_ELEMENT,c=u.byteLength/o[1];this.bandCount=Math.floor(c/h/o[0]);var l=Math.ceil(this.bandCount/4);if(1===l){r=n.createTexture();return this.textures.push(r),void NT(t,r,u,o,this.bandCount,i.interpolate)}for(var v=new Array(l),p=0;p<l;++p){r=n.createTexture();this.textures.push(r);var d=p<l-1?4:this.bandCount%4;v[p]=new f(a*d)}for(var y=0,m=0,w=o[0]*this.bandCount,b=0;b<o[1];++b){for(var g=0;g<w;++g){var x=u[m+g],_=Math.floor(y/this.bandCount),M=g%this.bandCount;(O=v[p=Math.floor(M/4)])[_*(d=O.length/a)+M%4]=x,++y}m+=c/h}for(p=0;p<l;++p){var O;NT(t,r=this.textures[p],O=v[p],o,d=O.length/a,i.interpolate)}},n.prototype.hr=function(){this.tile.getState()===cu&&(this.loaded=!0,this.Wy(),this.dispatchEvent($))},n.prototype.disposeInternal=function(){var t=this.Vp.getGL();this.Vp.deleteBuffer(this.coords);for(var n=0;n<this.textures.length;++n)t.deleteTexture(this.textures[n]);this.tile.removeEventListener($,this.hr)},n.prototype.getPixelData=function(t,n){if(!this.loaded)return null;var i,r=this.Vy[0],e=this.Vy[1],o=this.Bd;if(this.tile instanceof Da){var u=this.tile.getSize(),s=u[0],a=u[1],f=s+2*o,h=a+2*o,c=o+Math.floor(s*(t/r)),l=o+Math.floor(a*(n/e)),v=this.tile.getData();if(v instanceof DataView){var p=v.byteLength/(f*h),d=p*(l*f+c),y=v.buffer.slice(d,d+p);return new DataView(y)}var m=this.bandCount*(l*f+c);return v.slice(m,m+this.bandCount)}zT||((i=document.createElement("canvas")).width=1,i.height=1,zT=i.getContext("2d")),zT.clearRect(0,0,1,1);var w,b=this.tile.getImage(),g=b.width-2*o,x=b.height-2*o,_=o+Math.floor(g*(t/r)),M=o+Math.floor(x*(n/e));try{zT.drawImage(b,_,M,1,1,0,0,1,1),w=zT.getImageData(0,0,1,1).data}catch(t){return zT=null,null}return w},n}(J),LT=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),GT={TILE_TEXTURE_ARRAY:"u_tileTextures",TILE_TRANSFORM:"u_tileTransform",TRANSITION_ALPHA:"u_transitionAlpha",DEPTH:"u_depth",TEXTURE_PIXEL_WIDTH:"u_texturePixelWidth",TEXTURE_PIXEL_HEIGHT:"u_texturePixelHeight",TEXTURE_RESOLUTION:"u_textureResolution",TEXTURE_ORIGIN_X:"u_textureOriginX",TEXTURE_ORIGIN_Y:"u_textureOriginY",RENDER_EXTENT:"u_renderExtent",RESOLUTION:"u_resolution",ZOOM:"u_zoom"},DT={TEXTURE_COORD:"a_textureCoord"},UT=[{name:DT.TEXTURE_COORD,size:2,type:CM.FLOAT}],qT={};function BT(t){return 2*(1-1/(t+1))-1}function XT(t,n,i){i in t||(t[i]=[]),t[i].push(n)}function VT(t,n){var i=t.layerStatesArray[t.layerIndex];i.extent&&(n=Mr(n,Ee(i.extent,t.viewState.projection)));var r=i.layer.getRenderSource();if(!r.getWrapX()){var e=r.getTileGridForProjection(t.viewState.projection).getExtent();e&&(n=Mr(n,e))}return n}function WT(t,n){return"".concat(t.getKey(),",").concat(LO(n))}var YT=function(t){function n(n,i){var r=t.call(this,n,{uniforms:i.uniforms})||this;r.renderComplete=!1,r.Yy=[1,0,0,1,0,0],r.Zy=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r.Hy=new xO(0,0,0,0),r.Ky=zO(0,0,0),r.Jy=[0,0],r.ed,r.td=i.vertexShader,r.rd=i.fragmentShader,r.$y=new wM(hM,cM),r.$y.fromArray([0,1,3,1,2,3]);var e=void 0!==i.cacheSize?i.cacheSize:512;return r.Qy=new NO(e),r.tm=i.paletteTextures||[],r.Yi=null,r}return LT(n,t),n.prototype.reset=function(n){t.prototype.reset.call(this,{uniforms:n.uniforms}),this.td=n.vertexShader,this.rd=n.fragmentShader,this.tm=n.paletteTextures||[],this.helper&&(this.ed=this.helper.getProgram(this.rd,this.td))},n.prototype.afterHelperCreated=function(){this.ed=this.helper.getProgram(this.rd,this.td),this.helper.flushBufferData(this.$y)},n.prototype.nm=function(t){var n=this.getLayer(),i=t.getState(),r=n.getUseInterimTilesOnError();return i==cu||i==vu||i==lu&&!r},n.prototype.prepareFrameInternal=function(t){var n=this.getLayer().getRenderSource();return!!n&&(!kr(VT(t,t.extent))&&n.getState()===Gn)},n.prototype.enqueueTiles=function(t,n,i,r){var e=t.viewState,o=this.getLayer(),u=o.getRenderSource(),s=u.getTileGridForProjection(e.projection),a=u.getGutterForProjection(e.projection),f=d(u);f in t.wantedTiles||(t.wantedTiles[f]={});for(var h=t.wantedTiles[f],c=this.Qy,l=Math.max(i-o.getPreload(),s.getMinZoom(),o.getMinZoom()),v=i;v>=l;--v)for(var p=s.getTileRangeForExtentAndZ(n,v,this.Hy),y=s.getResolution(v),m=p.minX;m<=p.maxX;++m)for(var w=p.minY;w<=p.maxY;++w){var b=zO(v,m,w,this.Ky),g=WT(u,b),x=void 0,_=void 0;if(c.containsKey(g)&&(_=(x=c.get(g)).tile),!x||x.tile.key!==u.getKey())if(_=u.getTile(v,m,w,t.pixelRatio,e.projection),x)if(this.nm(_))x.setTile(_);else{var M=_.getInterimTile();x.setTile(M)}else x=new FT({tile:_,grid:s,helper:this.helper,gutter:a}),c.set(g,x);XT(r,x,v);var O=_.getKey();h[O]=!0,_.getState()===fu&&(t.tileQueue.isKeyQueued(O)||t.tileQueue.enqueue([_,f,s.getTileCoordCenter(b),y]))}},n.prototype.renderFrame=function(t){this.Yi=t,this.renderComplete=!0;var n=this.helper.getGL();this.preRender(n,t);var i=t.viewState,r=this.getLayer().getRenderSource(),o=r.getTileGridForProjection(i.projection),u=r.getGutterForProjection(i.projection),s=VT(t,t.extent),a=o.getZForResolution(i.resolution,r.zDirection),f={};if(t.nextExtent){var h=o.getZForResolution(i.nextResolution,r.zDirection),c=VT(t,t.nextExtent);this.enqueueTiles(t,c,h,f)}this.enqueueTiles(t,s,a,f);for(var l={},v=d(this),p=t.time,y=!1,m=f[a],w=0,b=m.length;w<b;++w){var g=(D=(tt=m[w]).tile).tileCoord;if(tt.loaded){if(1===(U=D.getAlpha(v,p))){D.endTransition(v);continue}y=!0,l[q=LO(g)]=U}if(this.renderComplete=!1,!this.im(o,g,a+1,f))for(var x=o.getMinZoom(),_=a-1;_>=x;--_){if(this.im(o,g,_,f))break}}this.helper.useProgram(this.ed),this.helper.prepareDraw(t,!y);for(var M=Object.keys(f).map(Number).sort(e),O=i.center[0],S=i.center[1],j=0,E=M.length;j<E;++j){var k=M[j],T=o.getResolution(k),A=ua(o.getTileSize(k),this.Jy),C=o.getOrigin(k),P=A[0]+2*u,R=A[1]+2*u,I=P/R,N=(O-C[0])/(A[0]*T),z=(C[1]-S)/(A[1]*T),F=i.resolution/T,L=BT(k),G=f[k];for(w=0,b=G.length;w<b;++w){if((tt=G[w]).loaded){var D,U,q=LO(g=(D=tt.tile).tileCoord),B=g[1],X=g[2];Ge(this.Yy),Ve(this.Yy,2/(t.size[0]*F/P),-2/(t.size[1]*F/P)),Xe(this.Yy,i.rotation),Ve(this.Yy,1,1/I),Ye(this.Yy,(A[0]*(B-N)-u)/P,(A[1]*(X-z)-u)/R),this.helper.setUniformMatrixValue(GT.TILE_TRANSFORM,MM(this.Zy,this.Yy)),this.helper.bindBuffer(tt.coords),this.helper.bindBuffer(this.$y),this.helper.enableAttributes(UT);for(var V=0;V<tt.textures.length;){var W="TEXTURE"+V,Y="".concat(GT.TILE_TEXTURE_ARRAY,"[").concat(V,"]");n.activeTexture(n[W]),n.bindTexture(n.TEXTURE_2D,tt.textures[V]),n.uniform1i(this.helper.getUniformLocation(Y),V),++V}for(var Z=0;Z<this.tm.length;++Z){var H=this.tm[Z];n.activeTexture(n["TEXTURE"+V]);var K=H.getTexture(n);n.bindTexture(n.TEXTURE_2D,K),n.uniform1i(this.helper.getUniformLocation(H.name),V),++V}(U=q in l?l[q]:1)<1&&(t.animate=!0),this.helper.setUniformFloatValue(GT.TRANSITION_ALPHA,U),this.helper.setUniformFloatValue(GT.DEPTH,L),this.helper.setUniformFloatValue(GT.TEXTURE_PIXEL_WIDTH,P),this.helper.setUniformFloatValue(GT.TEXTURE_PIXEL_HEIGHT,R),this.helper.setUniformFloatValue(GT.TEXTURE_RESOLUTION,T),this.helper.setUniformFloatValue(GT.TEXTURE_ORIGIN_X,C[0]+B*A[0]*T-u*T),this.helper.setUniformFloatValue(GT.TEXTURE_ORIGIN_Y,C[1]-X*A[1]*T+u*T);var J=s;u>0&&Mr(J=o.getTileCoordExtent(g),s,J),this.helper.setUniformFloatVec4(GT.RENDER_EXTENT,J),this.helper.setUniformFloatValue(GT.RESOLUTION,i.resolution),this.helper.setUniformFloatValue(GT.ZOOM,i.zoom),this.helper.drawElements(0,this.$y.getSize())}}}this.helper.finalizeDraw(t,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);for(var $=this.helper.getCanvas(),Q=this.Qy;Q.canExpireCache();){var tt;(tt=Q.pop()).dispose()}return t.postRenderFunctions.push((function(t,n){r.expireCache(n.viewState.projection,qT)})),this.postRender(n,t),$},n.prototype.getData=function(t){if(!this.helper.getGL())return null;var n=this.Yi;if(!n)return null;var i=this.getLayer(),r=Be(n.pixelToCoordinateTransform,t.slice()),e=n.viewState,o=i.getExtent();if(o&&!$i(Ee(o,e.projection),r))return null;var u=i.getRenderSource(),s=u.getTileGridForProjection(e.projection);if(!u.getWrapX()){var a=s.getExtent();if(a&&!$i(a,r))return null}for(var f=this.Qy,h=s.getZForResolution(e.resolution);h>=s.getMinZoom();--h){var c=s.getTileCoordForCoordAndZ(r,h),l=WT(u,c);if(f.containsKey(l)){var v=f.get(l);if(v.loaded){var p=s.getOrigin(h),d=ua(s.getTileSize(h)),y=s.getResolution(h),m=(r[0]-p[0])/y-c[1]*d[0],w=(p[1]-r[1])/y-c[2]*d[1];return v.getPixelData(m,w)}}}return null},n.prototype.im=function(t,n,i,r){var e=t.getTileRangeForTileCoordAndZ(n,i,this.Hy);if(!e)return!1;for(var o=!0,u=this.Qy,s=this.getLayer().getRenderSource(),a=e.minX;a<=e.maxX;++a)for(var f=e.minY;f<=e.maxY;++f){var h=WT(s,[i,a,f]),c=!1;if(u.containsKey(h)){var l=u.get(h);l.loaded&&(XT(r,l,i),c=!0)}c||(o=!1)}return o},n.prototype.removeHelper=function(){if(this.helper){var n=this.Qy;n.forEach((function(t){return t.dispose()})),n.clear()}t.prototype.removeHelper.call(this)},n.prototype.disposeInternal=function(){var n=this.helper;n&&(n.getGL().deleteProgram(this.ed),delete this.ed,n.deleteBuffer(this.$y));t.prototype.disposeInternal.call(this),delete this.$y,delete this.Qy,delete this.Yi},n}(WM),ZT=1,HT=2,KT=4,JT=8,$T=16,QT=31,tA=0,nA={};function iA(t){if("number"==typeof t)return ZT;if("boolean"==typeof t)return JT;if("string"==typeof t)return zt(t)?KT|HT:HT;if(!Array.isArray(t))throw new Error("Unhandled value type: ".concat(JSON.stringify(t)));var n=t;if(n.every((function(t){return"number"==typeof t})))return 3===n.length||4===n.length?KT|$T:$T;if("string"!=typeof n[0])throw new Error("Expected an expression operator but received: ".concat(JSON.stringify(n)));var i=nA[n[0]];if(void 0===i)throw new Error("Unrecognized expression operator: ".concat(JSON.stringify(n)));return i.getReturnType(n.slice(1))}function rA(t){return M(t)%1==0}function eA(t){var n=t.toString();return-1===n.indexOf(".")?n+".0":n}function oA(t){if(t.length<2||t.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return"vec".concat(t.length,"(").concat(t.map(eA).join(", "),")")}function uA(t){var n=Rt(t).slice();return n.length<4&&n.push(1),oA(n.map((function(t,n){return n<3?t/255:t})))}function sA(t,n){return void 0===t.stringLiteralsMap[n]&&(t.stringLiteralsMap[n]=Object.keys(t.stringLiteralsMap).length),t.stringLiteralsMap[n]}function aA(t,n){return eA(sA(t,n))}function fA(t,n,i){if(Array.isArray(n)&&"string"==typeof n[0]){var r=nA[n[0]];if(void 0===r)throw new Error("Unrecognized expression operator: ".concat(JSON.stringify(n)));return r.toGlsl(t,n.slice(1),i)}var e=iA(n);if((e&ZT)>0)return eA(n);if((e&JT)>0)return n.toString();if((e&HT)>0&&(void 0===i||i==HT))return aA(t,n.toString());if((e&KT)>0&&(void 0===i||i==KT))return uA(n);if((e&$T)>0)return oA(n);throw new Error("Unexpected expression ".concat(n," (expected type ").concat(i,")"))}function hA(t){if(!(iA(t)&ZT))throw new Error("A numeric value was expected, got ".concat(JSON.stringify(t)," instead"))}function cA(t){for(var n=0;n<t.length;n++)hA(t[n])}function lA(t){if(!(iA(t)&HT))throw new Error("A string value was expected, got ".concat(JSON.stringify(t)," instead"))}function vA(t){if(!(iA(t)&JT))throw new Error("A boolean value was expected, got ".concat(JSON.stringify(t)," instead"))}function pA(t,n){if(t.length!==n)throw new Error("Exactly ".concat(n," arguments were expected, got ").concat(t.length," instead"))}function dA(t,n){if(t.length<n)throw new Error("At least ".concat(n," arguments were expected, got ").concat(t.length," instead"))}function yA(t,n){if(t.length>n)throw new Error("At most ".concat(n," arguments were expected, got ").concat(t.length," instead"))}function mA(t){if(t.length%2!=0)throw new Error("An even amount of arguments was expected, got ".concat(t," instead"))}function wA(t,n){if(!rA(n))throw new Error("Could not infer only one type from the following expression: ".concat(JSON.stringify(t)))}function bA(t){return"u_var_"+t}nA.get={getReturnType:function(t){return QT},toGlsl:function(t,n){pA(n,1),lA(n[0]);var i=n[0].toString();return-1===t.attributes.indexOf(i)&&t.attributes.push(i),(t.inFragmentShader?"v_":"a_")+i}},nA.var={getReturnType:function(t){return QT},toGlsl:function(t,n){pA(n,1),lA(n[0]);var i=n[0].toString();return-1===t.variables.indexOf(i)&&t.variables.push(i),bA(i)}};var gA="u_paletteTextures";nA.palette={getReturnType:function(t){return KT},toGlsl:function(t,n){pA(n,2),hA(n[0]);var i=fA(t,n[0]),r=n[1];if(!Array.isArray(r))throw new Error("The second argument of palette must be an array");for(var e=r.length,o=new Uint8Array(4*e),u=0;u<e;u++){var s=r[u],a=void 0;if("string"==typeof s)a=Pt(s);else{if(!Array.isArray(s))throw new Error("The second argument of palette must be an array of strings or colors");var f=s.length;if(4===f)a=s;else{if(3!==f)throw new Error("Expected palette color to have 3 or 4 values, got ".concat(f));a=[s[0],s[1],s[2],1]}}var h=4*u;o[h]=a[0],o[h+1]=a[1],o[h+2]=a[2],o[h+3]=255*a[3]}t.paletteTextures||(t.paletteTextures=[]);var c="".concat(gA,"[").concat(t.paletteTextures.length,"]"),l=new PT(c,o);return t.paletteTextures.push(l),"texture2D(".concat(c,", vec2((").concat(i," + 0.5) / ").concat(e,".0, 0.5))")}};var xA="getBandValue";function _A(t){return{getReturnType:function(t){return JT},toGlsl:function(n,i){pA(i,2);for(var r=QT,e=0;e<i.length;e++)r&=iA(i[e]);if(r===tA)throw new Error("All arguments should be of compatible type, got ".concat(JSON.stringify(i)," instead"));return r&=~KT,"(".concat(fA(n,i[0],r)," ").concat(t," ").concat(fA(n,i[1],r),")")}}}function MA(t){return{getReturnType:function(t){return JT},toGlsl:function(n,i){dA(i,2);for(var r=0;r<i.length;r++)vA(i[r]);var e="";return e=i.map((function(t){return fA(n,t)})).join(" ".concat(t," ")),e="(".concat(e,")")}}}nA.band={getReturnType:function(t){return ZT},toGlsl:function(t,n){dA(n,1),yA(n,3);var i=n[0];if(!(xA in t.functions)){for(var r="",e=t.bandCount||1,o=0;o<e;o++){var u=Math.floor(o/4),s=o%4;s===e-1&&1===s&&(s=3);var a="".concat(GT.TILE_TEXTURE_ARRAY,"[").concat(u,"]");r+="\n          if (band == ".concat(o+1,".0) {\n            return texture2D(").concat(a,", v_textureCoord + vec2(dx, dy))[").concat(s,"];\n          }\n        ")}t.functions.getBandValue="\n        float getBandValue(float band, float xOffset, float yOffset) {\n          float dx = xOffset / ".concat(GT.TEXTURE_PIXEL_WIDTH,";\n          float dy = yOffset / ").concat(GT.TEXTURE_PIXEL_HEIGHT,";\n          ").concat(r,"\n        }\n      ")}var f=fA(t,i),h=fA(t,n[1]||0),c=fA(t,n[2]||0);return"".concat(xA,"(").concat(f,", ").concat(h,", ").concat(c,")")}},nA.time={getReturnType:function(t){return ZT},toGlsl:function(t,n){return pA(n,0),"u_time"}},nA.zoom={getReturnType:function(t){return ZT},toGlsl:function(t,n){return pA(n,0),"u_zoom"}},nA.resolution={getReturnType:function(t){return ZT},toGlsl:function(t,n){return pA(n,0),"u_resolution"}},nA["*"]={getReturnType:function(t){return ZT},toGlsl:function(t,n){return pA(n,2),cA(n),"(".concat(fA(t,n[0])," * ").concat(fA(t,n[1]),")")}},nA["/"]={getReturnType:function(t){return ZT},toGlsl:function(t,n){return pA(n,2),cA(n),"(".concat(fA(t,n[0])," / ").concat(fA(t,n[1]),")")}},nA["+"]={getReturnType:function(t){return ZT},toGlsl:function(t,n){return pA(n,2),cA(n),"(".concat(fA(t,n[0])," + ").concat(fA(t,n[1]),")")}},nA["-"]={getReturnType:function(t){return ZT},toGlsl:function(t,n){return pA(n,2),cA(n),"(".concat(fA(t,n[0])," - ").concat(fA(t,n[1]),")")}},nA.clamp={getReturnType:function(t){return ZT},toGlsl:function(t,n){pA(n,3),cA(n);var i=fA(t,n[1]),r=fA(t,n[2]);return"clamp(".concat(fA(t,n[0]),", ").concat(i,", ").concat(r,")")}},nA["%"]={getReturnType:function(t){return ZT},toGlsl:function(t,n){return pA(n,2),cA(n),"mod(".concat(fA(t,n[0]),", ").concat(fA(t,n[1]),")")}},nA["^"]={getReturnType:function(t){return ZT},toGlsl:function(t,n){return pA(n,2),cA(n),"pow(".concat(fA(t,n[0]),", ").concat(fA(t,n[1]),")")}},nA.abs={getReturnType:function(t){return ZT},toGlsl:function(t,n){return pA(n,1),cA(n),"abs(".concat(fA(t,n[0]),")")}},nA.floor={getReturnType:function(t){return ZT},toGlsl:function(t,n){return pA(n,1),cA(n),"floor(".concat(fA(t,n[0]),")")}},nA.round={getReturnType:function(t){return ZT},toGlsl:function(t,n){return pA(n,1),cA(n),"floor(".concat(fA(t,n[0])," + 0.5)")}},nA.ceil={getReturnType:function(t){return ZT},toGlsl:function(t,n){return pA(n,1),cA(n),"ceil(".concat(fA(t,n[0]),")")}},nA.sin={getReturnType:function(t){return ZT},toGlsl:function(t,n){return pA(n,1),cA(n),"sin(".concat(fA(t,n[0]),")")}},nA.cos={getReturnType:function(t){return ZT},toGlsl:function(t,n){return pA(n,1),cA(n),"cos(".concat(fA(t,n[0]),")")}},nA.atan={getReturnType:function(t){return ZT},toGlsl:function(t,n){return dA(n,1),yA(n,2),cA(n),2===n.length?"atan(".concat(fA(t,n[0]),", ").concat(fA(t,n[1]),")"):"atan(".concat(fA(t,n[0]),")")}},nA[">"]={getReturnType:function(t){return JT},toGlsl:function(t,n){return pA(n,2),cA(n),"(".concat(fA(t,n[0])," > ").concat(fA(t,n[1]),")")}},nA[">="]={getReturnType:function(t){return JT},toGlsl:function(t,n){return pA(n,2),cA(n),"(".concat(fA(t,n[0])," >= ").concat(fA(t,n[1]),")")}},nA["<"]={getReturnType:function(t){return JT},toGlsl:function(t,n){return pA(n,2),cA(n),"(".concat(fA(t,n[0])," < ").concat(fA(t,n[1]),")")}},nA["<="]={getReturnType:function(t){return JT},toGlsl:function(t,n){return pA(n,2),cA(n),"(".concat(fA(t,n[0])," <= ").concat(fA(t,n[1]),")")}},nA["=="]=_A("=="),nA["!="]=_A("!="),nA["!"]={getReturnType:function(t){return JT},toGlsl:function(t,n){return pA(n,1),vA(n[0]),"(!".concat(fA(t,n[0]),")")}},nA.all=MA("&&"),nA.any=MA("||"),nA.between={getReturnType:function(t){return JT},toGlsl:function(t,n){pA(n,3),cA(n);var i=fA(t,n[1]),r=fA(t,n[2]),e=fA(t,n[0]);return"(".concat(e," >= ").concat(i," && ").concat(e," <= ").concat(r,")")}},nA.array={getReturnType:function(t){return $T},toGlsl:function(t,n){dA(n,2),yA(n,4),cA(n);var i=n.map((function(n){return fA(t,n,ZT)}));return"vec".concat(n.length,"(").concat(i.join(", "),")")}},nA.color={getReturnType:function(t){return KT},toGlsl:function(t,n){dA(n,3),yA(n,4),cA(n);var i=n;3===n.length&&i.push(1);var r=n.map((function(n,i){return fA(t,n,ZT)+(i<3?" / 255.0":"")}));return"vec".concat(n.length,"(").concat(r.join(", "),")")}},nA.interpolate={getReturnType:function(t){for(var n=KT|ZT,i=3;i<t.length;i+=2)n&=iA(t[i]);return n},toGlsl:function(t,n,i){mA(n),dA(n,6);var r,e=n[0];switch(e[0]){case"linear":r=1;break;case"exponential":r=e[1];break;default:r=null}if(!r)throw new Error('Invalid interpolation type for "interpolate" operator, received: '.concat(JSON.stringify(e)));var o=void 0!==i?i:QT,u=nA.interpolate.getReturnType(n)&o;wA(n,u);for(var s=fA(t,n[1]),a=eA(r),f="",h=2;h<n.length-2;h+=2){var c=fA(t,n[h]),l=f||fA(t,n[h+1],u),v=fA(t,n[h+2]),p=fA(t,n[h+3],u);f="mix(".concat(l,", ").concat(p,", pow(clamp((").concat(s," - ").concat(c,") / (").concat(v," - ").concat(c,"), 0.0, 1.0), ").concat(a,"))")}return f}},nA.match={getReturnType:function(t){for(var n=QT,i=2;i<t.length;i+=2)n&=iA(t[i]);return n&=iA(t[t.length-1])},toGlsl:function(t,n,i){mA(n),dA(n,4);var r=void 0!==i?i:QT,e=nA.match.getReturnType(n)&r;wA(n,e);for(var o=fA(t,n[0]),u=fA(t,n[n.length-1],e),s=null,a=n.length-3;a>=1;a-=2){var f=fA(t,n[a]),h=fA(t,n[a+1],e);s="(".concat(o," == ").concat(f," ? ").concat(h," : ").concat(s||u,")")}return s}},nA.case={getReturnType:function(t){for(var n=QT,i=1;i<t.length;i+=2)n&=iA(t[i]);return n&=iA(t[t.length-1])},toGlsl:function(t,n,i){!function(t){if(t.length%2==0)throw new Error("An odd amount of arguments was expected, got ".concat(t," instead"))}(n),dA(n,3);var r=void 0!==i?i:QT,e=nA.case.getReturnType(n)&r;wA(n,e);for(var o=0;o<n.length-1;o+=2)vA(n[o]);var u=fA(t,n[n.length-1],e),s=null;for(o=n.length-3;o>=0;o-=2){var a=fA(t,n[o]),f=fA(t,n[o+1],e);s="(".concat(a," ? ").concat(f," : ").concat(s||u,")")}return s}};var OA=function(){function t(){this.uniforms=[],this.attributes=[],this.varyings=[],this.sizeExpression="vec2(1.0)",this.rotationExpression="0.0",this.offsetExpression="vec2(0.0)",this.colorExpression="vec4(1.0)",this.texCoordExpression="vec4(0.0, 0.0, 1.0, 1.0)",this.discardExpression="false",this.rotateWithView=!1}return t.prototype.addUniform=function(t){return this.uniforms.push(t),this},t.prototype.addAttribute=function(t){return this.attributes.push(t),this},t.prototype.addVarying=function(t,n,i){return this.varyings.push({name:t,type:n,expression:i}),this},t.prototype.setSizeExpression=function(t){return this.sizeExpression=t,this},t.prototype.setRotationExpression=function(t){return this.rotationExpression=t,this},t.prototype.setSymbolOffsetExpression=function(t){return this.offsetExpression=t,this},t.prototype.setColorExpression=function(t){return this.colorExpression=t,this},t.prototype.setTextureCoordinateExpression=function(t){return this.texCoordExpression=t,this},t.prototype.setFragmentDiscardExpression=function(t){return this.discardExpression=t,this},t.prototype.setSymbolRotateWithView=function(t){return this.rotateWithView=t,this},t.prototype.getSizeExpression=function(){return this.sizeExpression},t.prototype.getOffsetExpression=function(){return this.offsetExpression},t.prototype.getColorExpression=function(){return this.colorExpression},t.prototype.getTextureCoordinateExpression=function(){return this.texCoordExpression},t.prototype.getFragmentDiscardExpression=function(){return this.discardExpression},t.prototype.getSymbolVertexShader=function(t){var n=this.rotateWithView?"u_offsetScaleMatrix * u_offsetRotateMatrix":"u_offsetScaleMatrix",i=this.attributes,r=this.varyings;return t&&(i=i.concat("vec4 a_hitColor"),r=r.concat({name:"v_hitColor",type:"vec4",expression:"a_hitColor"})),"precision mediump float;\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\nuniform float u_time;\nuniform float u_zoom;\nuniform float u_resolution;\n".concat(this.uniforms.map((function(t){return"uniform "+t+";"})).join("\n"),"\nattribute vec2 a_position;\nattribute float a_index;\n").concat(i.map((function(t){return"attribute "+t+";"})).join("\n"),"\nvarying vec2 v_texCoord;\nvarying vec2 v_quadCoord;\n").concat(r.map((function(t){return"varying "+t.type+" "+t.name+";"})).join("\n"),"\nvoid main(void) {\n  mat4 offsetMatrix = ").concat(n,";\n  vec2 halfSize = ").concat(this.sizeExpression," * 0.5;\n  vec2 offset = ").concat(this.offsetExpression,";\n  float angle = ").concat(this.rotationExpression,";\n  float offsetX;\n  float offsetY;\n  if (a_index == 0.0) {\n    offsetX = (offset.x - halfSize.x) * cos(angle) + (offset.y - halfSize.y) * sin(angle);\n    offsetY = (offset.y - halfSize.y) * cos(angle) - (offset.x - halfSize.x) * sin(angle);\n  } else if (a_index == 1.0) {\n    offsetX = (offset.x + halfSize.x) * cos(angle) + (offset.y - halfSize.y) * sin(angle);\n    offsetY = (offset.y - halfSize.y) * cos(angle) - (offset.x + halfSize.x) * sin(angle);\n  } else if (a_index == 2.0) {\n    offsetX = (offset.x + halfSize.x) * cos(angle) + (offset.y + halfSize.y) * sin(angle);\n    offsetY = (offset.y + halfSize.y) * cos(angle) - (offset.x + halfSize.x) * sin(angle);\n  } else {\n    offsetX = (offset.x - halfSize.x) * cos(angle) + (offset.y + halfSize.y) * sin(angle);\n    offsetY = (offset.y + halfSize.y) * cos(angle) - (offset.x - halfSize.x) * sin(angle);\n  }\n  vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n  vec4 texCoord = ").concat(this.texCoordExpression,";\n  float u = a_index == 0.0 || a_index == 3.0 ? texCoord.s : texCoord.p;\n  float v = a_index == 2.0 || a_index == 3.0 ? texCoord.t : texCoord.q;\n  v_texCoord = vec2(u, v);\n  u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;\n  v = a_index == 2.0 || a_index == 3.0 ? 0.0 : 1.0;\n  v_quadCoord = vec2(u, v);\n").concat(r.map((function(t){return"  "+t.name+" = "+t.expression+";"})).join("\n"),"\n}")},t.prototype.getSymbolFragmentShader=function(t){var n=t?"  if (gl_FragColor.a < 0.1) { discard; } gl_FragColor = v_hitColor;":"",i=this.varyings;return t&&(i=i.concat({name:"v_hitColor",type:"vec4",expression:"a_hitColor"})),"precision mediump float;\nuniform float u_time;\nuniform float u_zoom;\nuniform float u_resolution;\n".concat(this.uniforms.map((function(t){return"uniform "+t+";"})).join("\n"),"\nvarying vec2 v_texCoord;\nvarying vec2 v_quadCoord;\n").concat(i.map((function(t){return"varying "+t.type+" "+t.name+";"})).join("\n"),"\nvoid main(void) {\n  if (").concat(this.discardExpression,") { discard; }\n  gl_FragColor = ").concat(this.colorExpression,";\n  gl_FragColor.rgb *= gl_FragColor.a;\n").concat(n,"\n}")},t}();function SA(t){var n=t.symbol,i=void 0!==n.size?n.size:1,r=n.color||"white",e=n.textureCoord||[0,0,1,1],o=n.offset||[0,0],u=void 0!==n.opacity?n.opacity:1,s=void 0!==n.rotation?n.rotation:0,a={inFragmentShader:!1,variables:[],attributes:[],stringLiteralsMap:{},functions:{}},f=fA(a,i,$T|ZT),h=fA(a,o,$T),c=fA(a,e,$T),l=fA(a,s,ZT),v={inFragmentShader:!0,variables:a.variables,attributes:[],stringLiteralsMap:a.stringLiteralsMap,functions:{}},p=fA(v,r,KT),d=fA(v,u,ZT),y="1.0",m="vec2(".concat(fA(v,i,$T|ZT),").x");switch(n.symbolType){case"square":case"image":break;case"circle":y="(1.0-smoothstep(1.-4./".concat(m,",1.,dot(v_quadCoord-.5,v_quadCoord-.5)*4.))");break;case"triangle":var w="(v_quadCoord*2.-1.)",b="(atan(".concat(w,".x,").concat(w,".y))");y="(1.0-smoothstep(.5-3./".concat(m,",.5,cos(floor(.5+").concat(b,"/2.094395102)*2.094395102-").concat(b,")*length(").concat(w,")))");break;default:throw new Error("Unexpected symbol type: "+n.symbolType)}var g=(new OA).setSizeExpression("vec2(".concat(f,")")).setRotationExpression(l).setSymbolOffsetExpression(h).setTextureCoordinateExpression(c).setSymbolRotateWithView(!!n.rotateWithView).setColorExpression("vec4(".concat(p,".rgb, ").concat(p,".a * ").concat(d," * ").concat(y,")"));if(t.filter){var x=fA(v,t.filter,JT);g.setFragmentDiscardExpression("!".concat(x))}var _={};if(v.variables.forEach((function(n){var i=bA(n);g.addUniform("float ".concat(i)),_[i]=function(){if(!t.variables||void 0===t.variables[n])throw new Error("The following variable is missing from the style: ".concat(n));var i=t.variables[n];return"string"==typeof i&&(i=sA(a,i)),void 0!==i?i:-9999999}})),"image"===n.symbolType&&n.src){var M=new Image;M.crossOrigin=void 0===n.crossOrigin?"anonymous":n.crossOrigin,M.src=n.src,g.addUniform("sampler2D u_texture").setColorExpression(g.getColorExpression()+" * texture2D(u_texture, v_texCoord)"),_.u_texture=M}return v.attributes.forEach((function(t){-1===a.attributes.indexOf(t)&&a.attributes.push(t),g.addVarying("v_".concat(t),"float","a_".concat(t))})),a.attributes.forEach((function(t){g.addAttribute("float a_".concat(t))})),{builder:g,attributes:a.attributes.map((function(t){return{name:t,callback:function(n,i){var r=i[t];return"string"==typeof r&&(r=sA(a,r)),void 0!==r?r:-9999999}}})),uniforms:_}}var jA=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),EA=function(t){function n(n){var i=this,r=W({},n);return(i=t.call(this,r)||this).rm=SA(n.style),i.om=n.style.variables||{},i.um=!!n.disableHitDetection,i}return jA(n,t),n.prototype.createRenderer=function(){return new KM(this,{vertexShader:this.rm.builder.getSymbolVertexShader(),fragmentShader:this.rm.builder.getSymbolFragmentShader(),hitVertexShader:!this.um&&this.rm.builder.getSymbolVertexShader(!0),hitFragmentShader:!this.um&&this.rm.builder.getSymbolFragmentShader(!0),uniforms:this.rm.uniforms,attributes:this.rm.attributes})},n.prototype.updateStyleVariables=function(t){W(this.om,t),this.changed()},n}(Bn),kA=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();function TA(t,n){var i="\n    attribute vec2 ".concat(DT.TEXTURE_COORD,";\n    uniform mat4 ").concat(GT.TILE_TRANSFORM,";\n    uniform float ").concat(GT.TEXTURE_PIXEL_WIDTH,";\n    uniform float ").concat(GT.TEXTURE_PIXEL_HEIGHT,";\n    uniform float ").concat(GT.TEXTURE_RESOLUTION,";\n    uniform float ").concat(GT.TEXTURE_ORIGIN_X,";\n    uniform float ").concat(GT.TEXTURE_ORIGIN_Y,";\n    uniform float ").concat(GT.DEPTH,";\n\n    varying vec2 v_textureCoord;\n    varying vec2 v_mapCoord;\n\n    void main() {\n      v_textureCoord = ").concat(DT.TEXTURE_COORD,";\n      v_mapCoord = vec2(\n        ").concat(GT.TEXTURE_ORIGIN_X," + ").concat(GT.TEXTURE_RESOLUTION," * ").concat(GT.TEXTURE_PIXEL_WIDTH," * v_textureCoord[0],\n        ").concat(GT.TEXTURE_ORIGIN_Y," - ").concat(GT.TEXTURE_RESOLUTION," * ").concat(GT.TEXTURE_PIXEL_HEIGHT," * v_textureCoord[1]\n      );\n      gl_Position = ").concat(GT.TILE_TRANSFORM," * vec4(").concat(DT.TEXTURE_COORD,", ").concat(GT.DEPTH,", 1.0);\n    }\n  "),r={inFragmentShader:!0,variables:[],attributes:[],stringLiteralsMap:{},functions:{},bandCount:n},e=[];if(void 0!==t.color){var o=fA(r,t.color,KT);e.push("color = ".concat(o,";"))}if(void 0!==t.contrast){var u=fA(r,t.contrast,ZT);e.push("color.rgb = clamp((".concat(u," + 1.0) * color.rgb - (").concat(u," / 2.0), vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));"))}if(void 0!==t.exposure){var s=fA(r,t.exposure,ZT);e.push("color.rgb = clamp((".concat(s," + 1.0) * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));"))}if(void 0!==t.saturation){var a=fA(r,t.saturation,ZT);e.push("\n      float saturation = ".concat(a," + 1.0;\n      float sr = (1.0 - saturation) * 0.2126;\n      float sg = (1.0 - saturation) * 0.7152;\n      float sb = (1.0 - saturation) * 0.0722;\n      mat3 saturationMatrix = mat3(\n        sr + saturation, sr, sr,\n        sg, sg + saturation, sg,\n        sb, sb, sb + saturation\n      );\n      color.rgb = clamp(saturationMatrix * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));\n    "))}if(void 0!==t.gamma){var f=fA(r,t.gamma,ZT);e.push("color.rgb = pow(color.rgb, vec3(1.0 / ".concat(f,"));"))}if(void 0!==t.brightness){var h=fA(r,t.brightness,ZT);e.push("color.rgb = clamp(color.rgb + ".concat(h,", vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));"))}var c={},l=r.variables.length;if(l>1&&!t.variables)throw new Error("Missing variables in style (expected ".concat(r.variables,")"));for(var v=function(n){var i=r.variables[n];if(!(i in t.variables))throw new Error("Missing '".concat(i,"' in style variables"));var e=bA(i);c[e]=function(){var n=t.variables[i];return"string"==typeof n&&(n=sA(r,n)),void 0!==n?n:-9999999}},p=0;p<l;++p)v(p);var d=Object.keys(c).map((function(t){return"uniform float ".concat(t,";")})),y=Math.ceil(n/4);d.push("uniform sampler2D ".concat(GT.TILE_TEXTURE_ARRAY,"[").concat(y,"];")),r.paletteTextures&&d.push("uniform sampler2D ".concat(gA,"[").concat(r.paletteTextures.length,"];"));var m=Object.keys(r.functions).map((function(t){return r.functions[t]}));return{vertexShader:i,fragmentShader:"\n    #ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n    #else\n    precision mediump float;\n    #endif\n\n    varying vec2 v_textureCoord;\n    varying vec2 v_mapCoord;\n    uniform vec4 ".concat(GT.RENDER_EXTENT,";\n    uniform float ").concat(GT.TRANSITION_ALPHA,";\n    uniform float ").concat(GT.TEXTURE_PIXEL_WIDTH,";\n    uniform float ").concat(GT.TEXTURE_PIXEL_HEIGHT,";\n    uniform float ").concat(GT.RESOLUTION,";\n    uniform float ").concat(GT.ZOOM,";\n\n    ").concat(d.join("\n"),"\n\n    ").concat(m.join("\n"),"\n\n    void main() {\n      if (\n        v_mapCoord[0] < ").concat(GT.RENDER_EXTENT,"[0] ||\n        v_mapCoord[1] < ").concat(GT.RENDER_EXTENT,"[1] ||\n        v_mapCoord[0] > ").concat(GT.RENDER_EXTENT,"[2] ||\n        v_mapCoord[1] > ").concat(GT.RENDER_EXTENT,"[3]\n      ) {\n        discard;\n      }\n\n      vec4 color = texture2D(").concat(GT.TILE_TEXTURE_ARRAY,"[0],  v_textureCoord);\n\n      ").concat(e.join("\n"),"\n\n      if (color.a == 0.0) {\n        discard;\n      }\n\n      gl_FragColor = color;\n      gl_FragColor.rgb *= gl_FragColor.a;\n      gl_FragColor *= ").concat(GT.TRANSITION_ALPHA,";\n    }"),uniforms:c,paletteTextures:r.paletteTextures}}var AA=function(t){function n(n){var i=this,r=n?W({},n):{},e=r.style||{};delete r.style;var o=r.cacheSize;return delete r.cacheSize,(i=t.call(this,r)||this).sm=r.sources,i.am=null,i.ph=NaN,i.je=e,i.Qt=o,i.om=i.je.variables||{},i.addChangeListener(En,i.fm),i}return kA(n,t),n.prototype.getSources=function(t,n){var i=this.getSource();return this.sm?"function"==typeof this.sm?this.sm(t,n):this.sm:i?[i]:[]},n.prototype.getRenderSource=function(){return this.am||this.getSource()},n.prototype.getSourceState=function(){var t=this.getRenderSource();return t?t.getState():Fn},n.prototype.fm=function(){this.getSource()&&this.setStyle(this.je)},n.prototype.hm=function(){var t=this.getSource();return t&&"bandCount"in t?t.bandCount:4},n.prototype.createRenderer=function(){var t=TA(this.je,this.hm());return new YT(this,{vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,uniforms:t.uniforms,cacheSize:this.Qt,paletteTextures:t.paletteTextures})},n.prototype.renderSources=function(t,n){for(var i,r=this.getRenderer(),e=0,o=n.length;e<o;++e)this.am=n[e],r.prepareFrame(t)&&(i=r.renderFrame(t));return i},n.prototype.render=function(t,n){var i=this;this.rendered=!0;for(var r=t.viewState,e=this.getSources(t.extent,r.resolution),o=!0,u=function(t,n){var r=e[t],u=r.getState();if(u==Ln){r.addEventListener("change",(function t(){r.getState()==Gn&&(r.removeEventListener("change",t),i.changed())}))}o=o&&u==Gn},s=0,a=e.length;s<a;++s)u(s);var f=this.renderSources(t,e);if(this.getRenderer().renderComplete&&o)return this.ph=r.resolution,f;if(this.ph>.5*r.resolution){var h=this.getSources(t.extent,this.ph).filter((function(t){return!e.includes(t)}));if(h.length>0)return this.renderSources(t,h)}return f},n.prototype.setStyle=function(t){this.om=t.variables||{},this.je=t;var n=TA(this.je,this.hm());this.getRenderer().reset({vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,uniforms:n.uniforms,paletteTextures:n.paletteTextures}),this.changed()},n.prototype.updateStyleVariables=function(t){W(this.om,t),this.changed()},n}(iM);AA.prototype.dispose;var CA=AA,PA=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),RA=function(t){function n(n){return(n=W({},n)).controls||(n.controls=za()),n.interactions||(n.interactions=K_({onFocusOnly:!0})),t.call(this,n)||this}return PA(n,t),n.prototype.createRenderer=function(){return new Po(this)},n}(ha);var IA=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),NA=function(t){function n(n,i,r,e,o,u,s){var a=this,f=n.getExtent(),h=i.getExtent(),c=h?Mr(r,h):r,l=pO(n,i,br(c),e),v=new cO(n,i,c,f,.5*l,e),p=u(v.calculateSourceExtent(),l,o),d=p?uv:hv,y=p?p.getPixelRatio():1;return(a=t.call(this,r,e,y,d)||this).Cd=i,a.Rd=f,a.Kd=v,a.yi=e,a.lm=r,a.vm=p,a.pm=y,a.kh=s,a.Eo=null,a.dm=null,a}return IA(n,t),n.prototype.disposeInternal=function(){this.state==sv&&this.ym(),t.prototype.disposeInternal.call(this)},n.prototype.getImage=function(){return this.Eo},n.prototype.getProjection=function(){return this.Cd},n.prototype.Jd=function(){var t=this.vm.getState();if(t==av){var n=jr(this.lm)/this.yi,i=_r(this.lm)/this.yi;this.Eo=yO(n,i,this.pm,this.vm.getResolution(),this.Rd,this.yi,this.lm,this.Kd,[{extent:this.vm.getExtent(),image:this.vm.getImage()}],0,void 0,this.kh)}this.state=t,this.changed()},n.prototype.load=function(){if(this.state==uv){this.state=sv,this.changed();var t=this.vm.getState();t==av||t==fv?this.Jd():(this.dm=lt(this.vm,$,(function(t){var n=this.vm.getState();n!=av&&n!=fv||(this.ym(),this.Jd())}),this),this.vm.load())}},n.prototype.ym=function(){pt(this.dm),this.dm=null},n}(vv),zA=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();function FA(t){var n,i,r=t[0],e=new Array(r),o=1<<r-1;for(n=0;n<r;++n)i=48,t[1]&o&&(i+=1),t[2]&o&&(i+=2),e[n]=String.fromCharCode(i),o>>=1;return e.join("")}for(var LA=function(t){function n(n){var i=this,r=void 0!==n.hidpi&&n.hidpi,e=void 0===n.imageSmoothing||n.imageSmoothing;return void 0!==n.interpolate&&(e=n.interpolate),(i=t.call(this,{cacheSize:n.cacheSize,crossOrigin:"anonymous",interpolate:e,opaque:!0,projection:ae("EPSG:3857"),reprojectionErrorThreshold:n.reprojectionErrorThreshold,state:Ln,tileLoadFunction:n.tileLoadFunction,tilePixelRatio:r?2:1,wrapX:void 0===n.wrapX||n.wrapX,transition:n.transition,zDirection:n.zDirection})||this).wm=r,i.bm=void 0!==n.culture?n.culture:"en-us",i.gm=void 0!==n.maxZoom?n.maxZoom:-1,i.xm=n.key,i._m=n.imagerySet,OS("https://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+i._m+"?uriScheme=https&include=ImageryProviders&key="+i.xm+"&c="+i.bm,i.handleImageryMetadataResponse.bind(i),void 0,"jsonp"),i}return zA(n,t),n.prototype.getApiKey=function(){return this.xm},n.prototype.getImagerySet=function(){return this._m},n.prototype.handleImageryMetadataResponse=function(t){if(200==t.statusCode&&"OK"==t.statusDescription&&"ValidCredentials"==t.authenticationResultCode&&1==t.resourceSets.length&&1==t.resourceSets[0].resources.length){var n=t.resourceSets[0].resources[0],i=-1==this.gm?n.zoomMax:this.gm,r=iS(this.getProjection()),e=this.wm?2:1,o=n.imageWidth==n.imageHeight?n.imageWidth/e:[n.imageWidth/e,n.imageHeight/e],u=QO({extent:r,minZoom:n.zoomMin,maxZoom:i,tileSize:o});this.tileGrid=u;var s=this.bm,a=this.wm;if(this.tileUrlFunction=fS(n.imageUrlSubdomains.map((function(t){var i=[0,0,0],r=n.imageUrl.replace("{subdomain}",t).replace("{culture}",s);return function(t,n,e){if(t){zO(t[0],t[1],t[2],i);var o=r;return a&&(o+="&dpi=d1&device=mobile"),o.replace("{quadkey}",FA(i))}}}))),n.imageryProviders){var f=me(ae("EPSG:4326"),this.getProjection());this.setAttributions(function(t){var i=[],r=t.viewState,e=this.getTileGrid(),o=e.getZForResolution(r.resolution,this.zDirection),u=e.getTileCoordForCoordAndZ(r.center,o)[0];return n.imageryProviders.map((function(n){for(var r=!1,e=n.coverageAreas,o=0,s=e.length;o<s;++o){var a=e[o];if(u>=a.zoomMin&&u<=a.zoomMax){var h=a.bbox;if(Er(Pr([h[1],h[0],h[3],h[2]],f),t.extent)){r=!0;break}}}r&&i.push(n.attribution)})),i.push('<a class="ol-attribution-bing-tos" href="https://www.microsoft.com/maps/product/terms.html" target="_blank">Terms of Use</a>'),i}.bind(this))}this.setState(Gn)}else this.setState(Dn)},n}(_S),GA=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),DA=function(t){function n(n){var i=this,r=n||{},e=void 0===r.imageSmoothing||r.imageSmoothing;void 0!==r.interpolate&&(e=r.interpolate);var o=void 0!==r.projection?r.projection:"EPSG:3857",u=void 0!==r.tileGrid?r.tileGrid:QO({extent:iS(o),maxResolution:r.maxResolution,maxZoom:r.maxZoom,minZoom:r.minZoom,tileSize:r.tileSize});return(i=t.call(this,{attributions:r.attributions,cacheSize:r.cacheSize,crossOrigin:r.crossOrigin,interpolate:e,opaque:r.opaque,projection:o,reprojectionErrorThreshold:r.reprojectionErrorThreshold,tileGrid:u,tileLoadFunction:r.tileLoadFunction,tilePixelRatio:r.tilePixelRatio,tileUrlFunction:r.tileUrlFunction,url:r.url,urls:r.urls,wrapX:void 0===r.wrapX||r.wrapX,transition:r.transition,attributionsCollapsible:r.attributionsCollapsible,zDirection:r.zDirection})||this).Bd=void 0!==r.gutter?r.gutter:0,i}return GA(n,t),n.prototype.getGutter=function(){return this.Bd},n}(_S),UA=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),qA=function(t){function n(n){var i=t.call(this,{attributions:n.attributions,cacheSize:n.cacheSize,crossOrigin:n.crossOrigin,maxZoom:void 0!==n.maxZoom?n.maxZoom:18,minZoom:n.minZoom,projection:n.projection,transition:n.transition,wrapX:n.wrapX,zDirection:n.zDirection})||this;return i.Mm=n.account,i.Om=n.map||"",i.Sm=n.config||{},i.jm={},i.Em(),i}return UA(n,t),n.prototype.getConfig=function(){return this.Sm},n.prototype.updateConfig=function(t){W(this.Sm,t),this.Em()},n.prototype.setConfig=function(t){this.Sm=t||{},this.Em()},n.prototype.Em=function(){var t=JSON.stringify(this.Sm);if(this.jm[t])this.km(this.jm[t]);else{var n="https://"+this.Mm+".carto.com/api/v1/map";this.Om&&(n+="/named/"+this.Om);var i=new XMLHttpRequest;i.addEventListener("load",this.Tm.bind(this,t)),i.addEventListener("error",this.Am.bind(this)),i.open("POST",n),i.setRequestHeader("Content-type","application/json"),i.send(JSON.stringify(this.Sm))}},n.prototype.Tm=function(t,n){var i=n.target;if(!i.status||i.status>=200&&i.status<300){var r=void 0;try{r=JSON.parse(i.responseText)}catch(t){return void this.setState(Dn)}this.km(r),this.jm[t]=r,this.setState(Gn)}else this.setState(Dn)},n.prototype.Am=function(t){this.setState(Dn)},n.prototype.km=function(t){var n="https://"+t.cdn_url.https+"/"+this.Mm+"/api/v1/map/"+t.layergroupid+"/{z}/{x}/{y}.png";this.setUrl(n)},n}(DA),BA=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),XA=function(t){function n(n){var i=t.call(this,{attributions:n.attributions,wrapX:n.wrapX})||this;return i.resolution=void 0,i.distance=void 0!==n.distance?n.distance:20,i.minDistance=n.minDistance||0,i.interpolationRatio=0,i.features=[],i.geometryFunction=n.geometryFunction||function(t){var n=t.getGeometry();return g(n.getType()==Kr.POINT,10),n},i.Cm=n.createCluster,i.source=null,i.Pm=i.refresh.bind(i),i.updateDistance(i.distance,i.minDistance),i.setSource(n.source||null),i}return BA(n,t),n.prototype.clear=function(n){this.features.length=0,t.prototype.clear.call(this,n)},n.prototype.getDistance=function(){return this.distance},n.prototype.getSource=function(){return this.source},n.prototype.loadFeatures=function(t,n,i){this.source.loadFeatures(t,n,i),n!==this.resolution&&(this.resolution=n,this.refresh())},n.prototype.setDistance=function(t){this.updateDistance(t,this.minDistance)},n.prototype.setMinDistance=function(t){this.updateDistance(this.distance,t)},n.prototype.getMinDistance=function(){return this.minDistance},n.prototype.setSource=function(t){this.source&&this.source.removeEventListener($,this.Pm),this.source=t,t&&t.addEventListener($,this.Pm),this.refresh()},n.prototype.refresh=function(){this.clear(),this.cluster(),this.addFeatures(this.features)},n.prototype.updateDistance=function(t,n){var i=0===t?0:Math.min(n,t)/t,r=t!==this.distance||this.interpolationRatio!==i;this.distance=t,this.minDistance=n,this.interpolationRatio=i,r&&this.refresh()},n.prototype.cluster=function(){if(void 0!==this.resolution&&this.source)for(var t=[1/0,1/0,-1/0,-1/0],n=this.distance*this.resolution,i=this.source.getFeatures(),r={},e=0,o=i.length;e<o;e++){var u=i[e];if(!(d(u)in r)){var s=this.geometryFunction(u);if(s){or(s.getCoordinates(),t),Hi(t,n,t);var a=this.source.getFeaturesInExtent(t).filter((function(t){var n=d(t);return!(n in r)&&(r[n]=!0,!0)}));this.features.push(this.createCluster(a,t))}}}},n.prototype.createCluster=function(t,n){for(var i=[0,0],r=t.length-1;r>=0;--r){var e=this.geometryFunction(t[r]);e?zr(i,e.getCoordinates()):t.splice(r,1)}Br(i,1/t.length);var o=br(n),u=this.interpolationRatio,s=new _s([i[0]*(1-u)+o[0]*u,i[1]*(1-u)+o[1]*u]);return this.Cm?this.Cm(s,t):new ef({geometry:s,features:t})},n}(Bx),VA="1.3.0",WA=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),YA=function(t){function n(n){var i=this,r=void 0===n.projection?"EPSG:3857":n.projection,e=n.tileGrid;if(void 0===e&&r&&(e=QO({extent:iS(r),maxResolution:n.maxResolution,maxZoom:n.maxZoom,minZoom:n.minZoom,tileSize:n.tileSize})),(i=t.call(this,{cacheSize:.1,attributions:n.attributions,attributionsCollapsible:n.attributionsCollapsible,projection:r,tileGrid:e,opaque:n.opaque,state:n.state,tilePixelRatio:n.tilePixelRatio,wrapX:n.wrapX,transition:n.transition,interpolate:n.interpolate})||this).Bd=void 0!==n.gutter?n.gutter:0,i._y=n.tileSize?ua(n.tileSize):null,!i._y&&n.tilePixelRatio&&e){var o=ua(e.getTileSize(0));i._y=[o[0]*n.tilePixelRatio,o[1]*n.tilePixelRatio]}return i.xy=null,i.Py={},i.ge=n.loader,i.hr=i.hr.bind(i),i.bandCount=void 0===n.bandCount?4:n.bandCount,i.tileGridForProjection={},i.tileCacheForProjection={},i.ar,i.Rm,i.Im,i.Nm,i.zm,i}return WA(n,t),n.prototype.setTileSizes=function(t){this.xy=t},n.prototype.getTileSize=function(t){if(this.xy)return this.xy[t];if(this._y)return this._y;var n=this.getTileGrid();return n?ua(n.getTileSize(t)):[256,256]},n.prototype.getGutterForProjection=function(t){var n=this.getProjection();return!n||ye(n,t)?this.Bd:0},n.prototype.setLoader=function(t){this.ge=t},n.prototype.getTile=function(t,n,i,r,e){var o=this.getProjection();if(o&&e&&!ye(o,e)){var u=FO(t,n,i),s=this.getTileCacheForProjection(e);if(s.containsKey(u))return s.get(u);var a=this,f=a.getTileGrid(),h=Math.max.apply(null,f.getResolutions().map((function(t,n){var i=ua(f.getTileSize(n)),r=a.getTileSize(n);return Math.max(r[0]/i[0],r[1]/i[1])}))),c=ua(a.getTileGridForProjection(e).getTileSize(t)),l=[Math.round(c[0]*h),Math.round(c[1]*h)],v=new Da(W({tileCoord:[t,n,i],loader:function(){return a.Fm([t,n,i],r,e).then((function(t){return t||Promise.reject()}))},size:l},this.tileOptions));return v.key=this.getKey(),v.addEventListener($,this.hr),s.set(u,v),v}var p=this.getTileSize(t),d=FO(t,n,i);if(this.tileCache.containsKey(d))return this.tileCache.get(d);var y=this.ge;var m=W({tileCoord:[t,n,i],loader:function(){return V((function(){return y(t,n,i)}))},size:p},this.tileOptions),w=new Da(m);return w.key=this.getKey(),w.addEventListener($,this.hr),this.tileCache.set(d,w),w},n.prototype.hr=function(t){var n,i=t.target,r=d(i),e=i.getState();e==hu?(this.Py[r]=!0,n=VO):r in this.Py&&(delete this.Py[r],n=e==lu?YO:e==cu?WO:void 0),n&&this.dispatchEvent(new oS(n,i))},n.prototype.getTileData=function(t,n){var i=(n||{}).pixelRatio||1,r=this;return r.ar||(r.ar=new du((function(){return 1}),B)),new Promise((function(n,e){var o=r.getState(),u=function(){if(o===Gn){var e=r.getProjection(),u=r.getTile(t[0],t[1],t[2],i,e);if(u){var s=u.getState();if(s===cu)n(u.getData());else if(s===vu)n(void 0);else{var a=lt(u,$,(function(){var t=u.getState();t!==hu&&(pt(a),r.ar.loadMoreTiles(8,8),n(t===cu?u.getData():void 0))}));s===lu&&(u.state=fu);var f=u.getKey();r.ar.isKeyQueued(f)||(r.ar.enqueue([u]),r.ar.loadMoreTiles(8,8))}return}}n(void 0)};if(o!==Ln)u();else var s=lt(r,$,(function(){(o=r.getState())!==Ln&&(pt(s),u())}))}))},n.prototype.getTileGridForProjection=function(t){var n=this.getProjection();if(!this.tileGrid||n&&!ye(n,t)){var i=d(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=KO(t)),this.tileGridForProjection[i]}return this.tileGrid},n.prototype.setTileGridForProjection=function(t,n){var i=ae(t);if(i){var r=d(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=n)}},n.prototype.getTileCacheForProjection=function(t){var n=this.getProjection();if(!n||ye(n,t))return this.tileCache;var i=d(t);return i in this.tileCacheForProjection||(this.tileCacheForProjection[i]=new XO(.1)),this.tileCacheForProjection[i]},n.prototype.expireCache=function(t,n){var i=this.getTileCacheForProjection(t);for(var r in this.tileCache.expireCache(this.tileCache==i?n:{}),this.tileCacheForProjection){var e=this.tileCacheForProjection[r];e.expireCache(e==i?n:{})}},n.prototype.Fm=function(t,i,r){var e=this;function o(t){var n=e.getProjection(),o=e.getTileGrid(),u=Math.max.apply(null,o.getResolutions().map((function(t,n){var i=ua(o.getTileSize(n)),r=e.getTileSize(n);return Math.max(r[0]/i[0],r[1]/i[1])}))),s=new DA({projection:n,tileGrid:o,tilePixelRatio:u,url:"{z}/{x}/{y}:"+t,cacheSize:.1,gutter:e.getGutterForProjection(n),tileLoadFunction:function(n){(function(t,n){return e.getTileData(t,{pixelRatio:i}).then((function(i){if(i){var r=e.getTileSize(t[0]),o=e.getGutterForProjection(e.getProjection()),u=[r[0]+2*o,r[1]+2*o],s=i instanceof Float32Array,a=u[0]*u[1],f=s?Float32Array:Uint8Array,h=new f(i.buffer),c=f.BYTES_PER_ELEMENT,l=c*h.length/a,v=h.byteLength/u[1],p=Math.floor(v/c/u[0]),d=a*p,y=h;if(h.length!==d){y=new f(d);for(var m=0,w=0,b=u[0]*p,g=0;g<u[1];++g){for(var x=0;x<b;++x)y[m++]=h[w+x];w+=v/c}}var _=new Uint8Array(y.buffer),M=document.createElement("canvas");M.width=u[0],M.height=u[1];for(var O=M.getContext("2d"),S=O.getImageData(0,0,M.width,M.height),j=S.data,E=3*n,k=0,T=j.length;k<T;k+=4)j[k]=_[E],j[k+1]=_[E+1],j[k+2]=_[E+2],j[k+3]=255,E+=l;return O.putImageData(S,0,0),e.Rm=f,e.Im=l,M}}))})(n.getTileCoord(),t).then((function(t){t?n.setImage(t):n.setState(lu)}))},interpolate:!1});return s.setTileGridForProjection(r,e.getTileGridForProjection(r)),s}e.zm||(e.tileCache=new XO(0),e.Nm=[],e.zm={});var u=d(r);u in e.zm||(e.zm[u]=new n({projection:r,interpolate:e.getInterpolate(),tileGrid:e.getTileGridForProjection(r),wrapX:e.getWrapX(),loader:function(t,n,i){var u=[];return function s(a){return a===e.Nm.length&&e.Nm.push(o(a)),e.Nm[a].getTileImage([t,n,i],{projection:r}).then((function(t){if(!t)return Promise.reject();u.push(t);var n,i,o=Math.ceil(e.Im/3);if(a<o-1)return s(a+1);for(var f=u.length-1;f>=0;f--){var h=u[f];n||(i=new Uint8Array(e.Im*h.width*h.height),n=new e.Rm(i.buffer));for(var c=h.getContext("2d").getImageData(0,0,h.width,h.height).data,l=3*f,v=0,p=c.length;v<p;v+=4)i[l]=c[v],i[l+1]=c[v+1],i[l+2]=c[v+2],l+=e.Im}for(v=0,p=e.Nm.length;v<p;v++)e.Nm[v].expireCache(r,{});return n||Promise.reject()}))}(0)}}));var s=e.zm[u],a=s.getTileCoordForTileUrlFunction(t,r);return s.getTileData(a,{pixelRatio:i})},n}(uS),ZA=new ArrayBuffer(4),HA=new Float32Array(ZA),KA=new Uint32Array(ZA),JA=new Uint32Array(512),$A=new Uint32Array(512),QA=0;QA<256;++QA){var tC=QA-127;tC<-27?(JA[QA]=0,JA[256|QA]=32768,$A[QA]=24,$A[256|QA]=24):tC<-14?(JA[QA]=1024>>-tC-14,JA[256|QA]=1024>>-tC-14|32768,$A[QA]=-tC-1,$A[256|QA]=-tC-1):tC<=15?(JA[QA]=tC+15<<10,JA[256|QA]=tC+15<<10|32768,$A[QA]=13,$A[256|QA]=13):tC<128?(JA[QA]=31744,JA[256|QA]=64512,$A[QA]=24,$A[256|QA]=24):(JA[QA]=31744,JA[256|QA]=64512,$A[QA]=13,$A[256|QA]=13)}var nC=new Uint32Array(2048),iC=new Uint32Array(64),rC=new Uint32Array(64);nC[0]=0;for(var eC=1;eC<1024;++eC){for(var oC=eC<<13,uC=0;0==(8388608&oC);)uC-=8388608,oC<<=1;oC&=-8388609,uC+=947912704,nC[eC]=oC|uC}for(var sC=1024;sC<2048;++sC)nC[sC]=939524096+(sC-1024<<13);iC[0]=0;for(var aC=1;aC<31;++aC)iC[aC]=aC<<23;iC[31]=1199570944,iC[32]=2147483648;for(var fC=33;fC<63;++fC)iC[fC]=2147483648+(fC-32<<23);iC[63]=3347054592,rC[0]=0;for(var hC=1;hC<64;++hC)rC[hC]=32===hC?0:1024;function cC(t){var n=t>>10;return KA[0]=nC[rC[n]+(1023&t)]+iC[n],HA[0]}var lC=Reflect.getPrototypeOf(Uint8Array).prototype,vC=Reflect.getOwnPropertyDescriptor(lC,Symbol.toStringTag).get;function pC(t){return void 0!==vC.call(t)}var dC=Object.prototype.toString;function yC(t){return!!ArrayBuffer.isView(t)&&(!pC(t)&&"[object DataView]"===dC.call(t))}function mC(t,n){if(!yC(t))throw new TypeError("First argument to getFloat16 function must be a DataView");for(var i=arguments.length,r=new Array(i>2?i-2:0),e=2;e<i;e++)r[e-2]=arguments[e];return cC(t.getUint16.apply(t,[n].concat(r)))}var wC=i(802),bC=i(51),gC=i(150);function xC(t,n){for(var i,r=t.width,e=t.height,o=new Uint8Array(r*e*3),u=0,s=0;u<t.length;++u,s+=3)i=256-t[u]/n*256,o[s]=i,o[s+1]=i,o[s+2]=i;return o}function _C(t,n){for(var i,r=t.width,e=t.height,o=new Uint8Array(r*e*3),u=0,s=0;u<t.length;++u,s+=3)i=t[u]/n*256,o[s]=i,o[s+1]=i,o[s+2]=i;return o}function MC(t,n){for(var i=t.width,r=t.height,e=new Uint8Array(i*r*3),o=n.length/3,u=n.length/3*2,s=0,a=0;s<t.length;++s,a+=3){var f=t[s];e[a]=n[f]/65536*256,e[a+1]=n[f+o]/65536*256,e[a+2]=n[f+u]/65536*256}return e}function OC(t){for(var n=t.width,i=t.height,r=new Uint8Array(n*i*3),e=0,o=0;e<t.length;e+=4,o+=3){var u=t[e],s=t[e+1],a=t[e+2],f=t[e+3];r[o]=(255-u)/256*255*((255-f)/256),r[o+1]=(255-s)/256*255*((255-f)/256),r[o+2]=(255-a)/256*255*((255-f)/256)}return r}function SC(t){for(var n=t.width,i=t.height,r=new Uint8ClampedArray(n*i*3),e=0,o=0;e<t.length;e+=3,o+=3){var u=t[e],s=t[e+1],a=t[e+2];r[o]=u+1.402*(a-128),r[o+1]=u-.34414*(s-128)-.71414*(a-128),r[o+2]=u+1.772*(s-128)}return r}function jC(t){for(var n=t.width,i=t.height,r=new Uint8Array(n*i*3),e=0,o=0;e<t.length;e+=3,o+=3){var u=(t[e+0]+16)/116,s=(t[e+1]<<24>>24)/500+u,a=u-(t[e+2]<<24>>24)/200,f=void 0,h=void 0,c=void 0;h=-.9689*(s=.95047*(s*s*s>.008856?s*s*s:(s-16/116)/7.787))+1.8758*(u=1*(u*u*u>.008856?u*u*u:(u-16/116)/7.787))+.0415*(a=1.08883*(a*a*a>.008856?a*a*a:(a-16/116)/7.787)),c=.0557*s+-.204*u+1.057*a,f=(f=3.2406*s+-1.5372*u+-.4986*a)>.0031308?1.055*Math.pow(f,1/2.4)-.055:12.92*f,h=h>.0031308?1.055*Math.pow(h,1/2.4)-.055:12.92*h,c=c>.0031308?1.055*Math.pow(c,1/2.4)-.055:12.92*c,r[o]=255*Math.max(0,Math.min(1,f)),r[o+1]=255*Math.max(0,Math.min(1,h)),r[o+2]=255*Math.max(0,Math.min(1,c))}return r}function EC(t,n,i,r,e,o,u){try{var s=t[o](u),a=s.value}catch(t){return void i(t)}s.done?n(a):Promise.resolve(a).then(r,e)}function kC(t){return function(){var n=this,i=arguments;return new Promise((function(r,e){var o=t.apply(n,i);function u(t){EC(o,r,e,u,s,"next",t)}function s(t){EC(o,r,e,u,s,"throw",t)}u(void 0)}))}}var TC=new Map;function AC(t,n){Array.isArray(t)||(t=[t]),t.forEach((function(t){return TC.set(t,n)}))}function CC(t){return PC.apply(this,arguments)}function PC(){return(PC=kC(regeneratorRuntime.mark((function t(n){var i,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=TC.get(n.Compression)){t.next=3;break}throw new Error("Unknown compression method identifier: ".concat(n.Compression));case 3:return t.next=5,i();case 5:return r=t.sent,t.abrupt("return",new r(n));case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function RC(t,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return new(Object.getPrototypeOf(t).constructor)(n*i*r)}function IC(t,n,i,r,e){var o=n/r,u=i/e;return t.map((function(t){for(var s=RC(t,r,e),a=0;a<e;++a)for(var f=Math.min(Math.round(u*a),i-1),h=0;h<r;++h){var c=Math.min(Math.round(o*h),n-1),l=t[f*n+c];s[a*r+h]=l}return s}))}function NC(t,n,i){return(1-i)*t+i*n}function zC(t,n,i,r,e){var o=n/r,u=i/e;return t.map((function(t){for(var s=RC(t,r,e),a=0;a<e;++a)for(var f=u*a,h=Math.floor(f),c=Math.min(Math.ceil(f),i-1),l=0;l<r;++l){var v=o*l,p=v%1,d=Math.floor(v),y=Math.min(Math.ceil(v),n-1),m=t[h*n+d],w=t[h*n+y],b=t[c*n+d],g=t[c*n+y],x=NC(NC(m,w,p),NC(b,g,p),f%1);s[a*r+l]=x}return s}))}function FC(t,n,i,r,e){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"nearest";switch(o.toLowerCase()){case"nearest":return IC(t,n,i,r,e);case"bilinear":case"linear":return zC(t,n,i,r,e);default:throw new Error("Unsupported resampling method: '".concat(o,"'"))}}function LC(t,n,i,r,e,o){for(var u=n/r,s=i/e,a=RC(t,r,e,o),f=0;f<e;++f)for(var h=Math.min(Math.round(s*f),i-1),c=0;c<r;++c)for(var l=Math.min(Math.round(u*c),n-1),v=0;v<o;++v){var p=t[h*n*o+l*o+v];a[f*r*o+c*o+v]=p}return a}function GC(t,n,i,r,e,o){for(var u=n/r,s=i/e,a=RC(t,r,e,o),f=0;f<e;++f)for(var h=s*f,c=Math.floor(h),l=Math.min(Math.ceil(h),i-1),v=0;v<r;++v)for(var p=u*v,d=p%1,y=Math.floor(p),m=Math.min(Math.ceil(p),n-1),w=0;w<o;++w){var b=t[c*n*o+y*o+w],g=t[c*n*o+m*o+w],x=t[l*n*o+y*o+w],_=t[l*n*o+m*o+w],M=NC(NC(b,g,d),NC(x,_,d),h%1);a[f*r*o+v*o+w]=M}return a}function DC(t,n,i,r,e,o){var u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"nearest";switch(u.toLowerCase()){case"nearest":return LC(t,n,i,r,e,o);case"bilinear":case"linear":return GC(t,n,i,r,e,o);default:throw new Error("Unsupported resampling method: '".concat(u,"'"))}}function UC(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==i)return;var r,e,o=[],u=!0,s=!1;try{for(i=i.call(t);!(u=(r=i.next()).done)&&(o.push(r.value),!n||o.length!==n);u=!0);}catch(t){s=!0,e=t}finally{try{u||null==i.return||i.return()}finally{if(s)throw e}}return o}(t,n)||function(t,n){if(!t)return;if("string"==typeof t)return qC(t,n);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return qC(t,n)}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qC(t,n){(null==n||n>t.length)&&(n=t.length);for(var i=0,r=new Array(n);i<n;i++)r[i]=t[i];return r}function BC(t,n,i,r,e,o,u){try{var s=t[o](u),a=s.value}catch(t){return void i(t)}s.done?n(a):Promise.resolve(a).then(r,e)}function XC(t){return function(){var n=this,i=arguments;return new Promise((function(r,e){var o=t.apply(n,i);function u(t){BC(o,r,e,u,s,"next",t)}function s(t){BC(o,r,e,u,s,"throw",t)}u(void 0)}))}}function VC(t,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function WC(t,n,i){for(var r=0,e=n;e<i;++e)r+=t[e];return r}function YC(t,n,i){switch(t){case 1:if(n<=8)return new Uint8Array(i);if(n<=16)return new Uint16Array(i);if(n<=32)return new Uint32Array(i);break;case 2:if(8===n)return new Int8Array(i);if(16===n)return new Int16Array(i);if(32===n)return new Int32Array(i);break;case 3:switch(n){case 16:case 32:return new Float32Array(i);case 64:return new Float64Array(i)}}throw Error("Unsupported data format/bitsPerSample")}function ZC(t,n){return(1!==t&&2!==t||!(n<=32)||n%8!=0)&&(3!==t||16!==n&&32!==n&&64!==n)}function HC(t,n,i,r,e,o,u){var s=new DataView(t),a=2===i?1:r,f=YC(n,e,2===i?u*o:u*o*r),h=parseInt("1".repeat(e),2);if(1===n){var c=o*(1===i?r*e:e);0!=(7&c)&&(c=c+7&-8);for(var l=0;l<u;++l)for(var v=l*c,p=0;p<o;++p)for(var d=v+p*a*e,y=0;y<a;++y){var m=d+y*e,w=(l*o+p)*a+y,b=Math.floor(m/8),g=m%8;if(g+e<=8)f[w]=s.getUint8(b)>>8-e-g&h;else if(g+e<=16)f[w]=s.getUint16(b)>>16-e-g&h;else if(g+e<=24){var x=s.getUint16(b)<<8|s.getUint8(b+2);f[w]=x>>24-e-g&h}else f[w]=s.getUint32(b)>>32-e-g&h}}return f.buffer}AC([void 0,1],(function(){return i.e(226).then(i.bind(i,966)).then((function(t){return t.default}))})),AC(5,(function(){return i.e(611).then(i.bind(i,611)).then((function(t){return t.default}))})),AC(6,(function(){throw new Error("old style JPEG compression is not supported.")})),AC(7,(function(){return i.e(382).then(i.bind(i,382)).then((function(t){return t.default}))})),AC([8,32946],(function(){return Promise.all([i.e(247),i.e(356)]).then(i.bind(i,356)).then((function(t){return t.default}))})),AC(32773,(function(){return i.e(395).then(i.bind(i,395)).then((function(t){return t.default}))})),AC(34887,(function(){return Promise.all([i.e(247),i.e(54)]).then(i.bind(i,54)).then((function(t){return t.default}))})),AC(50001,(function(){return i.e(629).then(i.bind(i,629)).then((function(t){return t.default}))}));var KC=function(){function t(n,i,r,e,o,u){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.fileDirectory=n,this.geoKeys=i,this.dataView=r,this.littleEndian=e,this.tiles=o?{}:null,this.isTiled=!n.StripOffsets;var s=n.PlanarConfiguration;if(this.planarConfiguration=void 0===s?1:s,1!==this.planarConfiguration&&2!==this.planarConfiguration)throw new Error("Invalid planar configuration.");this.source=u}var n,i,r,e,o,u,s;return n=t,(i=[{key:"getFileDirectory",value:function(){return this.fileDirectory}},{key:"getGeoKeys",value:function(){return this.geoKeys}},{key:"getWidth",value:function(){return this.fileDirectory.ImageWidth}},{key:"getHeight",value:function(){return this.fileDirectory.ImageLength}},{key:"getSamplesPerPixel",value:function(){return void 0!==this.fileDirectory.SamplesPerPixel?this.fileDirectory.SamplesPerPixel:1}},{key:"getTileWidth",value:function(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()}},{key:"getTileHeight",value:function(){return this.isTiled?this.fileDirectory.TileLength:void 0!==this.fileDirectory.RowsPerStrip?Math.min(this.fileDirectory.RowsPerStrip,this.getHeight()):this.getHeight()}},{key:"getBlockWidth",value:function(){return this.getTileWidth()}},{key:"getBlockHeight",value:function(t){return this.isTiled||(t+1)*this.getTileHeight()<=this.getHeight()?this.getTileHeight():this.getHeight()-t*this.getTileHeight()}},{key:"getBytesPerPixel",value:function(){for(var t=0,n=0;n<this.fileDirectory.BitsPerSample.length;++n)t+=this.getSampleByteSize(n);return t}},{key:"getSampleByteSize",value:function(t){if(t>=this.fileDirectory.BitsPerSample.length)throw new RangeError("Sample index ".concat(t," is out of range."));return Math.ceil(this.fileDirectory.BitsPerSample[t]/8)}},{key:"getReaderForSample",value:function(t){var n=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[t]:1,i=this.fileDirectory.BitsPerSample[t];switch(n){case 1:if(i<=8)return DataView.prototype.getUint8;if(i<=16)return DataView.prototype.getUint16;if(i<=32)return DataView.prototype.getUint32;break;case 2:if(i<=8)return DataView.prototype.getInt8;if(i<=16)return DataView.prototype.getInt16;if(i<=32)return DataView.prototype.getInt32;break;case 3:switch(i){case 16:return function(t,n){return mC(this,t,n)};case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}}throw Error("Unsupported data format/bitsPerSample")}},{key:"getSampleFormat",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[t]:1}},{key:"getBitsPerSample",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.fileDirectory.BitsPerSample[t]}},{key:"getArrayForSample",value:function(t,n){return YC(this.getSampleFormat(t),this.getBitsPerSample(t),n)}},{key:"getTileOrStrip",value:(s=XC(regeneratorRuntime.mark((function t(n,i,r,e,o){var u,s,a,f,h,c,l,v,p=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u=Math.ceil(this.getWidth()/this.getTileWidth()),s=Math.ceil(this.getHeight()/this.getTileHeight()),f=this.tiles,1===this.planarConfiguration?a=i*u+n:2===this.planarConfiguration&&(a=r*u*s+i*u+n),this.isTiled?(h=this.fileDirectory.TileOffsets[a],c=this.fileDirectory.TileByteCounts[a]):(h=this.fileDirectory.StripOffsets[a],c=this.fileDirectory.StripByteCounts[a]),t.next=7,this.source.fetch([{offset:h,length:c}],o);case 7:return l=t.sent[0],null!==f&&f[a]?v=f[a]:(v=XC(regeneratorRuntime.mark((function t(){var n,r,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.decode(p.fileDirectory,l);case 2:return n=t.sent,r=p.getSampleFormat(),o=p.getBitsPerSample(),ZC(r,o)&&(n=HC(n,r,p.planarConfiguration,p.getSamplesPerPixel(),o,p.getTileWidth(),p.getBlockHeight(i))),t.abrupt("return",n);case 7:case"end":return t.stop()}}),t)})))(),null!==f&&(f[a]=v)),t.t0=n,t.t1=i,t.t2=r,t.next=14,v;case 14:return t.t3=t.sent,t.abrupt("return",{x:t.t0,y:t.t1,sample:t.t2,data:t.t3});case 16:case"end":return t.stop()}}),t,this)}))),function(t,n,i,r,e){return s.apply(this,arguments)})},{key:"_readRaster",value:(u=XC(regeneratorRuntime.mark((function t(n,i,r,e,o,u,s,a,f){var h,c,l,v,p,d,y,m,w,b,g,x,_,M,O,S,j,E,k,T,A=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(h=this.getTileWidth(),c=this.getTileHeight(),l=this.getWidth(),v=this.getHeight(),p=Math.max(Math.floor(n[0]/h),0),d=Math.min(Math.ceil(n[2]/h),Math.ceil(l/h)),y=Math.max(Math.floor(n[1]/c),0),m=Math.min(Math.ceil(n[3]/c),Math.ceil(v/c)),w=n[2]-n[0],b=this.getBytesPerPixel(),g=[],x=[],_=0;_<i.length;++_)1===this.planarConfiguration?g.push(WC(this.fileDirectory.BitsPerSample,0,i[_])/8):g.push(0),x.push(this.getReaderForSample(i[_]));for(M=[],O=this.littleEndian,S=y;S<m;++S)for(j=p;j<d;++j)for(E=function(t){var u=t,s=i[t];2===A.planarConfiguration&&(b=A.getSampleByteSize(t));var a=A.getTileOrStrip(j,S,s,o,f);M.push(a),a.then((function(t){for(var o=t.data,s=new DataView(o),a=A.getBlockHeight(t.y),f=t.y*c,p=t.x*h,d=f+a,y=(t.x+1)*h,m=x[u],_=Math.min(a,a-(d-n[3]),v-f),M=Math.min(h,h-(y-n[2]),l-p),S=Math.max(0,n[1]-f);S<_;++S)for(var j=Math.max(0,n[0]-p);j<M;++j){var E=(S*h+j)*b,k=m.call(s,E+g[u],O),T=void 0;e?(T=(S+f-n[1])*w*i.length+(j+p-n[0])*i.length+u,r[T]=k):(T=(S+f-n[1])*w+j+p-n[0],r[u][T]=k)}}))},k=0;k<i.length;++k)E(k);return t.next=18,Promise.all(M);case 18:if(!(u&&n[2]-n[0]!==u||s&&n[3]-n[1]!==s)){t.next=23;break}return(T=e?DC(r,n[2]-n[0],n[3]-n[1],u,s,i.length,a):FC(r,n[2]-n[0],n[3]-n[1],u,s,a)).width=u,T.height=s,t.abrupt("return",T);case 23:return r.width=u||n[2]-n[0],r.height=s||n[3]-n[1],t.abrupt("return",r);case 26:case"end":return t.stop()}}),t,this)}))),function(t,n,i,r,e,o,s,a,f){return u.apply(this,arguments)})},{key:"readRasters",value:(o=XC(regeneratorRuntime.mark((function t(){var n,i,r,e,o,u,s,a,f,h,c,l,v,p,d,y,m,w,b,g,x,_,M,O,S,j,E=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=E.length>0&&void 0!==E[0]?E[0]:{},i=n.window,r=n.samples,e=void 0===r?[]:r,o=n.interleave,u=n.pool,s=void 0===u?null:u,a=n.width,f=n.height,h=n.resampleMethod,c=n.fillValue,l=n.signal,!((v=i||[0,0,this.getWidth(),this.getHeight()])[0]>v[2]||v[1]>v[3])){t.next=4;break}throw new Error("Invalid subsets");case 4:if(p=v[2]-v[0],d=v[3]-v[1],y=p*d,m=this.getSamplesPerPixel(),e&&e.length){t.next=12;break}for(w=0;w<m;++w)e.push(w);t.next=19;break;case 12:b=0;case 13:if(!(b<e.length)){t.next=19;break}if(!(e[b]>=m)){t.next=16;break}return t.abrupt("return",Promise.reject(new RangeError("Invalid sample index '".concat(e[b],"'."))));case 16:++b,t.next=13;break;case 19:if(o)x=this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,_=Math.max.apply(null,this.fileDirectory.BitsPerSample),g=YC(x,_,y*e.length),c&&g.fill(c);else for(g=[],M=0;M<e.length;++M)O=this.getArrayForSample(e[M],y),Array.isArray(c)&&M<c.length?O.fill(c[M]):c&&!Array.isArray(c)&&O.fill(c),g.push(O);if(t.t0=s,t.t0){t.next=25;break}return t.next=24,CC(this.fileDirectory);case 24:t.t0=t.sent;case 25:return S=t.t0,t.next=28,this._readRaster(v,e,g,o,S,a,f,h,l);case 28:return j=t.sent,t.abrupt("return",j);case 30:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"readRGB",value:(e=XC(regeneratorRuntime.mark((function t(){var n,i,r,e,o,u,s,a,f,h,c,l,v,p,d,y,m,w,b,g,x,_,M,O,S,j,E,k=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=k.length>0&&void 0!==k[0]?k[0]:{},i=n.window,r=n.interleave,e=void 0===r||r,o=n.pool,u=void 0===o?null:o,s=n.width,a=n.height,f=n.resampleMethod,h=n.enableAlpha,c=void 0!==h&&h,l=n.signal,!((v=i||[0,0,this.getWidth(),this.getHeight()])[0]>v[2]||v[1]>v[3])){t.next=4;break}throw new Error("Invalid subsets");case 4:if((p=this.fileDirectory.PhotometricInterpretation)!==gC.Ie.RGB){t.next=9;break}if(d=[0,1,2],this.fileDirectory.ExtraSamples!==gC.pd.Unspecified&&c)for(d=[],y=0;y<this.fileDirectory.BitsPerSample.length;y+=1)d.push(y);return t.abrupt("return",this.readRasters({window:i,interleave:e,samples:d,pool:u,width:s,height:a,resampleMethod:f,signal:l}));case 9:t.t0=p,t.next=t.t0===gC.Ie.WhiteIsZero||t.t0===gC.Ie.BlackIsZero||t.t0===gC.Ie.Palette?12:t.t0===gC.Ie.CMYK?14:t.t0===gC.Ie.YCbCr||t.t0===gC.Ie.CIELab?16:18;break;case 12:return m=[0],t.abrupt("break",19);case 14:return m=[0,1,2,3],t.abrupt("break",19);case 16:return m=[0,1,2],t.abrupt("break",19);case 18:throw new Error("Invalid or unsupported photometric interpretation.");case 19:return w={window:v,interleave:!0,samples:m,pool:u,width:s,height:a,resampleMethod:f,signal:l},b=this.fileDirectory,t.next=23,this.readRasters(w);case 23:g=t.sent,x=Math.pow(2,this.fileDirectory.BitsPerSample[0]),t.t1=p,t.next=t.t1===gC.Ie.WhiteIsZero?28:t.t1===gC.Ie.BlackIsZero?30:t.t1===gC.Ie.Palette?32:t.t1===gC.Ie.CMYK?34:t.t1===gC.Ie.YCbCr?36:t.t1===gC.Ie.CIELab?38:40;break;case 28:return _=xC(g,x),t.abrupt("break",41);case 30:return _=_C(g,x),t.abrupt("break",41);case 32:return _=MC(g,b.ColorMap),t.abrupt("break",41);case 34:return _=OC(g),t.abrupt("break",41);case 36:return _=SC(g),t.abrupt("break",41);case 38:return _=jC(g),t.abrupt("break",41);case 40:throw new Error("Unsupported photometric interpretation.");case 41:if(!e){for(M=new Uint8Array(_.length/3),O=new Uint8Array(_.length/3),S=new Uint8Array(_.length/3),j=0,E=0;j<_.length;j+=3,++E)M[E]=_[j],O[E]=_[j+1],S[E]=_[j+2];_=[M,O,S]}return _.width=g.width,_.height=g.height,t.abrupt("return",_);case 45:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"getTiePoints",value:function(){if(!this.fileDirectory.ModelTiepoint)return[];for(var t=[],n=0;n<this.fileDirectory.ModelTiepoint.length;n+=6)t.push({i:this.fileDirectory.ModelTiepoint[n],j:this.fileDirectory.ModelTiepoint[n+1],k:this.fileDirectory.ModelTiepoint[n+2],x:this.fileDirectory.ModelTiepoint[n+3],y:this.fileDirectory.ModelTiepoint[n+4],z:this.fileDirectory.ModelTiepoint[n+5]});return t}},{key:"getGDALMetadata",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n={};if(!this.fileDirectory.GDAL_METADATA)return null;var i=this.fileDirectory.GDAL_METADATA,r=bC(i,"Item");r=null===t?r.filter((function(t){return void 0===wC(t,"sample")})):r.filter((function(n){return Number(wC(n,"sample"))===t}));for(var e=0;e<r.length;++e){var o=r[e];n[wC(o,"name")]=o.inner}return n}},{key:"getGDALNoData",value:function(){if(!this.fileDirectory.GDAL_NODATA)return null;var t=this.fileDirectory.GDAL_NODATA;return Number(t.substring(0,t.length-1))}},{key:"getOrigin",value:function(){var t=this.fileDirectory.ModelTiepoint,n=this.fileDirectory.ModelTransformation;if(t&&6===t.length)return[t[3],t[4],t[5]];if(n)return[n[3],n[7],n[11]];throw new Error("The image does not have an affine transformation.")}},{key:"getResolution",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=this.fileDirectory.ModelPixelScale,i=this.fileDirectory.ModelTransformation;if(n)return[n[0],-n[1],n[2]];if(i)return[i[0],i[5],i[10]];if(t){var r=t.getResolution(),e=UC(r,3),o=e[0],u=e[1],s=e[2];return[o*t.getWidth()/this.getWidth(),u*t.getHeight()/this.getHeight(),s*t.getWidth()/this.getWidth()]}throw new Error("The image does not have an affine transformation.")}},{key:"pixelIsArea",value:function(){return 1===this.geoKeys.GTRasterTypeGeoKey}},{key:"getBoundingBox",value:function(){var t=this.getOrigin(),n=this.getResolution(),i=t[0],r=t[1],e=i+n[0]*this.getWidth(),o=r+n[1]*this.getHeight();return[Math.min(i,e),Math.min(r,o),Math.max(i,e),Math.max(r,o)]}}])&&VC(n.prototype,i),r&&VC(n,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();function JC(t,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var $C=function(){function t(n){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this._dataView=new DataView(n)}var n,i,r;return n=t,(i=[{key:"buffer",get:function(){return this._dataView.buffer}},{key:"getUint64",value:function(t,n){var i,r=this.getUint32(t,n),e=this.getUint32(t+4,n);if(n){if(i=r+Math.pow(2,32)*e,!Number.isSafeInteger(i))throw new Error("".concat(i," exceeds MAX_SAFE_INTEGER. ")+"Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues");return i}if(i=Math.pow(2,32)*r+e,!Number.isSafeInteger(i))throw new Error("".concat(i," exceeds MAX_SAFE_INTEGER. ")+"Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues");return i}},{key:"getInt64",value:function(t,n){for(var i=0,r=(128&this._dataView.getUint8(t+(n?7:0)))>0,e=!0,o=0;o<8;o++){var u=this._dataView.getUint8(t+(n?o:7-o));r&&(e?0!==u&&(u=255&~(u-1),e=!1):u=255&~u),i+=u*Math.pow(256,o)}return r&&(i=-i),i}},{key:"getUint8",value:function(t,n){return this._dataView.getUint8(t,n)}},{key:"getInt8",value:function(t,n){return this._dataView.getInt8(t,n)}},{key:"getUint16",value:function(t,n){return this._dataView.getUint16(t,n)}},{key:"getInt16",value:function(t,n){return this._dataView.getInt16(t,n)}},{key:"getUint32",value:function(t,n){return this._dataView.getUint32(t,n)}},{key:"getInt32",value:function(t,n){return this._dataView.getInt32(t,n)}},{key:"getFloat16",value:function(t,n){return mC(this._dataView,t,n)}},{key:"getFloat32",value:function(t,n){return this._dataView.getFloat32(t,n)}},{key:"getFloat64",value:function(t,n){return this._dataView.getFloat64(t,n)}}])&&JC(n.prototype,i),r&&JC(n,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();function QC(t,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var tP=function(){function t(n,i,r,e){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this._dataView=new DataView(n),this._sliceOffset=i,this._littleEndian=r,this._bigTiff=e}var n,i,r;return n=t,(i=[{key:"sliceOffset",get:function(){return this._sliceOffset}},{key:"sliceTop",get:function(){return this._sliceOffset+this.buffer.byteLength}},{key:"littleEndian",get:function(){return this._littleEndian}},{key:"bigTiff",get:function(){return this._bigTiff}},{key:"buffer",get:function(){return this._dataView.buffer}},{key:"covers",value:function(t,n){return this.sliceOffset<=t&&this.sliceTop>=t+n}},{key:"readUint8",value:function(t){return this._dataView.getUint8(t-this._sliceOffset,this._littleEndian)}},{key:"readInt8",value:function(t){return this._dataView.getInt8(t-this._sliceOffset,this._littleEndian)}},{key:"readUint16",value:function(t){return this._dataView.getUint16(t-this._sliceOffset,this._littleEndian)}},{key:"readInt16",value:function(t){return this._dataView.getInt16(t-this._sliceOffset,this._littleEndian)}},{key:"readUint32",value:function(t){return this._dataView.getUint32(t-this._sliceOffset,this._littleEndian)}},{key:"readInt32",value:function(t){return this._dataView.getInt32(t-this._sliceOffset,this._littleEndian)}},{key:"readFloat32",value:function(t){return this._dataView.getFloat32(t-this._sliceOffset,this._littleEndian)}},{key:"readFloat64",value:function(t){return this._dataView.getFloat64(t-this._sliceOffset,this._littleEndian)}},{key:"readUint64",value:function(t){var n,i=this.readUint32(t),r=this.readUint32(t+4);if(this._littleEndian){if(n=i+Math.pow(2,32)*r,!Number.isSafeInteger(n))throw new Error("".concat(n," exceeds MAX_SAFE_INTEGER. ")+"Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues");return n}if(n=Math.pow(2,32)*i+r,!Number.isSafeInteger(n))throw new Error("".concat(n," exceeds MAX_SAFE_INTEGER. ")+"Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues");return n}},{key:"readInt64",value:function(t){for(var n=0,i=(128&this._dataView.getUint8(t+(this._littleEndian?7:0)))>0,r=!0,e=0;e<8;e++){var o=this._dataView.getUint8(t+(this._littleEndian?e:7-e));i&&(r?0!==o&&(o=255&~(o-1),r=!1):o=255&~o),n+=o*Math.pow(256,e)}return i&&(n=-n),n}},{key:"readOffset",value:function(t){return this._bigTiff?this.readUint64(t):this.readUint32(t)}}])&&QC(n.prototype,i),r&&QC(n,r),Object.defineProperty(n,"prototype",{writable:!1}),t}();function nP(t){return eP(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||oP(t)||rP()}function iP(t,n){return eP(t)||function(t,n){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==i)return;var r,e,o=[],u=!0,s=!1;try{for(i=i.call(t);!(u=(r=i.next()).done)&&(o.push(r.value),!n||o.length!==n);u=!0);}catch(t){s=!0,e=t}finally{try{u||null==i.return||i.return()}finally{if(s)throw e}}return o}(t,n)||oP(t,n)||rP()}function rP(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function eP(t){if(Array.isArray(t))return t}function oP(t,n){if(t){if("string"==typeof t)return uP(t,n);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?uP(t,n):void 0}}function uP(t,n){(null==n||n>t.length)&&(n=t.length);for(var i=0,r=new Array(n);i<n;i++)r[i]=t[i];return r}var sP="\r\n\r\n";function aP(t){if(void 0!==Object.fromEntries)return Object.fromEntries(t);var n,i={},r=function(t,n){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=oP(t))||n&&t&&"number"==typeof t.length){i&&(t=i);var r=0,e=function(){};return{s:e,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,u=!0,s=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return u=t.done,t},e:function(t){s=!0,o=t},f:function(){try{u||null==i.return||i.return()}finally{if(s)throw o}}}}(t);try{for(r.s();!(n=r.n()).done;){var e=iP(n.value,2),o=e[0],u=e[1];i[o.toLowerCase()]=u}}catch(t){r.e(t)}finally{r.f()}return i}function fP(t){return aP(t.split("\r\n").map((function(t){var n=t.split(":").map((function(t){return t.trim()}));return n[0]=n[0].toLowerCase(),n})))}function hP(t){var n,i,r;if(t){var e=iP(t.match(/bytes (\d+)-(\d+)\/(\d+)/),4);n=e[1],i=e[2],r=e[3],n=parseInt(n,10),i=parseInt(i,10),r=parseInt(r,10)}return{start:n,end:i,total:r}}function cP(t,n){for(var i=null,r=new TextDecoder("ascii"),e=[],o="--".concat(n),u="".concat(o,"--"),s=0;s<10;++s){r.decode(new Uint8Array(t,s,o.length))===o&&(i=s)}if(null===i)throw new Error("Could not find initial boundary");for(;i<t.byteLength;){var a=r.decode(new Uint8Array(t,i,Math.min(o.length+1024,t.byteLength-i)));if(0===a.length||a.startsWith(u))break;if(!a.startsWith(o))throw new Error("Part does not start with boundary");var f=a.substr(o.length+2);if(0===f.length)break;var h=f.indexOf(sP),c=fP(f.substr(0,h)),l=hP(c["content-range"]),v=l.start,p=l.end,d=l.total,y=i+o.length+h+sP.length,m=parseInt(p,10)+1-parseInt(v,10);e.push({headers:c,data:t.slice(y,y+m),offset:v,length:m,fileSize:d}),i=y+m+4}return e}function lP(t,n,i,r,e,o,u){try{var s=t[o](u),a=s.value}catch(t){return void i(t)}s.done?n(a):Promise.resolve(a).then(r,e)}function vP(t){return function(){var n=this,i=arguments;return new Promise((function(r,e){var o=t.apply(n,i);function u(t){lP(o,r,e,u,s,"next",t)}function s(t){lP(o,r,e,u,s,"throw",t)}u(void 0)}))}}function pP(t,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var dP=function(){function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t)}var n,i,r,e,o,u;return n=t,(i=[{key:"fetch",value:(u=vP(regeneratorRuntime.mark((function t(n){var i,r=this,e=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.length>1&&void 0!==e[1]?e[1]:void 0,t.abrupt("return",Promise.all(n.map((function(t){return r.fetchSlice(t,i)}))));case 2:case"end":return t.stop()}}),t)}))),function(t){return u.apply(this,arguments)})},{key:"fetchSlice",value:(o=vP(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw new Error("fetching of slice ".concat(n," not possible, not implemented"));case 1:case"end":return t.stop()}}),t)}))),function(t){return o.apply(this,arguments)})},{key:"fileSize",get:function(){return null}},{key:"close",value:(e=vP(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return e.apply(this,arguments)})}])&&pP(n.prototype,i),r&&pP(n,r),Object.defineProperty(n,"prototype",{writable:!1}),t}(),yP=i(875);function mP(t){return(mP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wP(t,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function bP(t,n,i){return n&&wP(t.prototype,n),i&&wP(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function gP(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function xP(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&kP(t,n)}function _P(t){var n=EP();return function(){var i,r=TP(t);if(n){var e=TP(this).constructor;i=Reflect.construct(r,arguments,e)}else i=r.apply(this,arguments);return MP(this,i)}}function MP(t,n){if(n&&("object"===mP(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return OP(t)}function OP(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function SP(t){var n="function"==typeof Map?new Map:void 0;return(SP=function(t){if(null===t||(i=t,-1===Function.toString.call(i).indexOf("[native code]")))return t;var i;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,r)}function r(){return jP(t,arguments,TP(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),kP(r,t)})(t)}function jP(t,n,i){return(jP=EP()?Reflect.construct:function(t,n,i){var r=[null];r.push.apply(r,n);var e=new(Function.bind.apply(t,r));return i&&kP(e,i.prototype),e}).apply(null,arguments)}function EP(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function kP(t,n){return(kP=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function TP(t){return(TP=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function AP(t,n,i,r,e,o,u){try{var s=t[o](u),a=s.value}catch(t){return void i(t)}s.done?n(a):Promise.resolve(a).then(r,e)}function CP(t){return function(){var n=this,i=arguments;return new Promise((function(r,e){var o=t.apply(n,i);function u(t){AP(o,r,e,u,s,"next",t)}function s(t){AP(o,r,e,u,s,"throw",t)}u(void 0)}))}}function PP(t){return RP.apply(this,arguments)}function RP(){return(RP=CP(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){return setTimeout(t,n)})));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function IP(t,n){var i=Array.isArray(t)?t:Array.from(t),r=Array.isArray(n)?n:Array.from(n);return i.map((function(t,n){return[t,r[n]]}))}var NP=function(t){xP(i,t);var n=_P(i);function i(t){var r;return gP(this,i),r=n.call(this,t),Error.captureStackTrace&&Error.captureStackTrace(OP(r),i),r.name="AbortError",r}return bP(i)}(SP(Error)),zP=function(t){xP(i,t);var n=_P(i);function i(t,r){var e;return gP(this,i),(e=n.call(this,r)).errors=t,e.message=r,e.name="AggregateError",e}return bP(i)}(SP(Error));function FP(t){return(FP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function LP(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==i)return;var r,e,o=[],u=!0,s=!1;try{for(i=i.call(t);!(u=(r=i.next()).done)&&(o.push(r.value),!n||o.length!==n);u=!0);}catch(t){s=!0,e=t}finally{try{u||null==i.return||i.return()}finally{if(s)throw e}}return o}(t,n)||DP(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function GP(t,n){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=DP(t))||n&&t&&"number"==typeof t.length){i&&(t=i);var r=0,e=function(){};return{s:e,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,u=!0,s=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return u=t.done,t},e:function(t){s=!0,o=t},f:function(){try{u||null==i.return||i.return()}finally{if(s)throw o}}}}function DP(t,n){if(t){if("string"==typeof t)return UP(t,n);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?UP(t,n):void 0}}function UP(t,n){(null==n||n>t.length)&&(n=t.length);for(var i=0,r=new Array(n);i<n;i++)r[i]=t[i];return r}function qP(t,n,i,r,e,o,u){try{var s=t[o](u),a=s.value}catch(t){return void i(t)}s.done?n(a):Promise.resolve(a).then(r,e)}function BP(t){return function(){var n=this,i=arguments;return new Promise((function(r,e){var o=t.apply(n,i);function u(t){qP(o,r,e,u,s,"next",t)}function s(t){qP(o,r,e,u,s,"throw",t)}u(void 0)}))}}function XP(t,n){return(XP=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function VP(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=YP(t);if(n){var e=YP(this).constructor;i=Reflect.construct(r,arguments,e)}else i=r.apply(this,arguments);return WP(this,i)}}function WP(t,n){if(n&&("object"===FP(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function YP(t){return(YP=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ZP(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function HP(t,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function KP(t,n,i){return n&&HP(t.prototype,n),i&&HP(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}var JP=function(){function t(n,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;ZP(this,t),this.offset=n,this.length=i,this.data=r}return KP(t,[{key:"top",get:function(){return this.offset+this.length}}]),t}(),$P=KP((function t(n,i,r){ZP(this,t),this.offset=n,this.length=i,this.blockIds=r})),QP=function(t){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&XP(t,n)}(r,t);var n,i=VP(r);function r(t){var n,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=e.blockSize,u=void 0===o?65536:o,s=e.cacheSize,a=void 0===s?100:s;return ZP(this,r),(n=i.call(this)).source=t,n.blockSize=u,n.blockCache=new yP({max:a}),n.blockRequests=new Map,n.blockIdsToFetch=new Set,n}return KP(r,[{key:"fileSize",get:function(){return this.source.fileSize}},{key:"fetch",value:(n=BP(regeneratorRuntime.mark((function t(n,i){var r,e,o,u,s,a,f,h,c,l,v,p,d,y,m,w,b,g,x,_,M,O,S,j,E,k,T,A,C,P,R,I,N,z,F,L,G,D;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=new Map,e=new Map,o=new Set,u=GP(n);try{for(u.s();!(s=u.n()).done;)for(a=s.value,f=a.offset,h=a.length,c=f+h,null!==(l=this.fileSize)&&(c=Math.min(c,l)),v=Math.floor(f/this.blockSize)*this.blockSize,p=v;p<c;p+=this.blockSize)d=Math.floor(p/this.blockSize),this.blockCache.has(d)?r.set(d,this.blockCache.get(d)):this.blockRequests.has(d)?e.set(d,this.blockRequests.get(d)):(this.blockIdsToFetch.has(d)||this.blockIdsToFetch.add(d),o.add(d))}catch(t){u.e(t)}finally{u.f()}return t.next=7,PP();case 7:this.fetchBlocks(i),y=GP(o),t.prev=9,y.s();case 11:if((m=y.n()).done){t.next=26;break}if(w=m.value,b=this.blockRequests.get(w),g=this.blockCache.get(w),!b){t.next=19;break}e.set(w,b),t.next=24;break;case 19:if(!g){t.next=23;break}r.set(w,g),t.next=24;break;case 23:throw new Error("Block ".concat(w," is not in the block requests"));case 24:t.next=11;break;case 26:t.next=31;break;case 28:t.prev=28,t.t0=t.catch(9),y.e(t.t0);case 31:return t.prev=31,y.f(),t.finish(31);case 34:return t.next=36,Promise.allSettled(Array.from(e.values()));case 36:if(!(x=t.sent).some((function(t){return"rejected"===t.status}))){t.next=65;break}_=new Set,M=GP(IP(e.keys(),x));try{for(M.s();!(O=M.n()).done;)S=LP(O.value,2),j=S[0],E=S[1],k=E.rejected,T=E.reason,k&&"AbortError"===T.name&&T.signal!==i&&(this.blockIdsToFetch.add(j),_.add(j))}catch(t){M.e(t)}finally{M.f()}if(!(this.blockIdsToFetch.length>0)){t.next=65;break}this.fetchBlocks(i),A=GP(_),t.prev=44,A.s();case 46:if((C=A.n()).done){t.next=54;break}if(P=C.value,R=this.blockRequests.get(P)){t.next=51;break}throw new Error("Block ".concat(P," is not in the block requests"));case 51:e.set(P,R);case 52:t.next=46;break;case 54:t.next=59;break;case 56:t.prev=56,t.t1=t.catch(44),A.e(t.t1);case 59:return t.prev=59,A.f(),t.finish(59);case 62:return t.next=64,Promise.allSettled(Array.from(e.values()));case 64:x=t.sent;case 65:if(!x.some((function(t){return"rejected"===t.status}))){t.next=69;break}if(!i||!i.aborted){t.next=68;break}throw new NP("Request was aborted");case 68:throw new zP(x.filter((function(t){return"rejected"===t.status})).map((function(t){return t.reason})),"Request failed");case 69:I=x.map((function(t){return t.value})),N=new Map(IP(Array.from(e.keys()),I)),z=GP(r);try{for(z.s();!(F=z.n()).done;)L=LP(F.value,2),G=L[0],D=L[1],N.set(G,D)}catch(t){z.e(t)}finally{z.f()}return t.abrupt("return",this.readSliceData(n,N));case 74:case"end":return t.stop()}}),t,this,[[9,28,31,34],[44,56,59,62]])}))),function(t,i){return n.apply(this,arguments)})},{key:"fetchBlocks",value:function(t){var n=this;this.blockIdsToFetch.size>0&&function(){for(var i=n.groupBlocks(n.blockIdsToFetch),r=n.source.fetch(i,t),e=function(e){var o,u=GP(i[e].blockIds);try{var s=function(){var i=o.value,u=BP(regeneratorRuntime.mark((function o(){var u,s,a,f,h,c;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,r;case 3:return o.t0=e,u=o.sent[o.t0],s=i*n.blockSize,a=s-u.offset,f=Math.min(a+n.blockSize,u.data.byteLength),h=u.data.slice(a,f),c=new JP(s,h.byteLength,h),n.blockCache.set(i,c),o.abrupt("return",c);case 14:throw o.prev=14,o.t1=o.catch(0),"AbortError"===o.t1.name&&(o.t1.signal=t),o.t1;case 18:return o.prev=18,n.blockRequests.delete(i),o.finish(18);case 21:case"end":return o.stop()}}),o,null,[[0,14,18,21]])})))();n.blockRequests.set(i,u)};for(u.s();!(o=u.n()).done;)s()}catch(t){u.e(t)}finally{u.f()}},o=0;o<i.length;++o)e(o);n.blockIdsToFetch.clear()}()}},{key:"groupBlocks",value:function(t){var n=Array.from(t).sort((function(t,n){return t-n}));if(0===n.length)return[];var i,r=[],e=null,o=[],u=GP(n);try{for(u.s();!(i=u.n()).done;){var s=i.value;null===e||e+1===s?(r.push(s),e=s):(o.push(new $P(r[0]*this.blockSize,r.length*this.blockSize,r)),r=[s],e=s)}}catch(t){u.e(t)}finally{u.f()}return o.push(new $P(r[0]*this.blockSize,r.length*this.blockSize,r)),o}},{key:"readSliceData",value:function(t,n){var i=this;return t.map((function(t){for(var r=t.offset+t.length,e=Math.floor(t.offset/i.blockSize),o=Math.floor((t.offset+t.length)/i.blockSize),u=new ArrayBuffer(t.length),s=new Uint8Array(u),a=e;a<=o;++a){var f=n.get(a),h=f.offset-t.offset,c=0,l=0,v=void 0;h<0?c=-h:h>0&&(l=h),v=f.top-r<0?f.length-c:r-f.offset-c;var p=new Uint8Array(f.data,c,v);s.set(p,l)}return u}))}}]),r}(dP);function tR(t,n,i,r,e,o,u){try{var s=t[o](u),a=s.value}catch(t){return void i(t)}s.done?n(a):Promise.resolve(a).then(r,e)}function nR(t){return function(){var n=this,i=arguments;return new Promise((function(r,e){var o=t.apply(n,i);function u(t){tR(o,r,e,u,s,"next",t)}function s(t){tR(o,r,e,u,s,"throw",t)}u(void 0)}))}}function iR(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function rR(t,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function eR(t,n,i){return n&&rR(t.prototype,n),i&&rR(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}var oR=function(){function t(){iR(this,t)}var n;return eR(t,[{key:"ok",get:function(){return this.status>=200&&this.status<=299}},{key:"status",get:function(){throw new Error("not implemented")}},{key:"getHeader",value:function(t){throw new Error("not implemented")}},{key:"getData",value:(n=nR(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw new Error("not implemented");case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})}]),t}(),uR=function(){function t(n){iR(this,t),this.url=n}var n;return eR(t,[{key:"request",value:(n=nR(regeneratorRuntime.mark((function t(){var n,i=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw(n=i.length>0&&void 0!==i[0]?i[0]:{}).headers,n.credentials,n.signal,new Error("request is not implemented");case 2:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})}]),t}();function sR(t){return(sR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function aR(t,n,i,r,e,o,u){try{var s=t[o](u),a=s.value}catch(t){return void i(t)}s.done?n(a):Promise.resolve(a).then(r,e)}function fR(t){return function(){var n=this,i=arguments;return new Promise((function(r,e){var o=t.apply(n,i);function u(t){aR(o,r,e,u,s,"next",t)}function s(t){aR(o,r,e,u,s,"throw",t)}u(void 0)}))}}function hR(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function cR(t,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function lR(t,n,i){return n&&cR(t.prototype,n),i&&cR(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function vR(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&pR(t,n)}function pR(t,n){return(pR=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function dR(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=mR(t);if(n){var e=mR(this).constructor;i=Reflect.construct(r,arguments,e)}else i=r.apply(this,arguments);return yR(this,i)}}function yR(t,n){if(n&&("object"===sR(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function mR(t){return(mR=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var wR=function(t){vR(r,t);var n,i=dR(r);function r(t){var n;return hR(this,r),(n=i.call(this)).response=t,n}return lR(r,[{key:"status",get:function(){return this.response.status}},{key:"getHeader",value:function(t){return this.response.headers.get(t)}},{key:"getData",value:(n=fR(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.response.arrayBuffer){t.next=6;break}return t.next=3,this.response.arrayBuffer();case 3:t.t0=t.sent,t.next=9;break;case 6:return t.next=8,this.response.buffer();case 8:t.t0=t.sent.buffer;case 9:return n=t.t0,t.abrupt("return",n);case 11:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})}]),r}(oR),bR=function(t){vR(r,t);var n,i=dR(r);function r(t,n){var e;return hR(this,r),(e=i.call(this,t)).credentials=n,e}return lR(r,[{key:"request",value:(n=fR(regeneratorRuntime.mark((function t(){var n,i,r,e,o,u=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=u.length>0&&void 0!==u[0]?u[0]:{},i=n.headers,r=n.credentials,e=n.signal,t.next=3,fetch(this.url,{headers:i,credentials:r,signal:e});case 3:return o=t.sent,t.abrupt("return",new wR(o));case 5:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})}]),r}(uR);function gR(t){return(gR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xR(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==i)return;var r,e,o=[],u=!0,s=!1;try{for(i=i.call(t);!(u=(r=i.next()).done)&&(o.push(r.value),!n||o.length!==n);u=!0);}catch(t){s=!0,e=t}finally{try{u||null==i.return||i.return()}finally{if(s)throw e}}return o}(t,n)||function(t,n){if(!t)return;if("string"==typeof t)return _R(t,n);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return _R(t,n)}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _R(t,n){(null==n||n>t.length)&&(n=t.length);for(var i=0,r=new Array(n);i<n;i++)r[i]=t[i];return r}function MR(t,n,i,r,e,o,u){try{var s=t[o](u),a=s.value}catch(t){return void i(t)}s.done?n(a):Promise.resolve(a).then(r,e)}function OR(t){return function(){var n=this,i=arguments;return new Promise((function(r,e){var o=t.apply(n,i);function u(t){MR(o,r,e,u,s,"next",t)}function s(t){MR(o,r,e,u,s,"throw",t)}u(void 0)}))}}function SR(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function jR(t,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ER(t,n,i){return n&&jR(t.prototype,n),i&&jR(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function kR(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&TR(t,n)}function TR(t,n){return(TR=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function AR(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=PR(t);if(n){var e=PR(this).constructor;i=Reflect.construct(r,arguments,e)}else i=r.apply(this,arguments);return CR(this,i)}}function CR(t,n){if(n&&("object"===gR(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function PR(t){return(PR=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var RR=function(t){kR(r,t);var n,i=AR(r);function r(t,n){var e;return SR(this,r),(e=i.call(this)).xhr=t,e.data=n,e}return ER(r,[{key:"status",get:function(){return this.xhr.status}},{key:"getHeader",value:function(t){return this.xhr.getResponseHeader(t)}},{key:"getData",value:(n=OR(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.data);case 1:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})}]),r}(oR),IR=function(t){kR(r,t);var n,i=AR(r);function r(){return SR(this,r),i.apply(this,arguments)}return ER(r,[{key:"constructRequest",value:function(t,n){var i=this;return new Promise((function(r,e){var o=new XMLHttpRequest;o.open("GET",i.url),o.responseType="arraybuffer";for(var u=0,s=Object.entries(t);u<s.length;u++){var a=xR(s[u],2),f=a[0],h=a[1];o.setRequestHeader(f,h)}o.onload=function(){var t=o.response;r(new RR(o,t))},o.onerror=e,o.onabort=function(){return e(new NP("Request aborted"))},o.send(),n&&(n.aborted&&o.abort(),n.addEventListener("abort",(function(){return o.abort()})))}))}},{key:"request",value:(n=OR(regeneratorRuntime.mark((function t(){var n,i,r,e,o=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>0&&void 0!==o[0]?o[0]:{},i=n.headers,r=n.signal,t.next=3,this.constructRequest(i,r);case 3:return e=t.sent,t.abrupt("return",e);case 5:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})}]),r}(uR),NR=i(752),zR=i(640),FR=i(630);function LR(t){return(LR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function GR(t,n){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),i.push.apply(i,r)}return i}function DR(t){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?GR(Object(i),!0).forEach((function(n){UR(t,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):GR(Object(i)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(i,n))}))}return t}function UR(t,n,i){return n in t?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i,t}function qR(t,n,i,r,e,o,u){try{var s=t[o](u),a=s.value}catch(t){return void i(t)}s.done?n(a):Promise.resolve(a).then(r,e)}function BR(t){return function(){var n=this,i=arguments;return new Promise((function(r,e){var o=t.apply(n,i);function u(t){qR(o,r,e,u,s,"next",t)}function s(t){qR(o,r,e,u,s,"throw",t)}u(void 0)}))}}function XR(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function VR(t,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function WR(t,n,i){return n&&VR(t.prototype,n),i&&VR(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function YR(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&ZR(t,n)}function ZR(t,n){return(ZR=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function HR(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=JR(t);if(n){var e=JR(this).constructor;i=Reflect.construct(r,arguments,e)}else i=r.apply(this,arguments);return KR(this,i)}}function KR(t,n){if(n&&("object"===LR(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function JR(t){return(JR=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var $R=function(t){YR(r,t);var n,i=HR(r);function r(t,n){var e;return XR(this,r),(e=i.call(this)).response=t,e.dataPromise=n,e}return WR(r,[{key:"status",get:function(){return this.response.statusCode}},{key:"getHeader",value:function(t){return this.response.headers[t]}},{key:"getData",value:(n=BR(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.dataPromise;case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})}]),r}(oR),QR=function(t){YR(r,t);var n,i=HR(r);function r(t){var n;return XR(this,r),(n=i.call(this,t)).parsedUrl=FR.parse(n.url),n.httpApi="http:"===n.parsedUrl.protocol?NR:zR,n}return WR(r,[{key:"constructRequest",value:function(t,n){var i=this;return new Promise((function(r,e){var o=i.httpApi.get(DR(DR({},i.parsedUrl),{},{headers:t}),(function(t){var n=new Promise((function(n){var i=[];t.on("data",(function(t){i.push(t)})),t.on("end",(function(){var t=Buffer.concat(i).buffer;n(t)})),t.on("error",e)}));r(new $R(t,n))}));o.on("error",e),n&&(n.aborted&&o.destroy(new NP("Request aborted")),n.addEventListener("abort",(function(){return o.destroy(new NP("Request aborted"))})))}))}},{key:"request",value:(n=BR(regeneratorRuntime.mark((function t(){var n,i,r,e,o=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.length>0&&void 0!==o[0]?o[0]:{},i=n.headers,r=n.signal,t.next=3,this.constructRequest(i,r);case 3:return e=t.sent,t.abrupt("return",e);case 5:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})}]),r}(uR);function tI(t){return(tI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var nI=["headers","credentials","maxRanges","allowFullFile"],iI=["headers","maxRanges","allowFullFile"],rI=["headers","maxRanges","allowFullFile"],eI=["forceXHR"];function oI(t,n){if(null==t)return{};var i,r,e=function(t,n){if(null==t)return{};var i,r,e={},o=Object.keys(t);for(r=0;r<o.length;r++)i=o[r],n.indexOf(i)>=0||(e[i]=t[i]);return e}(t,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)i=o[r],n.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(t,i)&&(e[i]=t[i])}return e}function uI(t,n){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),i.push.apply(i,r)}return i}function sI(t){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?uI(Object(i),!0).forEach((function(n){aI(t,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):uI(Object(i)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(i,n))}))}return t}function aI(t,n,i){return n in t?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i,t}function fI(t,n,i,r,e,o,u){try{var s=t[o](u),a=s.value}catch(t){return void i(t)}s.done?n(a):Promise.resolve(a).then(r,e)}function hI(t){return function(){var n=this,i=arguments;return new Promise((function(r,e){var o=t.apply(n,i);function u(t){fI(o,r,e,u,s,"next",t)}function s(t){fI(o,r,e,u,s,"throw",t)}u(void 0)}))}}function cI(t,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function lI(t,n){return(lI=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function vI(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=dI(t);if(n){var e=dI(this).constructor;i=Reflect.construct(r,arguments,e)}else i=r.apply(this,arguments);return pI(this,i)}}function pI(t,n){if(n&&("object"===tI(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function dI(t){return(dI=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var yI=function(t){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&lI(t,n)}(a,t);var n,i,r,e,o,u,s=vI(a);function a(t,n,i,r){var e;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,a),(e=s.call(this)).client=t,e.headers=n,e.maxRanges=i,e.allowFullFile=r,e._fileSize=null,e}return n=a,(i=[{key:"fetch",value:(u=hI(regeneratorRuntime.mark((function t(n,i){var r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.maxRanges>=n.length)){t.next=4;break}return t.abrupt("return",this.fetchSlices(n,i));case 4:this.maxRanges>0&&n.length;case 5:return t.abrupt("return",Promise.all(n.map((function(t){return r.fetchSlice(t,i)}))));case 6:case"end":return t.stop()}}),t,this)}))),function(t,n){return u.apply(this,arguments)})},{key:"fetchSlices",value:(o=hI(regeneratorRuntime.mark((function t(n,i){var r,e,o,u,s,a,f,h,c,l,v,p,d=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.client.request({headers:sI(sI({},this.headers),{},{Range:"bytes=".concat(n.map((function(t){var n=t.offset,i=t.length;return"".concat(n,"-").concat(n+i)})).join(","))}),signal:i});case 2:if((r=t.sent).ok){t.next=7;break}throw new Error("Error fetching data.");case 7:if(206!==r.status){t.next=32;break}if(y=r.getHeader("content-type"),m=void 0,m=nP(y.split(";").map((function(t){return t.trim()}))),e={type:m[0],params:aP(m.slice(1).map((function(t){return t.split("=")})))},o=e.params,"multipart/byteranges"!==e.type){t.next=18;break}return t.t0=cP,t.next=13,r.getData();case 13:return t.t1=t.sent,t.t2=o.boundary,u=(0,t.t0)(t.t1,t.t2),this._fileSize=u[0].fileSize||null,t.abrupt("return",u);case 18:return t.next=20,r.getData();case 20:if(s=t.sent,a=hP(r.getHeader("content-range")),f=a.start,h=a.end,c=a.total,this._fileSize=c||null,l=[{data:s,offset:f,length:h-f}],!(n.length>1)){t.next=29;break}return t.next=27,Promise.all(n.slice(1).map((function(t){return d.fetchSlice(t,i)})));case 27:return v=t.sent,t.abrupt("return",l.concat(v));case 29:return t.abrupt("return",l);case 32:if(this.allowFullFile){t.next=34;break}throw new Error("Server responded with full file");case 34:return t.next=36,r.getData();case 36:return p=t.sent,this._fileSize=p.byteLength,t.abrupt("return",[{data:p,offset:0,length:p.byteLength}]);case 39:case"end":return t.stop()}var y,m}),t,this)}))),function(t,n){return o.apply(this,arguments)})},{key:"fetchSlice",value:(e=hI(regeneratorRuntime.mark((function t(n,i){var r,e,o,u,s,a,f;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.offset,e=n.length,t.next=3,this.client.request({headers:sI(sI({},this.headers),{},{Range:"bytes=".concat(r,"-").concat(r+e)}),signal:i});case 3:if((o=t.sent).ok){t.next=8;break}throw new Error("Error fetching data.");case 8:if(206!==o.status){t.next=17;break}return t.next=11,o.getData();case 11:return u=t.sent,s=hP(o.getHeader("content-range")),a=s.total,this._fileSize=a||null,t.abrupt("return",{data:u,offset:r,length:e});case 17:if(this.allowFullFile){t.next=19;break}throw new Error("Server responded with full file");case 19:return t.next=21,o.getData();case 21:return f=t.sent,this._fileSize=f.byteLength,t.abrupt("return",{data:f,offset:0,length:f.byteLength});case 24:case"end":return t.stop()}}),t,this)}))),function(t,n){return e.apply(this,arguments)})},{key:"fileSize",get:function(){return this._fileSize}}])&&cI(n.prototype,i),r&&cI(n,r),Object.defineProperty(n,"prototype",{writable:!1}),a}(dP);function mI(t,n){var i=n.blockSize,r=n.cacheSize;return null===i?t:new QP(t,i,r)}function wI(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.headers,r=void 0===i?{}:i,e=n.credentials,o=n.maxRanges,u=void 0===o?0:o,s=n.allowFullFile,a=void 0!==s&&s,f=oI(n,nI),h=new bR(t,e),c=new yI(h,r,u,a);return mI(c,f)}function bI(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.headers,r=void 0===i?{}:i,e=n.maxRanges,o=void 0===e?0:e,u=n.allowFullFile,s=void 0!==u&&u,a=oI(n,iI),f=new IR(t),h=new yI(f,r,o,s);return mI(h,a)}function gI(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.headers,r=void 0===i?{}:i,e=n.maxRanges,o=void 0===e?0:e,u=n.allowFullFile,s=void 0!==u&&u,a=oI(n,rI),f=new QR(t),h=new yI(f,r,o,s);return mI(h,a)}function xI(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.forceXHR,r=void 0!==i&&i,e=oI(n,eI);return"function"!=typeof fetch||r?"undefined"!=typeof XMLHttpRequest?bI(t,e):gI(t,e):wI(t,e)}function _I(t){return(_I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function MI(t,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function OI(t,n){return(OI=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function SI(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=EI(t);if(n){var e=EI(this).constructor;i=Reflect.construct(r,arguments,e)}else i=r.apply(this,arguments);return jI(this,i)}}function jI(t,n){if(n&&("object"===_I(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function EI(t){return(EI=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var kI=function(t){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&OI(t,n)}(o,t);var n,i,r,e=SI(o);function o(t){var n;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,o),(n=e.call(this)).arrayBuffer=t,n}return n=o,(i=[{key:"fetchSlice",value:function(t,n){if(n&&n.aborted)throw new NP("Request aborted");return this.arrayBuffer.slice(t.offset,t.offset+t.length)}}])&&MI(n.prototype,i),r&&MI(n,r),Object.defineProperty(n,"prototype",{writable:!1}),o}(dP);function TI(t){return new kI(t)}function AI(t){return(AI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function CI(t,n,i,r,e,o,u){try{var s=t[o](u),a=s.value}catch(t){return void i(t)}s.done?n(a):Promise.resolve(a).then(r,e)}function PI(t,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function RI(t,n){return(RI=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function II(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,r=zI(t);if(n){var e=zI(this).constructor;i=Reflect.construct(r,arguments,e)}else i=r.apply(this,arguments);return NI(this,i)}}function NI(t,n){if(n&&("object"===AI(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function zI(t){return(zI=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var FI=function(t){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&RI(t,n)}(s,t);var n,i,r,e,o,u=II(s);function s(t){var n;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,s),(n=u.call(this)).file=t,n}return n=s,(i=[{key:"fetchSlice",value:(e=regeneratorRuntime.mark((function t(n,i){var r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,e){var o=r.file.slice(n.offset,n.offset+n.length),u=new FileReader;u.onload=function(n){return t(n.target.result)},u.onerror=e,u.onabort=e,u.readAsArrayBuffer(o),i&&i.addEventListener("abort",(function(){return u.abort()}))})));case 1:case"end":return t.stop()}}),t)})),o=function(){var t=this,n=arguments;return new Promise((function(i,r){var o=e.apply(t,n);function u(t){CI(o,i,r,u,s,"next",t)}function s(t){CI(o,i,r,u,s,"throw",t)}u(void 0)}))},function(t,n){return o.apply(this,arguments)})}])&&PI(n.prototype,i),r&&PI(n,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(dP);function LI(t){return new FI(t)}function GI(t){return(GI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function DI(t,n){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),i.push.apply(i,r)}return i}function UI(t){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?DI(Object(i),!0).forEach((function(n){qI(t,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):DI(Object(i)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(i,n))}))}return t}function qI(t,n,i){return n in t?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i,t}function BI(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==i)return;var r,e,o=[],u=!0,s=!1;try{for(i=i.call(t);!(u=(r=i.next()).done)&&(o.push(r.value),!n||o.length!==n);u=!0);}catch(t){s=!0,e=t}finally{try{u||null==i.return||i.return()}finally{if(s)throw e}}return o}(t,n)||function(t,n){if(!t)return;if("string"==typeof t)return XI(t,n);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return XI(t,n)}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function XI(t,n){(null==n||n>t.length)&&(n=t.length);for(var i=0,r=new Array(n);i<n;i++)r[i]=t[i];return r}function VI(t,n,i,r,e,o,u){try{var s=t[o](u),a=s.value}catch(t){return void i(t)}s.done?n(a):Promise.resolve(a).then(r,e)}function WI(t){return function(){var n=this,i=arguments;return new Promise((function(r,e){var o=t.apply(n,i);function u(t){VI(o,r,e,u,s,"next",t)}function s(t){VI(o,r,e,u,s,"throw",t)}u(void 0)}))}}function YI(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&QI(t,n)}function ZI(t){var n=$I();return function(){var i,r=tN(t);if(n){var e=tN(this).constructor;i=Reflect.construct(r,arguments,e)}else i=r.apply(this,arguments);return HI(this,i)}}function HI(t,n){if(n&&("object"===GI(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function KI(t){var n="function"==typeof Map?new Map:void 0;return(KI=function(t){if(null===t||(i=t,-1===Function.toString.call(i).indexOf("[native code]")))return t;var i;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,r)}function r(){return JI(t,arguments,tN(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),QI(r,t)})(t)}function JI(t,n,i){return(JI=$I()?Reflect.construct:function(t,n,i){var r=[null];r.push.apply(r,n);var e=new(Function.bind.apply(t,r));return i&&QI(e,i.prototype),e}).apply(null,arguments)}function $I(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function QI(t,n){return(QI=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function tN(t){return(tN=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function nN(t,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function iN(t,n,i){return n&&nN(t.prototype,n),i&&nN(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function rN(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function eN(t){switch(t){case gC.sf.BYTE:case gC.sf.ASCII:case gC.sf.SBYTE:case gC.sf.UNDEFINED:return 1;case gC.sf.SHORT:case gC.sf.SSHORT:return 2;case gC.sf.LONG:case gC.sf.SLONG:case gC.sf.FLOAT:case gC.sf.IFD:return 4;case gC.sf.RATIONAL:case gC.sf.SRATIONAL:case gC.sf.DOUBLE:case gC.sf.LONG8:case gC.sf.SLONG8:case gC.sf.IFD8:return 8;default:throw new RangeError("Invalid field type: ".concat(t))}}function oN(t){var n=t.GeoKeyDirectory;if(!n)return null;for(var i={},r=4;r<=4*n[3];r+=4){var e=gC.P1[n[r]],o=n[r+1]?gC.L[n[r+1]]:null,u=n[r+2],s=n[r+3],a=null;if(o){if(null==(a=t[o]))throw new Error("Could not get value of geoKey '".concat(e,"'."));"string"==typeof a?a=a.substring(s,s+u-1):a.subarray&&(a=a.subarray(s,s+u),1===u&&(a=a[0]))}else a=s;i[e]=a}return i}function uN(t,n,i,r){var e=null,o=null,u=eN(n);switch(n){case gC.sf.BYTE:case gC.sf.ASCII:case gC.sf.UNDEFINED:e=new Uint8Array(i),o=t.readUint8;break;case gC.sf.SBYTE:e=new Int8Array(i),o=t.readInt8;break;case gC.sf.SHORT:e=new Uint16Array(i),o=t.readUint16;break;case gC.sf.SSHORT:e=new Int16Array(i),o=t.readInt16;break;case gC.sf.LONG:case gC.sf.IFD:e=new Uint32Array(i),o=t.readUint32;break;case gC.sf.SLONG:e=new Int32Array(i),o=t.readInt32;break;case gC.sf.LONG8:case gC.sf.IFD8:e=new Array(i),o=t.readUint64;break;case gC.sf.SLONG8:e=new Array(i),o=t.readInt64;break;case gC.sf.RATIONAL:e=new Uint32Array(2*i),o=t.readUint32;break;case gC.sf.SRATIONAL:e=new Int32Array(2*i),o=t.readInt32;break;case gC.sf.FLOAT:e=new Float32Array(i),o=t.readFloat32;break;case gC.sf.DOUBLE:e=new Float64Array(i),o=t.readFloat64;break;default:throw new RangeError("Invalid field type: ".concat(n))}if(n!==gC.sf.RATIONAL&&n!==gC.sf.SRATIONAL)for(var s=0;s<i;++s)e[s]=o.call(t,r+s*u);else for(var a=0;a<i;a+=2)e[a]=o.call(t,r+a*u),e[a+1]=o.call(t,r+(a*u+4));return n===gC.sf.ASCII?new TextDecoder("utf-8").decode(e):e}var sN=iN((function t(n,i,r){rN(this,t),this.fileDirectory=n,this.geoKeyDirectory=i,this.nextIFDByteOffset=r})),aN=function(t){YI(i,t);var n=ZI(i);function i(t){var r;return rN(this,i),(r=n.call(this,"No image at index ".concat(t))).index=t,r}return iN(i)}(KI(Error)),fN=function(){function t(){rN(this,t)}var n;return iN(t,[{key:"readRasters",value:(n=WI(regeneratorRuntime.mark((function t(){var n,i,r,e,o,u,s,a,f,h,c,l,v,p,d,y,m,w,b,g,x,_,M,O,S,j,E,k,T,A,C,P,R,I,N,z,F,L,G,D=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=D.length>0&&void 0!==D[0]?D[0]:{},i=n.window,r=n.width,e=n.height,o=n.resX,u=n.resY,s=n.bbox,t.next=5,this.getImage();case 5:return a=t.sent,f=a,t.next=9,this.getImageCount();case 9:if(h=t.sent,c=a.getBoundingBox(),!i||!s){t.next=13;break}throw new Error('Both "bbox" and "window" passed.');case 13:if(!r&&!e){t.next=24;break}if(i&&(l=a.getOrigin(),v=BI(l,2),p=v[0],d=v[1],y=a.getResolution(),m=BI(y,2),w=m[0],b=m[1],s=[p+i[0]*w,d+i[1]*b,p+i[2]*w,d+i[3]*b]),g=s||c,!r){t.next=20;break}if(!o){t.next=19;break}throw new Error("Both width and resX passed");case 19:o=(g[2]-g[0])/r;case 20:if(!e){t.next=24;break}if(!u){t.next=23;break}throw new Error("Both width and resY passed");case 23:u=(g[3]-g[1])/e;case 24:if(!o&&!u){t.next=48;break}x=[],_=0;case 27:if(!(_<h)){t.next=36;break}return t.next=30,this.getImage(_);case 30:M=t.sent,O=M.fileDirectory,S=O.SubfileType,j=O.NewSubfileType,(0===_||2===S||1&j)&&x.push(M);case 33:++_,t.next=27;break;case 36:x.sort((function(t,n){return t.getWidth()-n.getWidth()})),E=0;case 38:if(!(E<x.length)){t.next=48;break}if(k=x[E],T=(c[2]-c[0])/k.getWidth(),A=(c[3]-c[1])/k.getHeight(),f=k,!(o&&o>T||u&&u>A)){t.next=45;break}return t.abrupt("break",48);case 45:++E,t.next=38;break;case 48:return C=i,s&&(P=a.getOrigin(),R=BI(P,2),I=R[0],N=R[1],z=f.getResolution(a),F=BI(z,2),L=F[0],G=F[1],C=[Math.round((s[0]-I)/L),Math.round((s[1]-N)/G),Math.round((s[2]-I)/L),Math.round((s[3]-N)/G)],C=[Math.min(C[0],C[2]),Math.min(C[1],C[3]),Math.max(C[0],C[2]),Math.max(C[1],C[3])]),t.abrupt("return",f.readRasters(UI(UI({},n),{},{window:C})));case 51:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})}]),t}(),hN=function(t){YI(f,t);var n,i,r,e,o,u,s,a=ZI(f);function f(t,n,i,r){var e,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return rN(this,f),(e=a.call(this)).source=t,e.littleEndian=n,e.bigTiff=i,e.firstIFDOffset=r,e.cache=o.cache||!1,e.ifdRequests=[],e.ghostValues=null,e}return iN(f,[{key:"getSlice",value:(s=WI(regeneratorRuntime.mark((function t(n,i){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.bigTiff?4048:1024,t.t0=tP,t.next=4,this.source.fetch([{offset:n,length:void 0!==i?i:r}]);case 4:return t.t1=t.sent[0],t.t2=n,t.t3=this.littleEndian,t.t4=this.bigTiff,t.abrupt("return",new t.t0(t.t1,t.t2,t.t3,t.t4));case 9:case"end":return t.stop()}}),t,this)}))),function(t,n){return s.apply(this,arguments)})},{key:"parseFileDirectoryAt",value:(u=WI(regeneratorRuntime.mark((function t(n){var i,r,e,o,u,s,a,f,h,c,l,v,p,d,y,m,w,b,g,x;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=this.bigTiff?20:12,r=this.bigTiff?8:2,t.next=4,this.getSlice(n);case 4:if(e=t.sent,o=this.bigTiff?e.readUint64(n):e.readUint16(n),u=o*i+(this.bigTiff?16:6),e.covers(n,u)){t.next=11;break}return t.next=10,this.getSlice(n,u);case 10:e=t.sent;case 11:s={},a=n+(this.bigTiff?8:2),f=0;case 14:if(!(f<o)){t.next=41;break}if(h=e.readUint16(a),c=e.readUint16(a+2),l=this.bigTiff?e.readUint64(a+4):e.readUint32(a+4),v=void 0,p=void 0,d=eN(c),y=a+(this.bigTiff?12:8),!(d*l<=(this.bigTiff?8:4))){t.next=26;break}v=uN(e,c,l,y),t.next=36;break;case 26:if(m=e.readOffset(y),w=eN(c)*l,!e.covers(m,w)){t.next=32;break}v=uN(e,c,l,m),t.next=36;break;case 32:return t.next=34,this.getSlice(m,w);case 34:b=t.sent,v=uN(b,c,l,m);case 36:p=1===l&&-1===gC.It.indexOf(h)&&c!==gC.sf.RATIONAL&&c!==gC.sf.SRATIONAL?v[0]:v,s[gC.L[h]]=p;case 38:a+=i,++f,t.next=14;break;case 41:return g=oN(s),x=e.readOffset(n+r+i*o),t.abrupt("return",new sN(s,g,x));case 44:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"requestIFD",value:(o=WI(regeneratorRuntime.mark((function t(n){var i=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.ifdRequests[n]){t.next=4;break}return t.abrupt("return",this.ifdRequests[n]);case 4:if(0!==n){t.next=9;break}return this.ifdRequests[n]=this.parseFileDirectoryAt(this.firstIFDOffset),t.abrupt("return",this.ifdRequests[n]);case 9:if(this.ifdRequests[n-1]){t.next=19;break}t.prev=10,this.ifdRequests[n-1]=this.requestIFD(n-1),t.next=19;break;case 14:if(t.prev=14,t.t0=t.catch(10),!(t.t0 instanceof aN)){t.next=18;break}throw new aN(n);case 18:throw t.t0;case 19:return this.ifdRequests[n]=WI(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.ifdRequests[n-1];case 2:if(0!==(r=t.sent).nextIFDByteOffset){t.next=5;break}throw new aN(n);case 5:return t.abrupt("return",i.parseFileDirectoryAt(r.nextIFDByteOffset));case 6:case"end":return t.stop()}}),t)})))(),t.abrupt("return",this.ifdRequests[n]);case 21:case"end":return t.stop()}}),t,this,[[10,14]])}))),function(t){return o.apply(this,arguments)})},{key:"getImage",value:(e=WI(regeneratorRuntime.mark((function t(){var n,i,r=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.length>0&&void 0!==r[0]?r[0]:0,t.next=3,this.requestIFD(n);case 3:return i=t.sent,t.abrupt("return",new KC(i.fileDirectory,i.geoKeyDirectory,this.dataView,this.littleEndian,this.cache,this.source));case 5:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"getImageCount",value:(r=WI(regeneratorRuntime.mark((function t(){var n,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=0,i=!0;case 2:if(!i){t.next=18;break}return t.prev=3,t.next=6,this.requestIFD(n);case 6:++n,t.next=16;break;case 9:if(t.prev=9,t.t0=t.catch(3),!(t.t0 instanceof aN)){t.next=15;break}i=!1,t.next=16;break;case 15:throw t.t0;case 16:t.next=2;break;case 18:return t.abrupt("return",n);case 19:case"end":return t.stop()}}),t,this,[[3,9]])}))),function(){return r.apply(this,arguments)})},{key:"getGhostValues",value:(i=WI(regeneratorRuntime.mark((function t(){var n,i,r,e,o,u,s,a,f=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.bigTiff?16:8,!this.ghostValues){t.next=3;break}return t.abrupt("return",this.ghostValues);case 3:return r=(i="GDAL_STRUCTURAL_METADATA_SIZE=").length+100,t.next=7,this.getSlice(n,r);case 7:if(e=t.sent,i!==uN(e,gC.sf.ASCII,i.length,n)){t.next=19;break}if(o=uN(e,gC.sf.ASCII,r,n),u=o.split("\n")[0],!((s=Number(u.split("=")[1].split(" ")[0])+u.length)>r)){t.next=16;break}return t.next=15,this.getSlice(n,s);case 15:e=t.sent;case 16:a=uN(e,gC.sf.ASCII,s,n),this.ghostValues={},a.split("\n").filter((function(t){return t.length>0})).map((function(t){return t.split("=")})).forEach((function(t){var n=BI(t,2),i=n[0],r=n[1];f.ghostValues[i]=r}));case 19:return t.abrupt("return",this.ghostValues);case 20:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"close",value:function(){return"function"==typeof this.source.close&&this.source.close()}}],[{key:"fromSource",value:(n=WI(regeneratorRuntime.mark((function t(n,i,r){var e,o,u,s,a,h,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.fetch([{offset:0,length:1024}],r);case 2:if(e=t.sent[0],o=new $C(e),18761!==(u=o.getUint16(0,0))){t.next=9;break}s=!0,t.next=14;break;case 9:if(19789!==u){t.next=13;break}s=!1,t.next=14;break;case 13:throw new TypeError("Invalid byte order value.");case 14:if(42!==(a=o.getUint16(2,s))){t.next=19;break}h=!1,t.next=27;break;case 19:if(43!==a){t.next=26;break}if(h=!0,8===o.getUint16(4,s)){t.next=24;break}throw new Error("Unsupported offset byte-size.");case 24:t.next=27;break;case 26:throw new TypeError("Invalid magic number.");case 27:return c=h?o.getUint64(8,s):o.getUint32(4,s),t.abrupt("return",new f(n,s,h,c,i));case 29:case"end":return t.stop()}}),t)}))),function(t,i,r){return n.apply(this,arguments)})}]),f}(fN),cN=function(t){YI(o,t);var n,i,r,e=ZI(o);function o(t,n){var i;return rN(this,o),(i=e.call(this)).mainFile=t,i.overviewFiles=n,i.imageFiles=[t].concat(n),i.fileDirectoriesPerFile=null,i.fileDirectoriesPerFileParsing=null,i.imageCount=null,i}return iN(o,[{key:"parseFileDirectoriesPerFile",value:(r=WI(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=[this.mainFile.parseFileDirectoryAt(this.mainFile.firstIFDOffset)].concat(this.overviewFiles.map((function(t){return t.parseFileDirectoryAt(t.firstIFDOffset)}))),t.next=3,Promise.all(n);case 3:return this.fileDirectoriesPerFile=t.sent,t.abrupt("return",this.fileDirectoriesPerFile);case 5:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"getImage",value:(i=WI(regeneratorRuntime.mark((function t(){var n,i,r,e,o,u,s,a=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.length>0&&void 0!==a[0]?a[0]:0,t.next=3,this.getImageCount();case 3:return t.next=5,this.parseFileDirectoriesPerFile();case 5:i=0,r=0,e=0;case 8:if(!(e<this.imageFiles.length)){t.next=26;break}o=this.imageFiles[e],u=0;case 11:if(!(u<this.imageCounts[e])){t.next=22;break}if(n!==i){t.next=17;break}return t.next=15,o.requestIFD(r);case 15:return s=t.sent,t.abrupt("return",new KC(s.fileDirectory,s.geoKeyDirectory,o.dataView,o.littleEndian,o.cache,o.source));case 17:i++,r++;case 19:u++,t.next=11;break;case 22:r=0;case 23:e++,t.next=8;break;case 26:throw new RangeError("Invalid image index");case 27:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"getImageCount",value:(n=WI(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===this.imageCount){t.next=2;break}return t.abrupt("return",this.imageCount);case 2:return n=[this.mainFile.getImageCount()].concat(this.overviewFiles.map((function(t){return t.getImageCount()}))),t.next=5,Promise.all(n);case 5:return this.imageCounts=t.sent,this.imageCount=this.imageCounts.reduce((function(t,n){return t+n}),0),t.abrupt("return",this.imageCount);case 8:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})}]),o}(fN);function lN(t){return vN.apply(this,arguments)}function vN(){return(vN=WI(regeneratorRuntime.mark((function t(n){var i,r,e=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.length>1&&void 0!==e[1]?e[1]:{},r=e.length>2?e[2]:void 0,t.abrupt("return",hN.fromSource(xI(n,i),r));case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function pN(){return(pN=WI(regeneratorRuntime.mark((function t(n,i){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",hN.fromSource(TI(n),i));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function dN(){return(dN=WI(regeneratorRuntime.mark((function t(n,i){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",hN.fromSource(LI(n),i));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function yN(){return(yN=WI(regeneratorRuntime.mark((function t(n){var i,r,e,o,u,s=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=s.length>1&&void 0!==s[1]?s[1]:[],r=s.length>2&&void 0!==s[2]?s[2]:{},e=s.length>3?s[3]:void 0,t.next=5,hN.fromSource(xI(n,r),e);case 5:return o=t.sent,t.next=8,Promise.all(i.map((function(t){return hN.fromSource(xI(t,r))})));case 8:return u=t.sent,t.abrupt("return",new cN(o,u));case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function mN(t,n,i,r,e,o,u){try{var s=t[o](u),a=s.value}catch(t){return void i(t)}s.done?n(a):Promise.resolve(a).then(r,e)}function wN(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function bN(t,n){for(var i=0;i<n.length;i++){var r=n[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var gN,xN="undefined"!=typeof navigator&&navigator.hardwareConcurrency||2,_N=function(){function t(){var n=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xN,e=arguments.length>1?arguments[1]:void 0;wN(this,t),this.workers=null,this._awaitingDecoder=null,this.size=r,this.messageId=0,r&&(this._awaitingDecoder=e?Promise.resolve(e):new Promise((function(t){i.e(231).then(i.bind(i,231)).then((function(n){t(n.create)}))})),this._awaitingDecoder.then((function(t){n._awaitingDecoder=null,n.workers=[];for(var i=0;i<r;i++)n.workers.push({worker:t(),idle:!0})})))}var n,r,e,o,u;return n=t,(r=[{key:"decode",value:(o=regeneratorRuntime.mark((function t(n,i){var r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._awaitingDecoder){t.next=3;break}return t.next=3,this._awaitingDecoder;case 3:return t.abrupt("return",0===this.size?CC(n).then((function(t){return t.decode(n,i)})):new Promise((function(t){var e=r.workers.find((function(t){return t.idle}))||r.workers[Math.floor(Math.random()*r.size)];e.idle=!1;var o=r.messageId++;e.worker.addEventListener("message",(function n(i){i.data.id===o&&(e.idle=!0,t(i.data.decoded),e.worker.removeEventListener("message",n))})),e.worker.postMessage({fileDirectory:n,buffer:i,id:o},[i])})));case 4:case"end":return t.stop()}}),t,this)})),u=function(){var t=this,n=arguments;return new Promise((function(i,r){var e=o.apply(t,n);function u(t){mN(e,i,r,u,s,"next",t)}function s(t){mN(e,i,r,u,s,"throw",t)}u(void 0)}))},function(t,n){return u.apply(this,arguments)})},{key:"destroy",value:function(){this.workers&&(this.workers.forEach((function(t){t.worker.terminate()})),this.workers=null)}}])&&bN(n.prototype,r),e&&bN(n,e),Object.defineProperty(n,"prototype",{writable:!1}),t}(),MN=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ON="STATISTICS_MAXIMUM",SN="STATISTICS_MINIMUM";function jN(t){try{return t.getBoundingBox()}catch(i){var n=t.fileDirectory;return[0,0,n.ImageWidth,n.ImageLength]}}function EN(t){try{return t.getOrigin().slice(0,2)}catch(n){return[0,t.fileDirectory.ImageLength]}}function kN(t,n){try{return t.getResolution(n)}catch(i){return[n.fileDirectory.ImageWidth/t.fileDirectory.ImageWidth,n.fileDirectory.ImageHeight/t.fileDirectory.ImageHeight]}}function TN(t){var n=t.geoKeys;if(!n)return null;if(n.ProjectedCSTypeGeoKey){if(!(r=ae(i="EPSG:"+n.ProjectedCSTypeGeoKey)))(e=hi(n.ProjLinearUnitsGeoKey))&&(r=new vi({code:i,units:e}));return r}if(n.GeographicTypeGeoKey){var i,r,e;if(!(r=ae(i="EPSG:"+n.GeographicTypeGeoKey)))(e=hi(n.GeogAngularUnitsGeoKey))&&(r=new vi({code:i,units:e}));return r}return null}function AN(t){return t.getImageCount().then((function(n){for(var i=new Array(n),r=0;r<n;++r)i[r]=t.getImage(r);return Promise.all(i)}))}function CN(t,n){return(t.overviews?function(t){return yN.apply(this,arguments)}(t.url,t.overviews,n):lN(t.url,n)).then(AN)}function PN(t,n,i,r,e){if(Array.isArray(t)){var o=t.length;if(!Array.isArray(n)||o!=n.length){var u=new Error(r);throw e(u),u}for(var s=0;s<o;++s)PN(t[s],n[s],i,r,e)}else if(n=n,Math.abs(t-n)>i*t)throw new Error(r)}function RN(t){return t instanceof Int8Array?-128:t instanceof Int16Array?-32768:t instanceof Int32Array?-2147483648:t instanceof Float32Array?12e-39:0}function IN(t){return t instanceof Int8Array?127:t instanceof Uint8Array||t instanceof Uint8ClampedArray?255:t instanceof Int16Array?32767:t instanceof Uint16Array?65535:t instanceof Int32Array?2147483647:t instanceof Uint32Array?4294967295:t instanceof Float32Array?34e37:255}var NN=function(t){function n(n){var i=t.call(this,{state:Ln,tileGrid:null,projection:null,opaque:n.opaque,transition:n.transition,interpolate:!1!==n.interpolate,wrapX:n.wrapX})||this;i.Lm=n.sources;var r=i.Lm.length;i.Gm=n.sourceOptions,i.Dm=new Array(r),i.Um=new Array(r),i.qm,i.Bm,i.Xm,i.Vm=!1!==n.normalize,i.Wm=!1,i._e=null,i.Ym=n.convertToRGB?"readRGB":"readRasters",i.setKey(i.Lm.map((function(t){return t.url})).join(","));for(var e=i,o=new Array(r),u=0;u<r;++u)o[u]=CN(i.Lm[u],i.Gm);return Promise.all(o).then((function(t){e.Zm(t)})).catch((function(t){console.error(t),e._e=t,e.setState(Dn)})),i}return MN(n,t),n.prototype.getMetadata=function(){return this.Xm?JSON.parse(JSON.stringify(this.Xm)):void 0},n.prototype.getSourceInfo=function(){return this.Lm?JSON.parse(JSON.stringify(this.Lm)):void 0},n.prototype.getError=function(){return this._e},n.prototype.Zm=function(t){for(var n,i,r,e,o,u=new Array(t.length),s=new Array(t.length),a=new Array(t.length),f=0,h=t.length,c=function(h){var c=t[h],v=c.length,p=void 0,d=void 0,y=new Array(v),m=new Array(v),w=new Array(v);s[h]=new Array(v),a[h]=new Array(v);for(var b=0;b<v;++b){var g=c[b],x=g.getGDALNoData();a[h][b]=g.getGDALMetadata(0),s[h][b]=x;var _=l.Lm[h].bands;u[h]=_?_.length:g.getSamplesPerPixel();var M=v-(b+1);p||(p=jN(g)),d||(d=EN(g));var O=kN(g,c[0]);w[M]=O[0];var S=[g.getTileWidth(),g.getTileHeight()];y[M]=S;var j=O[0]/Math.abs(O[1]);m[M]=[S[0],S[1]/j]}if(n?Mr(n,p,n):n=p,i){var E="Origin mismatch for source ".concat(h,", got [").concat(d,"] but expected [").concat(i,"]");PN(i,d,0,E,l.viewRejector)}else i=d;if(o){o.length-f>w.length&&(f=o.length-w.length);var k=o[o.length-1]/w[w.length-1];l.Um[h]=k;var T=w.map((function(t){return t*k}));E="Resolution mismatch for source ".concat(h,", got [").concat(T,"] but expected [").concat(o,"]");PN(o.slice(f,o.length),T,.02,E,l.viewRejector)}else o=w,l.Um[h]=1;r?PN(r.slice(f,r.length),m,.01,"Tile size mismatch for source ".concat(h),l.viewRejector):r=m,e?PN(e.slice(f,e.length),y,0,"Tile size mismatch for source ".concat(h),l.viewRejector):e=y,l.Dm[h]=c.reverse()},l=this,v=0;v<h;++v)c(v);for(var p=0,d=this.Dm.length;p<d;++p)for(var y=this.Dm[p];y.length<o.length;)y.unshift(void 0);if(!this.getProjection()){var m=t[0];for(p=m.length-1;p>=0;--p){var w=TN(m[p]);if(w){this.projection=w;break}}}this.qm=u,this.Bm=s,this.Xm=a;t:for(v=0;v<h;++v){if(void 0!==this.Lm[v].nodata){this.Wm=!0;break}var b=s[v],g=this.Lm[v].bands;if(g){for(p=0;p<g.length;++p)if(null!==b[g[p]-1]){this.Wm=!0;break t}}else for(var x=0;x<b.length;++x)if(null!==b[x]){this.Wm=!0;break t}}var _=this.Wm?1:0;this.bandCount=u.reduce((function(t,n){return t+=n}),0)+_;var M=new HO({extent:n,minZoom:f,origin:i,resolutions:o,tileSizes:r});this.tileGrid=M,this.setTileSizes(e),this.setLoader(this.Hm.bind(this)),this.setState(Gn),this.viewResolver({projection:this.projection,resolutions:o,center:Oe(br(n),this.projection),extent:je(n,this.projection),zoom:0})},n.prototype.Hm=function(t,n,i){for(var r=this.getTileSize(t),e=this.Dm.length,o=new Array(e),u=this.Wm,s=this.bandCount,a=this.qm,f=this.Bm,h=this.Lm,c=function(e){var u=h[e],s=l.Um[e],a=[Math.round(n*(r[0]*s)),Math.round(i*(r[1]*s)),Math.round((n+1)*(r[0]*s)),Math.round((i+1)*(r[1]*s))],c=l.Dm[e][t],v=void 0;u.bands&&(v=u.bands.map((function(t){return t-1})));var p=void 0;p="nodata"in u&&null!==u.nodata?u.nodata:v?v.map((function(t){return f[e][t]})):f[e],o[e]=c[l.Ym]({window:a,width:r[0],height:r[1],samples:v,fillValue:p,pool:(gN||(gN=new _N),gN),interleave:!1})},l=this,v=0;v<e;++v)c(v);var p=r[0]*r[1],d=p*s,y=this.Vm,m=this.Xm;return Promise.all(o).then((function(t){var n;n=y?new Uint8Array(d):new Float32Array(d);for(var i=0,r=0;r<p;++r){for(var o=u,s=0;s<e;++s){var c=h[s],l=c.min,v=c.max,w=void 0,b=void 0;if(y){var g=m[s][0];void 0===l&&(l=g&&SN in g?parseFloat(g.STATISTICS_MINIMUM):RN(t[s][0])),void 0===v&&(v=g&&ON in g?parseFloat(g.STATISTICS_MAXIMUM):IN(t[s][0])),b=-l*(w=255/(v-l))}for(var _=0;_<a[s];++_){var M=t[s][_][r],O=void 0;if(O=y?x(w*M+b,0,255):M,u){var S=c.nodata;if(void 0===S){var j=void 0;j=c.bands?c.bands[_]-1:_,S=f[s][j]}var E=isNaN(S);(!E&&M!==S||E&&!isNaN(M))&&(o=!1,n[i]=O)}else n[i]=O;i++}}u&&(o||(n[i]=255),i++)}return n})).catch((function(t){throw console.error(t),t}))},n.prototype.isNormalized=function(){return!!this.Vm},n.prototype.getNoData=function(){return this.Bm?JSON.parse(JSON.stringify(this.Bm)):void 0},n.prototype.getSamplesPerPixel=function(){return this.qm?JSON.parse(JSON.stringify(this.qm)):void 0},n.prototype.getBandCount=function(){return this.bandCount?JSON.parse(JSON.stringify(this.bandCount)):void 0},n.getTIFFfromUrl=function(t){return lN(t)},n.getTIFFfromUrls=function(t){return lN(t)},n.getTIFFfromBlob=function(t){return function(t,n){return dN.apply(this,arguments)}(t)},n.getTIFFfromArrayBuffer=function(t){return function(t,n){return pN.apply(this,arguments)}(t)},n}(YA);NN.prototype.getView;var zN=NN,FN=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),LN="default",GN="truncated",DN=function(t){function n(n,i,r,e,o,u,s){var a=t.call(this,i,r,e,o,u,s)||this;return a.Km=null,a._y=n,a}return FN(n,t),n.prototype.getImage=function(){if(this.Km)return this.Km;var n=t.prototype.getImage.call(this);if(this.state==cu){var i=this._y;if(n.width==i[0]&&n.height==i[1])return this.Km=n,n;var r=Qt(i[0],i[1]);return r.drawImage(n,0,0),this.Km=r.canvas,r.canvas}return n},n}(Db),UN=function(t){function n(n){var i=this,r=n,e=void 0===r.imageSmoothing||r.imageSmoothing;void 0!==r.interpolate&&(e=r.interpolate);var o=r.size,u=void 0!==r.tierSizeCalculation?r.tierSizeCalculation:LN,s=r.tilePixelRatio||1,a=o[0],f=o[1],h=[],c=r.tileSize||gu,l=c*s;switch(u){case LN:for(;a>l||f>l;)h.push([Math.ceil(a/l),Math.ceil(f/l)]),l+=l;break;case GN:for(var v=a,p=f;v>l||p>l;)h.push([Math.ceil(v/l),Math.ceil(p/l)]),v>>=1,p>>=1;break;default:g(!1,53)}h.push([1,1]),h.reverse();for(var d=[s],y=[0],m=1,w=h.length;m<w;m++)d.push(s<<m),y.push(h[m-1][0]*h[m-1][1]+y[m-1]);d.reverse();var b=new HO({tileSize:c,extent:r.extent||[0,-f,a,0],resolutions:d}),x=r.url;x&&-1==x.indexOf("{TileGroup}")&&-1==x.indexOf("{tileIndex}")&&(x+="{TileGroup}/{z}-{x}-{y}.jpg");var _=cS(x),M=c*s;var O=fS(_.map((function(t){return function(n,i,r){if(n){var e=n[0],o=n[1],u=n[2],s=o+u*h[e][0],a={z:e,x:o,y:u,tileIndex:s,TileGroup:"TileGroup"+((s+y[e])/M|0)};return t.replace(/\{(\w+?)\}/g,(function(t,n){return a[n]}))}}}))),S=DN.bind(null,ua(c*s));(i=t.call(this,{attributions:r.attributions,cacheSize:r.cacheSize,crossOrigin:r.crossOrigin,interpolate:e,projection:r.projection,tilePixelRatio:s,reprojectionErrorThreshold:r.reprojectionErrorThreshold,tileClass:S,tileGrid:b,tileUrlFunction:O,transition:r.transition})||this).zDirection=r.zDirection;var j=O(b.getTileCoordForCoordAndResolution(br(b.getExtent()),d[d.length-1]),1,null),E=new Image;return E.addEventListener("error",function(){M=c,this.changed()}.bind(i)),E.src=j,i}return FN(n,t),n}(_S),qN=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();function BN(t){return t.toLocaleString("en",{maximumFractionDigits:10})}var XN=function(t){function n(n){var i=this,r=n||{},e=void 0===r.imageSmoothing||r.imageSmoothing;void 0!==r.interpolate&&(e=r.interpolate);var u=r.url||"";u+=u.lastIndexOf("/")===u.length-1||""===u?"":"/";var s=r.version||Vl,a=r.sizes||[],f=r.size;g(null!=f&&Array.isArray(f)&&2==f.length&&!isNaN(f[0])&&f[0]>0&&!isNaN(f[1])&&f[1]>0,60);var h,c,l,v=f[0],p=f[1],d=r.tileSize,y=r.tilePixelRatio||1,m=r.format||"jpg",w=r.quality||(r.version==Xl?"native":"default"),b=r.resolutions||[],x=r.supports||[],_=r.extent||[0,-p,v,0],M=null!=a&&Array.isArray(a)&&a.length>0,O=void 0!==d&&("number"==typeof d&&Number.isInteger(d)&&d>0||Array.isArray(d)&&d.length>0),S=null!=x&&Array.isArray(x)&&(o(x,"regionByPx")||o(x,"regionByPct"))&&(o(x,"sizeByWh")||o(x,"sizeByH")||o(x,"sizeByW")||o(x,"sizeByPct"));if(b.sort((function(t,n){return n-t})),O||S)if(null!=d&&("number"==typeof d&&Number.isInteger(d)&&d>0?(h=d,c=d):Array.isArray(d)&&d.length>0&&((1==d.length||null==d[1]&&Number.isInteger(d[0]))&&(h=d[0],c=d[0]),2==d.length&&(Number.isInteger(d[0])&&Number.isInteger(d[1])?(h=d[0],c=d[1]):null==d[0]&&Number.isInteger(d[1])&&(h=d[1],c=d[1])))),void 0!==h&&void 0!==c||(h=gu,c=gu),0==b.length)for(var j=l=Math.max(Math.ceil(Math.log(v/h)/Math.LN2),Math.ceil(Math.log(p/c)/Math.LN2));j>=0;j--)b.push(Math.pow(2,j));else{var E=Math.max.apply(Math,b);l=Math.round(Math.log(E)/Math.LN2)}else if(h=v,c=p,b=[],M){a.sort((function(t,n){return t[0]-n[0]})),l=-1;var k=[];for(j=0;j<a.length;j++){var T=v/a[j][0];b.length>0&&b[b.length-1]==T?k.push(j):(b.push(T),l++)}if(k.length>0)for(j=0;j<k.length;j++)a.splice(k[j]-j,1)}else b.push(1),a.push([v,p]),l=0;var A=new HO({tileSize:[h,c],extent:_,origin:Or(_),resolutions:b}),C=DN.bind(null,ua(d||256).map((function(t){return t*y})));return(i=t.call(this,{attributions:r.attributions,attributionsCollapsible:r.attributionsCollapsible,cacheSize:r.cacheSize,crossOrigin:r.crossOrigin,interpolate:e,projection:r.projection,reprojectionErrorThreshold:r.reprojectionErrorThreshold,state:r.state,tileClass:C,tileGrid:A,tilePixelRatio:r.tilePixelRatio,tileUrlFunction:function(t,n,i){var r,e,f=t[0];if(!(f>l)){var d=t[1],y=t[2],g=b[f];if(!(void 0===d||void 0===y||void 0===g||d<0||Math.ceil(v/g/h)<=d||y<0||Math.ceil(p/g/c)<=y)){if(S||O){var _=d*h*g,j=y*c*g,E=h*g,k=c*g,T=h,A=c;if(_+E>v&&(E=v-_),j+k>p&&(k=p-j),_+h*g>v&&(T=Math.floor((v-_+g-1)/g)),j+c*g>p&&(A=Math.floor((p-j+g-1)/g)),0==_&&E==v&&0==j&&k==p)r="full";else if(!S||o(x,"regionByPx"))r=_+","+j+","+E+","+k;else if(o(x,"regionByPct")){r="pct:"+BN(_/v*100)+","+BN(j/p*100)+","+BN(E/v*100)+","+BN(k/p*100)}s!=Wl||S&&!o(x,"sizeByWh")?!S||o(x,"sizeByW")?e=T+",":o(x,"sizeByH")?e=","+A:o(x,"sizeByWh")?e=T+","+A:o(x,"sizeByPct")&&(e="pct:"+BN(100/g)):e=T+","+A}else if(r="full",M){var C=a[f][0],P=a[f][1];e=s==Wl?C==v&&P==p?"max":C+","+P:C==v?"full":C+","}else e=s==Wl?"max":"full";return u+r+"/"+e+"/0/"+w+"."+m}}},transition:r.transition})||this).zDirection=r.zDirection,i}return qN(n,t),n}(_S),VN=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),WN="imageloadstart",YN="imageloadend",ZN="imageloaderror",HN=function(t){function n(n,i){var r=t.call(this,n)||this;return r.image=i,r}return VN(n,t),n}(L);function KN(t,n){t.getImage().src=n}var JN=function(t){function n(n){var i=this,r=void 0===n.imageSmoothing||n.imageSmoothing;return void 0!==n.interpolate&&(r=n.interpolate),(i=t.call(this,{attributions:n.attributions,projection:n.projection,state:n.state,interpolate:r})||this).on,i.once,i.un,i.ji=void 0!==n.resolutions?n.resolutions:null,i.Jm=null,i.$m=0,i}return VN(n,t),n.prototype.getResolutions=function(){return this.ji},n.prototype.findNearestResolution=function(t){if(this.ji){var n=u(this.ji,t,0);t=this.ji[n]}return t},n.prototype.getImage=function(t,n,i,r){var e=this.getProjection();if(e&&r&&!ye(e,r)){if(this.Jm){if(this.$m==this.getRevision()&&ye(this.Jm.getProjection(),r)&&this.Jm.getResolution()==n&&sr(this.Jm.getExtent(),t))return this.Jm;this.Jm.dispose(),this.Jm=null}return this.Jm=new NA(e,r,t,n,i,function(t,n,i){return this.getImageInternal(t,n,i,e)}.bind(this),this.getInterpolate()),this.$m=this.getRevision(),this.Jm}return e&&(r=e),this.getImageInternal(t,n,i,r)},n.prototype.getImageInternal=function(t,n,i,r){return v()},n.prototype.handleImageChange=function(t){var n,i=t.target;switch(i.getState()){case sv:this.loading=!0,n=WN;break;case av:this.loading=!1,n=YN;break;case fv:this.loading=!1,n=ZN;break;default:return}this.hasListener(n)&&this.dispatchEvent(new HN(n,i))},n}(Px);function $N(t,n){var i=[];Object.keys(n).forEach((function(t){null!==n[t]&&void 0!==n[t]&&i.push(t+"="+encodeURIComponent(n[t]))}));var r=i.join("&");return(t=-1===(t=t.replace(/[?&]$/,"")).indexOf("?")?t+"?":t+"&")+r}var QN=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),tz=function(t){function n(n){var i=this,r=n||{},e=void 0===r.imageSmoothing||r.imageSmoothing;return void 0!==r.interpolate&&(e=r.interpolate),(i=t.call(this,{attributions:r.attributions,interpolate:e,projection:r.projection,resolutions:r.resolutions})||this).Lo=void 0!==r.crossOrigin?r.crossOrigin:null,i.wm=void 0===r.hidpi||r.hidpi,i.Ch=r.url,i._o=void 0!==r.imageLoadFunction?r.imageLoadFunction:KN,i.Qm=r.params||{},i.bo=null,i.tw=[0,0],i.lh=0,i.nw=void 0!==r.ratio?r.ratio:1.5,i}return QN(n,t),n.prototype.getParams=function(){return this.Qm},n.prototype.getImageInternal=function(t,n,i,r){if(void 0===this.Ch)return null;n=this.findNearestResolution(n),i=this.wm?i:1;var e=this.bo;if(e&&this.lh==this.getRevision()&&e.getResolution()==n&&e.getPixelRatio()==i&&Qi(e.getExtent(),t))return e;var o={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};W(o,this.Qm);var u=((t=t.slice())[0]+t[2])/2,s=(t[1]+t[3])/2;if(1!=this.nw){var a=this.nw*jr(t)/2,f=this.nw*_r(t)/2;t[0]=u-a,t[1]=s-f,t[2]=u+a,t[3]=s+f}var h=n/i,c=Math.ceil(jr(t)/h),l=Math.ceil(_r(t)/h);t[0]=u-h*c/2,t[2]=u+h*c/2,t[1]=s-h*l/2,t[3]=s+h*l/2,this.tw[0]=c,this.tw[1]=l;var v=this.iw(t,this.tw,i,r,o);return this.bo=new yv(t,n,i,v,this.Lo,this._o),this.lh=this.getRevision(),this.bo.addEventListener($,this.handleImageChange.bind(this)),this.bo},n.prototype.getImageLoadFunction=function(){return this._o},n.prototype.iw=function(t,n,i,r,e){var o=r.getCode().split(/:(?=\d+$)/).pop();e.SIZE=n[0]+","+n[1],e.BBOX=t.join(","),e.BBOXSR=o,e.IMAGESR=o,e.DPI=Math.round(90*i);var u=this.Ch,s=u.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return s==u&&g(!1,50),$N(s,e)},n.prototype.getUrl=function(){return this.Ch},n.prototype.setImageLoadFunction=function(t){this.bo=null,this._o=t,this.changed()},n.prototype.setUrl=function(t){t!=this.Ch&&(this.Ch=t,this.bo=null,this.changed())},n.prototype.updateParams=function(t){W(this.Qm,t),this.bo=null,this.changed()},n}(JN),nz=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),iz=function(t){function n(n){var i=this,r=n||{},e=void 0===r.imageSmoothing||r.imageSmoothing;return void 0!==r.interpolate&&(e=r.interpolate),(i=t.call(this,{attributions:r.attributions,interpolate:e,projection:r.projection,resolutions:r.resolutions,state:r.state})||this).rw=r.canvasFunction,i.Eo=null,i.lh=0,i.nw=void 0!==r.ratio?r.ratio:1.5,i}return nz(n,t),n.prototype.getImageInternal=function(t,n,i,r){n=this.findNearestResolution(n);var e=this.Eo;if(e&&this.lh==this.getRevision()&&e.getResolution()==n&&e.getPixelRatio()==i&&Qi(e.getExtent(),t))return e;Ar(t=t.slice(),this.nw);var o=[jr(t)/n*i,_r(t)/n*i],u=this.rw.call(this,t,n,i,o,r);return u&&(e=new Lb(t,n,i,u)),this.Eo=e,this.lh=this.getRevision(),e},n}(JN),rz=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();var ez=function(t){function n(n){var i=this,r=void 0===n.imageSmoothing||n.imageSmoothing;return void 0!==n.interpolate&&(r=n.interpolate),(i=t.call(this,{interpolate:r,projection:n.projection,resolutions:n.resolutions})||this).Lo=void 0!==n.crossOrigin?n.crossOrigin:null,i.ew=void 0!==n.displayDpi?n.displayDpi:96,i.Qm=n.params||{},i.Ch=n.url,i._o=void 0!==n.imageLoadFunction?n.imageLoadFunction:KN,i.wm=void 0===n.hidpi||n.hidpi,i.Xt=void 0!==n.metersPerUnit?n.metersPerUnit:1,i.nw=void 0!==n.ratio?n.ratio:1,i.ow=void 0!==n.useOverlay&&n.useOverlay,i.bo=null,i.lh=0,i}return rz(n,t),n.prototype.getParams=function(){return this.Qm},n.prototype.getImageInternal=function(t,n,i,r){n=this.findNearestResolution(n),i=this.wm?i:1;var e=this.bo;if(e&&this.lh==this.getRevision()&&e.getResolution()==n&&e.getPixelRatio()==i&&Qi(e.getExtent(),t))return e;1!=this.nw&&Ar(t=t.slice(),this.nw);var o=[jr(t)/n*i,_r(t)/n*i];if(void 0!==this.Ch){var u=this.getUrl(this.Ch,this.Qm,t,o,r);(e=new yv(t,n,i,u,this.Lo,this._o)).addEventListener($,this.handleImageChange.bind(this))}else e=null;return this.bo=e,this.lh=this.getRevision(),e},n.prototype.getImageLoadFunction=function(){return this._o},n.prototype.updateParams=function(t){W(this.Qm,t),this.changed()},n.prototype.getUrl=function(t,n,i,r,e){var o=function(t,n,i,r){var e=jr(t),o=_r(t),u=n[0],s=n[1],a=.0254/r;return s*e>u*o?e*i/(u*a):o*i/(s*a)}(i,r,this.Xt,this.ew),u=br(i),s={OPERATION:this.ow?"GETDYNAMICMAPOVERLAYIMAGE":"GETMAPIMAGE",VERSION:"2.0.0",LOCALE:"en",CLIENTAGENT:"ol/source/ImageMapGuide source",CLIP:"1",SETDISPLAYDPI:this.ew,SETDISPLAYWIDTH:Math.round(r[0]),SETDISPLAYHEIGHT:Math.round(r[1]),SETVIEWSCALE:o,SETVIEWCENTERX:u[0],SETVIEWCENTERY:u[1]};return W(s,n),$N(t,s)},n.prototype.setImageLoadFunction=function(t){this.bo=null,this._o=t,this.changed()},n}(JN),oz=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),uz=function(t){function n(n){var i=this,r=void 0!==n.crossOrigin?n.crossOrigin:null,e=void 0!==n.imageLoadFunction?n.imageLoadFunction:KN,o=void 0===n.imageSmoothing||n.imageSmoothing;return void 0!==n.interpolate&&(o=n.interpolate),(i=t.call(this,{attributions:n.attributions,interpolate:o,projection:ae(n.projection)})||this).Ch=n.url,i.uw=n.imageExtent,i.bo=new yv(i.uw,void 0,1,i.Ch,r,e),i.tw=n.imageSize?n.imageSize:null,i.bo.addEventListener($,i.handleImageChange.bind(i)),i}return oz(n,t),n.prototype.getImageExtent=function(){return this.uw},n.prototype.getImageInternal=function(t,n,i,r){return Er(t,this.bo.getExtent())?this.bo:null},n.prototype.getUrl=function(){return this.Ch},n.prototype.handleImageChange=function(n){if(this.bo.getState()==av){var i=this.bo.getExtent(),r=this.bo.getImage(),e=void 0,o=void 0;this.tw?(e=this.tw[0],o=this.tw[1]):(e=r.width,o=r.height);var u=jr(i),s=_r(i),a=u/e,f=s/o,h=e,c=o;if(a>f?h=Math.round(u/f):c=Math.round(s/a),h!==e||c!==o){var l=Qt(h,c);this.getInterpolate()||W(l,oO);var v=l.canvas;l.drawImage(r,0,0,e,o,0,0,v.width,v.height),this.bo.setImage(v)}}t.prototype.handleImageChange.call(this,n)},n}(JN),sz="carmentaserver",az="geoserver",fz="mapserver",hz="qgis",cz=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),lz=[101,101],vz=function(t){function n(n){var i=this,r=n||{},e=void 0===r.imageSmoothing||r.imageSmoothing;return void 0!==r.interpolate&&(e=r.interpolate),(i=t.call(this,{attributions:r.attributions,interpolate:e,projection:r.projection,resolutions:r.resolutions})||this).Lo=void 0!==r.crossOrigin?r.crossOrigin:null,i.Ch=r.url,i._o=void 0!==r.imageLoadFunction?r.imageLoadFunction:KN,i.Qm=r.params||{},i.sw=!0,i.aw(),i.fw=r.serverType,i.wm=void 0===r.hidpi||r.hidpi,i.bo=null,i.tw=[0,0],i.lh=0,i.nw=void 0!==r.ratio?r.ratio:1.5,i}return cz(n,t),n.prototype.getFeatureInfoUrl=function(t,n,i,r){if(void 0!==this.Ch){var e=ae(i),o=this.getProjection();o&&o!==e&&(n=pO(o,e,t,n),t=be(t,e,o));var u=xr(t,n,0,lz),s={SERVICE:"WMS",VERSION:VA,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.Qm.LAYERS};W(s,this.Qm,r);var a=R((t[0]-u[0])/n,4),f=R((u[3]-t[1])/n,4);return s[this.sw?"I":"X"]=a,s[this.sw?"J":"Y"]=f,this.iw(u,lz,1,o||e,s)}},n.prototype.getLegendUrl=function(t,n){if(void 0!==this.Ch){var i={SERVICE:"WMS",VERSION:VA,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(void 0===n||void 0===n.LAYER){var r=this.Qm.LAYERS;if(!(!Array.isArray(r)||1===r.length))return;i.LAYER=r}if(void 0!==t){var e=this.getProjection()?this.getProjection().getMetersPerUnit():1;i.SCALE=t*e/28e-5}return W(i,n),$N(this.Ch,i)}},n.prototype.getParams=function(){return this.Qm},n.prototype.getImageInternal=function(t,n,i,r){if(void 0===this.Ch)return null;n=this.findNearestResolution(n),1==i||this.wm&&void 0!==this.fw||(i=1);var e=n/i,o=br(t),u=xr(o,e,0,[I(jr(t)/e,4),I(_r(t)/e,4)]),s=xr(o,e,0,[I(this.nw*jr(t)/e,4),I(this.nw*_r(t)/e,4)]),a=this.bo;if(a&&this.lh==this.getRevision()&&a.getResolution()==n&&a.getPixelRatio()==i&&Qi(a.getExtent(),u))return a;var f={SERVICE:"WMS",VERSION:VA,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};W(f,this.Qm),this.tw[0]=P(jr(s)/e,4),this.tw[1]=P(_r(s)/e,4);var h=this.iw(s,this.tw,i,r,f);return this.bo=new yv(s,n,i,h,this.Lo,this._o),this.lh=this.getRevision(),this.bo.addEventListener($,this.handleImageChange.bind(this)),this.bo},n.prototype.getImageLoadFunction=function(){return this._o},n.prototype.iw=function(t,n,i,r,e){if(g(void 0!==this.Ch,9),e[this.sw?"CRS":"SRS"]=r.getCode(),"STYLES"in this.Qm||(e.STYLES=""),1!=i)switch(this.fw){case az:var o=90*i+.5|0;"FORMAT_OPTIONS"in e?e.FORMAT_OPTIONS+=";dpi:"+o:e.FORMAT_OPTIONS="dpi:"+o;break;case fz:e.MAP_RESOLUTION=90*i;break;case sz:case hz:e.DPI=90*i;break;default:g(!1,8)}e.WIDTH=n[0],e.HEIGHT=n[1];var u,s=r.getAxisOrientation();return u=this.sw&&"ne"==s.substr(0,2)?[t[1],t[0],t[3],t[2]]:t,e.BBOX=u.join(","),$N(this.Ch,e)},n.prototype.getUrl=function(){return this.Ch},n.prototype.setImageLoadFunction=function(t){this.bo=null,this._o=t,this.changed()},n.prototype.setUrl=function(t){t!=this.Ch&&(this.Ch=t,this.bo=null,this.changed())},n.prototype.updateParams=function(t){W(this.Qm,t),this.aw(),this.bo=null,this.changed()},n.prototype.aw=function(){var t=this.Qm.VERSION||VA;this.sw=Nr(t,"1.3")>=0},n}(JN),pz={"image/png":!0,"image/jpeg":!0,"image/gif":!0,"image/webp":!0},dz={"application/vnd.mapbox-vector-tile":!0,"application/geo+json":!0};function yz(t,n){for(var i,r,e=0;e<t.length;++e){var o=t[e];if("item"===o.rel){if(o.type===n){i=o.href;break}pz[o.type]?r=o.href:r||0!==o.type.indexOf("image/")||(r=o.href)}}if(!i){if(!r)throw new Error('Could not find "item" link');i=r}return i}function mz(t,n,i){for(var r,e,o={},u=0;u<t.length;++u){var s=t[u];if(o[s.type]=s.href,"item"===s.rel){if(s.type===n){r=s.href;break}dz[s.type]&&(e=s.href)}}if(!r&&i)for(u=0;u<i.length;++u){var a=i[u];if(o[a]){r=o[a];break}}if(!r){if(!e)throw new Error('Could not find "item" link');r=e}return r}function wz(t,n,i,r){var e=t.projection;if(!e&&!(e=ae(n.crs)))throw new Error("Unsupported CRS: ".concat(n.crs));for(var o="en"!==e.getAxisOrientation().substr(0,2),u=n.tileMatrices,s={},a=0;a<u.length;++a){var f=u[a];s[f.id]=f}var h={},c=[];if(r)for(a=0;a<r.length;++a){var l=(b=r[a]).tileMatrix;c.push(l),h[l]=b}else for(a=0;a<u.length;++a){l=u[a].id;c.push(l)}var v=c.length,p=new Array(v),d=new Array(v),y=new Array(v),m=new Array(v),w=[-1/0,-1/0,1/0,1/0];for(a=0;a<v;++a){l=c[a];var b,g=(f=s[l]).pointOfOrigin;if(p[a]=o?[g[1],g[0]]:g,d[a]=f.cellSize,y[a]=[f.matrixWidth,f.matrixHeight],m[a]=[f.tileWidth,f.tileHeight],b=h[l]){var x=f.cellSize*f.tileWidth,_=p[a][0]+b.minTileCol*x,M=p[a][0]+(b.maxTileCol+1)*x,O=f.cellSize*f.tileHeight,S=void 0,j=void 0;"bottomLeft"===f.cornerOfOrigin?(S=p[a][1]+b.minTileRow*O,j=p[a][1]+(b.maxTileRow+1)*O):(S=p[a][1]-(b.maxTileRow+1)*O,j=p[a][1]-b.minTileRow*O),Mr(w,[_,S,M,j],w)}}var E=new HO({origins:p,resolutions:d,sizes:y,tileSizes:m,extent:r?w:void 0}),k=t.context,T=t.url;return{grid:E,urlTemplate:i,urlFunction:function(t,n,e){if(t){var o=c[t[0]],u=s[o],a="bottomLeft"===u.cornerOfOrigin,f={tileMatrix:o,tileCol:t[1],tileRow:a?-t[2]-1:t[2]};if(r){var l=h[u.id];if(f.tileCol<l.minTileCol||f.tileCol>l.maxTileCol||f.tileRow<l.minTileRow||f.tileRow>l.maxTileRow)return}W(f,k);var v=i.replace(/\{(\w+?)\}/g,(function(t,n){return f[n]}));return TS(T,v)}}}}function bz(t){return kS(t.url).then((function(n){return function(t,n){var i,r=n.tileMatrixSetLimits;if("map"===n.dataType)i=yz(n.links,t.mediaType);else{if("vector"!==n.dataType)throw new Error('Expected tileset data type to be "map" or "vector"');i=mz(n.links,t.mediaType,t.supportedMediaTypes)}if(n.tileMatrixSet)return wz(t,n.tileMatrixSet,i,r);var e=n.links.find((function(t){return"http://www.opengis.net/def/rel/ogc/1.0/tiling-scheme"===t.rel}));if(!e)throw new Error("Expected http://www.opengis.net/def/rel/ogc/1.0/tiling-scheme link or tileMatrixSet");var o=e.href;return kS(TS(t.url,o)).then((function(n){return wz(t,n,i,r)}))}(t,n)}))}var gz,xz=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),_z=function(t){function n(n){var i=this,r=void 0===n.imageSmoothing||n.imageSmoothing;return void 0!==n.interpolate&&(r=n.interpolate),i=t.call(this,{attributions:n.attributions,cacheSize:n.cacheSize,crossOrigin:n.crossOrigin,interpolate:r,projection:n.projection,reprojectionErrorThreshold:n.reprojectionErrorThreshold,state:Ln,tileLoadFunction:n.tileLoadFunction,wrapX:void 0===n.wrapX||n.wrapX,transition:n.transition})||this,bz({url:n.url,projection:i.getProjection(),mediaType:n.mediaType,context:n.context||null}).then(i.hw.bind(i)).catch(i.cw.bind(i)),i}return xz(n,t),n.prototype.hw=function(t){this.tileGrid=t.grid,this.setTileUrlFunction(t.urlFunction,t.urlTemplate),this.setState(Gn)},n.prototype.cw=function(t){console.error(t),this.setState(Dn)},n}(_S),Mz=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Oz=function(t){function n(n){var i=t.call(this,{attributions:n.attributions,attributionsCollapsible:n.attributionsCollapsible,cacheSize:n.cacheSize,format:n.format,overlaps:n.overlaps,projection:n.projection,tileClass:n.tileClass,transition:n.transition,wrapX:n.wrapX,zDirection:n.zDirection,state:Ln})||this;return bz({url:n.url,projection:i.getProjection(),mediaType:n.mediaType,supportedMediaTypes:n.format.supportedMediaTypes,context:n.context||null}).then(i.hw.bind(i)).catch(i.cw.bind(i)),i}return Mz(n,t),n.prototype.hw=function(t){this.tileGrid=t.grid,this.setTileUrlFunction(t.urlFunction,t.urlTemplate),this.setState(Gn)},n.prototype.cw=function(t){console.error(t),this.setState(Dn)},n}(wS),Sz=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),jz='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.',Ez=function(t){function n(n){var i,r=n||{},e=void 0===r.imageSmoothing||r.imageSmoothing;void 0!==r.interpolate&&(e=r.interpolate),i=void 0!==r.attributions?r.attributions:[jz];var o=void 0!==r.crossOrigin?r.crossOrigin:"anonymous",u=void 0!==r.url?r.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png";return t.call(this,{attributions:i,attributionsCollapsible:!1,cacheSize:r.cacheSize,crossOrigin:o,interpolate:e,maxZoom:void 0!==r.maxZoom?r.maxZoom:19,opaque:void 0===r.opaque||r.opaque,reprojectionErrorThreshold:r.reprojectionErrorThreshold,tileLoadFunction:r.tileLoadFunction,transition:r.transition,url:u,wrapX:r.wrapX,zDirection:r.zDirection})||this}return Sz(n,t),n}(DA),kz=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Tz=!0;try{new ImageData(10,10)}catch(t){Tz=!1}function Az(t,n,i){if(Tz)return new ImageData(t,n,i);gz||(gz=document.createElement("canvas").getContext("2d"));var r=gz.createImageData(n,i);return r.data.set(t),r}function Cz(t){var n=!0;try{new ImageData(10,10)}catch(t){n=!1}function i(t,i,r){return n?new ImageData(t,i,r):{data:t,width:i,height:r}}return function(n){var r=n.buffers,e=n.meta,o=n.imageOps,u=n.width,s=n.height,a=r.length,f=r[0].byteLength;if(o){for(var h=new Array(a),c=0;c<a;++c)h[c]=i(new Uint8ClampedArray(r[c]),u,s);return t(h,e).data.buffer}var l=new Uint8ClampedArray(f),v=new Array(a),p=new Array(a);for(c=0;c<a;++c)v[c]=new Uint8ClampedArray(r[c]),p[c]=[0,0,0,0];for(var d=0;d<f;d+=4){for(var y=0;y<a;++y){var m=v[y];p[y][0]=m[d],p[y][1]=m[d+1],p[y][2]=m[d+2],p[y][3]=m[d+3]}var w=t(p,e);l[d]=w[0],l[d+1]=w[1],l[d+2]=w[2],l[d+3]=w[3]}return l.buffer}}function Pz(t,n){var i=Object.keys(t.lib||{}).map((function(n){return"var "+n+" = "+t.lib[n].toString()+";"})).concat(["var __minion__ = ("+Cz.toString()+")(",t.operation.toString(),");",'self.addEventListener("message", function(event) {',"  var buffer = __minion__(event.data);","  self.postMessage({buffer: buffer, meta: event.data.meta}, [buffer]);","});"]),r=new Worker("undefined"==typeof Blob?"data:text/javascript;base64,"+Buffer.from(i.join("\n"),"binary").toString("base64"):URL.createObjectURL(new Blob(i,{type:"text/javascript"})));return r.addEventListener("message",n),r}var Rz=function(t){function n(n){var i,r=t.call(this)||this;r._imageOps=!!n.imageOps,i=0===n.threads?0:r._imageOps?1:n.threads||1;var e=new Array(i);if(i)for(var o=0;o<i;++o)e[o]=Pz(n,r._onWorkerMessage.bind(r,o));else e[0]=function(t,n){var i=Cz(t.operation),r=!1;return{postMessage:function(t){setTimeout((function(){r||n({data:{buffer:i(t),meta:t.meta}})}),0)},terminate:function(){r=!0}}}(n,r._onWorkerMessage.bind(r,0));return r._workers=e,r._queue=[],r._maxQueueLength=n.queue||1/0,r._running=0,r._dataLookup={},r._job=null,r}return kz(n,t),n.prototype.process=function(t,n,i){this._enqueue({inputs:t,meta:n,callback:i}),this._dispatch()},n.prototype._enqueue=function(t){for(this._queue.push(t);this._queue.length>this._maxQueueLength;)this._queue.shift().callback(null,null)},n.prototype._dispatch=function(){if(!this._running&&0!==this._queue.length){var t=this._queue.shift();this._job=t;var n=t.inputs[0].width,i=t.inputs[0].height,r=t.inputs.map((function(t){return t.data.buffer})),e=this._workers.length;if(this._running=e,1!==e)for(var o=t.inputs[0].data.length,u=4*Math.ceil(o/4/e),s=0;s<e;++s){for(var a=s*u,f=[],h=0,c=r.length;h<c;++h)f.push(r[h].slice(a,a+u));this._workers[s].postMessage({buffers:f,meta:t.meta,imageOps:this._imageOps,width:n,height:i},f)}else this._workers[0].postMessage({buffers:r,meta:t.meta,imageOps:this._imageOps,width:n,height:i},r)}},n.prototype._onWorkerMessage=function(t,n){this.disposed||(this._dataLookup[t]=n.data,--this._running,0===this._running&&this._resolveJob())},n.prototype._resolveJob=function(){var t,n,i=this._job,r=this._workers.length;if(1===r)t=new Uint8ClampedArray(this._dataLookup[0].buffer),n=this._dataLookup[0].meta;else{var e=i.inputs[0].data.length;t=new Uint8ClampedArray(e),n=new Array(r);for(var o=4*Math.ceil(e/4/r),u=0;u<r;++u){var s=this._dataLookup[u].buffer,a=u*o;t.set(new Uint8ClampedArray(s),a),n[u]=this._dataLookup[u].meta}}this._job=null,this._dataLookup={},i.callback(null,Az(t,i.inputs[0].width,i.inputs[0].height),n),this._dispatch()},n.prototype.disposeInternal=function(){for(var t=0;t<this._workers.length;++t)this._workers[t].terminate();this._workers.length=0},n}(D),Iz="beforeoperations",Nz="afteroperations",zz="pixel",Fz="image",Lz=function(t){function n(n,i,r){var e=t.call(this,n)||this;return e.extent=i.extent,e.resolution=i.viewState.resolution/i.pixelRatio,e.data=r,e}return kz(n,t),n}(L),Gz=function(t){function n(n){var i=t.call(this,{projection:null})||this;i.on,i.once,i.un,i.lw=null,i.pw=void 0!==n.operationType?n.operationType:zz,i.dw=void 0!==n.threads?n.threads:1,i.Uu=function(t){for(var n=t.length,i=new Array(n),r=0;r<n;++r)i[r]=qz(t[r]);return i}(n.sources);for(var r,e=i.changed.bind(i),o=0,u=i.Uu.length;o<u;++o)i.Uu[o].addEventListener($,e);return i.ar=new du((function(){return 1}),i.changed.bind(i)),i.yw,i.mw=null,i.lh,i.Yi={animate:!1,coordinateToPixelTransform:[1,0,0,1,0,0],declutterTree:null,extent:null,index:0,layerIndex:0,layerStatesArray:(r=i.Uu,r.map((function(t){return t.getLayerState()}))),pixelRatio:1,pixelToCoordinateTransform:[1,0,0,1,0,0],postRenderFunctions:[],size:[0,0],tileQueue:i.ar,time:Date.now(),usedTiles:{},viewState:{rotation:0},viewHints:[],wantedTiles:{},mapId:d(i),renderTargets:{}},i.setAttributions((function(t){for(var i=[],r=0,e=n.sources.length;r<e;++r){var o=n.sources[r],u=(o instanceof Px?o:o.getSource()).getAttributions();if("function"==typeof u){var s=u(t);i.push.apply(i,s)}}return 0!==i.length?i:null})),void 0!==n.operation&&i.setOperation(n.operation,n.lib),i}return kz(n,t),n.prototype.setOperation=function(t,n){this.lw&&this.lw.dispose(),this.lw=new Rz({operation:t,imageOps:this.pw===Fz,queue:1,lib:n,threads:this.dw}),this.changed()},n.prototype.ww=function(t,n,i){var r=W({},this.Yi);r.viewState=W({},r.viewState);var e=br(t);r.extent=t.slice(),r.size[0]=Math.round(jr(t)/n),r.size[1]=Math.round(_r(t)/n),r.time=Date.now();var o=r.viewState;return o.center=e,o.projection=i,o.resolution=n,r},n.prototype.bw=function(){for(var t=!0,n=0,i=this.Uu.length;n<i;++n)if(this.Uu[n].getSource().getState()!==Gn){t=!1;break}return t},n.prototype.getImage=function(t,n,i,r){if(!this.bw())return null;var e=this.ww(t,n,r);if(this.yw=e,this.mw){var o=this.mw.getResolution(),u=this.mw.getExtent();n===o&&sr(t,u)||(this.mw=null)}return this.mw&&this.getRevision()===this.lh||this.gw(),e.tileQueue.loadMoreTiles(16,16),e.animate&&requestAnimationFrame(this.changed.bind(this)),this.mw},n.prototype.gw=function(){for(var t=this.yw,n=this.Uu.length,i=new Array(n),r=0;r<n;++r){t.layerIndex=r;var e=Uz(this.Uu[r],t);if(!e)return;i[r]=e}var o={};this.dispatchEvent(new Lz(Iz,t,o)),this.lw.process(i,o,this.xw.bind(this,t))},n.prototype.xw=function(t,n,i,r){if(!n&&i){var e=t.extent,o=t.viewState.resolution;if(o===this.yw.viewState.resolution&&sr(e,this.yw.extent)){var u;if(this.mw)u=this.mw.getImage().getContext("2d");else u=Qt(Math.round(jr(e)/o),Math.round(_r(e)/o)),this.mw=new Lb(e,o,1,u.canvas);u.putImageData(i,0,0),this.changed(),this.lh=this.getRevision(),this.dispatchEvent(new Lz(Nz,t,r)),t.animate&&requestAnimationFrame(this.changed.bind(this))}}},n.prototype.disposeInternal=function(){this.lw&&this.lw.dispose(),t.prototype.disposeInternal.call(this)},n}(JN);Gz.prototype.dispose;var Dz=null;function Uz(t,n){var i=t.getRenderer();if(!i)throw new Error("Unsupported layer type: "+t);if(!i.prepareFrame(n))return null;var r=n.size[0],e=n.size[1];if(0===r||0===e)return null;var o,u=i.renderFrame(n,null);if(u instanceof HTMLCanvasElement)o=u;else{if(u&&(o=u.firstElementChild),!(o instanceof HTMLCanvasElement))throw new Error("Unsupported rendered element: "+o);if(o.width===r&&o.height===e)return o.getContext("2d").getImageData(0,0,r,e)}if(Dz){var s=Dz.canvas;s.width!==r||s.height!==e?Dz=Qt(r,e):Dz.clearRect(0,0,r,e)}else Dz=Qt(r,e);return Dz.drawImage(o,0,0,r,e),Dz.getImageData(0,0,r,e)}function qz(t){var n;return t instanceof Px?t instanceof uS?n=new ET({source:t}):t instanceof JN&&(n=new hO({source:t})):n=t,n}var Bz=Gz,Xz=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Vz=['Map tiles by <a href="https://stamen.com/" target="_blank">Stamen Design</a>, under <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC BY 3.0</a>.',jz],Wz={terrain:{extension:"jpg",opaque:!0},"terrain-background":{extension:"jpg",opaque:!0},"terrain-labels":{extension:"png",opaque:!1},"terrain-lines":{extension:"png",opaque:!1},"toner-background":{extension:"png",opaque:!0},toner:{extension:"png",opaque:!0},"toner-hybrid":{extension:"png",opaque:!1},"toner-labels":{extension:"png",opaque:!1},"toner-lines":{extension:"png",opaque:!1},"toner-lite":{extension:"png",opaque:!0},watercolor:{extension:"jpg",opaque:!0}},Yz={terrain:{minZoom:0,maxZoom:18},toner:{minZoom:0,maxZoom:20},watercolor:{minZoom:0,maxZoom:18}},Zz=function(t){function n(n){var i=void 0===n.imageSmoothing||n.imageSmoothing;void 0!==n.interpolate&&(i=n.interpolate);var r=n.layer.indexOf("-"),e=-1==r?n.layer:n.layer.slice(0,r),o=Yz[e],u=Wz[n.layer],s=void 0!==n.url?n.url:"https://stamen-tiles-{a-d}.a.ssl.fastly.net/"+n.layer+"/{z}/{x}/{y}."+u.extension;return t.call(this,{attributions:Vz,cacheSize:n.cacheSize,crossOrigin:"anonymous",interpolate:i,maxZoom:null!=n.maxZoom?n.maxZoom:o.maxZoom,minZoom:null!=n.minZoom?n.minZoom:o.minZoom,opaque:u.opaque,reprojectionErrorThreshold:n.reprojectionErrorThreshold,tileLoadFunction:n.tileLoadFunction,transition:n.transition,url:s,wrapX:n.wrapX,zDirection:n.zDirection})||this}return Xz(n,t),n}(DA),Hz=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Kz=function(t){function n(n){var i=this,r=n||{},e=void 0===r.imageSmoothing||r.imageSmoothing;return void 0!==r.interpolate&&(e=r.interpolate),(i=t.call(this,{attributions:r.attributions,cacheSize:r.cacheSize,crossOrigin:r.crossOrigin,interpolate:e,projection:r.projection,reprojectionErrorThreshold:r.reprojectionErrorThreshold,tileGrid:r.tileGrid,tileLoadFunction:r.tileLoadFunction,url:r.url,urls:r.urls,wrapX:void 0===r.wrapX||r.wrapX,transition:r.transition,zDirection:r.zDirection})||this).Qm=r.params||{},i.wm=void 0===r.hidpi||r.hidpi,i.Sy=[1/0,1/0,-1/0,-1/0],i.setKey(i._w()),i}return Hz(n,t),n.prototype._w=function(){var t=0,n=[];for(var i in this.Qm)n[t++]=i+"-"+this.Qm[i];return n.join("/")},n.prototype.getParams=function(){return this.Qm},n.prototype.iw=function(t,n,i,r,e,o){var u=this.urls;if(u){var s,a=e.getCode().split(/:(?=\d+$)/).pop();if(o.SIZE=n[0]+","+n[1],o.BBOX=i.join(","),o.BBOXSR=a,o.IMAGESR=a,o.DPI=Math.round(o.DPI?o.DPI*r:90*r),1==u.length)s=u[0];else s=u[T(UO(t),u.length)];return $N(s.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage"),o)}},n.prototype.getTilePixelRatio=function(t){return this.wm?t:1},n.prototype.updateParams=function(t){W(this.Qm,t),this.setKey(this._w())},n.prototype.tileUrlFunction=function(t,n,i){var r=this.getTileGrid();if(r||(r=this.getTileGridForProjection(i)),!(r.getResolutions().length<=t[0])){1==n||this.wm||(n=1);var e=r.getTileCoordExtent(t,this.Sy),o=ua(r.getTileSize(t[0]),this.tmpSize);1!=n&&(o=oa(o,n,this.tmpSize));var u={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};return W(u,this.Qm),this.iw(t,o,e,n,i,u)}},n}(_S),Jz=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),$z=function(t){function n(n){var i=this,r=n||{};return i=t.call(this,{opaque:!1,projection:r.projection,tileGrid:r.tileGrid,wrapX:void 0===r.wrapX||r.wrapX,zDirection:r.zDirection,url:r.template||"z:{z} x:{x} y:{y}",tileLoadFunction:function(t,n){var r=t.getTileCoord()[0],e=ua(i.tileGrid.getTileSize(r)),o=Qt(e[0],e[1]);o.strokeStyle="grey",o.strokeRect(.5,.5,e[0]+.5,e[1]+.5),o.fillStyle="grey",o.strokeStyle="white",o.textAlign="center",o.textBaseline="middle",o.font="24px sans-serif",o.lineWidth=4,o.strokeText(n,e[0]/2,e[1]/2,e[0]),o.fillText(n,e[0]/2,e[1]/2,e[0]),t.setImage(o.canvas)}})||this}return Jz(n,t),n}(DA),Qz=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),tF=function(t){function n(n){var i=this,r=n||{},e=void 0===r.imageSmoothing||r.imageSmoothing;void 0!==r.interpolate&&(e=r.interpolate);var o=r.params||{},u=!("TRANSPARENT"in o)||o.TRANSPARENT;return(i=t.call(this,{attributions:r.attributions,attributionsCollapsible:r.attributionsCollapsible,cacheSize:r.cacheSize,crossOrigin:r.crossOrigin,interpolate:e,opaque:!u,projection:r.projection,reprojectionErrorThreshold:r.reprojectionErrorThreshold,tileClass:r.tileClass,tileGrid:r.tileGrid,tileLoadFunction:r.tileLoadFunction,url:r.url,urls:r.urls,wrapX:void 0===r.wrapX||r.wrapX,transition:r.transition,zDirection:r.zDirection})||this).Bd=void 0!==r.gutter?r.gutter:0,i.Qm=o,i.sw=!0,i.fw=r.serverType,i.wm=void 0===r.hidpi||r.hidpi,i.Sy=[1/0,1/0,-1/0,-1/0],i.aw(),i.setKey(i._w()),i}return Qz(n,t),n.prototype.getFeatureInfoUrl=function(t,n,i,r){var e=ae(i),o=this.getProjection(),u=this.getTileGrid();u||(u=this.getTileGridForProjection(e));var s=u.getZForResolution(n,this.zDirection),a=u.getTileCoordForCoordAndZ(t,s);if(!(u.getResolutions().length<=a[0])){var f=u.getResolution(a[0]),h=u.getTileCoordExtent(a,this.Sy),c=ua(u.getTileSize(a[0]),this.tmpSize),l=this.Bd;0!==l&&(c=ra(c,l,this.tmpSize),h=Hi(h,f*l,h)),o&&o!==e&&(f=pO(o,e,t,f),h=ge(h,e,o),t=be(t,e,o));var v={SERVICE:"WMS",VERSION:VA,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.Qm.LAYERS};W(v,this.Qm,r);var p=Math.floor((t[0]-h[0])/f),d=Math.floor((h[3]-t[1])/f);return v[this.sw?"I":"X"]=p,v[this.sw?"J":"Y"]=d,this.iw(a,c,h,1,o||e,v)}},n.prototype.getLegendUrl=function(t,n){if(void 0!==this.urls[0]){var i={SERVICE:"WMS",VERSION:VA,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(void 0===n||void 0===n.LAYER){var r=this.Qm.LAYERS;if(!(!Array.isArray(r)||1===r.length))return;i.LAYER=r}if(void 0!==t){var e=this.getProjection()?this.getProjection().getMetersPerUnit():1;i.SCALE=t*e/28e-5}return W(i,n),$N(this.urls[0],i)}},n.prototype.getGutter=function(){return this.Bd},n.prototype.getParams=function(){return this.Qm},n.prototype.iw=function(t,n,i,r,e,o){var u=this.urls;if(u){if(o.WIDTH=n[0],o.HEIGHT=n[1],o[this.sw?"CRS":"SRS"]=e.getCode(),"STYLES"in this.Qm||(o.STYLES=""),1!=r)switch(this.fw){case az:var s=90*r+.5|0;"FORMAT_OPTIONS"in o?o.FORMAT_OPTIONS+=";dpi:"+s:o.FORMAT_OPTIONS="dpi:"+s;break;case fz:o.MAP_RESOLUTION=90*r;break;case sz:case hz:o.DPI=90*r;break;default:g(!1,52)}var a,f=e.getAxisOrientation(),h=i;if(this.sw&&"ne"==f.substr(0,2)){var c=void 0;c=i[0],h[0]=i[1],h[1]=c,c=i[2],h[2]=i[3],h[3]=c}if(o.BBOX=h.join(","),1==u.length)a=u[0];else a=u[T(UO(t),u.length)];return $N(a,o)}},n.prototype.getTilePixelRatio=function(t){return this.wm&&void 0!==this.fw?t:1},n.prototype._w=function(){var t=0,n=[];for(var i in this.Qm)n[t++]=i+"-"+this.Qm[i];return n.join("/")},n.prototype.updateParams=function(t){W(this.Qm,t),this.aw(),this.setKey(this._w())},n.prototype.aw=function(){var t=this.Qm.VERSION||VA;this.sw=Nr(t,"1.3")>=0},n.prototype.tileUrlFunction=function(t,n,i){var r=this.getTileGrid();if(r||(r=this.getTileGridForProjection(i)),!(r.getResolutions().length<=t[0])){1==n||this.wm&&void 0!==this.fw||(n=1);var e=r.getResolution(t[0]),o=r.getTileCoordExtent(t,this.Sy),u=ua(r.getTileSize(t[0]),this.tmpSize),s=this.Bd;0!==s&&(u=ra(u,s,this.tmpSize),o=Hi(o,e*s,o)),1!=n&&(u=oa(u,n,this.tmpSize));var a={SERVICE:"WMS",VERSION:VA,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};return W(a,this.Qm),this.iw(t,u,o,n,i,a)}},n}(_S),nF=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),iF=function(t){function n(n,i,r,e,o,u){var s=t.call(this,n,i)||this;return s.wo=r,s.Ft=e,s.Mw=o,s.Ow=null,s.bt=null,s.xe=null,s.Sw=u,s}return nF(n,t),n.prototype.getImage=function(){return null},n.prototype.getData=function(t){if(!this.Ow||!this.bt)return null;var n=(t[0]-this.Ft[0])/(this.Ft[2]-this.Ft[0]),i=(t[1]-this.Ft[1])/(this.Ft[3]-this.Ft[1]),r=this.Ow[Math.floor((1-i)*this.Ow.length)];if("string"!=typeof r)return null;var e=r.charCodeAt(Math.floor(n*r.length));e>=93&&e--,e>=35&&e--;var o=null;if((e-=32)in this.bt){var u=this.bt[e];o=this.xe&&u in this.xe?this.xe[u]:u}return o},n.prototype.forDataAtCoordinate=function(t,n,i){this.state==vu&&!0===i?(this.state=fu,vt(this,$,(function(i){n(this.getData(t))}),this),this.jw()):!0===i?setTimeout(function(){n(this.getData(t))}.bind(this),0):n(this.getData(t))},n.prototype.getKey=function(){return this.wo},n.prototype.cw=function(){this.state=lu,this.changed()},n.prototype.Qs=function(t){this.Ow=t.grid,this.bt=t.keys,this.xe=t.data,this.state=cu,this.changed()},n.prototype.jw=function(){if(this.state==fu)if(this.state=hu,this.Sw)OS(this.wo,this.Qs.bind(this),this.cw.bind(this));else{var t=new XMLHttpRequest;t.addEventListener("load",this.Gy.bind(this)),t.addEventListener("error",this.Dy.bind(this)),t.open("GET",this.wo),t.send()}},n.prototype.Gy=function(t){var n=t.target;if(!n.status||n.status>=200&&n.status<300){var i=void 0;try{i=JSON.parse(n.responseText)}catch(t){return void this.cw()}this.Qs(i)}else this.cw()},n.prototype.Dy=function(t){this.cw()},n.prototype.load=function(){this.Mw?this.jw():this.setState(vu)},n}(La),rF=function(t){function n(n){var i=t.call(this,{projection:ae("EPSG:3857"),state:Ln,zDirection:n.zDirection})||this;if(i.Mw=void 0===n.preemptive||n.preemptive,i.Ew=hS,i.kw=void 0,i.Sw=n.jsonp||!1,n.url)if(i.Sw)OS(n.url,i.handleTileJSONResponse.bind(i),i.handleTileJSONError.bind(i));else{var r=new XMLHttpRequest;r.addEventListener("load",i.Gy.bind(i)),r.addEventListener("error",i.Dy.bind(i)),r.open("GET",n.url),r.send()}else n.tileJSON?i.handleTileJSONResponse(n.tileJSON):g(!1,51);return i}return nF(n,t),n.prototype.Gy=function(t){var n=t.target;if(!n.status||n.status>=200&&n.status<300){var i=void 0;try{i=JSON.parse(n.responseText)}catch(t){return void this.handleTileJSONError()}this.handleTileJSONResponse(i)}else this.handleTileJSONError()},n.prototype.Dy=function(t){this.handleTileJSONError()},n.prototype.getTemplate=function(){return this.kw},n.prototype.forDataAtCoordinateAndResolution=function(t,n,i,r){if(this.tileGrid){var e=this.tileGrid.getZForResolution(n,this.zDirection),o=this.tileGrid.getTileCoordForCoordAndZ(t,e);this.getTile(o[0],o[1],o[2],1,this.getProjection()).forDataAtCoordinate(t,i,r)}else!0===r?setTimeout((function(){i(null)}),0):i(null)},n.prototype.handleTileJSONError=function(){this.setState(Dn)},n.prototype.handleTileJSONResponse=function(t){var n,i=ae("EPSG:4326"),r=this.getProjection();if(void 0!==t.bounds){var e=me(i,r);n=Pr(t.bounds,e)}var o=iS(r),u=t.minzoom||0,s=QO({extent:o,maxZoom:t.maxzoom||22,minZoom:u});this.tileGrid=s,this.kw=t.template;var a=t.grids;if(a){if(this.Ew=aS(a,s),void 0!==t.attribution){var f=void 0!==n?n:o;this.setAttributions((function(n){return Er(f,n.extent)?[t.attribution]:null}))}this.setState(Gn)}else this.setState(Dn)},n.prototype.getTile=function(t,n,i,r,e){var o=FO(t,n,i);if(this.tileCache.containsKey(o))return this.tileCache.get(o);var u=[t,n,i],s=this.getTileCoordForTileUrlFunction(u,e),a=this.Ew(s,r,e),f=new iF(u,void 0!==a?fu:vu,void 0!==a?a:"",this.tileGrid.getTileCoordExtent(u),this.Mw,this.Sw);return this.tileCache.set(o,f),f},n.prototype.useTile=function(t,n,i){var r=FO(t,n,i);this.tileCache.containsKey(r)&&this.tileCache.get(r)},n}(uS),eF="KVP",oF="REST",uF=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),sF=function(t){function n(n){var i=t.call(this,{extent:n.extent,origin:n.origin,origins:n.origins,resolutions:n.resolutions,tileSize:n.tileSize,tileSizes:n.tileSizes,sizes:n.sizes})||this;return i.Tw=n.matrixIds,i}return uF(n,t),n.prototype.getMatrixId=function(t){return this.Tw[t]},n.prototype.getMatrixIds=function(){return this.Tw},n}(HO),aF=sF;function fF(t,n,i){var r=[],e=[],o=[],u=[],s=[],a=void 0!==i?i:[],h=ae(t.SupportedCRS),c=h.getMetersPerUnit(),l="ne"==h.getAxisOrientation().substr(0,2);return t.TileMatrix.sort((function(t,n){return n.ScaleDenominator-t.ScaleDenominator})),t.TileMatrix.forEach((function(n){if(!(a.length>0)||f(a,(function(i){return n.Identifier==i.TileMatrix||-1===n.Identifier.indexOf(":")&&t.Identifier+":"+n.Identifier===i.TileMatrix}))){e.push(n.Identifier);var i=28e-5*n.ScaleDenominator/c,h=n.TileWidth,v=n.TileHeight;l?o.push([n.TopLeftCorner[1],n.TopLeftCorner[0]]):o.push(n.TopLeftCorner),r.push(i),u.push(h==v?h:[h,v]),s.push([n.MatrixWidth,n.MatrixHeight])}})),new sF({extent:n,origins:o,resolutions:r,matrixIds:e,tileSizes:u,sizes:s})}var hF=function(){var t=function(n,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(n,i)};return function(n,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=n}t(n,i),n.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),cF=function(t){function n(n){var i=this,r=void 0===n.imageSmoothing||n.imageSmoothing;void 0!==n.interpolate&&(r=n.interpolate);var e=void 0!==n.requestEncoding?n.requestEncoding:eF,o=n.tileGrid,u=n.urls;return void 0===u&&void 0!==n.url&&(u=cS(n.url)),(i=t.call(this,{attributions:n.attributions,attributionsCollapsible:n.attributionsCollapsible,cacheSize:n.cacheSize,crossOrigin:n.crossOrigin,interpolate:r,projection:n.projection,reprojectionErrorThreshold:n.reprojectionErrorThreshold,tileClass:n.tileClass,tileGrid:o,tileLoadFunction:n.tileLoadFunction,tilePixelRatio:n.tilePixelRatio,urls:u,wrapX:void 0!==n.wrapX&&n.wrapX,transition:n.transition,zDirection:n.zDirection})||this).Yu=void 0!==n.version?n.version:"1.0.0",i.Ah=void 0!==n.format?n.format:"image/jpeg",i.Aw=void 0!==n.dimensions?n.dimensions:{},i.lf=n.layer,i.Cw=n.matrixSet,i.je=n.style,i.Pw=e,i.setKey(i.Rw()),u&&u.length>0&&(i.tileUrlFunction=fS(u.map(i.createFromWMTSTemplate.bind(i)))),i}return hF(n,t),n.prototype.setUrls=function(t){this.urls=t;var n=t.join("\n");this.setTileUrlFunction(fS(t.map(this.createFromWMTSTemplate.bind(this))),n)},n.prototype.getDimensions=function(){return this.Aw},n.prototype.getFormat=function(){return this.Ah},n.prototype.getLayer=function(){return this.lf},n.prototype.getMatrixSet=function(){return this.Cw},n.prototype.getRequestEncoding=function(){return this.Pw},n.prototype.getStyle=function(){return this.je},n.prototype.getVersion=function(){return this.Yu},n.prototype.Rw=function(){var t=0,n=[];for(var i in this.Aw)n[t++]=i+"-"+this.Aw[i];return n.join("/")},n.prototype.updateDimensions=function(t){W(this.Aw,t),this.setKey(this.Rw())},n.prototype.createFromWMTSTemplate=function(t){var n=this.Pw,i={layer:this.lf,style:this.je,tilematrixset:this.Cw};n==eF&&W(i,{Service:"WMTS",Request:"GetTile",Version:this.Yu,Format:this.Ah}),t=n==eF?$N(t,i):t.replace(/\{(\w+?)\}/g,(function(t,n){return n.toLowerCase()in i?i[n.toLowerCase()]:t}));var r=this.tileGrid,e=this.Aw;return function(i,o,u){if(i){var s={TileMatrix:r.getMatrixId(i[0]),TileCol:i[1],TileRow:i[2]};W(s,e);var a=t;return a=n==eF?$N(a,s):a.replace(/\{(\w+?)\}/g,(function(t,n){return s[n]}))}}},n}(_S);var lF=function(){function t(t){this.Iw,this.Nw,this.zw,this.Fw=void 0===t||t,this.Lw=0}return t.prototype.insertItem=function(t){var n={prev:void 0,next:void 0,data:t},i=this.zw;if(i){var r=i.next;n.prev=i,n.next=r,i.next=n,r&&(r.prev=n),i===this.Nw&&(this.Nw=n)}else this.Iw=n,this.Nw=n,this.Fw&&(n.next=n,n.prev=n);this.zw=n,this.Lw++},t.prototype.removeItem=function(){var t=this.zw;if(t){var n=t.next,i=t.prev;n&&(n.prev=i),i&&(i.next=n),this.zw=n||i,this.Iw===this.Nw?(this.zw=void 0,this.Iw=void 0,this.Nw=void 0):this.Iw===t?this.Iw=this.zw:this.Nw===t&&(this.Nw=i?this.zw.prev:this.zw),this.Lw--}},t.prototype.firstItem=function(){if(this.zw=this.Iw,this.zw)return this.zw.data},t.prototype.lastItem=function(){if(this.zw=this.Nw,this.zw)return this.zw.data},t.prototype.nextItem=function(){if(this.zw&&this.zw.next)return this.zw=this.zw.next,this.zw.data},t.prototype.getNextItem=function(){if(this.zw&&this.zw.next)return this.zw.next.data},t.prototype.prevItem=function(){if(this.zw&&this.zw.prev)return this.zw=this.zw.prev,this.zw.data},t.prototype.getPrevItem=function(){if(this.zw&&this.zw.prev)return this.zw.prev.data},t.prototype.getCurrItem=function(){if(this.zw)return this.zw.data},t.prototype.setFirstItem=function(){this.Fw&&this.zw&&(this.Iw=this.zw,this.Nw=this.zw.prev)},t.prototype.concat=function(t){if(t.zw){if(this.zw){var n=this.zw.next;this.zw.next=t.Iw,t.Iw.prev=this.zw,n.prev=t.Nw,t.Nw.next=n,this.Lw+=t.Lw}else this.zw=t.zw,this.Iw=t.Iw,this.Nw=t.Nw,this.Lw=t.Lw;t.zw=void 0,t.Iw=void 0,t.Nw=void 0,t.Lw=0}},t.prototype.getLength=function(){return this.Lw},t}(),vF={};vF.AssertionError=b,vF.Collection=Et,vF.Collection.CollectionEvent=jt,vF.DataTile=Da,vF.Disposable=D,vF.Feature=ef,vF.Feature.createStyleFunction=rf,vF.Geolocation=kb,vF.Image=yv,vF.Image.listenImage=dv,vF.ImageBase=vv,vF.ImageCanvas=Lb,vF.ImageTile=Db,vF.Kinetic=H_,vF.Map=RA,vF.MapBrowserEvent=ru,vF.MapBrowserEventHandler=uu,vF.MapEvent=nu,vF.Object=xt,vF.Object.ObjectEvent=gt,vF.Observable=wt,vF.Observable.unByKey=mt,vF.Overlay=Ho,vF.PluggableMap=ha,vF.Tile=La,vF.TileCache=XO,vF.TileQueue=du,vF.TileQueue.getTilePriority=yu,vF.TileRange=xO,vF.TileRange.createOrUpdate=gO,vF.VectorRenderTile=yS,vF.VectorTile=IO,vF.View=ia,vF.View.createCenterConstraint=Js,vF.View.createResolutionConstraint=$s,vF.View.createRotationConstraint=Qs,vF.View.isNoopAnimation=ta,vF.array={},vF.array.binarySearch=r,vF.array.equals=h,vF.array.extend=a,vF.array.find=f,vF.array.findIndex=c,vF.array.includes=o,vF.array.isSorted=l,vF.array.linearFindNearest=u,vF.array.numberSafeCompareFunction=e,vF.array.remove=function(t,n){var i=t.indexOf(n),r=i>-1;return r&&t.splice(i,1),r},vF.array.reverseSubArray=s,vF.array.stableSort=function(t,n){var i,r=t.length,e=Array(t.length);for(i=0;i<r;i++)e[i]={index:i,value:t[i]};for(e.sort((function(t,i){return n(t.value,i.value)||t.index-i.index})),i=0;i<t.length;i++)t[i]=e[i].value},vF.asserts={},vF.asserts.assert=g,vF.centerconstraint={},vF.centerconstraint.createExtent=N,vF.centerconstraint.none=z,vF.color={},vF.color.asArray=Rt,vF.color.asString=At,vF.color.fromString=Pt,vF.color.isStringColor=zt,vF.color.normalize=It,vF.color.toString=Nt,vF.colorlike={},vF.colorlike.asColorLike=Ft,vF.control={},vF.control.Attribution=Vn,vF.control.Control=an,vF.control.FullScreen=ri,vF.control.MousePosition=ze,vF.control.OverviewMap=da,vF.control.Rotate=ma,vF.control.ScaleLine=Ea,vF.control.Zoom=Ta,vF.control.ZoomSlider=Ra,vF.control.ZoomToExtent=Na,vF.control.defaults=za,vF.coordinate={},vF.coordinate.add=zr,vF.coordinate.closestOnCircle=Fr,vF.coordinate.closestOnSegment=Lr,vF.coordinate.createStringXY=function(t){return function(n){return Yr(n,t)}},vF.coordinate.degreesToStringHDMS=Gr,vF.coordinate.distance=Vr,vF.coordinate.equals=Ur,vF.coordinate.format=Dr,vF.coordinate.getWorldsAway=Hr,vF.coordinate.rotate=qr,vF.coordinate.scale=Br,vF.coordinate.squaredDistance=Xr,vF.coordinate.squaredDistanceToSegment=Wr,vF.coordinate.toStringHDMS=function(t,n){return t?Gr("NS",t[1],n)+" "+Gr("EW",t[0],n):""},vF.coordinate.toStringXY=Yr,vF.coordinate.wrapX=Zr,vF.css={},vF.css.CLASS_COLLAPSED=pn,vF.css.CLASS_CONTROL=vn,vF.css.CLASS_HIDDEN=fn,vF.css.CLASS_SELECTABLE=hn,vF.css.CLASS_UNSELECTABLE=cn,vF.css.CLASS_UNSUPPORTED=ln,vF.css.cssOpacity=wn,vF.css.getFontParameters=mn,vF.dom={},vF.dom.createCanvasContext2D=Qt,vF.dom.outerHeight=nn,vF.dom.outerWidth=tn,vF.dom.removeChildren=on,vF.dom.removeNode=en,vF.dom.replaceChildren=un,vF.dom.replaceNode=rn,vF.easing={},vF.easing.easeIn=Au,vF.easing.easeOut=Cu,vF.easing.inAndOut=Pu,vF.easing.linear=Ru,vF.easing.upAndDown=function(t){return t<.5?Pu(2*t):1-Pu(2*(t-.5))},vF.events={},vF.events.Event=L,vF.events.Event.preventDefault=function(t){t.preventDefault()},vF.events.Event.stopPropagation=F,vF.events.Target=J,vF.events.condition={},vF.events.condition.all=Ua,vF.events.condition.altKeyOnly=qa,vF.events.condition.altShiftKeysOnly=Ba,vF.events.condition.always=Wa,vF.events.condition.click=function(t){return t.type==eu.CLICK},vF.events.condition.doubleClick=function(t){return t.type==eu.DBLCLICK},vF.events.condition.focus=Xa,vF.events.condition.focusWithTabindex=Va,vF.events.condition.mouseActionButton=Ya,vF.events.condition.mouseOnly=Qa,vF.events.condition.never=Za,vF.events.condition.noModifierKeys=Ka,vF.events.condition.penOnly=function(t){var n=t.originalEvent;return g(void 0!==n,56),"pen"===n.pointerType},vF.events.condition.platformModifierKeyOnly=function(t){var n=t.originalEvent;return!n.altKey&&(Zt?n.metaKey:n.ctrlKey)&&!n.shiftKey},vF.events.condition.pointerMove=function(t){return"pointermove"==t.type},vF.events.condition.primaryAction=tf,vF.events.condition.shiftKeyOnly=Ja,vF.events.condition.singleClick=Ha,vF.events.condition.targetNotEditable=$a,vF.events.condition.touchOnly=function(t){var n=t.originalEvent;return g(void 0!==n,56),"touch"===n.pointerType},vF.events.listen=lt,vF.events.listenOnce=vt,vF.events.unlistenByKey=pt,vF.extent={},vF.extent.applyTransform=Pr,vF.extent.approximatelyEquals=ar,vF.extent.boundingExtent=Zi,vF.extent.buffer=Hi,vF.extent.clone=Ki,vF.extent.closestSquaredDistanceXY=Ji,vF.extent.containsCoordinate=$i,vF.extent.containsExtent=Qi,vF.extent.containsXY=tr,vF.extent.coordinateRelationship=nr,vF.extent.createEmpty=ir,vF.extent.createOrUpdate=rr,vF.extent.createOrUpdateEmpty=er,vF.extent.createOrUpdateFromCoordinate=or,vF.extent.createOrUpdateFromCoordinates=function(t,n){return cr(er(n),t)},vF.extent.createOrUpdateFromFlatCoordinates=ur,vF.extent.createOrUpdateFromRings=function(t,n){return vr(er(n),t)},vF.extent.equals=sr,vF.extent.extend=fr,vF.extent.extendCoordinate=hr,vF.extent.extendCoordinates=cr,vF.extent.extendFlatCoordinates=lr,vF.extent.extendRings=vr,vF.extent.extendXY=pr,vF.extent.forEachCorner=dr,vF.extent.getArea=yr,vF.extent.getBottomLeft=mr,vF.extent.getBottomRight=wr,vF.extent.getCenter=br,vF.extent.getCorner=gr,vF.extent.getEnlargedArea=function(t,n){var i=Math.min(t[0],n[0]),r=Math.min(t[1],n[1]);return(Math.max(t[2],n[2])-i)*(Math.max(t[3],n[3])-r)},vF.extent.getForViewAndSize=xr,vF.extent.getHeight=_r,vF.extent.getIntersection=Mr,vF.extent.getIntersectionArea=function(t,n){return yr(Mr(t,n))},vF.extent.getMargin=function(t){return jr(t)+_r(t)},vF.extent.getSize=function(t){return[t[2]-t[0],t[3]-t[1]]},vF.extent.getTopLeft=Or,vF.extent.getTopRight=Sr,vF.extent.getWidth=jr,vF.extent.intersects=Er,vF.extent.intersectsSegment=Cr,vF.extent.isEmpty=kr,vF.extent.returnOrUpdate=Tr,vF.extent.scaleFromCenter=Ar,vF.extent.wrapX=Rr,vF.featureloader={},vF.featureloader.loadFeaturesXhr=hf,vF.featureloader.setWithCredentials=function(t){ff=t},vF.featureloader.xhr=cf,vF.format={},vF.format.EsriJSON=Lf,vF.format.Feature=lf,vF.format.Feature.transformExtentWithOptions=pf,vF.format.Feature.transformGeometryWithOptions=vf,vF.format.GML=Vc,vF.format.GML2=Gc,vF.format.GML3=Bc,vF.format.GML32=Zc,vF.format.GMLBase=xc,vF.format.GMLBase.GMLNS=wc,vF.format.GPX=Al,vF.format.GeoJSON=qh,vF.format.IGC=ql,vF.format.IIIFInfo=$l,vF.format.JSONFeature=mf,vF.format.KML=qd,vF.format.KML.getDefaultFillStyle=function(){return rp},vF.format.KML.getDefaultImageStyle=function(){return op},vF.format.KML.getDefaultStrokeStyle=function(){return sp},vF.format.KML.getDefaultStyle=function(){return fp},vF.format.KML.getDefaultStyleArray=function(){return cp},vF.format.KML.getDefaultTextStyle=function(){return ap},vF.format.KML.readFlatCoordinates=mp,vF.format.MVT=Qd,vF.format.OSMXML=sy,vF.format.OWS=Ey,vF.format.Polyline=Gy,vF.format.Polyline.decodeDeltas=Cy,vF.format.Polyline.decodeFloats=Ry,vF.format.Polyline.decodeSignedIntegers=Ny,vF.format.Polyline.decodeUnsignedIntegers=Fy,vF.format.Polyline.encodeDeltas=Ay,vF.format.Polyline.encodeFloats=Py,vF.format.Polyline.encodeSignedIntegers=Iy,vF.format.Polyline.encodeUnsignedInteger=Ly,vF.format.Polyline.encodeUnsignedIntegers=zy,vF.format.TextFeature=Rl,vF.format.TopoJSON=Zy,vF.format.WFS=Um,vF.format.WFS.writeFilter=function(t,n){var i=n||"1.1.0",r=Xh(Dm(i),"Filter"),e={node:r};return W(e,{version:i,filter:t}),Om(r,t,[e]),r},vF.format.WKB=iw,vF.format.WKT=Mw,vF.format.WMSCapabilities=Hw,vF.format.WMSGetFeatureInfo=Jw,vF.format.WMTSCapabilities=db,vF.format.XML=ay,vF.format.XMLFeature=yc,vF.format.filter={},vF.format.filter.And=Bf,vF.format.filter.Bbox=Vf,vF.format.filter.Comparison=Yf,vF.format.filter.ComparisonBinary=Hf,vF.format.filter.Contains=Qf,vF.format.filter.DWithin=oh,vF.format.filter.Disjoint=nh,vF.format.filter.During=rh,vF.format.filter.EqualTo=sh,vF.format.filter.Filter=Gf,vF.format.filter.GreaterThan=fh,vF.format.filter.GreaterThanOrEqualTo=ch,vF.format.filter.Intersects=vh,vF.format.filter.IsBetween=dh,vF.format.filter.IsLike=mh,vF.format.filter.IsNull=bh,vF.format.filter.LessThan=xh,vF.format.filter.LessThanOrEqualTo=Mh,vF.format.filter.LogicalNary=Uf,vF.format.filter.Not=Sh,vF.format.filter.NotEqualTo=Eh,vF.format.filter.Or=Th,vF.format.filter.ResourceId=Ch,vF.format.filter.Spatial=Jf,vF.format.filter.Within=Rh,vF.format.filter.and=Ih,vF.format.filter.bbox=Nh,vF.format.filter.between=function(t,n,i){return new dh(t,n,i)},vF.format.filter.contains=function(t,n,i){return new Qf(t,n,i)},vF.format.filter.disjoint=function(t,n,i){return new nh(t,n,i)},vF.format.filter.during=function(t,n,i){return new rh(t,n,i)},vF.format.filter.dwithin=function(t,n,i,r,e){return new oh(t,n,i,r,e)},vF.format.filter.equalTo=function(t,n,i){return new sh(t,n,i)},vF.format.filter.greaterThan=function(t,n){return new fh(t,n)},vF.format.filter.greaterThanOrEqualTo=function(t,n){return new ch(t,n)},vF.format.filter.intersects=function(t,n,i){return new vh(t,n,i)},vF.format.filter.isNull=function(t){return new bh(t)},vF.format.filter.lessThan=function(t,n){return new xh(t,n)},vF.format.filter.lessThanOrEqualTo=function(t,n){return new Mh(t,n)},vF.format.filter.like=function(t,n,i,r,e,o){return new mh(t,n,i,r,e,o)},vF.format.filter.not=function(t){return new Sh(t)},vF.format.filter.notEqualTo=function(t,n,i){return new Eh(t,n,i)},vF.format.filter.or=function(t){var n=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(Th,n))},vF.format.filter.resourceId=function(t){return new Ch(t)},vF.format.filter.within=function(t,n,i){return new Rh(t,n,i)},vF.format.xlink={},vF.format.xlink.readHref=fy,vF.format.xsd={},vF.format.xsd.readBoolean=_c,vF.format.xsd.readBooleanString=Mc,vF.format.xsd.readDateTime=Oc,vF.format.xsd.readDecimal=Sc,vF.format.xsd.readDecimalString=jc,vF.format.xsd.readNonNegativeIntegerString=kc,vF.format.xsd.readPositiveInteger=Ec,vF.format.xsd.readString=Tc,vF.format.xsd.writeBooleanTextNode=Ac,vF.format.xsd.writeCDATASection=Cc,vF.format.xsd.writeDateTimeTextNode=Pc,vF.format.xsd.writeDecimalTextNode=Rc,vF.format.xsd.writeNonNegativeIntegerTextNode=Ic,vF.format.xsd.writeStringTextNode=Nc,vF.functions={},vF.functions.FALSE=q,vF.functions.TRUE=U,vF.functions.VOID=B,vF.functions.memoizeOne=X,vF.functions.toPromise=V,vF.geom={},vF.geom.Circle=Cb,vF.geom.Geometry=Xu,vF.geom.GeometryCollection=Lh,vF.geom.LineString=Mf,vF.geom.LinearRing=gs,vF.geom.MultiLineString=Sf,vF.geom.MultiPoint=Ef,vF.geom.MultiPolygon=Af,vF.geom.Point=_s,vF.geom.Polygon=Xs,vF.geom.Polygon.circular=Vs,vF.geom.Polygon.fromCircle=Ys,vF.geom.Polygon.fromExtent=Ws,vF.geom.Polygon.makeRegular=Zs,vF.geom.SimpleGeometry=Zu,vF.geom.SimpleGeometry.getStrideForLayout=Wu,vF.geom.SimpleGeometry.transformGeom2D=Yu,vF.geom.flat={},vF.geom.flat.area={},vF.geom.flat.area.linearRing=ys,vF.geom.flat.area.linearRings=ms,vF.geom.flat.area.linearRingss=ws,vF.geom.flat.center={},vF.geom.flat.center.linearRingss=kf,vF.geom.flat.closest={},vF.geom.flat.closest.arrayMaxSquaredDelta=Ju,vF.geom.flat.closest.assignClosestArrayPoint=ts,vF.geom.flat.closest.assignClosestMultiArrayPoint=ns,vF.geom.flat.closest.assignClosestPoint=Qu,vF.geom.flat.closest.maxSquaredDelta=Ku,vF.geom.flat.closest.multiArrayMaxSquaredDelta=$u,vF.geom.flat.contains={},vF.geom.flat.contains.linearRingContainsExtent=Ms,vF.geom.flat.contains.linearRingContainsXY=Os,vF.geom.flat.contains.linearRingsContainsXY=Ss,vF.geom.flat.contains.linearRingssContainsXY=js,vF.geom.flat.deflate={},vF.geom.flat.deflate.deflateCoordinate=is,vF.geom.flat.deflate.deflateCoordinates=rs,vF.geom.flat.deflate.deflateCoordinatesArray=es,vF.geom.flat.deflate.deflateMultiCoordinatesArray=os,vF.geom.flat.flip={},vF.geom.flat.flip.flipXY=ky,vF.geom.flat.geodesic={},vF.geom.flat.geodesic.greatCircleArc=function(t,n,i,r,e,o){var u=ae("EPSG:4326"),s=Math.cos(k(n)),a=Math.sin(k(n)),f=Math.cos(k(r)),h=Math.sin(k(r)),c=Math.cos(k(i-t)),l=Math.sin(k(i-t)),v=a*h+s*f*c;return Pb((function(n){if(1<=v)return[i,r];var e=n*Math.acos(v),o=Math.cos(e),u=Math.sin(e),p=l*f,d=s*h-a*f*c,y=Math.atan2(p,d),m=Math.asin(a*o+s*u*Math.cos(y));return[E(k(t)+Math.atan2(Math.sin(y)*u*s,o-a*Math.sin(m))),E(m)]}),we(u,e),o)},vF.geom.flat.geodesic.meridian=Rb,vF.geom.flat.geodesic.parallel=Ib,vF.geom.flat.inflate={},vF.geom.flat.inflate.inflateCoordinates=vs,vF.geom.flat.inflate.inflateCoordinatesArray=ps,vF.geom.flat.inflate.inflateMultiCoordinatesArray=ds,vF.geom.flat.interiorpoint={},vF.geom.flat.interiorpoint.getInteriorPointOfArray=Es,vF.geom.flat.interiorpoint.getInteriorPointsOfMultiArray=ks,vF.geom.flat.interpolate={},vF.geom.flat.interpolate.interpolatePoint=wf,vF.geom.flat.interpolate.lineStringCoordinateAtM=bf,vF.geom.flat.interpolate.lineStringsCoordinateAtM=gf,vF.geom.flat.intersectsextent={},vF.geom.flat.intersectsextent.intersectsLineString=As,vF.geom.flat.intersectsextent.intersectsLineStringArray=Cs,vF.geom.flat.intersectsextent.intersectsLinearRing=Ps,vF.geom.flat.intersectsextent.intersectsLinearRingArray=Rs,vF.geom.flat.intersectsextent.intersectsLinearRingMultiArray=Is,vF.geom.flat.length={},vF.geom.flat.length.lineStringLength=xf,vF.geom.flat.length.linearRingLength=function(t,n,i,r){var e=xf(t,n,i,r),o=t[i-r]-t[n],u=t[i-r+1]-t[n+1];return e+=Math.sqrt(o*o+u*u)},vF.geom.flat.orient={},vF.geom.flat.orient.inflateEnds=Us,vF.geom.flat.orient.linearRingIsClockwise=zs,vF.geom.flat.orient.linearRingsAreOriented=Fs,vF.geom.flat.orient.linearRingssAreOriented=Ls,vF.geom.flat.orient.orientLinearRings=Gs,vF.geom.flat.orient.orientLinearRingsArray=Ds,vF.geom.flat.reverse={},vF.geom.flat.reverse.coordinates=Ns,vF.geom.flat.segments={},vF.geom.flat.segments.forEach=Ts,vF.geom.flat.simplify={},vF.geom.flat.simplify.douglasPeucker=us,vF.geom.flat.simplify.douglasPeuckerArray=ss,vF.geom.flat.simplify.douglasPeuckerMultiArray=function(t,n,i,r,e,o,u,s){for(var a=0,f=i.length;a<f;++a){var h=i[a],c=[];u=ss(t,n,h,r,e,o,u,c),s.push(c),n=h[h.length-1]}return u},vF.geom.flat.simplify.quantize=hs,vF.geom.flat.simplify.quantizeArray=cs,vF.geom.flat.simplify.quantizeMultiArray=ls,vF.geom.flat.simplify.radialDistance=as,vF.geom.flat.simplify.simplifyLineString=function(t,n,i,r,e,o,u){var s=void 0!==u?u:[];return o||(i=as(t,n,i,r,e,s,0),t=s,n=0,r=2),s.length=us(t,n,i,r,e,s,0),s},vF.geom.flat.simplify.snap=fs,vF.geom.flat.straightchunk={},vF.geom.flat.straightchunk.matchingChunk=Nb,vF.geom.flat.textpath={},vF.geom.flat.textpath.drawTextOnPath=zb,vF.geom.flat.topology={},vF.geom.flat.topology.lineStringIsClosed=function(t,n,i,r){var e=i-r;return t[n]===t[e]&&t[n+1]===t[e+1]&&(i-n)/r>3&&!!ys(t,n,i,r)},vF.geom.flat.transform={},vF.geom.flat.transform.rotate=Gu,vF.geom.flat.transform.scale=Du,vF.geom.flat.transform.transform2D=Lu,vF.geom.flat.transform.translate=Uu,vF.has={},vF.has.DEVICE_PIXEL_RATIO=Ht,vF.has.FIREFOX=Xt,vF.has.IMAGE_DECODE=Jt,vF.has.MAC=Zt,vF.has.PASSIVE_EVENT_LISTENERS=$t,vF.has.SAFARI=Vt,vF.has.SAFARI_BUG_237906=Wt,vF.has.WEBKIT=Yt,vF.has.WORKER_OFFSCREEN_CANVAS=Kt,vF.interaction={},vF.interaction.DoubleClickZoom=Yb,vF.interaction.DragAndDrop=Jb,vF.interaction.DragAndDrop.DragAndDropEvent=Kb,vF.interaction.DragBox=fg,vF.interaction.DragBox.DragBoxEvent=ag,vF.interaction.DragPan=cg,vF.interaction.DragRotate=vg,vF.interaction.DragRotateAndZoom=dg,vF.interaction.DragZoom=mg,vF.interaction.Draw=Qx,vF.interaction.Draw.DrawEvent=$x,vF.interaction.Draw.createBox=function(){return function(t,n,i){var r=Zi([t[0],t[t.length-1]].map((function(t){return Se(t,i)}))),e=[[mr(r),wr(r),Sr(r),Or(r),mr(r)]],o=n;o?o.setCoordinates(e):o=new Xs(e);var u=Me();return u&&o.transform(i,u),o}},vF.interaction.Draw.createRegularPolygon=function(t,n){return function(i,r,e){var o=Se(i[0],e),u=Se(i[i.length-1],e),s=Math.sqrt(Xr(o,u)),a=r||Ys(new Cb(o),t),f=n;if(!n&&0!==n){var h=u[0]-o[0],c=u[1]-o[1];f=Math.atan2(c,h)}Zs(a,o,s,f);var l=Me();return l&&a.transform(e,l),a}},vF.interaction.Extent=u_,vF.interaction.Extent.ExtentEvent=i_,vF.interaction.Interaction=Vb,vF.interaction.Interaction.pan=Bb,vF.interaction.Interaction.zoomByDelta=Xb,vF.interaction.KeyboardPan=l_,vF.interaction.KeyboardZoom=p_,vF.interaction.Modify=S_,vF.interaction.Modify.ModifyEvent=x_,vF.interaction.MouseWheelZoom=T_,vF.interaction.PinchRotate=C_,vF.interaction.PinchZoom=R_,vF.interaction.Pointer=tg,vF.interaction.Pointer.centroid=Qb,vF.interaction.Select=L_,vF.interaction.Select.SelectEvent=z_,vF.interaction.Snap=q_,vF.interaction.Translate=Z_,vF.interaction.Translate.TranslateEvent=Y_,vF.interaction.defaults=K_,vF.layer={},vF.layer.Base=Cn,vF.layer.BaseImage=$_,vF.layer.BaseTile=iM,vF.layer.BaseVector=xg,vF.layer.Graticule=aM,vF.layer.Group=Qo,vF.layer.Group.GroupEvent=Jo,vF.layer.Heatmap=rO,vF.layer.Image=hO,vF.layer.Layer=Bn,vF.layer.Layer.inView=qn,vF.layer.MapboxVector=ST,vF.layer.Tile=ET,vF.layer.Vector=kx,vF.layer.VectorImage=CT,vF.layer.VectorTile=PO,vF.layer.WebGLPoints=EA,vF.layer.WebGLTile=CA,vF.loadingstrategy={},vF.loadingstrategy.all=Dx,vF.loadingstrategy.bbox=function(t,n){return[t]},vF.loadingstrategy.tile=function(t){return function(n,i,r){var e=t.getZForResolution(Te(i,r)),o=t.getTileRangeForExtentAndZ(Ee(n,r),e),u=[],s=[e,0,0];for(s[1]=o.minX;s[1]<=o.maxX;++s[1])for(s[2]=o.minY;s[2]<=o.maxY;++s[2])u.push(je(t.getTileCoordExtent(s),r));return u}},vF.math={},vF.math.ceil=I,vF.math.clamp=x,vF.math.cosh=_,vF.math.floor=R,vF.math.lerp=A,vF.math.log2=M,vF.math.modulo=T,vF.math.round=P,vF.math.solveLinearSystem=j,vF.math.squaredDistance=S,vF.math.squaredSegmentDistance=O,vF.math.toDegrees=E,vF.math.toFixed=C,vF.math.toRadians=k,vF.net={},vF.net.ClientError=ES,vF.net.ResponseError=jS,vF.net.getJSON=kS,vF.net.jsonp=OS,vF.net.overrideXHR=function(t){"undefined"!=typeof XMLHttpRequest&&(SS=XMLHttpRequest),global.XMLHttpRequest=t},vF.net.resolveUrl=TS,vF.net.restoreXHR=function(){global.XMLHttpRequest=SS},vF.obj={},vF.obj.assign=W,vF.obj.clear=Y,vF.obj.getValues=Z,vF.obj.isEmpty=H,vF.proj={},vF.proj.Projection=vi,vF.proj.Units={},vF.proj.Units.METERS_PER_UNIT=ci,vF.proj.Units.fromCode=hi,vF.proj.addCommon=Ce,vF.proj.addCoordinateTransforms=pe,vF.proj.addEquivalentProjections=he,vF.proj.addEquivalentTransforms=ce,vF.proj.addProjection=ue,vF.proj.addProjections=se,vF.proj.clearAllProjections=function(){Ci(),Ni()},vF.proj.clearUserProjection=function(){xe=null},vF.proj.cloneTransform=ee,vF.proj.createProjection=le,vF.proj.createSafeCoordinateTransform=Ae,vF.proj.createTransformFromCoordinateTransform=ve,vF.proj.disableCoordinateWarning=re,vF.proj.epsg3857={},vF.proj.epsg3857.EXTENT=mi,vF.proj.epsg3857.HALF_SIZE=yi,vF.proj.epsg3857.MAX_SAFE_Y=bi,vF.proj.epsg3857.PROJECTIONS=xi,vF.proj.epsg3857.RADIUS=di,vF.proj.epsg3857.WORLD_EXTENT=wi,vF.proj.epsg3857.fromEPSG4326=_i,vF.proj.epsg3857.toEPSG4326=Mi,vF.proj.epsg4326={},vF.proj.epsg4326.EXTENT=ji,vF.proj.epsg4326.METERS_PER_UNIT=Ei,vF.proj.epsg4326.PROJECTIONS=Ti,vF.proj.epsg4326.RADIUS=Si,vF.proj.equivalent=ye,vF.proj.fromLonLat=de,vF.proj.fromUserCoordinate=Se,vF.proj.fromUserExtent=Ee,vF.proj.fromUserResolution=Te,vF.proj.get=ae,vF.proj.getPointResolution=fe,vF.proj.getTransform=we,vF.proj.getTransformFromProjections=me,vF.proj.getUserProjection=Me,vF.proj.identityTransform=oe,vF.proj.proj4={},vF.proj.proj4.register=function(t){var n,i,r=Object.keys(t.defs),e=r.length;for(n=0;n<e;++n){var o=r[n];if(!ae(o)){var u=t.defs(o),s=u.units;s||"longlat"!==u.projName||(s=li.DEGREES),ue(new vi({code:o,axisOrientation:u.axis,metersPerUnit:u.to_meter,units:s}))}}for(n=0;n<e;++n){var a=r[n],f=ae(a);for(i=0;i<e;++i){var h=r[i],c=ae(h);if(!Fi(a,h))if(t.defs[a]===t.defs[h])he([f,c]);else{var l=t(a,h);pe(f,c,Ae(f,c,l.forward),Ae(c,f,l.inverse))}}}},vF.proj.projections={},vF.proj.projections.add=Ri,vF.proj.projections.clear=Ci,vF.proj.projections.get=Pi,vF.proj.setUserProjection=_e,vF.proj.toLonLat=function(t,n){var i=be(t,void 0!==n?n:"EPSG:3857","EPSG:4326"),r=i[0];return(r<-180||r>180)&&(i[0]=T(r+180,360)-180),i},vF.proj.toUserCoordinate=Oe,vF.proj.toUserExtent=je,vF.proj.toUserResolution=ke,vF.proj.transform=be,vF.proj.transformExtent=ge,vF.proj.transformWithProjections=function(t,n,i){return me(n,i)(t)},vF.proj.transforms={},vF.proj.transforms.add=zi,vF.proj.transforms.clear=Ni,vF.proj.transforms.get=Fi,vF.proj.transforms.remove=function(t,n){var i=t.getCode(),r=n.getCode(),e=Ii[i][r];return delete Ii[i][r],H(Ii[i])&&delete Ii[i],e},vF.proj.useGeographic=function(){_e("EPSG:4326")},vF.render={},vF.render.Box=ig,vF.render.Event=uo,vF.render.Feature=Yd,vF.render.Feature.toFeature=function(t,n){var i=t.getId(),r=Wd(t),e=t.getProperties(),o=new ef;return void 0!==n&&o.setGeometryName(n),o.setGeometry(r),void 0!==i&&o.setId(i),o.setProperties(e,!0),o},vF.render.Feature.toGeometry=Wd,vF.render.VectorContext=kg,vF.render.canvas={},vF.render.canvas.Builder=Ag,vF.render.canvas.BuilderGroup=Ug,vF.render.canvas.Executor=ax,vF.render.canvas.ExecutorGroup=vx,vF.render.canvas.ExecutorGroup.getPixelIndexArray=lx,vF.render.canvas.ImageBuilder=Pg,vF.render.canvas.Immediate=dx,vF.render.canvas.Instruction={},vF.render.canvas.Instruction.beginPathInstruction=Sg,vF.render.canvas.Instruction.closePathInstruction=jg,vF.render.canvas.Instruction.fillInstruction=Mg,vF.render.canvas.Instruction.strokeInstruction=Og,vF.render.canvas.LineStringBuilder=Ig,vF.render.canvas.PolygonBuilder=zg,vF.render.canvas.TextBuilder=Gg,vF.render.canvas.checkedFonts=wo,vF.render.canvas.defaultFillStyle=ao,vF.render.canvas.defaultFont=so,vF.render.canvas.defaultLineCap=fo,vF.render.canvas.defaultLineDash=ho,vF.render.canvas.defaultLineDashOffset=0,vF.render.canvas.defaultLineJoin=co,vF.render.canvas.defaultLineWidth=1,vF.render.canvas.defaultMiterLimit=lo,vF.render.canvas.defaultPadding=mo,vF.render.canvas.defaultStrokeStyle=vo,vF.render.canvas.defaultTextAlign=po,vF.render.canvas.defaultTextBaseline=yo,vF.render.canvas.drawImageOrLabel=Ao,vF.render.canvas.getTextDimensions=To,vF.render.canvas.hitdetect={},vF.render.canvas.hitdetect.HIT_DETECT_RESOLUTION=yx,vF.render.canvas.hitdetect.createHitDetectionImageData=mx,vF.render.canvas.hitdetect.hitDetect=wx,vF.render.canvas.labelCache=bo,vF.render.canvas.measureAndCacheTextWidth=ko,vF.render.canvas.measureTextHeight=So,vF.render.canvas.measureTextWidth=Eo,vF.render.canvas.registerFont=Oo,vF.render.canvas.rotateAtOffset=function(t,n,i,r){0!==n&&(t.translate(i,r),t.rotate(n),t.translate(-i,-r))},vF.render.canvas.textHeights=Mo,vF.render.getRenderPixel=function(t,n){return Be(t.inversePixelTransform,n.slice(0))},vF.render.getVectorContext=rM,vF.render.toContext=function(t,n){var i=t.canvas,r=n||{},e=r.pixelRatio||Ht,o=r.size;o&&(i.width=o[0]*e,i.height=o[1]*e,i.style.width=o[0]+"px",i.style.height=o[1]+"px");var u=[0,0,i.width,i.height],s=Ve([1,0,0,1,0,0],e,e);return new dx(t,e,u,s,0)},vF.renderer={},vF.renderer.Composite=Po,vF.renderer.Layer=Bg,vF.renderer.Map=eo,vF.renderer.canvas={},vF.renderer.canvas.ImageLayer=aO,vF.renderer.canvas.Layer=Wg,vF.renderer.canvas.TileLayer=MO,vF.renderer.canvas.VectorImageLayer=TT,vF.renderer.canvas.VectorLayer=jx,vF.renderer.canvas.VectorTileLayer=AO,vF.renderer.canvas.common={},vF.renderer.canvas.common.IMAGE_SMOOTHING_DISABLED=oO,vF.renderer.canvas.common.IMAGE_SMOOTHING_ENABLED=uO,vF.renderer.vector={},vF.renderer.vector.defaultOrder=gx,vF.renderer.vector.getSquaredTolerance=xx,vF.renderer.vector.getTolerance=_x,vF.renderer.vector.renderFeature=Mx,vF.renderer.webgl={},vF.renderer.webgl.Layer=WM,vF.renderer.webgl.Layer.colorDecodeId=VM,vF.renderer.webgl.Layer.colorEncodeId=XM,vF.renderer.webgl.Layer.getBlankImageData=function(){var t=document.createElement("canvas").getContext("2d").createImageData(1,1);return t.data[0]=255,t.data[1]=255,t.data[2]=255,t.data[3]=255,t},vF.renderer.webgl.Layer.writePointFeatureToBuffers=function(t,n,i,r,e,o){var u=3+e,s=t[n+0],a=t[n+1],f=UM;f.length=e;for(var h=0;h<f.length;h++)f[h]=t[n+2+h];var c=o?o.vertexPosition:0,l=o?o.indexPosition:0,v=c/u;return BM(i,c,s,a,0),f.length&&i.set(f,c+3),BM(i,c+=u,s,a,1),f.length&&i.set(f,c+3),BM(i,c+=u,s,a,2),f.length&&i.set(f,c+3),BM(i,c+=u,s,a,3),f.length&&i.set(f,c+3),c+=u,r[l++]=v,r[l++]=v+1,r[l++]=v+3,r[l++]=v+1,r[l++]=v+2,r[l++]=v+3,qM.vertexPosition=c,qM.indexPosition=l,qM},vF.renderer.webgl.PointsLayer=KM,vF.renderer.webgl.TileLayer=YT,vF.renderer.webgl.TileLayer.Attributes=DT,vF.renderer.webgl.TileLayer.Uniforms=GT,vF.reproj={},vF.reproj.Image=NA,vF.reproj.Tile=wO,vF.reproj.Triangulation=cO,vF.reproj.calculateSourceExtentResolution=dO,vF.reproj.calculateSourceResolution=pO,vF.reproj.common={},vF.reproj.common.ENABLE_RASTER_REPROJECTION=eO,vF.reproj.common.ERROR_THRESHOLD=.5,vF.reproj.render=yO,vF.resolutionconstraint={},vF.resolutionconstraint.createMinMaxResolution=Su,vF.resolutionconstraint.createSnapToPower=Ou,vF.resolutionconstraint.createSnapToResolutions=Mu,vF.rotationconstraint={},vF.rotationconstraint.createSnapToN=ku,vF.rotationconstraint.createSnapToZero=Tu,vF.rotationconstraint.disable=ju,vF.rotationconstraint.none=Eu,vF.size={},vF.size.buffer=ra,vF.size.hasArea=ea,vF.size.scale=oa,vF.size.toSize=ua,vF.source={},vF.source.BingMaps=LA,vF.source.BingMaps.quadKey=FA,vF.source.CartoDB=qA,vF.source.Cluster=XA,vF.source.DataTile=YA,vF.source.GeoTIFF=zN,vF.source.IIIF=XN,vF.source.Image=JN,vF.source.Image.ImageSourceEvent=HN,vF.source.Image.defaultImageLoadFunction=KN,vF.source.ImageArcGISRest=tz,vF.source.ImageCanvas=iz,vF.source.ImageMapGuide=ez,vF.source.ImageStatic=uz,vF.source.ImageWMS=vz,vF.source.OGCMapTile=_z,vF.source.OGCVectorTile=Oz,vF.source.OSM=Ez,vF.source.OSM.ATTRIBUTION=jz,vF.source.Raster=Bz,vF.source.Raster.Processor=Rz,vF.source.Raster.RasterSourceEvent=Lz,vF.source.Raster.newImageData=Az,vF.source.Source=Px,vF.source.Stamen=Zz,vF.source.Tile=uS,vF.source.Tile.TileSourceEvent=oS,vF.source.TileArcGISRest=Kz,vF.source.TileDebug=$z,vF.source.TileImage=_S,vF.source.TileJSON=CS,vF.source.TileWMS=tF,vF.source.UTFGrid=rF,vF.source.UTFGrid.CustomTile=iF,vF.source.UrlTile=vS,vF.source.Vector=Bx,vF.source.Vector.VectorSourceEvent=qx,vF.source.VectorTile=wS,vF.source.VectorTile.defaultLoadFunction=bS,vF.source.WMTS=cF,vF.source.WMTS.optionsFromCapabilities=function(t,n){var i=f(t.Contents.Layer,(function(t,i,r){return t.Identifier==n.layer}));if(null===i)return null;var r,e=t.Contents.TileMatrixSet;(r=i.TileMatrixSetLink.length>1?c(i.TileMatrixSetLink,"projection"in n?function(t,i,r){var o=f(e,(function(n){return n.Identifier==t.TileMatrixSet})).SupportedCRS,u=ae(o),s=ae(n.projection);return u&&s?ye(u,s):o==n.projection}:function(t,i,r){return t.TileMatrixSet==n.matrixSet}):0)<0&&(r=0);var u=i.TileMatrixSetLink[r].TileMatrixSet,s=i.TileMatrixSetLink[r].TileMatrixSetLimits,a=i.Format[0];"format"in n&&(a=n.format),(r=c(i.Style,(function(t,i,r){return"style"in n?t.Title==n.style:t.isDefault})))<0&&(r=0);var h=i.Style[r].Identifier,l={};"Dimension"in i&&i.Dimension.forEach((function(t,n,i){var r=t.Identifier,e=t.Default;void 0===e&&(e=t.Value[0]),l[r]=e}));var v,p=f(t.Contents.TileMatrixSet,(function(t,n,i){return t.Identifier==u})),d=p.SupportedCRS;if(d&&(v=ae(d)),"projection"in n){var y=ae(n.projection);y&&(v&&!ye(y,v)||(v=y))}var m=!1,w="ne"==v.getAxisOrientation().substr(0,2),b=p.TileMatrix[0],g={MinTileCol:0,MinTileRow:0,MaxTileCol:b.MatrixWidth-1,MaxTileRow:b.MatrixHeight-1};if(s){g=s[s.length-1];var x=f(p.TileMatrix,(function(t){return t.Identifier===g.TileMatrix||p.Identifier+":"+t.Identifier===g.TileMatrix}));x&&(b=x)}var _=28e-5*b.ScaleDenominator/v.getMetersPerUnit(),M=w?[b.TopLeftCorner[1],b.TopLeftCorner[0]]:b.TopLeftCorner,O=b.TileWidth*_,S=b.TileHeight*_,j=p.BoundingBox,E=[M[0]+O*g.MinTileCol,M[1]-S*(1+g.MaxTileRow),M[0]+O*(1+g.MaxTileCol),M[1]-S*g.MinTileRow];if(void 0!==j&&!Qi(j,E)){var k=i.WGS84BoundingBox,T=ae("EPSG:4326").getExtent();if(E=j,k)m=k[0]===T[0]&&k[2]===T[2];else{var A=ge(j,p.SupportedCRS,"EPSG:4326");m=A[0]-1e-10<=T[0]&&A[2]+1e-10>=T[2]}}var C=fF(p,E,s),P=[],R=n.requestEncoding;if(R=void 0!==R?R:"","OperationsMetadata"in t&&"GetTile"in t.OperationsMetadata)for(var I=t.OperationsMetadata.GetTile.DCP.HTTP.Get,N=0,z=I.length;N<z;++N)if(I[N].Constraint){var F=f(I[N].Constraint,(function(t){return"GetEncoding"==t.name})).AllowedValues.Value;if(""===R&&(R=F[0]),R!==eF)break;o(F,eF)&&P.push(I[N].href)}else I[N].href&&(R=eF,P.push(I[N].href));return 0===P.length&&(R=oF,i.ResourceURL.forEach((function(t){"tile"===t.resourceType&&(a=t.format,P.push(t.template))}))),{urls:P,layer:n.layer,matrixSet:u,format:a,projection:v,requestEncoding:R,tileGrid:C,style:h,dimensions:l,wrapX:m,crossOrigin:n.crossOrigin}},vF.source.XYZ=DA,vF.source.Zoomify=UN,vF.source.Zoomify.CustomTile=DN,vF.source.common={},vF.source.common.DEFAULT_WMS_VERSION=VA,vF.source.ogcTileUtil={},vF.source.ogcTileUtil.getMapTileUrlTemplate=yz,vF.source.ogcTileUtil.getTileSetInfo=bz,vF.source.ogcTileUtil.getVectorTileUrlTemplate=mz,vF.source.sourcesFromTileGrid=function(t,n){var i=new NO(32),r=t.getExtent();return function(e,o){i.expireCache(),r&&(e=Mr(r,e));var u=t.getZForResolution(o),s=[];return t.forEachTileCoord(e,u,(function(t){var r=t.toString();if(!i.containsKey(r)){var e=n(t);i.set(r,e)}s.push(i.get(r))})),s}},vF.sphere={},vF.sphere.DEFAULT_RADIUS=Jr,vF.sphere.getArea=function t(n,i){var r=i||{},e=r.radius||Jr,o=r.projection||"EPSG:3857",u=n.getType();u!==Kr.GEOMETRY_COLLECTION&&(n=n.clone().transform(o,"EPSG:4326"));var s,a,f,h,c,l,v=0;switch(u){case Kr.POINT:case Kr.MULTI_POINT:case Kr.LINE_STRING:case Kr.MULTI_LINE_STRING:case Kr.LINEAR_RING:break;case Kr.POLYGON:for(s=n.getCoordinates(),v=Math.abs(te(s[0],e)),f=1,h=s.length;f<h;++f)v-=Math.abs(te(s[f],e));break;case Kr.MULTI_POLYGON:for(f=0,h=(s=n.getCoordinates()).length;f<h;++f)for(a=s[f],v+=Math.abs(te(a[0],e)),c=1,l=a.length;c<l;++c)v-=Math.abs(te(a[c],e));break;case Kr.GEOMETRY_COLLECTION:var p=n.getGeometries();for(f=0,h=p.length;f<h;++f)v+=t(p[f],i);break;default:throw new Error("Unsupported geometry type: "+u)}return v},vF.sphere.getDistance=$r,vF.sphere.getLength=function t(n,i){var r=i||{},e=r.radius||Jr,o=r.projection||"EPSG:3857",u=n.getType();u!==Kr.GEOMETRY_COLLECTION&&(n=n.clone().transform(o,"EPSG:4326"));var s,a,f,h,c,l,v=0;switch(u){case Kr.POINT:case Kr.MULTI_POINT:break;case Kr.LINE_STRING:case Kr.LINEAR_RING:v=Qr(s=n.getCoordinates(),e);break;case Kr.MULTI_LINE_STRING:case Kr.POLYGON:for(f=0,h=(s=n.getCoordinates()).length;f<h;++f)v+=Qr(s[f],e);break;case Kr.MULTI_POLYGON:for(f=0,h=(s=n.getCoordinates()).length;f<h;++f)for(c=0,l=(a=s[f]).length;c<l;++c)v+=Qr(a[c],e);break;case Kr.GEOMETRY_COLLECTION:var p=n.getGeometries();for(f=0,h=p.length;f<h;++f)v+=t(p[f],i);break;default:throw new Error("Unsupported geometry type: "+u)}return v},vF.sphere.offset=ne,vF.string={},vF.string.compareVersions=Nr,vF.string.padNumber=Ir,vF.structs={},vF.structs.LRUCache=NO,vF.structs.LinkedList=lF,vF.structs.PriorityQueue=au,vF.structs.PriorityQueue.DROP=su,vF.structs.RBush=Tx,vF.style={},vF.style.Circle=kv,vF.style.Fill=Ql,vF.style.Icon=Mv,vF.style.IconImage=xv,vF.style.IconImage.get=gv,vF.style.IconImageCache=to,vF.style.IconImageCache.shared=no,vF.style.Image=cv,vF.style.RegularShape=jv,vF.style.Stroke=Ov,vF.style.Style=zv,vF.style.Style.createDefaultStyle=Rv,vF.style.Style.createEditingStyle=Iv,vF.style.Style.toFunction=Cv,vF.style.Text=Gv,vF.style.expressions={},vF.style.expressions.Operators=nA,vF.style.expressions.PALETTE_TEXTURE_ARRAY=gA,vF.style.expressions.arrayToGlsl=oA,vF.style.expressions.colorToGlsl=uA,vF.style.expressions.expressionToGlsl=fA,vF.style.expressions.getStringNumberEquivalent=sA,vF.style.expressions.getValueType=iA,vF.style.expressions.isTypeUnique=rA,vF.style.expressions.numberToGlsl=eA,vF.style.expressions.stringToGlsl=aA,vF.style.expressions.uniformNameForVariable=bA,vF.tilecoord={},vF.tilecoord.createOrUpdate=zO,vF.tilecoord.fromKey=DO,vF.tilecoord.getCacheKeyForTileKey=GO,vF.tilecoord.getKey=LO,vF.tilecoord.getKeyZXY=FO,vF.tilecoord.hash=UO,vF.tilecoord.withinExtentAndZ=qO,vF.tilegrid={},vF.tilegrid.TileGrid=HO,vF.tilegrid.WMTS=aF,vF.tilegrid.WMTS.createFromCapabilitiesMatrixSet=fF,vF.tilegrid.common={},vF.tilegrid.common.DEFAULT_MAX_ZOOM=42,vF.tilegrid.common.DEFAULT_TILE_SIZE=gu,vF.tilegrid.createForExtent=$O,vF.tilegrid.createForProjection=nS,vF.tilegrid.createXYZ=QO,vF.tilegrid.extentFromProjection=iS,vF.tilegrid.getForProjection=KO,vF.tilegrid.wrapX=JO,vF.tileurlfunction={},vF.tileurlfunction.createFromTemplate=sS,vF.tileurlfunction.createFromTemplates=aS,vF.tileurlfunction.createFromTileUrlFunctions=fS,vF.tileurlfunction.expandUrl=cS,vF.tileurlfunction.nullTileUrlFunction=hS,vF.transform={},vF.transform.apply=Be;vF.transform.compose=Ze,vF.transform.composeCssTransform=function(t,n,i,r,e,o,u){return Je(Ze([1,0,0,1,0,0],t,n,i,r,e,o,u))},vF.transform.create=Le,vF.transform.determinant=Ke,vF.transform.invert=function(t){return He(t,t)},vF.transform.makeInverse=He,vF.transform.makeScale=We,vF.transform.multiply=De,vF.transform.reset=Ge,vF.transform.rotate=Xe,vF.transform.scale=Ve,vF.transform.set=Ue,vF.transform.setFromArray=qe,vF.transform.toString=Je,vF.transform.translate=Ye,vF.uri={},vF.uri.appendParams=$N,vF.util={},vF.util.VERSION=m,vF.util.abstract=v,vF.util.getUid=d,vF.vec={},vF.vec.mat4={},vF.vec.mat4.create=_M,vF.vec.mat4.fromTransform=MM,vF.webgl={},vF.webgl.ARRAY_BUFFER=fM,vF.webgl.Buffer=wM,vF.webgl.Buffer.getArrayClassForType=mM,vF.webgl.DYNAMIC_DRAW=lM,vF.webgl.ELEMENT_ARRAY_BUFFER=hM,vF.webgl.FLOAT=vM,vF.webgl.Helper=FM,vF.webgl.Helper.computeAttributesStride=NM,vF.webgl.PaletteTexture=PT,vF.webgl.PostProcessingPass=xM,vF.webgl.RenderTarget=ZM,vF.webgl.STATIC_DRAW=cM,vF.webgl.STREAM_DRAW=35040,vF.webgl.ShaderBuilder={},vF.webgl.ShaderBuilder.ShaderBuilder=OA,vF.webgl.ShaderBuilder.parseLiteralStyle=SA,vF.webgl.TileTexture=FT,vF.webgl.UNSIGNED_BYTE=5121,vF.webgl.UNSIGNED_INT=5125,vF.webgl.UNSIGNED_SHORT=5123,vF.webgl.getContext=dM,vF.webgl.getSupportedExtensions=function(){if(!eM){var t=dM(document.createElement("canvas"));t&&(eM=t.getSupportedExtensions())}return eM},vF.xml={},vF.xml.OBJECT_PROPERTY_NODE_FACTORY=ec,vF.xml.XML_SCHEMA_INSTANCE_URI=Bh,vF.xml.createElementNS=Xh,vF.xml.getAllTextContent=Vh,vF.xml.Gw=Wh,vF.xml.getAttributeNS=Zh,vF.xml.getDocument=pc,vF.xml.getXMLSerializer=lc,vF.xml.isDocument=Yh,vF.xml.makeArrayExtender=Kh,vF.xml.makeArrayPusher=Jh,vF.xml.makeArraySerializer=ic,vF.xml.makeChildAppender=nc,vF.xml.makeObjectPropertyPusher=Qh,vF.xml.makeObjectPropertySetter=tc,vF.xml.makeReplacer=$h,vF.xml.makeSequence=oc,vF.xml.makeSimpleNodeFactory=rc,vF.xml.makeStructureNS=uc,vF.xml.parse=Hh,vF.xml.parseNode=sc,vF.xml.pushParseAndPop=ac,vF.xml.pushSerializeAndPop=hc,vF.xml.registerDocument=function(t){vc=t},vF.xml.registerXMLSerializer=function(t){cc=t},vF.xml.serialize=fc;var pF=vF},150:function(t,n,i){"use strict";i.d(n,{Ie:function(){return h},It:function(){return u},L:function(){return r},L5:function(){return l},P1:function(){return p},Qb:function(){return v},pd:function(){return c},sf:function(){return a}});var r={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams",50674:"LercParameters"},e={};for(var o in r)r.hasOwnProperty(o)&&(e[r[o]]=parseInt(o,10));var u=[e.BitsPerSample,e.ExtraSamples,e.SampleFormat,e.StripByteCounts,e.StripOffsets,e.StripRowCounts,e.TileByteCounts,e.TileOffsets,e.SubIFDs],s={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"},a={};for(var f in s)s.hasOwnProperty(f)&&(a[s[f]]=parseInt(f,10));var h={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,TransparencyMask:4,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9},c={Unspecified:0,Assocalpha:1,Unassalpha:2},l={Version:0,AddCompression:1},v={None:0,Deflate:1},p={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"},d={};for(var y in p)p.hasOwnProperty(y)&&(d[p[y]]=parseInt(y,10))}},i={};function r(t){var e=i[t];if(void 0!==e)return e.exports;var o=i[t]={id:t,loaded:!1,exports:{}};return n[t].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}r.m=n,r.d=function(t,n){for(var i in n)r.o(n,i)&&!r.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:n[i]})},r.f={},r.e=function(t){return Promise.all(Object.keys(r.f).reduce((function(n,i){return r.f[i](t,n),n}),[]))},r.u=function(t){return t+".ol.js"},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},t={},r.l=function(n,i,e,o){if(t[n])t[n].push(i);else{var u,s;if(void 0!==e)for(var a=document.getElementsByTagName("script"),f=0;f<a.length;f++){var h=a[f];if(h.getAttribute("src")==n||h.getAttribute("data-webpack")=="ol:"+e){u=h;break}}u||(s=!0,(u=document.createElement("script")).charset="utf-8",u.timeout=120,r.nc&&u.setAttribute("nonce",r.nc),u.setAttribute("data-webpack","ol:"+e),u.src=n),t[n]=[i];var c=function(i,r){u.onerror=u.onload=null,clearTimeout(l);var e=t[n];if(delete t[n],u.parentNode&&u.parentNode.removeChild(u),e&&e.forEach((function(t){return t(r)})),i)return i(r)},l=setTimeout(c.bind(null,void 0,{type:"timeout",target:u}),12e4);u.onerror=c.bind(null,u.onerror),u.onload=c.bind(null,u.onload),s&&document.head.appendChild(u)}},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t},function(){var t;r.g.importScripts&&(t=r.g.location+"");var n=r.g.document;if(!t&&n&&(n.currentScript&&(t=n.currentScript.src),!t)){var i=n.getElementsByTagName("script");i.length&&(t=i[i.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=t}(),function(){var t={179:0};r.f.j=function(n,i){var e=r.o(t,n)?t[n]:void 0;if(0!==e)if(e)i.push(e[2]);else{var o=new Promise((function(i,r){e=t[n]=[i,r]}));i.push(e[2]=o);var u=r.p+r.u(n),s=new Error;r.l(u,(function(i){if(r.o(t,n)&&(0!==(e=t[n])&&(t[n]=void 0),e)){var o=i&&("load"===i.type?"missing":i.type),u=i&&i.target&&i.target.src;s.message="Loading chunk "+n+" failed.\n("+o+": "+u+")",s.name="ChunkLoadError",s.type=o,s.request=u,e[1](s)}}),"chunk-"+n,n)}};var n=function(n,i){var e,o,u=i[0],s=i[1],a=i[2],f=0;if(u.some((function(n){return 0!==t[n]}))){for(e in s)r.o(s,e)&&(r.m[e]=s[e]);if(a)a(r)}for(n&&n(i);f<u.length;f++)o=u[f],r.o(t,o)&&t[o]&&t[o][0](),t[o]=0},i=self.webpackChunkol=self.webpackChunkol||[];i.forEach(n.bind(null,0)),i.push=n.bind(null,i.push.bind(i))}(),r(760);var e=r(198);return e=e.default}()}));
//# sourceMappingURL=ol.js.map